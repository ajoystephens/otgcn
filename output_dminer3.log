2023-09-02 20:41:42,049 - CV - INFO - ===== FILE SETUP =========================================================================
2023-09-02 20:41:42,049 - CV - INFO - SOURCE: abide_large
2023-09-02 20:41:42,049 - CV - INFO - N_FOLDS: 10
2023-09-02 20:41:42,049 - CV - INFO - DEVICE: cuda
2023-09-02 20:41:42,049 - CV - INFO - continue_previous: 0
2023-09-02 20:41:42,049 - CV - INFO - ===== DONE FILE SETUP ====================================================================
2023-09-02 20:41:42,049 - CV - INFO - ===== SETTING INITAL SEED ================================================================
2023-09-02 20:41:42,049 - CV - INFO - SEED: 1
2023-09-02 20:41:42,049 - CV - INFO - ===== DONE SETTING INITAL SEED ===========================================================
2023-09-02 20:41:42,049 - CV - INFO - ===== COMPILING OPTION SET ===============================================================
2023-09-02 20:41:42,049 - CV - INFO - 	learning_rate: [0.001, 0.005, 0.01]
2023-09-02 20:41:42,049 - CV - INFO - 	h1: [64]
2023-09-02 20:41:42,050 - CV - INFO - 	h2: [32]
2023-09-02 20:41:42,050 - CV - INFO - 	weight_decay: [0.0005]
2023-09-02 20:41:42,050 - CV - INFO - 	dropout: [0.0]
2023-09-02 20:41:42,050 - CV - INFO - 	max_pretrain_epochs: [100]
2023-09-02 20:41:42,050 - CV - INFO - 	max_ot_epochs: [50]
2023-09-02 20:41:42,050 - CV - INFO - 	lambda: [0.01, 0.03, 0.05]
2023-09-02 20:41:42,050 - CV - INFO - 	theta: [10, 30, 50]
2023-09-02 20:41:42,050 - CV - INFO - 	clip: [5]
2023-09-02 20:41:42,050 - CV - INFO - Total Sets: 27
2023-09-02 20:41:42,050 - CV - INFO - ===== DONE COMPILING OPTION SET ==========================================================
2023-09-02 20:41:42,050 - CV - INFO - ===== ASSIGNING FOLDS ====================================================================
2023-09-02 20:41:42,051 - CV - INFO - Fold Assignment Shape: (804,)
2023-09-02 20:41:42,051 - CV - INFO - Fold Assignment Counts: 
{0: 96, 1: 77, 2: 83, 3: 75, 4: 72, 5: 78, 6: 87, 7: 87, 8: 70, 9: 79}
2023-09-02 20:41:42,051 - CV - INFO - ===== DONE ASSIGNING FOLDS ===============================================================
2023-09-02 20:41:42,051 - CV - INFO - ===== BEGINNING OPTION SET (001)==========================================================
2023-09-02 20:41:42,051 - CV - INFO - 	done: False
2023-09-02 20:41:42,051 - CV - INFO - 	learning_rate: 0.001
2023-09-02 20:41:42,051 - CV - INFO - 	h1: 64
2023-09-02 20:41:42,051 - CV - INFO - 	h2: 32
2023-09-02 20:41:42,051 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:41:42,051 - CV - INFO - 	dropout: 0.0
2023-09-02 20:41:42,051 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:41:42,051 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:41:42,051 - CV - INFO - 	lambda: 0.01
2023-09-02 20:41:42,051 - CV - INFO - 	theta: 10
2023-09-02 20:41:42,051 - CV - INFO - 	clip: 5
2023-09-02 20:41:42,051 - CV - INFO - ----- BEGINNING FOLD SET (001:0)----------------------------------------------------------
2023-09-02 20:41:42,051 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/001/0
2023-09-02 20:41:42,051 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:41:42,051 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:41:42,051 - FGO - INFO - 	done: False
2023-09-02 20:41:42,051 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:41:42,051 - FGO - INFO - 	h1: 64
2023-09-02 20:41:42,051 - FGO - INFO - 	h2: 32
2023-09-02 20:41:42,051 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:41:42,051 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:41:42,051 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:41:42,051 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:41:42,051 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:41:42,051 - FGO - INFO - 	theta: 10
2023-09-02 20:41:42,051 - FGO - INFO - 	clip: 5
2023-09-02 20:41:42,051 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:41:42,051 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:41:42,052 - FGO - INFO - Source Total: 708
2023-09-02 20:41:42,052 - FGO - INFO - Target Total: 96
2023-09-02 20:41:42,052 - FGO - INFO - Train Total: 708
2023-09-02 20:41:42,052 - FGO - INFO - Val Total:   96
2023-09-02 20:41:42,052 - FGO - INFO - Test Total:  96
2023-09-02 20:41:42,052 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:41:42,052 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:41:42,052 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:41:42,052 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:41:42,052 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:41:42,052 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:41:42,052 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:41:42,052 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:41:42,052 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:41:42,052 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:41:42,053 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:41:42,538 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:41:42,653 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:41:42,653 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:41:42,653 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:41:42,653 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:41:42,653 - FGO - INFO - N: 804
2023-09-02 20:41:42,653 - FGO - INFO - N_s: 708
2023-09-02 20:41:42,653 - FGO - INFO - N_t: 96
2023-09-02 20:41:42,658 - CV - INFO - Begin Pretrain
2023-09-02 20:41:42,658 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:41:43,044 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:41:43,069 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:41:43,094 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.53 |
2023-09-02 20:41:43,119 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.61 | Val F1: 0.67 |
2023-09-02 20:41:43,145 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.52 | Val F1: 0.86 |
2023-09-02 20:41:43,170 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.41 | Val F1: 0.89 |
2023-09-02 20:41:43,195 - FGO - INFO - Epoch  60 | Train Loss: 0.298 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:41:43,220 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:41:43,245 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:41:43,270 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:41:43,295 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:41:43,295 - FGO - INFO - Best Epoch:  86 | Train Loss: 0.161 | Val Loss: 0.18 | Val F1: 0.95 
2023-09-02 20:41:43,295 - FGO - INFO - Setting model to best state.
2023-09-02 20:41:43,297 - CV - INFO - Pretrain Complete, 86 epochs
2023-09-02 20:41:43,297 - CV - INFO - Begin OT Train
2023-09-02 20:41:43,297 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:41:43,370 - FGO - INFO - Epoch   0 | Train Loss: -0.528 | Val Loss: 0.05 | Val F1: 0.95 |
2023-09-02 20:41:44,229 - FGO - INFO - Epoch  10 | Train Loss: -0.597 | Val Loss: 0.01 | Val F1: 0.97 |
2023-09-02 20:41:45,061 - FGO - INFO - Epoch  20 | Train Loss: -0.638 | Val Loss: 0.00 | Val F1: 0.98 |
2023-09-02 20:41:45,855 - FGO - INFO - Epoch  30 | Train Loss: -0.671 | Val Loss: -0.01 | Val F1: 0.98 |
2023-09-02 20:41:46,704 - FGO - INFO - Epoch  40 | Train Loss: -0.691 | Val Loss: -0.01 | Val F1: 0.98 |
2023-09-02 20:41:47,478 - FGO - INFO - Best Epoch:  11 | Train Loss: -0.599 | Val Loss: 0.01 | Val F1: 0.98 |
2023-09-02 20:41:47,478 - FGO - INFO - Setting model to best state.
2023-09-02 20:41:47,482 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:41:47,482 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:41:47,524 - FGO - INFO - Train CM:
[[373   9]
 [ 16 310]]
2023-09-02 20:41:47,525 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:41:47,525 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:41:47,529 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:41:47,531 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:41:47,532 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:41:47,532 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:41:47,532 - CV - INFO - fold time: 5.481086492538452s (0.09135144154230754m)
2023-09-02 20:41:47,532 - CV - INFO - ----- BEGINNING FOLD SET (001:1)----------------------------------------------------------
2023-09-02 20:41:47,534 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/001/1
2023-09-02 20:41:47,534 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:41:47,534 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:41:47,534 - FGO - INFO - 	done: False
2023-09-02 20:41:47,534 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:41:47,534 - FGO - INFO - 	h1: 64
2023-09-02 20:41:47,534 - FGO - INFO - 	h2: 32
2023-09-02 20:41:47,534 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:41:47,534 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:41:47,534 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:41:47,534 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:41:47,534 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:41:47,534 - FGO - INFO - 	theta: 10
2023-09-02 20:41:47,534 - FGO - INFO - 	clip: 5
2023-09-02 20:41:47,534 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:41:47,534 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:41:47,534 - FGO - INFO - Source Total: 727
2023-09-02 20:41:47,534 - FGO - INFO - Target Total: 77
2023-09-02 20:41:47,534 - FGO - INFO - Train Total: 727
2023-09-02 20:41:47,534 - FGO - INFO - Val Total:   77
2023-09-02 20:41:47,534 - FGO - INFO - Test Total:  77
2023-09-02 20:41:47,534 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:41:47,534 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:41:47,534 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:41:47,534 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:41:47,534 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:41:47,535 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:41:47,535 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:41:47,535 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:41:47,535 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:41:47,535 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:41:47,536 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:41:47,537 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:41:47,633 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:41:47,633 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:41:47,633 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:41:47,633 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:41:47,633 - FGO - INFO - N: 804
2023-09-02 20:41:47,633 - FGO - INFO - N_s: 727
2023-09-02 20:41:47,633 - FGO - INFO - N_t: 77
2023-09-02 20:41:47,637 - CV - INFO - Begin Pretrain
2023-09-02 20:41:47,637 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:41:47,640 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:41:47,665 - FGO - INFO - Epoch  10 | Train Loss: 0.673 | Val Loss: 0.68 | Val F1: 0.51 |
2023-09-02 20:41:47,690 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.55 |
2023-09-02 20:41:47,714 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:41:47,739 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.55 | Val F1: 0.73 |
2023-09-02 20:41:47,764 - FGO - INFO - Epoch  50 | Train Loss: 0.396 | Val Loss: 0.47 | Val F1: 0.73 |
2023-09-02 20:41:47,788 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.40 | Val F1: 0.81 |
2023-09-02 20:41:47,813 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.34 | Val F1: 0.80 |
2023-09-02 20:41:47,838 - FGO - INFO - Epoch  80 | Train Loss: 0.172 | Val Loss: 0.29 | Val F1: 0.83 |
2023-09-02 20:41:47,862 - FGO - INFO - Epoch  90 | Train Loss: 0.142 | Val Loss: 0.26 | Val F1: 0.87 |
2023-09-02 20:41:47,887 - FGO - INFO - Epoch 100 | Train Loss: 0.122 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:41:47,887 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.147 | Val Loss: 0.27 | Val F1: 0.87 
2023-09-02 20:41:47,887 - FGO - INFO - Setting model to best state.
2023-09-02 20:41:47,888 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:41:47,888 - CV - INFO - Begin OT Train
2023-09-02 20:41:47,888 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:41:47,980 - FGO - INFO - Epoch   0 | Train Loss: -0.431 | Val Loss: 0.18 | Val F1: 0.87 |
2023-09-02 20:41:48,846 - FGO - INFO - Epoch  10 | Train Loss: -0.558 | Val Loss: 0.14 | Val F1: 0.92 |
2023-09-02 20:41:49,703 - FGO - INFO - Epoch  20 | Train Loss: -0.597 | Val Loss: 0.14 | Val F1: 0.91 |
2023-09-02 20:41:50,556 - FGO - INFO - Epoch  30 | Train Loss: -0.635 | Val Loss: 0.14 | Val F1: 0.91 |
2023-09-02 20:41:51,388 - FGO - INFO - Epoch  40 | Train Loss: -0.662 | Val Loss: 0.14 | Val F1: 0.89 |
2023-09-02 20:41:52,206 - FGO - INFO - Best Epoch:   6 | Train Loss: -0.540 | Val Loss: 0.14 | Val F1: 0.93 |
2023-09-02 20:41:52,206 - FGO - INFO - Setting model to best state.
2023-09-02 20:41:52,209 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:41:52,210 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:41:52,249 - FGO - INFO - Train CM:
[[379  11]
 [ 16 321]]
2023-09-02 20:41:52,250 - FGO - INFO - Val CM:
[[41  3]
 [ 4 29]]
2023-09-02 20:41:52,250 - FGO - INFO - Test CM:
[[41  3]
 [ 4 29]]
2023-09-02 20:41:52,254 - FGO - INFO - test statistical parity: 0.29487179487179493
2023-09-02 20:41:52,256 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:41:52,257 - FGO - INFO - test micro f1: 0.9090909090909091
2023-09-02 20:41:52,257 - FGO - INFO - test macro f1: 0.9068280034572169
2023-09-02 20:41:52,257 - CV - INFO - fold time: 4.724872350692749s (0.07874787251154582m)
2023-09-02 20:41:52,257 - CV - INFO - ----- BEGINNING FOLD SET (001:2)----------------------------------------------------------
2023-09-02 20:41:52,259 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/001/2
2023-09-02 20:41:52,259 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:41:52,259 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:41:52,259 - FGO - INFO - 	done: False
2023-09-02 20:41:52,259 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:41:52,259 - FGO - INFO - 	h1: 64
2023-09-02 20:41:52,259 - FGO - INFO - 	h2: 32
2023-09-02 20:41:52,259 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:41:52,259 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:41:52,259 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:41:52,259 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:41:52,259 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:41:52,259 - FGO - INFO - 	theta: 10
2023-09-02 20:41:52,259 - FGO - INFO - 	clip: 5
2023-09-02 20:41:52,259 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:41:52,259 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:41:52,259 - FGO - INFO - Source Total: 721
2023-09-02 20:41:52,259 - FGO - INFO - Target Total: 83
2023-09-02 20:41:52,259 - FGO - INFO - Train Total: 721
2023-09-02 20:41:52,259 - FGO - INFO - Val Total:   83
2023-09-02 20:41:52,259 - FGO - INFO - Test Total:  83
2023-09-02 20:41:52,259 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:41:52,259 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:41:52,259 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:41:52,259 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:41:52,259 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:41:52,260 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:41:52,260 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:41:52,260 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:41:52,260 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:41:52,260 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:41:52,261 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:41:52,262 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:41:52,364 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:41:52,364 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:41:52,364 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:41:52,364 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:41:52,364 - FGO - INFO - N: 804
2023-09-02 20:41:52,364 - FGO - INFO - N_s: 721
2023-09-02 20:41:52,364 - FGO - INFO - N_t: 83
2023-09-02 20:41:52,367 - CV - INFO - Begin Pretrain
2023-09-02 20:41:52,367 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:41:52,370 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:41:52,395 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.57 |
2023-09-02 20:41:52,420 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.64 | Val F1: 0.66 |
2023-09-02 20:41:52,444 - FGO - INFO - Epoch  30 | Train Loss: 0.594 | Val Loss: 0.60 | Val F1: 0.76 |
2023-09-02 20:41:52,469 - FGO - INFO - Epoch  40 | Train Loss: 0.506 | Val Loss: 0.52 | Val F1: 0.83 |
2023-09-02 20:41:52,494 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:41:52,521 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.34 | Val F1: 0.85 |
2023-09-02 20:41:52,549 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:41:52,576 - FGO - INFO - Epoch  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:41:52,604 - FGO - INFO - Epoch  90 | Train Loss: 0.140 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:41:52,632 - FGO - INFO - Epoch 100 | Train Loss: 0.119 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:41:52,632 - FGO - INFO - Best Epoch:  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 
2023-09-02 20:41:52,632 - FGO - INFO - Setting model to best state.
2023-09-02 20:41:52,633 - CV - INFO - Pretrain Complete, 80 epochs
2023-09-02 20:41:52,633 - CV - INFO - Begin OT Train
2023-09-02 20:41:52,633 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:41:52,735 - FGO - INFO - Epoch   0 | Train Loss: -0.483 | Val Loss: 0.17 | Val F1: 0.87 |
2023-09-02 20:41:53,664 - FGO - INFO - Epoch  10 | Train Loss: -0.585 | Val Loss: 0.20 | Val F1: 0.91 |
2023-09-02 20:41:54,526 - FGO - INFO - Epoch  20 | Train Loss: -0.629 | Val Loss: 0.21 | Val F1: 0.90 |
2023-09-02 20:41:55,437 - FGO - INFO - Epoch  30 | Train Loss: -0.663 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:41:56,343 - FGO - INFO - Epoch  40 | Train Loss: -0.690 | Val Loss: 0.21 | Val F1: 0.90 |
2023-09-02 20:41:57,095 - FGO - INFO - Best Epoch:   7 | Train Loss: -0.576 | Val Loss: 0.20 | Val F1: 0.91 |
2023-09-02 20:41:57,095 - FGO - INFO - Setting model to best state.
2023-09-02 20:41:57,099 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:41:57,099 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:41:57,141 - FGO - INFO - Train CM:
[[379   5]
 [ 17 320]]
2023-09-02 20:41:57,141 - FGO - INFO - Val CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:41:57,141 - FGO - INFO - Test CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:41:57,146 - FGO - INFO - test statistical parity: 0.10563380281690143
2023-09-02 20:41:57,147 - FGO - INFO - test equal opportunity: 0.09259259259259256
2023-09-02 20:41:57,148 - FGO - INFO - test micro f1: 0.9156626506024096
2023-09-02 20:41:57,149 - FGO - INFO - test macro f1: 0.9124076586763153
2023-09-02 20:41:57,149 - CV - INFO - fold time: 4.891479015350342s (0.08152465025583903m)
2023-09-02 20:41:57,149 - CV - INFO - ----- BEGINNING FOLD SET (001:3)----------------------------------------------------------
2023-09-02 20:41:57,150 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/001/3
2023-09-02 20:41:57,150 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:41:57,150 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:41:57,150 - FGO - INFO - 	done: False
2023-09-02 20:41:57,150 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:41:57,150 - FGO - INFO - 	h1: 64
2023-09-02 20:41:57,150 - FGO - INFO - 	h2: 32
2023-09-02 20:41:57,150 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:41:57,151 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:41:57,151 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:41:57,151 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:41:57,151 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:41:57,151 - FGO - INFO - 	theta: 10
2023-09-02 20:41:57,151 - FGO - INFO - 	clip: 5
2023-09-02 20:41:57,151 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:41:57,151 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:41:57,151 - FGO - INFO - Source Total: 729
2023-09-02 20:41:57,151 - FGO - INFO - Target Total: 75
2023-09-02 20:41:57,151 - FGO - INFO - Train Total: 729
2023-09-02 20:41:57,151 - FGO - INFO - Val Total:   75
2023-09-02 20:41:57,151 - FGO - INFO - Test Total:  75
2023-09-02 20:41:57,151 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:41:57,151 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:41:57,151 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:41:57,151 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:41:57,151 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:41:57,151 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:41:57,151 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:41:57,151 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:41:57,151 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:41:57,151 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:41:57,152 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:41:57,154 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:41:57,247 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:41:57,247 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:41:57,247 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:41:57,247 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:41:57,247 - FGO - INFO - N: 804
2023-09-02 20:41:57,247 - FGO - INFO - N_s: 729
2023-09-02 20:41:57,247 - FGO - INFO - N_t: 75
2023-09-02 20:41:57,250 - CV - INFO - Begin Pretrain
2023-09-02 20:41:57,250 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:41:57,254 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:41:57,278 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.67 | Val F1: 0.39 |
2023-09-02 20:41:57,303 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.64 |
2023-09-02 20:41:57,328 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.57 | Val F1: 0.86 |
2023-09-02 20:41:57,352 - FGO - INFO - Epoch  40 | Train Loss: 0.510 | Val Loss: 0.47 | Val F1: 0.92 |
2023-09-02 20:41:57,377 - FGO - INFO - Epoch  50 | Train Loss: 0.406 | Val Loss: 0.34 | Val F1: 0.93 |
2023-09-02 20:41:57,402 - FGO - INFO - Epoch  60 | Train Loss: 0.305 | Val Loss: 0.23 | Val F1: 0.97 |
2023-09-02 20:41:57,426 - FGO - INFO - Epoch  70 | Train Loss: 0.231 | Val Loss: 0.16 | Val F1: 0.99 |
2023-09-02 20:41:57,451 - FGO - INFO - Epoch  80 | Train Loss: 0.186 | Val Loss: 0.12 | Val F1: 0.99 |
2023-09-02 20:41:57,475 - FGO - INFO - Epoch  90 | Train Loss: 0.156 | Val Loss: 0.10 | Val F1: 0.99 |
2023-09-02 20:41:57,499 - FGO - INFO - Epoch 100 | Train Loss: 0.135 | Val Loss: 0.09 | Val F1: 0.97 |
2023-09-02 20:41:57,500 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.161 | Val Loss: 0.10 | Val F1: 0.99 
2023-09-02 20:41:57,500 - FGO - INFO - Setting model to best state.
2023-09-02 20:41:57,501 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:41:57,501 - CV - INFO - Begin OT Train
2023-09-02 20:41:57,501 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:41:57,581 - FGO - INFO - Epoch   0 | Train Loss: -0.490 | Val Loss: 0.01 | Val F1: 0.99 |
2023-09-02 20:41:58,444 - FGO - INFO - Epoch  10 | Train Loss: -0.595 | Val Loss: -0.01 | Val F1: 0.99 |
2023-09-02 20:41:59,284 - FGO - INFO - Epoch  20 | Train Loss: -0.635 | Val Loss: -0.00 | Val F1: 0.99 |
2023-09-02 20:42:00,128 - FGO - INFO - Epoch  30 | Train Loss: -0.669 | Val Loss: -0.02 | Val F1: 0.99 |
2023-09-02 20:42:01,028 - FGO - INFO - Epoch  40 | Train Loss: -0.693 | Val Loss: -0.02 | Val F1: 0.99 |
2023-09-02 20:42:01,818 - FGO - INFO - Best Epoch:   7 | Train Loss: -0.593 | Val Loss: 0.00 | Val F1: 0.99 |
2023-09-02 20:42:01,818 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:01,822 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:42:01,822 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:01,866 - FGO - INFO - Train CM:
[[387   9]
 [ 19 314]]
2023-09-02 20:42:01,866 - FGO - INFO - Val CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:42:01,866 - FGO - INFO - Test CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:42:01,871 - FGO - INFO - test statistical parity: 0.024590163934426257
2023-09-02 20:42:01,872 - FGO - INFO - test equal opportunity: 0.033333333333333326
2023-09-02 20:42:01,873 - FGO - INFO - test micro f1: 0.9866666666666668
2023-09-02 20:42:01,874 - FGO - INFO - test macro f1: 0.9866571784380003
2023-09-02 20:42:01,874 - CV - INFO - fold time: 4.725079536437988s (0.0787513256072998m)
2023-09-02 20:42:01,874 - CV - INFO - ----- BEGINNING FOLD SET (001:4)----------------------------------------------------------
2023-09-02 20:42:01,875 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/001/4
2023-09-02 20:42:01,875 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:01,875 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:01,876 - FGO - INFO - 	done: False
2023-09-02 20:42:01,876 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:01,876 - FGO - INFO - 	h1: 64
2023-09-02 20:42:01,876 - FGO - INFO - 	h2: 32
2023-09-02 20:42:01,876 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:01,876 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:01,876 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:01,876 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:01,876 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:01,876 - FGO - INFO - 	theta: 10
2023-09-02 20:42:01,876 - FGO - INFO - 	clip: 5
2023-09-02 20:42:01,876 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:01,876 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:01,876 - FGO - INFO - Source Total: 732
2023-09-02 20:42:01,876 - FGO - INFO - Target Total: 72
2023-09-02 20:42:01,876 - FGO - INFO - Train Total: 732
2023-09-02 20:42:01,876 - FGO - INFO - Val Total:   72
2023-09-02 20:42:01,876 - FGO - INFO - Test Total:  72
2023-09-02 20:42:01,876 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:01,876 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:01,876 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:01,876 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:01,876 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:01,876 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:01,876 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:01,876 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:01,876 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:01,876 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:01,877 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:01,879 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:01,969 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:01,969 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:01,969 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:01,969 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:01,969 - FGO - INFO - N: 804
2023-09-02 20:42:01,969 - FGO - INFO - N_s: 732
2023-09-02 20:42:01,969 - FGO - INFO - N_t: 72
2023-09-02 20:42:01,973 - CV - INFO - Begin Pretrain
2023-09-02 20:42:01,973 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:01,976 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:42:02,001 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.68 | Val F1: 0.45 |
2023-09-02 20:42:02,026 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.66 | Val F1: 0.63 |
2023-09-02 20:42:02,050 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.60 | Val F1: 0.75 |
2023-09-02 20:42:02,075 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.50 | Val F1: 0.87 |
2023-09-02 20:42:02,100 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.39 | Val F1: 0.89 |
2023-09-02 20:42:02,125 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:42:02,149 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:42:02,174 - FGO - INFO - Epoch  80 | Train Loss: 0.179 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:42:02,199 - FGO - INFO - Epoch  90 | Train Loss: 0.150 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:42:02,223 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:42:02,223 - FGO - INFO - Best Epoch:  81 | Train Loss: 0.175 | Val Loss: 0.16 | Val F1: 0.97 
2023-09-02 20:42:02,223 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:02,225 - CV - INFO - Pretrain Complete, 81 epochs
2023-09-02 20:42:02,225 - CV - INFO - Begin OT Train
2023-09-02 20:42:02,225 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:02,297 - FGO - INFO - Epoch   0 | Train Loss: -0.581 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:42:03,181 - FGO - INFO - Epoch  10 | Train Loss: -0.655 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:42:04,051 - FGO - INFO - Epoch  20 | Train Loss: -0.705 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:42:04,926 - FGO - INFO - Epoch  30 | Train Loss: -0.729 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:42:05,807 - FGO - INFO - Epoch  40 | Train Loss: -0.742 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:42:06,538 - FGO - INFO - Best Epoch:   6 | Train Loss: -0.629 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:42:06,538 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:06,542 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:42:06,542 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:06,569 - FGO - INFO - Train CM:
[[387  10]
 [ 12 323]]
2023-09-02 20:42:06,569 - FGO - INFO - Val CM:
[[37  0]
 [ 2 33]]
2023-09-02 20:42:06,569 - FGO - INFO - Test CM:
[[37  0]
 [ 2 33]]
2023-09-02 20:42:06,574 - FGO - INFO - test statistical parity: 0.06774193548387092
2023-09-02 20:42:06,576 - FGO - INFO - test equal opportunity: 0.16666666666666663
2023-09-02 20:42:06,577 - FGO - INFO - test micro f1: 0.9722222222222222
2023-09-02 20:42:06,577 - FGO - INFO - test macro f1: 0.9721362229102167
2023-09-02 20:42:06,577 - CV - INFO - fold time: 4.70346212387085s (0.07839103539784749m)
2023-09-02 20:42:06,577 - CV - INFO - ----- BEGINNING FOLD SET (001:5)----------------------------------------------------------
2023-09-02 20:42:06,579 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/001/5
2023-09-02 20:42:06,579 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:06,579 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:06,579 - FGO - INFO - 	done: False
2023-09-02 20:42:06,579 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:06,579 - FGO - INFO - 	h1: 64
2023-09-02 20:42:06,579 - FGO - INFO - 	h2: 32
2023-09-02 20:42:06,579 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:06,579 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:06,579 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:06,579 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:06,579 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:06,579 - FGO - INFO - 	theta: 10
2023-09-02 20:42:06,579 - FGO - INFO - 	clip: 5
2023-09-02 20:42:06,579 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:06,579 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:06,579 - FGO - INFO - Source Total: 726
2023-09-02 20:42:06,579 - FGO - INFO - Target Total: 78
2023-09-02 20:42:06,579 - FGO - INFO - Train Total: 726
2023-09-02 20:42:06,579 - FGO - INFO - Val Total:   78
2023-09-02 20:42:06,579 - FGO - INFO - Test Total:  78
2023-09-02 20:42:06,579 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:06,579 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:06,579 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:06,579 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:06,579 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:06,580 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:06,580 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:06,580 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:06,580 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:06,580 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:06,581 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:06,582 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:06,679 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:06,679 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:06,679 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:06,679 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:06,679 - FGO - INFO - N: 804
2023-09-02 20:42:06,679 - FGO - INFO - N_s: 726
2023-09-02 20:42:06,679 - FGO - INFO - N_t: 78
2023-09-02 20:42:06,683 - CV - INFO - Begin Pretrain
2023-09-02 20:42:06,683 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:06,686 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:42:06,710 - FGO - INFO - Epoch  10 | Train Loss: 0.669 | Val Loss: 0.72 | Val F1: 0.34 |
2023-09-02 20:42:06,735 - FGO - INFO - Epoch  20 | Train Loss: 0.644 | Val Loss: 0.69 | Val F1: 0.42 |
2023-09-02 20:42:06,759 - FGO - INFO - Epoch  30 | Train Loss: 0.591 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:42:06,784 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.53 | Val F1: 0.83 |
2023-09-02 20:42:06,808 - FGO - INFO - Epoch  50 | Train Loss: 0.397 | Val Loss: 0.41 | Val F1: 0.85 |
2023-09-02 20:42:06,833 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:42:06,857 - FGO - INFO - Epoch  70 | Train Loss: 0.220 | Val Loss: 0.27 | Val F1: 0.88 |
2023-09-02 20:42:06,882 - FGO - INFO - Epoch  80 | Train Loss: 0.175 | Val Loss: 0.25 | Val F1: 0.88 |
2023-09-02 20:42:06,906 - FGO - INFO - Epoch  90 | Train Loss: 0.148 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:42:06,930 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.21 | Val F1: 0.91 |
2023-09-02 20:42:06,930 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.209 | Val Loss: 0.26 | Val F1: 0.91 
2023-09-02 20:42:06,930 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:06,932 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:42:06,932 - CV - INFO - Begin OT Train
2023-09-02 20:42:06,932 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:07,003 - FGO - INFO - Epoch   0 | Train Loss: -0.527 | Val Loss: 0.14 | Val F1: 0.91 |
2023-09-02 20:42:07,824 - FGO - INFO - Epoch  10 | Train Loss: -0.602 | Val Loss: 0.17 | Val F1: 0.88 |
2023-09-02 20:42:08,694 - FGO - INFO - Epoch  20 | Train Loss: -0.644 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 20:42:09,607 - FGO - INFO - Epoch  30 | Train Loss: -0.677 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:42:10,435 - FGO - INFO - Epoch  40 | Train Loss: -0.699 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 20:42:11,225 - FGO - INFO - Best Epoch:  21 | Train Loss: -0.647 | Val Loss: 0.18 | Val F1: 0.91 |
2023-09-02 20:42:11,225 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:11,228 - CV - INFO - OT Train Complete, 21 epochs
2023-09-02 20:42:11,229 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:11,256 - FGO - INFO - Train CM:
[[393   7]
 [ 17 309]]
2023-09-02 20:42:11,257 - FGO - INFO - Val CM:
[[34  0]
 [ 7 37]]
2023-09-02 20:42:11,257 - FGO - INFO - Test CM:
[[34  0]
 [ 7 37]]
2023-09-02 20:42:11,262 - FGO - INFO - test statistical parity: 0.09178743961352659
2023-09-02 20:42:11,263 - FGO - INFO - test equal opportunity: 0.17948717948717952
2023-09-02 20:42:11,264 - FGO - INFO - test micro f1: 0.9102564102564102
2023-09-02 20:42:11,264 - FGO - INFO - test macro f1: 0.9101234567901235
2023-09-02 20:42:11,264 - CV - INFO - fold time: 4.687039136886597s (0.07811731894810994m)
2023-09-02 20:42:11,264 - CV - INFO - ----- BEGINNING FOLD SET (001:6)----------------------------------------------------------
2023-09-02 20:42:11,266 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/001/6
2023-09-02 20:42:11,266 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:11,266 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:11,266 - FGO - INFO - 	done: False
2023-09-02 20:42:11,266 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:11,266 - FGO - INFO - 	h1: 64
2023-09-02 20:42:11,266 - FGO - INFO - 	h2: 32
2023-09-02 20:42:11,266 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:11,266 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:11,266 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:11,266 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:11,266 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:11,266 - FGO - INFO - 	theta: 10
2023-09-02 20:42:11,266 - FGO - INFO - 	clip: 5
2023-09-02 20:42:11,266 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:11,266 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:11,266 - FGO - INFO - Source Total: 717
2023-09-02 20:42:11,266 - FGO - INFO - Target Total: 87
2023-09-02 20:42:11,266 - FGO - INFO - Train Total: 717
2023-09-02 20:42:11,266 - FGO - INFO - Val Total:   87
2023-09-02 20:42:11,266 - FGO - INFO - Test Total:  87
2023-09-02 20:42:11,266 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:11,266 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:11,266 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:11,266 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:11,266 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:11,267 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:11,267 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:11,267 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:11,267 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:11,267 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:11,268 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:11,269 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:11,375 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:11,375 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:11,375 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:11,375 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:11,375 - FGO - INFO - N: 804
2023-09-02 20:42:11,375 - FGO - INFO - N_s: 717
2023-09-02 20:42:11,375 - FGO - INFO - N_t: 87
2023-09-02 20:42:11,378 - CV - INFO - Begin Pretrain
2023-09-02 20:42:11,378 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:11,381 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:42:11,409 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.47 |
2023-09-02 20:42:11,434 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.63 |
2023-09-02 20:42:11,459 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.78 |
2023-09-02 20:42:11,483 - FGO - INFO - Epoch  40 | Train Loss: 0.509 | Val Loss: 0.50 | Val F1: 0.84 |
2023-09-02 20:42:11,508 - FGO - INFO - Epoch  50 | Train Loss: 0.402 | Val Loss: 0.40 | Val F1: 0.86 |
2023-09-02 20:42:11,532 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.31 | Val F1: 0.92 |
2023-09-02 20:42:11,557 - FGO - INFO - Epoch  70 | Train Loss: 0.228 | Val Loss: 0.23 | Val F1: 0.92 |
2023-09-02 20:42:11,581 - FGO - INFO - Epoch  80 | Train Loss: 0.184 | Val Loss: 0.19 | Val F1: 0.93 |
2023-09-02 20:42:11,605 - FGO - INFO - Epoch  90 | Train Loss: 0.154 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:42:11,630 - FGO - INFO - Epoch 100 | Train Loss: 0.134 | Val Loss: 0.14 | Val F1: 0.95 |
2023-09-02 20:42:11,630 - FGO - INFO - Best Epoch:  99 | Train Loss: 0.135 | Val Loss: 0.14 | Val F1: 0.95 
2023-09-02 20:42:11,630 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:11,631 - CV - INFO - Pretrain Complete, 99 epochs
2023-09-02 20:42:11,631 - CV - INFO - Begin OT Train
2023-09-02 20:42:11,631 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:11,734 - FGO - INFO - Epoch   0 | Train Loss: -0.552 | Val Loss: 0.05 | Val F1: 0.95 |
2023-09-02 20:42:12,514 - FGO - INFO - Epoch  10 | Train Loss: -0.606 | Val Loss: 0.04 | Val F1: 0.95 |
2023-09-02 20:42:13,363 - FGO - INFO - Epoch  20 | Train Loss: -0.651 | Val Loss: 0.02 | Val F1: 0.95 |
2023-09-02 20:42:14,185 - FGO - INFO - Epoch  30 | Train Loss: -0.681 | Val Loss: 0.01 | Val F1: 0.96 |
2023-09-02 20:42:15,029 - FGO - INFO - Epoch  40 | Train Loss: -0.699 | Val Loss: -0.00 | Val F1: 0.98 |
2023-09-02 20:42:15,805 - FGO - INFO - Best Epoch:  40 | Train Loss: -0.699 | Val Loss: -0.00 | Val F1: 0.98 |
2023-09-02 20:42:15,805 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:15,808 - CV - INFO - OT Train Complete, 40 epochs
2023-09-02 20:42:15,808 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:15,837 - FGO - INFO - Train CM:
[[376   9]
 [ 20 312]]
2023-09-02 20:42:15,837 - FGO - INFO - Val CM:
[[47  2]
 [ 0 38]]
2023-09-02 20:42:15,837 - FGO - INFO - Test CM:
[[47  2]
 [ 0 38]]
2023-09-02 20:42:15,842 - FGO - INFO - test statistical parity: 0.044303797468354444
2023-09-02 20:42:15,843 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:42:15,844 - FGO - INFO - test micro f1: 0.9770114942528736
2023-09-02 20:42:15,845 - FGO - INFO - test macro f1: 0.9767628205128205
2023-09-02 20:42:15,845 - CV - INFO - fold time: 4.580404043197632s (0.0763400673866272m)
2023-09-02 20:42:15,845 - CV - INFO - ----- BEGINNING FOLD SET (001:7)----------------------------------------------------------
2023-09-02 20:42:15,846 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/001/7
2023-09-02 20:42:15,847 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:15,847 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:15,847 - FGO - INFO - 	done: False
2023-09-02 20:42:15,847 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:15,847 - FGO - INFO - 	h1: 64
2023-09-02 20:42:15,847 - FGO - INFO - 	h2: 32
2023-09-02 20:42:15,847 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:15,847 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:15,847 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:15,847 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:15,847 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:15,847 - FGO - INFO - 	theta: 10
2023-09-02 20:42:15,847 - FGO - INFO - 	clip: 5
2023-09-02 20:42:15,847 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:15,847 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:15,847 - FGO - INFO - Source Total: 717
2023-09-02 20:42:15,847 - FGO - INFO - Target Total: 87
2023-09-02 20:42:15,847 - FGO - INFO - Train Total: 717
2023-09-02 20:42:15,847 - FGO - INFO - Val Total:   87
2023-09-02 20:42:15,847 - FGO - INFO - Test Total:  87
2023-09-02 20:42:15,847 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:15,847 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:15,847 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:15,847 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:15,847 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:15,847 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:15,847 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:15,847 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:15,848 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:15,848 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:15,849 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:15,850 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:15,956 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:15,956 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:15,956 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:15,956 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:15,956 - FGO - INFO - N: 804
2023-09-02 20:42:15,956 - FGO - INFO - N_s: 717
2023-09-02 20:42:15,956 - FGO - INFO - N_t: 87
2023-09-02 20:42:15,960 - CV - INFO - Begin Pretrain
2023-09-02 20:42:15,960 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:15,963 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:42:15,988 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.40 |
2023-09-02 20:42:16,012 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.62 |
2023-09-02 20:42:16,037 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.77 |
2023-09-02 20:42:16,062 - FGO - INFO - Epoch  40 | Train Loss: 0.507 | Val Loss: 0.52 | Val F1: 0.88 |
2023-09-02 20:42:16,086 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.41 | Val F1: 0.88 |
2023-09-02 20:42:16,110 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:42:16,135 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.23 | Val F1: 0.94 |
2023-09-02 20:42:16,160 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:42:16,184 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:42:16,209 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:42:16,209 - FGO - INFO - Best Epoch:  91 | Train Loss: 0.149 | Val Loss: 0.15 | Val F1: 0.97 
2023-09-02 20:42:16,209 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:16,210 - CV - INFO - Pretrain Complete, 91 epochs
2023-09-02 20:42:16,210 - CV - INFO - Begin OT Train
2023-09-02 20:42:16,210 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:16,314 - FGO - INFO - Epoch   0 | Train Loss: -0.551 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:42:17,289 - FGO - INFO - Epoch  10 | Train Loss: -0.602 | Val Loss: 0.02 | Val F1: 0.98 |
2023-09-02 20:42:18,181 - FGO - INFO - Epoch  20 | Train Loss: -0.649 | Val Loss: 0.00 | Val F1: 0.98 |
2023-09-02 20:42:19,050 - FGO - INFO - Epoch  30 | Train Loss: -0.685 | Val Loss: -0.01 | Val F1: 0.97 |
2023-09-02 20:42:19,926 - FGO - INFO - Epoch  40 | Train Loss: -0.705 | Val Loss: -0.01 | Val F1: 0.98 |
2023-09-02 20:42:20,707 - FGO - INFO - Best Epoch:   8 | Train Loss: -0.589 | Val Loss: 0.03 | Val F1: 0.98 |
2023-09-02 20:42:20,707 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:20,710 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:42:20,710 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:20,741 - FGO - INFO - Train CM:
[[378   9]
 [ 17 313]]
2023-09-02 20:42:20,741 - FGO - INFO - Val CM:
[[46  1]
 [ 1 39]]
2023-09-02 20:42:20,742 - FGO - INFO - Test CM:
[[46  1]
 [ 1 39]]
2023-09-02 20:42:20,746 - FGO - INFO - test statistical parity: 0.33666666666666667
2023-09-02 20:42:20,748 - FGO - INFO - test equal opportunity: 0.032258064516129004
2023-09-02 20:42:20,749 - FGO - INFO - test micro f1: 0.9770114942528736
2023-09-02 20:42:20,749 - FGO - INFO - test macro f1: 0.9768617021276595
2023-09-02 20:42:20,749 - CV - INFO - fold time: 4.90435266494751s (0.08173921108245849m)
2023-09-02 20:42:20,749 - CV - INFO - ----- BEGINNING FOLD SET (001:8)----------------------------------------------------------
2023-09-02 20:42:20,751 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/001/8
2023-09-02 20:42:20,751 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:20,751 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:20,751 - FGO - INFO - 	done: False
2023-09-02 20:42:20,751 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:20,751 - FGO - INFO - 	h1: 64
2023-09-02 20:42:20,751 - FGO - INFO - 	h2: 32
2023-09-02 20:42:20,751 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:20,751 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:20,751 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:20,751 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:20,751 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:20,751 - FGO - INFO - 	theta: 10
2023-09-02 20:42:20,751 - FGO - INFO - 	clip: 5
2023-09-02 20:42:20,751 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:20,751 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:20,751 - FGO - INFO - Source Total: 734
2023-09-02 20:42:20,751 - FGO - INFO - Target Total: 70
2023-09-02 20:42:20,751 - FGO - INFO - Train Total: 734
2023-09-02 20:42:20,751 - FGO - INFO - Val Total:   70
2023-09-02 20:42:20,751 - FGO - INFO - Test Total:  70
2023-09-02 20:42:20,751 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:20,751 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:20,751 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:20,751 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:20,751 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:20,752 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:20,752 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:20,752 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:20,752 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:20,752 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:20,753 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:20,754 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:20,842 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:20,842 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:20,842 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:20,842 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:20,842 - FGO - INFO - N: 804
2023-09-02 20:42:20,842 - FGO - INFO - N_s: 734
2023-09-02 20:42:20,842 - FGO - INFO - N_t: 70
2023-09-02 20:42:20,846 - CV - INFO - Begin Pretrain
2023-09-02 20:42:20,846 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:20,849 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:42:20,874 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.69 | Val F1: 0.41 |
2023-09-02 20:42:20,899 - FGO - INFO - Epoch  20 | Train Loss: 0.645 | Val Loss: 0.66 | Val F1: 0.62 |
2023-09-02 20:42:20,924 - FGO - INFO - Epoch  30 | Train Loss: 0.588 | Val Loss: 0.61 | Val F1: 0.76 |
2023-09-02 20:42:20,949 - FGO - INFO - Epoch  40 | Train Loss: 0.498 | Val Loss: 0.53 | Val F1: 0.81 |
2023-09-02 20:42:20,973 - FGO - INFO - Epoch  50 | Train Loss: 0.392 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:42:20,998 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:42:21,022 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.27 | Val F1: 0.86 |
2023-09-02 20:42:21,047 - FGO - INFO - Epoch  80 | Train Loss: 0.181 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:42:21,072 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:42:21,096 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:42:21,096 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.157 | Val Loss: 0.19 | Val F1: 0.94 
2023-09-02 20:42:21,096 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:21,098 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:42:21,098 - CV - INFO - Begin OT Train
2023-09-02 20:42:21,098 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:21,199 - FGO - INFO - Epoch   0 | Train Loss: -0.541 | Val Loss: 0.10 | Val F1: 0.94 |
2023-09-02 20:42:22,047 - FGO - INFO - Epoch  10 | Train Loss: -0.606 | Val Loss: 0.12 | Val F1: 0.91 |
2023-09-02 20:42:22,876 - FGO - INFO - Epoch  20 | Train Loss: -0.649 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:42:23,718 - FGO - INFO - Epoch  30 | Train Loss: -0.684 | Val Loss: 0.11 | Val F1: 0.94 |
2023-09-02 20:42:24,532 - FGO - INFO - Epoch  40 | Train Loss: -0.707 | Val Loss: 0.11 | Val F1: 0.94 |
2023-09-02 20:42:25,343 - FGO - INFO - Best Epoch:   8 | Train Loss: -0.594 | Val Loss: 0.10 | Val F1: 0.94 |
2023-09-02 20:42:25,343 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:25,346 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:42:25,347 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:25,376 - FGO - INFO - Train CM:
[[391   9]
 [ 19 315]]
2023-09-02 20:42:25,376 - FGO - INFO - Val CM:
[[34  0]
 [ 4 32]]
2023-09-02 20:42:25,377 - FGO - INFO - Test CM:
[[34  0]
 [ 4 32]]
2023-09-02 20:42:25,381 - FGO - INFO - test statistical parity: 0.08906882591093113
2023-09-02 20:42:25,382 - FGO - INFO - test equal opportunity: 0.06666666666666665
2023-09-02 20:42:25,383 - FGO - INFO - test micro f1: 0.9428571428571428
2023-09-02 20:42:25,384 - FGO - INFO - test macro f1: 0.9428104575163399
2023-09-02 20:42:25,384 - CV - INFO - fold time: 4.6346657276153564s (0.07724442879358927m)
2023-09-02 20:42:25,384 - CV - INFO - ----- BEGINNING FOLD SET (001:9)----------------------------------------------------------
2023-09-02 20:42:25,385 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/001/9
2023-09-02 20:42:25,386 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:25,386 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:25,386 - FGO - INFO - 	done: False
2023-09-02 20:42:25,386 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:25,386 - FGO - INFO - 	h1: 64
2023-09-02 20:42:25,386 - FGO - INFO - 	h2: 32
2023-09-02 20:42:25,386 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:25,386 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:25,386 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:25,386 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:25,386 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:25,386 - FGO - INFO - 	theta: 10
2023-09-02 20:42:25,386 - FGO - INFO - 	clip: 5
2023-09-02 20:42:25,386 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:25,386 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:25,386 - FGO - INFO - Source Total: 725
2023-09-02 20:42:25,386 - FGO - INFO - Target Total: 79
2023-09-02 20:42:25,386 - FGO - INFO - Train Total: 725
2023-09-02 20:42:25,386 - FGO - INFO - Val Total:   79
2023-09-02 20:42:25,386 - FGO - INFO - Test Total:  79
2023-09-02 20:42:25,386 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:25,386 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:25,386 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:25,386 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:25,386 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:25,387 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:25,387 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:25,387 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:25,387 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:25,387 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:25,388 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:25,389 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:25,487 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:25,487 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:25,487 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:25,487 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:25,487 - FGO - INFO - N: 804
2023-09-02 20:42:25,487 - FGO - INFO - N_s: 725
2023-09-02 20:42:25,487 - FGO - INFO - N_t: 79
2023-09-02 20:42:25,491 - CV - INFO - Begin Pretrain
2023-09-02 20:42:25,491 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:25,494 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:42:25,518 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.50 |
2023-09-02 20:42:25,543 - FGO - INFO - Epoch  20 | Train Loss: 0.648 | Val Loss: 0.65 | Val F1: 0.59 |
2023-09-02 20:42:25,568 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.61 | Val F1: 0.69 |
2023-09-02 20:42:25,592 - FGO - INFO - Epoch  40 | Train Loss: 0.504 | Val Loss: 0.54 | Val F1: 0.78 |
2023-09-02 20:42:25,617 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:42:25,641 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.34 | Val F1: 0.90 |
2023-09-02 20:42:25,666 - FGO - INFO - Epoch  70 | Train Loss: 0.227 | Val Loss: 0.26 | Val F1: 0.92 |
2023-09-02 20:42:25,690 - FGO - INFO - Epoch  80 | Train Loss: 0.182 | Val Loss: 0.21 | Val F1: 0.96 |
2023-09-02 20:42:25,715 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:42:25,739 - FGO - INFO - Epoch 100 | Train Loss: 0.133 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:42:25,739 - FGO - INFO - Best Epoch:  85 | Train Loss: 0.165 | Val Loss: 0.19 | Val F1: 0.97 
2023-09-02 20:42:25,739 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:25,740 - CV - INFO - Pretrain Complete, 85 epochs
2023-09-02 20:42:25,740 - CV - INFO - Begin OT Train
2023-09-02 20:42:25,740 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:25,840 - FGO - INFO - Epoch   0 | Train Loss: -0.492 | Val Loss: 0.09 | Val F1: 0.96 |
2023-09-02 20:42:26,638 - FGO - INFO - Epoch  10 | Train Loss: -0.566 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:42:27,502 - FGO - INFO - Epoch  20 | Train Loss: -0.613 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 20:42:28,366 - FGO - INFO - Epoch  30 | Train Loss: -0.651 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:42:29,200 - FGO - INFO - Epoch  40 | Train Loss: -0.678 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:42:29,956 - FGO - INFO - Best Epoch:   9 | Train Loss: -0.562 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:42:29,956 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:29,959 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:42:29,960 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:29,989 - FGO - INFO - Train CM:
[[378   7]
 [ 18 322]]
2023-09-02 20:42:29,989 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:42:29,989 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:42:29,994 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:42:29,995 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:42:29,996 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:42:29,997 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:42:29,997 - CV - INFO - fold time: 4.612902879714966s (0.0768817146619161m)
2023-09-02 20:42:29,997 - CV - INFO - Mean Pretrain Epochs 85.8:
2023-09-02 20:42:29,997 - CV - INFO - Mean OT Train Epochs 12.3:
2023-09-02 20:42:29,997 - CV - INFO - Mean Val Macro F1 : 0.9536979932263066
2023-09-02 20:42:29,997 - CV - INFO - Mean Eval Stat : 0.9536979932263066 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:42:29,997 - CV - INFO - NEW BEST SET! (0.9536979932263066)
2023-09-02 20:42:29,997 - CV - INFO - set time: 47.945855379104614s (0.7990975896517436m)
2023-09-02 20:42:29,997 - CV - INFO - script time so far: 47.9478919506073s (0.7991315325101217m) (0.013318858875168696h)
2023-09-02 20:42:29,997 - CV - INFO - ===== BEGINNING OPTION SET (002)==========================================================
2023-09-02 20:42:29,997 - CV - INFO - 	done: False
2023-09-02 20:42:29,997 - CV - INFO - 	learning_rate: 0.001
2023-09-02 20:42:29,997 - CV - INFO - 	h1: 64
2023-09-02 20:42:29,997 - CV - INFO - 	h2: 32
2023-09-02 20:42:29,997 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:29,997 - CV - INFO - 	dropout: 0.0
2023-09-02 20:42:29,997 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:29,997 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:29,997 - CV - INFO - 	lambda: 0.01
2023-09-02 20:42:29,997 - CV - INFO - 	theta: 30
2023-09-02 20:42:29,997 - CV - INFO - 	clip: 5
2023-09-02 20:42:29,997 - CV - INFO - ----- BEGINNING FOLD SET (002:0)----------------------------------------------------------
2023-09-02 20:42:29,999 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/002/0
2023-09-02 20:42:29,999 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:29,999 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:29,999 - FGO - INFO - 	done: False
2023-09-02 20:42:29,999 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:29,999 - FGO - INFO - 	h1: 64
2023-09-02 20:42:29,999 - FGO - INFO - 	h2: 32
2023-09-02 20:42:29,999 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:29,999 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:29,999 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:29,999 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:29,999 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:29,999 - FGO - INFO - 	theta: 30
2023-09-02 20:42:29,999 - FGO - INFO - 	clip: 5
2023-09-02 20:42:29,999 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:29,999 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:29,999 - FGO - INFO - Source Total: 708
2023-09-02 20:42:29,999 - FGO - INFO - Target Total: 96
2023-09-02 20:42:29,999 - FGO - INFO - Train Total: 708
2023-09-02 20:42:29,999 - FGO - INFO - Val Total:   96
2023-09-02 20:42:29,999 - FGO - INFO - Test Total:  96
2023-09-02 20:42:29,999 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:29,999 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:29,999 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:29,999 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:29,999 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:30,000 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:30,000 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:30,000 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:30,000 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:30,000 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:30,001 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:30,002 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:30,117 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:30,117 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:30,117 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:30,117 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:30,117 - FGO - INFO - N: 804
2023-09-02 20:42:30,117 - FGO - INFO - N_s: 708
2023-09-02 20:42:30,117 - FGO - INFO - N_t: 96
2023-09-02 20:42:30,120 - CV - INFO - Begin Pretrain
2023-09-02 20:42:30,120 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:30,123 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:42:30,148 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:42:30,172 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.53 |
2023-09-02 20:42:30,196 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.61 | Val F1: 0.67 |
2023-09-02 20:42:30,221 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.52 | Val F1: 0.86 |
2023-09-02 20:42:30,245 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.41 | Val F1: 0.89 |
2023-09-02 20:42:30,269 - FGO - INFO - Epoch  60 | Train Loss: 0.298 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:42:30,293 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:42:30,318 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:42:30,342 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:42:30,366 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:42:30,366 - FGO - INFO - Best Epoch:  86 | Train Loss: 0.161 | Val Loss: 0.18 | Val F1: 0.95 
2023-09-02 20:42:30,366 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:30,368 - CV - INFO - Pretrain Complete, 86 epochs
2023-09-02 20:42:30,368 - CV - INFO - Begin OT Train
2023-09-02 20:42:30,368 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:30,460 - FGO - INFO - Epoch   0 | Train Loss: -1.958 | Val Loss: -0.15 | Val F1: 0.95 |
2023-09-02 20:42:31,381 - FGO - INFO - Epoch  10 | Train Loss: -2.141 | Val Loss: -0.20 | Val F1: 0.97 |
2023-09-02 20:42:32,218 - FGO - INFO - Epoch  20 | Train Loss: -2.286 | Val Loss: -0.21 | Val F1: 0.98 |
2023-09-02 20:42:33,048 - FGO - INFO - Epoch  30 | Train Loss: -2.363 | Val Loss: -0.21 | Val F1: 0.98 |
2023-09-02 20:42:33,871 - FGO - INFO - Epoch  40 | Train Loss: -2.400 | Val Loss: -0.21 | Val F1: 0.96 |
2023-09-02 20:42:34,591 - FGO - INFO - Best Epoch:  12 | Train Loss: -2.172 | Val Loss: -0.20 | Val F1: 0.98 |
2023-09-02 20:42:34,591 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:34,594 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:42:34,594 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:34,624 - FGO - INFO - Train CM:
[[379   3]
 [ 24 302]]
2023-09-02 20:42:34,624 - FGO - INFO - Val CM:
[[52  0]
 [ 3 41]]
2023-09-02 20:42:34,624 - FGO - INFO - Test CM:
[[52  0]
 [ 3 41]]
2023-09-02 20:42:34,630 - FGO - INFO - test statistical parity: 0.3390374331550802
2023-09-02 20:42:34,631 - FGO - INFO - test equal opportunity: 0.08333333333333337
2023-09-02 20:42:34,632 - FGO - INFO - test micro f1: 0.96875
2023-09-02 20:42:34,632 - FGO - INFO - test macro f1: 0.9683342495876855
2023-09-02 20:42:34,632 - CV - INFO - fold time: 4.63526725769043s (0.0772544542948405m)
2023-09-02 20:42:34,632 - CV - INFO - ----- BEGINNING FOLD SET (002:1)----------------------------------------------------------
2023-09-02 20:42:34,634 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/002/1
2023-09-02 20:42:34,634 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:34,634 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:34,634 - FGO - INFO - 	done: False
2023-09-02 20:42:34,634 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:34,634 - FGO - INFO - 	h1: 64
2023-09-02 20:42:34,634 - FGO - INFO - 	h2: 32
2023-09-02 20:42:34,634 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:34,634 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:34,634 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:34,634 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:34,634 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:34,634 - FGO - INFO - 	theta: 30
2023-09-02 20:42:34,634 - FGO - INFO - 	clip: 5
2023-09-02 20:42:34,634 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:34,634 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:34,634 - FGO - INFO - Source Total: 727
2023-09-02 20:42:34,634 - FGO - INFO - Target Total: 77
2023-09-02 20:42:34,634 - FGO - INFO - Train Total: 727
2023-09-02 20:42:34,634 - FGO - INFO - Val Total:   77
2023-09-02 20:42:34,634 - FGO - INFO - Test Total:  77
2023-09-02 20:42:34,634 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:34,634 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:34,634 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:34,634 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:34,634 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:34,635 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:34,635 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:34,635 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:34,635 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:34,635 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:34,636 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:34,637 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:34,732 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:34,732 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:34,733 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:34,733 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:34,733 - FGO - INFO - N: 804
2023-09-02 20:42:34,733 - FGO - INFO - N_s: 727
2023-09-02 20:42:34,733 - FGO - INFO - N_t: 77
2023-09-02 20:42:34,736 - CV - INFO - Begin Pretrain
2023-09-02 20:42:34,736 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:34,739 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:42:34,764 - FGO - INFO - Epoch  10 | Train Loss: 0.673 | Val Loss: 0.68 | Val F1: 0.51 |
2023-09-02 20:42:34,789 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.55 |
2023-09-02 20:42:34,814 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:42:34,839 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.55 | Val F1: 0.73 |
2023-09-02 20:42:34,863 - FGO - INFO - Epoch  50 | Train Loss: 0.396 | Val Loss: 0.47 | Val F1: 0.73 |
2023-09-02 20:42:34,888 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.40 | Val F1: 0.81 |
2023-09-02 20:42:34,913 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.34 | Val F1: 0.80 |
2023-09-02 20:42:34,937 - FGO - INFO - Epoch  80 | Train Loss: 0.172 | Val Loss: 0.29 | Val F1: 0.84 |
2023-09-02 20:42:34,962 - FGO - INFO - Epoch  90 | Train Loss: 0.142 | Val Loss: 0.26 | Val F1: 0.87 |
2023-09-02 20:42:34,987 - FGO - INFO - Epoch 100 | Train Loss: 0.122 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:42:34,987 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.147 | Val Loss: 0.27 | Val F1: 0.87 
2023-09-02 20:42:34,987 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:34,988 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:42:34,988 - CV - INFO - Begin OT Train
2023-09-02 20:42:34,988 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:35,059 - FGO - INFO - Epoch   0 | Train Loss: -1.835 | Val Loss: 0.04 | Val F1: 0.87 |
2023-09-02 20:42:36,039 - FGO - INFO - Epoch  10 | Train Loss: -2.062 | Val Loss: -0.00 | Val F1: 0.91 |
2023-09-02 20:42:36,905 - FGO - INFO - Epoch  20 | Train Loss: -2.222 | Val Loss: -0.01 | Val F1: 0.89 |
2023-09-02 20:42:37,656 - FGO - INFO - Epoch  30 | Train Loss: -2.333 | Val Loss: 0.00 | Val F1: 0.89 |
2023-09-02 20:42:38,449 - FGO - INFO - Epoch  40 | Train Loss: -2.386 | Val Loss: 0.01 | Val F1: 0.89 |
2023-09-02 20:42:39,206 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.003 | Val Loss: 0.00 | Val F1: 0.92 |
2023-09-02 20:42:39,206 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:39,209 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:42:39,209 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:39,234 - FGO - INFO - Train CM:
[[372  18]
 [ 21 316]]
2023-09-02 20:42:39,234 - FGO - INFO - Val CM:
[[40  4]
 [ 4 29]]
2023-09-02 20:42:39,235 - FGO - INFO - Test CM:
[[40  4]
 [ 4 29]]
2023-09-02 20:42:39,239 - FGO - INFO - test statistical parity: 0.31025641025641026
2023-09-02 20:42:39,240 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:42:39,241 - FGO - INFO - test micro f1: 0.8961038961038962
2023-09-02 20:42:39,242 - FGO - INFO - test macro f1: 0.8939393939393939
2023-09-02 20:42:39,242 - CV - INFO - fold time: 4.609532356262207s (0.07682553927103679m)
2023-09-02 20:42:39,242 - CV - INFO - ----- BEGINNING FOLD SET (002:2)----------------------------------------------------------
2023-09-02 20:42:39,243 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/002/2
2023-09-02 20:42:39,244 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:39,244 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:39,244 - FGO - INFO - 	done: False
2023-09-02 20:42:39,244 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:39,244 - FGO - INFO - 	h1: 64
2023-09-02 20:42:39,244 - FGO - INFO - 	h2: 32
2023-09-02 20:42:39,244 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:39,244 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:39,244 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:39,244 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:39,244 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:39,244 - FGO - INFO - 	theta: 30
2023-09-02 20:42:39,244 - FGO - INFO - 	clip: 5
2023-09-02 20:42:39,244 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:39,244 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:39,244 - FGO - INFO - Source Total: 721
2023-09-02 20:42:39,244 - FGO - INFO - Target Total: 83
2023-09-02 20:42:39,244 - FGO - INFO - Train Total: 721
2023-09-02 20:42:39,244 - FGO - INFO - Val Total:   83
2023-09-02 20:42:39,244 - FGO - INFO - Test Total:  83
2023-09-02 20:42:39,244 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:39,244 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:39,244 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:39,244 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:39,244 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:39,244 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:39,244 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:39,245 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:39,245 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:39,245 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:39,245 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:39,247 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:39,348 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:39,348 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:39,348 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:39,348 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:39,348 - FGO - INFO - N: 804
2023-09-02 20:42:39,348 - FGO - INFO - N_s: 721
2023-09-02 20:42:39,348 - FGO - INFO - N_t: 83
2023-09-02 20:42:39,352 - CV - INFO - Begin Pretrain
2023-09-02 20:42:39,352 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:39,355 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:42:39,380 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.57 |
2023-09-02 20:42:39,405 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.64 | Val F1: 0.66 |
2023-09-02 20:42:39,429 - FGO - INFO - Epoch  30 | Train Loss: 0.594 | Val Loss: 0.60 | Val F1: 0.76 |
2023-09-02 20:42:39,453 - FGO - INFO - Epoch  40 | Train Loss: 0.506 | Val Loss: 0.52 | Val F1: 0.83 |
2023-09-02 20:42:39,478 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:42:39,502 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.34 | Val F1: 0.85 |
2023-09-02 20:42:39,527 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:42:39,551 - FGO - INFO - Epoch  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:42:39,575 - FGO - INFO - Epoch  90 | Train Loss: 0.140 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:42:39,600 - FGO - INFO - Epoch 100 | Train Loss: 0.119 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:42:39,600 - FGO - INFO - Best Epoch:  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 
2023-09-02 20:42:39,600 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:39,601 - CV - INFO - Pretrain Complete, 80 epochs
2023-09-02 20:42:39,601 - CV - INFO - Begin OT Train
2023-09-02 20:42:39,601 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:39,692 - FGO - INFO - Epoch   0 | Train Loss: -1.923 | Val Loss: 0.01 | Val F1: 0.87 |
2023-09-02 20:42:40,615 - FGO - INFO - Epoch  10 | Train Loss: -2.124 | Val Loss: 0.02 | Val F1: 0.91 |
2023-09-02 20:42:41,521 - FGO - INFO - Epoch  20 | Train Loss: -2.275 | Val Loss: 0.01 | Val F1: 0.91 |
2023-09-02 20:42:42,423 - FGO - INFO - Epoch  30 | Train Loss: -2.378 | Val Loss: 0.01 | Val F1: 0.90 |
2023-09-02 20:42:43,222 - FGO - INFO - Epoch  40 | Train Loss: -2.427 | Val Loss: 0.00 | Val F1: 0.90 |
2023-09-02 20:42:43,948 - FGO - INFO - Best Epoch:   8 | Train Loss: -2.094 | Val Loss: 0.03 | Val F1: 0.91 |
2023-09-02 20:42:43,948 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:43,952 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:42:43,952 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:43,978 - FGO - INFO - Train CM:
[[379   5]
 [ 24 313]]
2023-09-02 20:42:43,978 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:42:43,979 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:42:43,983 - FGO - INFO - test statistical parity: 0.11971830985915494
2023-09-02 20:42:43,985 - FGO - INFO - test equal opportunity: 0.05555555555555547
2023-09-02 20:42:43,986 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:42:43,986 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:42:43,986 - CV - INFO - fold time: 4.744318962097168s (0.07907198270161947m)
2023-09-02 20:42:43,986 - CV - INFO - ----- BEGINNING FOLD SET (002:3)----------------------------------------------------------
2023-09-02 20:42:43,988 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/002/3
2023-09-02 20:42:43,988 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:43,988 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:43,988 - FGO - INFO - 	done: False
2023-09-02 20:42:43,988 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:43,988 - FGO - INFO - 	h1: 64
2023-09-02 20:42:43,988 - FGO - INFO - 	h2: 32
2023-09-02 20:42:43,988 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:43,988 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:43,988 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:43,988 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:43,988 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:43,988 - FGO - INFO - 	theta: 30
2023-09-02 20:42:43,988 - FGO - INFO - 	clip: 5
2023-09-02 20:42:43,988 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:43,988 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:43,988 - FGO - INFO - Source Total: 729
2023-09-02 20:42:43,988 - FGO - INFO - Target Total: 75
2023-09-02 20:42:43,988 - FGO - INFO - Train Total: 729
2023-09-02 20:42:43,988 - FGO - INFO - Val Total:   75
2023-09-02 20:42:43,988 - FGO - INFO - Test Total:  75
2023-09-02 20:42:43,988 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:43,988 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:43,988 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:43,988 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:43,988 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:43,989 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:43,989 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:43,989 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:43,989 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:43,989 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:43,990 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:43,991 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:44,084 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:44,084 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:44,084 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:44,084 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:44,084 - FGO - INFO - N: 804
2023-09-02 20:42:44,085 - FGO - INFO - N_s: 729
2023-09-02 20:42:44,085 - FGO - INFO - N_t: 75
2023-09-02 20:42:44,088 - CV - INFO - Begin Pretrain
2023-09-02 20:42:44,088 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:44,091 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:42:44,116 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.67 | Val F1: 0.39 |
2023-09-02 20:42:44,140 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.64 |
2023-09-02 20:42:44,165 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.57 | Val F1: 0.86 |
2023-09-02 20:42:44,190 - FGO - INFO - Epoch  40 | Train Loss: 0.510 | Val Loss: 0.47 | Val F1: 0.92 |
2023-09-02 20:42:44,214 - FGO - INFO - Epoch  50 | Train Loss: 0.406 | Val Loss: 0.34 | Val F1: 0.93 |
2023-09-02 20:42:44,239 - FGO - INFO - Epoch  60 | Train Loss: 0.305 | Val Loss: 0.23 | Val F1: 0.97 |
2023-09-02 20:42:44,263 - FGO - INFO - Epoch  70 | Train Loss: 0.231 | Val Loss: 0.16 | Val F1: 0.99 |
2023-09-02 20:42:44,288 - FGO - INFO - Epoch  80 | Train Loss: 0.186 | Val Loss: 0.12 | Val F1: 0.99 |
2023-09-02 20:42:44,312 - FGO - INFO - Epoch  90 | Train Loss: 0.156 | Val Loss: 0.10 | Val F1: 0.99 |
2023-09-02 20:42:44,337 - FGO - INFO - Epoch 100 | Train Loss: 0.135 | Val Loss: 0.09 | Val F1: 0.97 |
2023-09-02 20:42:44,337 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.161 | Val Loss: 0.10 | Val F1: 0.99 
2023-09-02 20:42:44,337 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:44,338 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:42:44,338 - CV - INFO - Begin OT Train
2023-09-02 20:42:44,338 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:44,409 - FGO - INFO - Epoch   0 | Train Loss: -1.891 | Val Loss: -0.13 | Val F1: 0.99 |
2023-09-02 20:42:45,401 - FGO - INFO - Epoch  10 | Train Loss: -2.113 | Val Loss: -0.16 | Val F1: 0.99 |
2023-09-02 20:42:46,207 - FGO - INFO - Epoch  20 | Train Loss: -2.268 | Val Loss: -0.16 | Val F1: 0.99 |
2023-09-02 20:42:47,024 - FGO - INFO - Epoch  30 | Train Loss: -2.371 | Val Loss: -0.17 | Val F1: 0.99 |
2023-09-02 20:42:47,817 - FGO - INFO - Epoch  40 | Train Loss: -2.416 | Val Loss: -0.17 | Val F1: 0.99 |
2023-09-02 20:42:48,539 - FGO - INFO - Best Epoch:   7 | Train Loss: -2.069 | Val Loss: -0.14 | Val F1: 0.99 |
2023-09-02 20:42:48,539 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:48,542 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:42:48,543 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:48,568 - FGO - INFO - Train CM:
[[392   4]
 [ 28 305]]
2023-09-02 20:42:48,569 - FGO - INFO - Val CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:42:48,569 - FGO - INFO - Test CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:42:48,574 - FGO - INFO - test statistical parity: 0.024590163934426257
2023-09-02 20:42:48,575 - FGO - INFO - test equal opportunity: 0.033333333333333326
2023-09-02 20:42:48,576 - FGO - INFO - test micro f1: 0.9866666666666668
2023-09-02 20:42:48,577 - FGO - INFO - test macro f1: 0.9866571784380003
2023-09-02 20:42:48,577 - CV - INFO - fold time: 4.590614557266235s (0.07651024262110392m)
2023-09-02 20:42:48,577 - CV - INFO - ----- BEGINNING FOLD SET (002:4)----------------------------------------------------------
2023-09-02 20:42:48,578 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/002/4
2023-09-02 20:42:48,579 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:48,579 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:48,579 - FGO - INFO - 	done: False
2023-09-02 20:42:48,579 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:48,579 - FGO - INFO - 	h1: 64
2023-09-02 20:42:48,579 - FGO - INFO - 	h2: 32
2023-09-02 20:42:48,579 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:48,579 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:48,579 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:48,579 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:48,579 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:48,579 - FGO - INFO - 	theta: 30
2023-09-02 20:42:48,579 - FGO - INFO - 	clip: 5
2023-09-02 20:42:48,579 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:48,579 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:48,579 - FGO - INFO - Source Total: 732
2023-09-02 20:42:48,579 - FGO - INFO - Target Total: 72
2023-09-02 20:42:48,579 - FGO - INFO - Train Total: 732
2023-09-02 20:42:48,579 - FGO - INFO - Val Total:   72
2023-09-02 20:42:48,579 - FGO - INFO - Test Total:  72
2023-09-02 20:42:48,579 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:48,579 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:48,579 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:48,579 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:48,579 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:48,579 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:48,579 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:48,579 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:48,580 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:48,580 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:48,580 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:48,582 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:48,672 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:48,672 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:48,672 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:48,672 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:48,672 - FGO - INFO - N: 804
2023-09-02 20:42:48,672 - FGO - INFO - N_s: 732
2023-09-02 20:42:48,672 - FGO - INFO - N_t: 72
2023-09-02 20:42:48,676 - CV - INFO - Begin Pretrain
2023-09-02 20:42:48,676 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:48,679 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:42:48,704 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.68 | Val F1: 0.45 |
2023-09-02 20:42:48,728 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.66 | Val F1: 0.63 |
2023-09-02 20:42:48,753 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.60 | Val F1: 0.75 |
2023-09-02 20:42:48,778 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.50 | Val F1: 0.87 |
2023-09-02 20:42:48,802 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.39 | Val F1: 0.89 |
2023-09-02 20:42:48,827 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:42:48,851 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:42:48,876 - FGO - INFO - Epoch  80 | Train Loss: 0.179 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:42:48,900 - FGO - INFO - Epoch  90 | Train Loss: 0.150 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:42:48,925 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:42:48,925 - FGO - INFO - Best Epoch:  81 | Train Loss: 0.175 | Val Loss: 0.16 | Val F1: 0.97 
2023-09-02 20:42:48,925 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:48,926 - CV - INFO - Pretrain Complete, 81 epochs
2023-09-02 20:42:48,926 - CV - INFO - Begin OT Train
2023-09-02 20:42:48,926 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:49,028 - FGO - INFO - Epoch   0 | Train Loss: -2.015 | Val Loss: -0.09 | Val F1: 0.97 |
2023-09-02 20:42:49,854 - FGO - INFO - Epoch  10 | Train Loss: -2.234 | Val Loss: -0.11 | Val F1: 0.97 |
2023-09-02 20:42:50,655 - FGO - INFO - Epoch  20 | Train Loss: -2.391 | Val Loss: -0.12 | Val F1: 0.97 |
2023-09-02 20:42:51,479 - FGO - INFO - Epoch  30 | Train Loss: -2.453 | Val Loss: -0.12 | Val F1: 0.96 |
2023-09-02 20:42:52,308 - FGO - INFO - Epoch  40 | Train Loss: -2.488 | Val Loss: -0.12 | Val F1: 0.97 |
2023-09-02 20:42:52,992 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.152 | Val Loss: -0.10 | Val F1: 0.97 |
2023-09-02 20:42:52,992 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:52,995 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:42:52,995 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:53,030 - FGO - INFO - Train CM:
[[388   9]
 [ 17 318]]
2023-09-02 20:42:53,031 - FGO - INFO - Val CM:
[[37  0]
 [ 2 33]]
2023-09-02 20:42:53,031 - FGO - INFO - Test CM:
[[37  0]
 [ 2 33]]
2023-09-02 20:42:53,038 - FGO - INFO - test statistical parity: 0.06774193548387092
2023-09-02 20:42:53,039 - FGO - INFO - test equal opportunity: 0.16666666666666663
2023-09-02 20:42:53,040 - FGO - INFO - test micro f1: 0.9722222222222222
2023-09-02 20:42:53,040 - FGO - INFO - test macro f1: 0.9721362229102167
2023-09-02 20:42:53,040 - CV - INFO - fold time: 4.4634850025177s (0.07439141670862834m)
2023-09-02 20:42:53,040 - CV - INFO - ----- BEGINNING FOLD SET (002:5)----------------------------------------------------------
2023-09-02 20:42:53,042 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/002/5
2023-09-02 20:42:53,042 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:53,042 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:53,042 - FGO - INFO - 	done: False
2023-09-02 20:42:53,042 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:53,042 - FGO - INFO - 	h1: 64
2023-09-02 20:42:53,042 - FGO - INFO - 	h2: 32
2023-09-02 20:42:53,042 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:53,042 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:53,042 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:53,042 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:53,042 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:53,042 - FGO - INFO - 	theta: 30
2023-09-02 20:42:53,042 - FGO - INFO - 	clip: 5
2023-09-02 20:42:53,042 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:53,042 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:53,042 - FGO - INFO - Source Total: 726
2023-09-02 20:42:53,042 - FGO - INFO - Target Total: 78
2023-09-02 20:42:53,042 - FGO - INFO - Train Total: 726
2023-09-02 20:42:53,042 - FGO - INFO - Val Total:   78
2023-09-02 20:42:53,042 - FGO - INFO - Test Total:  78
2023-09-02 20:42:53,042 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:53,042 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:53,042 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:53,042 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:53,042 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:53,043 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:53,043 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:53,043 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:53,043 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:53,043 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:53,044 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:53,045 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:53,142 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:53,142 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:53,142 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:53,142 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:53,142 - FGO - INFO - N: 804
2023-09-02 20:42:53,142 - FGO - INFO - N_s: 726
2023-09-02 20:42:53,142 - FGO - INFO - N_t: 78
2023-09-02 20:42:53,146 - CV - INFO - Begin Pretrain
2023-09-02 20:42:53,146 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:53,149 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:42:53,174 - FGO - INFO - Epoch  10 | Train Loss: 0.669 | Val Loss: 0.72 | Val F1: 0.34 |
2023-09-02 20:42:53,198 - FGO - INFO - Epoch  20 | Train Loss: 0.644 | Val Loss: 0.69 | Val F1: 0.42 |
2023-09-02 20:42:53,223 - FGO - INFO - Epoch  30 | Train Loss: 0.591 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:42:53,247 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.53 | Val F1: 0.83 |
2023-09-02 20:42:53,272 - FGO - INFO - Epoch  50 | Train Loss: 0.397 | Val Loss: 0.41 | Val F1: 0.85 |
2023-09-02 20:42:53,296 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:42:53,320 - FGO - INFO - Epoch  70 | Train Loss: 0.220 | Val Loss: 0.27 | Val F1: 0.88 |
2023-09-02 20:42:53,345 - FGO - INFO - Epoch  80 | Train Loss: 0.175 | Val Loss: 0.25 | Val F1: 0.88 |
2023-09-02 20:42:53,369 - FGO - INFO - Epoch  90 | Train Loss: 0.148 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:42:53,393 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:42:53,393 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.209 | Val Loss: 0.26 | Val F1: 0.91 
2023-09-02 20:42:53,393 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:53,395 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:42:53,395 - CV - INFO - Begin OT Train
2023-09-02 20:42:53,395 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:53,496 - FGO - INFO - Epoch   0 | Train Loss: -1.942 | Val Loss: -0.01 | Val F1: 0.91 |
2023-09-02 20:42:54,372 - FGO - INFO - Epoch  10 | Train Loss: -2.141 | Val Loss: 0.02 | Val F1: 0.88 |
2023-09-02 20:42:55,256 - FGO - INFO - Epoch  20 | Train Loss: -2.301 | Val Loss: 0.03 | Val F1: 0.87 |
2023-09-02 20:42:56,100 - FGO - INFO - Epoch  30 | Train Loss: -2.385 | Val Loss: 0.04 | Val F1: 0.87 |
2023-09-02 20:42:56,946 - FGO - INFO - Epoch  40 | Train Loss: -2.424 | Val Loss: 0.05 | Val F1: 0.87 |
2023-09-02 20:42:57,664 - FGO - INFO - Best Epoch:   8 | Train Loss: -2.108 | Val Loss: 0.02 | Val F1: 0.91 |
2023-09-02 20:42:57,664 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:57,667 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:42:57,667 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:42:57,695 - FGO - INFO - Train CM:
[[394   6]
 [ 24 302]]
2023-09-02 20:42:57,695 - FGO - INFO - Val CM:
[[34  0]
 [ 9 35]]
2023-09-02 20:42:57,696 - FGO - INFO - Test CM:
[[34  0]
 [ 9 35]]
2023-09-02 20:42:57,701 - FGO - INFO - test statistical parity: 0.004830917874396157
2023-09-02 20:42:57,702 - FGO - INFO - test equal opportunity: 0.005128205128205221
2023-09-02 20:42:57,703 - FGO - INFO - test micro f1: 0.8846153846153846
2023-09-02 20:42:57,704 - FGO - INFO - test macro f1: 0.8845964162419858
2023-09-02 20:42:57,704 - CV - INFO - fold time: 4.663261890411377s (0.07772103150685629m)
2023-09-02 20:42:57,704 - CV - INFO - ----- BEGINNING FOLD SET (002:6)----------------------------------------------------------
2023-09-02 20:42:57,705 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/002/6
2023-09-02 20:42:57,705 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:42:57,705 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:42:57,705 - FGO - INFO - 	done: False
2023-09-02 20:42:57,705 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:42:57,705 - FGO - INFO - 	h1: 64
2023-09-02 20:42:57,705 - FGO - INFO - 	h2: 32
2023-09-02 20:42:57,705 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:42:57,705 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:42:57,705 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:42:57,706 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:42:57,706 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:42:57,706 - FGO - INFO - 	theta: 30
2023-09-02 20:42:57,706 - FGO - INFO - 	clip: 5
2023-09-02 20:42:57,706 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:42:57,706 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:42:57,706 - FGO - INFO - Source Total: 717
2023-09-02 20:42:57,706 - FGO - INFO - Target Total: 87
2023-09-02 20:42:57,706 - FGO - INFO - Train Total: 717
2023-09-02 20:42:57,706 - FGO - INFO - Val Total:   87
2023-09-02 20:42:57,706 - FGO - INFO - Test Total:  87
2023-09-02 20:42:57,706 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:42:57,706 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:42:57,706 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:42:57,706 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:42:57,706 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:42:57,706 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:42:57,706 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:42:57,706 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:42:57,706 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:42:57,706 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:42:57,707 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:42:57,709 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:42:57,815 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:42:57,815 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:42:57,815 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:42:57,815 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:42:57,815 - FGO - INFO - N: 804
2023-09-02 20:42:57,815 - FGO - INFO - N_s: 717
2023-09-02 20:42:57,815 - FGO - INFO - N_t: 87
2023-09-02 20:42:57,819 - CV - INFO - Begin Pretrain
2023-09-02 20:42:57,819 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:42:57,822 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:42:57,846 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.47 |
2023-09-02 20:42:57,871 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.63 |
2023-09-02 20:42:57,895 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.78 |
2023-09-02 20:42:57,920 - FGO - INFO - Epoch  40 | Train Loss: 0.509 | Val Loss: 0.50 | Val F1: 0.84 |
2023-09-02 20:42:57,944 - FGO - INFO - Epoch  50 | Train Loss: 0.402 | Val Loss: 0.40 | Val F1: 0.86 |
2023-09-02 20:42:57,968 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.31 | Val F1: 0.92 |
2023-09-02 20:42:57,993 - FGO - INFO - Epoch  70 | Train Loss: 0.228 | Val Loss: 0.23 | Val F1: 0.92 |
2023-09-02 20:42:58,017 - FGO - INFO - Epoch  80 | Train Loss: 0.184 | Val Loss: 0.19 | Val F1: 0.93 |
2023-09-02 20:42:58,041 - FGO - INFO - Epoch  90 | Train Loss: 0.154 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:42:58,066 - FGO - INFO - Epoch 100 | Train Loss: 0.134 | Val Loss: 0.14 | Val F1: 0.95 |
2023-09-02 20:42:58,066 - FGO - INFO - Best Epoch:  99 | Train Loss: 0.135 | Val Loss: 0.14 | Val F1: 0.95 
2023-09-02 20:42:58,066 - FGO - INFO - Setting model to best state.
2023-09-02 20:42:58,067 - CV - INFO - Pretrain Complete, 99 epochs
2023-09-02 20:42:58,067 - CV - INFO - Begin OT Train
2023-09-02 20:42:58,067 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:42:58,165 - FGO - INFO - Epoch   0 | Train Loss: -1.985 | Val Loss: -0.13 | Val F1: 0.95 |
2023-09-02 20:42:58,958 - FGO - INFO - Epoch  10 | Train Loss: -2.183 | Val Loss: -0.16 | Val F1: 0.95 |
2023-09-02 20:42:59,781 - FGO - INFO - Epoch  20 | Train Loss: -2.327 | Val Loss: -0.18 | Val F1: 0.95 |
2023-09-02 20:43:00,590 - FGO - INFO - Epoch  30 | Train Loss: -2.395 | Val Loss: -0.19 | Val F1: 0.95 |
2023-09-02 20:43:01,375 - FGO - INFO - Epoch  40 | Train Loss: -2.434 | Val Loss: -0.21 | Val F1: 0.98 |
2023-09-02 20:43:02,190 - FGO - INFO - Best Epoch:  41 | Train Loss: -2.437 | Val Loss: -0.22 | Val F1: 0.99 |
2023-09-02 20:43:02,190 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:02,193 - CV - INFO - OT Train Complete, 41 epochs
2023-09-02 20:43:02,193 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:02,222 - FGO - INFO - Train CM:
[[378   7]
 [ 23 309]]
2023-09-02 20:43:02,222 - FGO - INFO - Val CM:
[[47  2]
 [ 0 38]]
2023-09-02 20:43:02,222 - FGO - INFO - Test CM:
[[47  2]
 [ 0 38]]
2023-09-02 20:43:02,228 - FGO - INFO - test statistical parity: 0.044303797468354444
2023-09-02 20:43:02,229 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:43:02,230 - FGO - INFO - test micro f1: 0.9770114942528736
2023-09-02 20:43:02,230 - FGO - INFO - test macro f1: 0.9767628205128205
2023-09-02 20:43:02,230 - CV - INFO - fold time: 4.526620388031006s (0.0754436731338501m)
2023-09-02 20:43:02,230 - CV - INFO - ----- BEGINNING FOLD SET (002:7)----------------------------------------------------------
2023-09-02 20:43:02,232 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/002/7
2023-09-02 20:43:02,232 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:02,232 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:02,232 - FGO - INFO - 	done: False
2023-09-02 20:43:02,232 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:02,232 - FGO - INFO - 	h1: 64
2023-09-02 20:43:02,232 - FGO - INFO - 	h2: 32
2023-09-02 20:43:02,232 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:02,232 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:02,232 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:02,232 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:02,232 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:02,232 - FGO - INFO - 	theta: 30
2023-09-02 20:43:02,232 - FGO - INFO - 	clip: 5
2023-09-02 20:43:02,232 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:02,232 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:02,232 - FGO - INFO - Source Total: 717
2023-09-02 20:43:02,232 - FGO - INFO - Target Total: 87
2023-09-02 20:43:02,232 - FGO - INFO - Train Total: 717
2023-09-02 20:43:02,232 - FGO - INFO - Val Total:   87
2023-09-02 20:43:02,232 - FGO - INFO - Test Total:  87
2023-09-02 20:43:02,232 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:02,232 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:02,232 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:02,232 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:02,232 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:02,233 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:02,233 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:02,233 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:02,233 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:02,233 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:02,234 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:02,235 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:02,342 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:02,342 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:02,342 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:02,342 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:02,342 - FGO - INFO - N: 804
2023-09-02 20:43:02,342 - FGO - INFO - N_s: 717
2023-09-02 20:43:02,342 - FGO - INFO - N_t: 87
2023-09-02 20:43:02,345 - CV - INFO - Begin Pretrain
2023-09-02 20:43:02,345 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:02,348 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:43:02,373 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.40 |
2023-09-02 20:43:02,398 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.62 |
2023-09-02 20:43:02,423 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.77 |
2023-09-02 20:43:02,447 - FGO - INFO - Epoch  40 | Train Loss: 0.507 | Val Loss: 0.52 | Val F1: 0.88 |
2023-09-02 20:43:02,472 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.41 | Val F1: 0.88 |
2023-09-02 20:43:02,496 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:43:02,521 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.23 | Val F1: 0.94 |
2023-09-02 20:43:02,545 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:43:02,570 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:43:02,594 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:43:02,594 - FGO - INFO - Best Epoch:  91 | Train Loss: 0.149 | Val Loss: 0.15 | Val F1: 0.97 
2023-09-02 20:43:02,594 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:02,596 - CV - INFO - Pretrain Complete, 91 epochs
2023-09-02 20:43:02,596 - CV - INFO - Begin OT Train
2023-09-02 20:43:02,596 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:02,669 - FGO - INFO - Epoch   0 | Train Loss: -1.987 | Val Loss: -0.13 | Val F1: 0.97 |
2023-09-02 20:43:03,557 - FGO - INFO - Epoch  10 | Train Loss: -2.191 | Val Loss: -0.17 | Val F1: 0.98 |
2023-09-02 20:43:04,462 - FGO - INFO - Epoch  20 | Train Loss: -2.347 | Val Loss: -0.18 | Val F1: 0.98 |
2023-09-02 20:43:05,272 - FGO - INFO - Epoch  30 | Train Loss: -2.414 | Val Loss: -0.19 | Val F1: 0.97 |
2023-09-02 20:43:06,135 - FGO - INFO - Epoch  40 | Train Loss: -2.454 | Val Loss: -0.22 | Val F1: 0.97 |
2023-09-02 20:43:06,851 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.113 | Val Loss: -0.15 | Val F1: 0.98 |
2023-09-02 20:43:06,851 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:06,858 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:43:06,858 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:06,887 - FGO - INFO - Train CM:
[[380   7]
 [ 20 310]]
2023-09-02 20:43:06,888 - FGO - INFO - Val CM:
[[46  1]
 [ 1 39]]
2023-09-02 20:43:06,888 - FGO - INFO - Test CM:
[[46  1]
 [ 1 39]]
2023-09-02 20:43:06,893 - FGO - INFO - test statistical parity: 0.33666666666666667
2023-09-02 20:43:06,895 - FGO - INFO - test equal opportunity: 0.032258064516129004
2023-09-02 20:43:06,896 - FGO - INFO - test micro f1: 0.9770114942528736
2023-09-02 20:43:06,896 - FGO - INFO - test macro f1: 0.9768617021276595
2023-09-02 20:43:06,896 - CV - INFO - fold time: 4.665796518325806s (0.07776327530543009m)
2023-09-02 20:43:06,896 - CV - INFO - ----- BEGINNING FOLD SET (002:8)----------------------------------------------------------
2023-09-02 20:43:06,898 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/002/8
2023-09-02 20:43:06,898 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:06,898 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:06,898 - FGO - INFO - 	done: False
2023-09-02 20:43:06,898 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:06,898 - FGO - INFO - 	h1: 64
2023-09-02 20:43:06,898 - FGO - INFO - 	h2: 32
2023-09-02 20:43:06,898 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:06,898 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:06,898 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:06,898 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:06,898 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:06,898 - FGO - INFO - 	theta: 30
2023-09-02 20:43:06,898 - FGO - INFO - 	clip: 5
2023-09-02 20:43:06,898 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:06,898 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:06,898 - FGO - INFO - Source Total: 734
2023-09-02 20:43:06,898 - FGO - INFO - Target Total: 70
2023-09-02 20:43:06,898 - FGO - INFO - Train Total: 734
2023-09-02 20:43:06,898 - FGO - INFO - Val Total:   70
2023-09-02 20:43:06,898 - FGO - INFO - Test Total:  70
2023-09-02 20:43:06,898 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:06,898 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:06,898 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:06,898 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:06,898 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:06,899 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:06,899 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:06,899 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:06,899 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:06,899 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:06,900 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:06,901 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:06,990 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:06,990 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:06,990 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:06,990 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:06,990 - FGO - INFO - N: 804
2023-09-02 20:43:06,990 - FGO - INFO - N_s: 734
2023-09-02 20:43:06,990 - FGO - INFO - N_t: 70
2023-09-02 20:43:06,993 - CV - INFO - Begin Pretrain
2023-09-02 20:43:06,993 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:06,997 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:43:07,022 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.69 | Val F1: 0.41 |
2023-09-02 20:43:07,046 - FGO - INFO - Epoch  20 | Train Loss: 0.645 | Val Loss: 0.66 | Val F1: 0.62 |
2023-09-02 20:43:07,071 - FGO - INFO - Epoch  30 | Train Loss: 0.588 | Val Loss: 0.61 | Val F1: 0.76 |
2023-09-02 20:43:07,096 - FGO - INFO - Epoch  40 | Train Loss: 0.498 | Val Loss: 0.53 | Val F1: 0.81 |
2023-09-02 20:43:07,121 - FGO - INFO - Epoch  50 | Train Loss: 0.392 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:43:07,145 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:43:07,170 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.27 | Val F1: 0.86 |
2023-09-02 20:43:07,195 - FGO - INFO - Epoch  80 | Train Loss: 0.181 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:43:07,220 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:43:07,244 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:43:07,244 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.157 | Val Loss: 0.19 | Val F1: 0.94 
2023-09-02 20:43:07,244 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:07,246 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:43:07,246 - CV - INFO - Begin OT Train
2023-09-02 20:43:07,246 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:07,348 - FGO - INFO - Epoch   0 | Train Loss: -1.978 | Val Loss: -0.04 | Val F1: 0.94 |
2023-09-02 20:43:08,223 - FGO - INFO - Epoch  10 | Train Loss: -2.167 | Val Loss: -0.03 | Val F1: 0.94 |
2023-09-02 20:43:09,105 - FGO - INFO - Epoch  20 | Train Loss: -2.322 | Val Loss: -0.03 | Val F1: 0.94 |
2023-09-02 20:43:09,915 - FGO - INFO - Epoch  30 | Train Loss: -2.405 | Val Loss: -0.02 | Val F1: 0.93 |
2023-09-02 20:43:10,777 - FGO - INFO - Epoch  40 | Train Loss: -2.448 | Val Loss: -0.03 | Val F1: 0.93 |
2023-09-02 20:43:11,485 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.094 | Val Loss: -0.04 | Val F1: 0.94 |
2023-09-02 20:43:11,485 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:11,489 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:43:11,489 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:11,518 - FGO - INFO - Train CM:
[[392   8]
 [ 21 313]]
2023-09-02 20:43:11,519 - FGO - INFO - Val CM:
[[34  0]
 [ 4 32]]
2023-09-02 20:43:11,519 - FGO - INFO - Test CM:
[[34  0]
 [ 4 32]]
2023-09-02 20:43:11,524 - FGO - INFO - test statistical parity: 0.08906882591093113
2023-09-02 20:43:11,525 - FGO - INFO - test equal opportunity: 0.06666666666666665
2023-09-02 20:43:11,526 - FGO - INFO - test micro f1: 0.9428571428571428
2023-09-02 20:43:11,526 - FGO - INFO - test macro f1: 0.9428104575163399
2023-09-02 20:43:11,526 - CV - INFO - fold time: 4.630320310592651s (0.07717200517654418m)
2023-09-02 20:43:11,526 - CV - INFO - ----- BEGINNING FOLD SET (002:9)----------------------------------------------------------
2023-09-02 20:43:11,528 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/002/9
2023-09-02 20:43:11,528 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:11,528 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:11,528 - FGO - INFO - 	done: False
2023-09-02 20:43:11,528 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:11,528 - FGO - INFO - 	h1: 64
2023-09-02 20:43:11,528 - FGO - INFO - 	h2: 32
2023-09-02 20:43:11,528 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:11,528 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:11,528 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:11,528 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:11,528 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:11,528 - FGO - INFO - 	theta: 30
2023-09-02 20:43:11,528 - FGO - INFO - 	clip: 5
2023-09-02 20:43:11,528 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:11,528 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:11,528 - FGO - INFO - Source Total: 725
2023-09-02 20:43:11,528 - FGO - INFO - Target Total: 79
2023-09-02 20:43:11,528 - FGO - INFO - Train Total: 725
2023-09-02 20:43:11,528 - FGO - INFO - Val Total:   79
2023-09-02 20:43:11,528 - FGO - INFO - Test Total:  79
2023-09-02 20:43:11,528 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:11,528 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:11,528 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:11,528 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:11,528 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:11,529 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:11,529 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:11,529 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:11,529 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:11,529 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:11,530 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:11,531 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:11,630 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:11,630 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:11,630 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:11,630 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:11,630 - FGO - INFO - N: 804
2023-09-02 20:43:11,630 - FGO - INFO - N_s: 725
2023-09-02 20:43:11,630 - FGO - INFO - N_t: 79
2023-09-02 20:43:11,633 - CV - INFO - Begin Pretrain
2023-09-02 20:43:11,633 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:11,637 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:43:11,665 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.50 |
2023-09-02 20:43:11,696 - FGO - INFO - Epoch  20 | Train Loss: 0.648 | Val Loss: 0.65 | Val F1: 0.59 |
2023-09-02 20:43:11,730 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.61 | Val F1: 0.69 |
2023-09-02 20:43:11,757 - FGO - INFO - Epoch  40 | Train Loss: 0.504 | Val Loss: 0.54 | Val F1: 0.78 |
2023-09-02 20:43:11,781 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:43:11,806 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.34 | Val F1: 0.90 |
2023-09-02 20:43:11,830 - FGO - INFO - Epoch  70 | Train Loss: 0.227 | Val Loss: 0.26 | Val F1: 0.92 |
2023-09-02 20:43:11,855 - FGO - INFO - Epoch  80 | Train Loss: 0.182 | Val Loss: 0.21 | Val F1: 0.96 |
2023-09-02 20:43:11,879 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:43:11,903 - FGO - INFO - Epoch 100 | Train Loss: 0.133 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:43:11,903 - FGO - INFO - Best Epoch:  85 | Train Loss: 0.165 | Val Loss: 0.19 | Val F1: 0.97 
2023-09-02 20:43:11,903 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:11,904 - CV - INFO - Pretrain Complete, 85 epochs
2023-09-02 20:43:11,905 - CV - INFO - Begin OT Train
2023-09-02 20:43:11,905 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:11,977 - FGO - INFO - Epoch   0 | Train Loss: -1.910 | Val Loss: -0.06 | Val F1: 0.96 |
2023-09-02 20:43:12,834 - FGO - INFO - Epoch  10 | Train Loss: -2.105 | Val Loss: -0.06 | Val F1: 0.96 |
2023-09-02 20:43:13,694 - FGO - INFO - Epoch  20 | Train Loss: -2.265 | Val Loss: -0.10 | Val F1: 0.96 |
2023-09-02 20:43:14,496 - FGO - INFO - Epoch  30 | Train Loss: -2.357 | Val Loss: -0.12 | Val F1: 0.96 |
2023-09-02 20:43:15,268 - FGO - INFO - Epoch  40 | Train Loss: -2.400 | Val Loss: -0.13 | Val F1: 0.96 |
2023-09-02 20:43:15,996 - FGO - INFO - Best Epoch:  11 | Train Loss: -2.122 | Val Loss: -0.05 | Val F1: 0.97 |
2023-09-02 20:43:15,996 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:15,999 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:43:16,000 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:16,027 - FGO - INFO - Train CM:
[[378   7]
 [ 30 310]]
2023-09-02 20:43:16,027 - FGO - INFO - Val CM:
[[47  2]
 [ 1 29]]
2023-09-02 20:43:16,027 - FGO - INFO - Test CM:
[[47  2]
 [ 1 29]]
2023-09-02 20:43:16,032 - FGO - INFO - test statistical parity: 0.008695652173913049
2023-09-02 20:43:16,033 - FGO - INFO - test equal opportunity: 0.038461538461538436
2023-09-02 20:43:16,034 - FGO - INFO - test micro f1: 0.9620253164556962
2023-09-02 20:43:16,035 - FGO - INFO - test macro f1: 0.9599459185398006
2023-09-02 20:43:16,035 - CV - INFO - fold time: 4.508187532424927s (0.07513645887374878m)
2023-09-02 20:43:16,035 - CV - INFO - Mean Pretrain Epochs 85.8:
2023-09-02 20:43:16,035 - CV - INFO - Mean OT Train Epochs 11.1:
2023-09-02 20:43:16,035 - CV - INFO - Mean Val Macro F1 : 0.9461438299207842
2023-09-02 20:43:16,035 - CV - INFO - Mean Eval Stat : 0.9461438299207842 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:43:16,035 - CV - INFO - set time: 46.03792595863342s (0.7672987659772237m)
2023-09-02 20:43:16,035 - CV - INFO - script time so far: 93.98586177825928s (1.5664310296376547m) (0.026107183827294246h)
2023-09-02 20:43:16,035 - CV - INFO - ===== BEGINNING OPTION SET (003)==========================================================
2023-09-02 20:43:16,035 - CV - INFO - 	done: False
2023-09-02 20:43:16,035 - CV - INFO - 	learning_rate: 0.001
2023-09-02 20:43:16,035 - CV - INFO - 	h1: 64
2023-09-02 20:43:16,035 - CV - INFO - 	h2: 32
2023-09-02 20:43:16,035 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:16,035 - CV - INFO - 	dropout: 0.0
2023-09-02 20:43:16,035 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:16,035 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:16,035 - CV - INFO - 	lambda: 0.01
2023-09-02 20:43:16,035 - CV - INFO - 	theta: 50
2023-09-02 20:43:16,035 - CV - INFO - 	clip: 5
2023-09-02 20:43:16,035 - CV - INFO - ----- BEGINNING FOLD SET (003:0)----------------------------------------------------------
2023-09-02 20:43:16,036 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/003/0
2023-09-02 20:43:16,037 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:16,037 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:16,037 - FGO - INFO - 	done: False
2023-09-02 20:43:16,037 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:16,037 - FGO - INFO - 	h1: 64
2023-09-02 20:43:16,037 - FGO - INFO - 	h2: 32
2023-09-02 20:43:16,037 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:16,037 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:16,037 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:16,037 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:16,037 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:16,037 - FGO - INFO - 	theta: 50
2023-09-02 20:43:16,037 - FGO - INFO - 	clip: 5
2023-09-02 20:43:16,037 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:16,037 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:16,037 - FGO - INFO - Source Total: 708
2023-09-02 20:43:16,037 - FGO - INFO - Target Total: 96
2023-09-02 20:43:16,037 - FGO - INFO - Train Total: 708
2023-09-02 20:43:16,037 - FGO - INFO - Val Total:   96
2023-09-02 20:43:16,037 - FGO - INFO - Test Total:  96
2023-09-02 20:43:16,037 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:16,037 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:16,037 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:16,037 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:16,037 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:16,038 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:16,038 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:16,038 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:16,038 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:16,038 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:16,039 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:16,040 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:16,155 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:16,155 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:16,155 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:16,155 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:16,155 - FGO - INFO - N: 804
2023-09-02 20:43:16,155 - FGO - INFO - N_s: 708
2023-09-02 20:43:16,155 - FGO - INFO - N_t: 96
2023-09-02 20:43:16,159 - CV - INFO - Begin Pretrain
2023-09-02 20:43:16,159 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:16,163 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:43:16,190 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:43:16,218 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.53 |
2023-09-02 20:43:16,246 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.61 | Val F1: 0.67 |
2023-09-02 20:43:16,281 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.52 | Val F1: 0.86 |
2023-09-02 20:43:16,310 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.41 | Val F1: 0.89 |
2023-09-02 20:43:16,335 - FGO - INFO - Epoch  60 | Train Loss: 0.298 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:43:16,359 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:43:16,387 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:43:16,420 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:43:16,455 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:43:16,455 - FGO - INFO - Best Epoch:  86 | Train Loss: 0.161 | Val Loss: 0.18 | Val F1: 0.95 
2023-09-02 20:43:16,455 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:16,457 - CV - INFO - Pretrain Complete, 86 epochs
2023-09-02 20:43:16,457 - CV - INFO - Begin OT Train
2023-09-02 20:43:16,457 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:16,538 - FGO - INFO - Epoch   0 | Train Loss: -3.388 | Val Loss: -0.35 | Val F1: 0.95 |
2023-09-02 20:43:17,487 - FGO - INFO - Epoch  10 | Train Loss: -3.717 | Val Loss: -0.41 | Val F1: 0.98 |
2023-09-02 20:43:18,307 - FGO - INFO - Epoch  20 | Train Loss: -3.976 | Val Loss: -0.42 | Val F1: 0.96 |
2023-09-02 20:43:19,108 - FGO - INFO - Epoch  30 | Train Loss: -4.089 | Val Loss: -0.41 | Val F1: 0.95 |
2023-09-02 20:43:19,949 - FGO - INFO - Epoch  40 | Train Loss: -4.141 | Val Loss: -0.43 | Val F1: 0.95 |
2023-09-02 20:43:20,665 - FGO - INFO - Best Epoch:   6 | Train Loss: -3.592 | Val Loss: -0.40 | Val F1: 0.98 |
2023-09-02 20:43:20,665 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:20,669 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:43:20,669 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:20,695 - FGO - INFO - Train CM:
[[379   3]
 [ 42 284]]
2023-09-02 20:43:20,696 - FGO - INFO - Val CM:
[[52  0]
 [ 5 39]]
2023-09-02 20:43:20,696 - FGO - INFO - Test CM:
[[52  0]
 [ 5 39]]
2023-09-02 20:43:20,701 - FGO - INFO - test statistical parity: 0.25989304812834224
2023-09-02 20:43:20,703 - FGO - INFO - test equal opportunity: 0.01388888888888884
2023-09-02 20:43:20,704 - FGO - INFO - test micro f1: 0.9479166666666666
2023-09-02 20:43:20,704 - FGO - INFO - test macro f1: 0.9469437382557754
2023-09-02 20:43:20,704 - CV - INFO - fold time: 4.669169664382935s (0.07781949440638224m)
2023-09-02 20:43:20,704 - CV - INFO - ----- BEGINNING FOLD SET (003:1)----------------------------------------------------------
2023-09-02 20:43:20,706 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/003/1
2023-09-02 20:43:20,706 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:20,706 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:20,706 - FGO - INFO - 	done: False
2023-09-02 20:43:20,706 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:20,706 - FGO - INFO - 	h1: 64
2023-09-02 20:43:20,706 - FGO - INFO - 	h2: 32
2023-09-02 20:43:20,706 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:20,706 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:20,706 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:20,706 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:20,706 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:20,706 - FGO - INFO - 	theta: 50
2023-09-02 20:43:20,706 - FGO - INFO - 	clip: 5
2023-09-02 20:43:20,706 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:20,706 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:20,706 - FGO - INFO - Source Total: 727
2023-09-02 20:43:20,706 - FGO - INFO - Target Total: 77
2023-09-02 20:43:20,706 - FGO - INFO - Train Total: 727
2023-09-02 20:43:20,706 - FGO - INFO - Val Total:   77
2023-09-02 20:43:20,706 - FGO - INFO - Test Total:  77
2023-09-02 20:43:20,706 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:20,706 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:20,706 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:20,706 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:20,706 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:20,707 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:20,707 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:20,707 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:20,707 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:20,707 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:20,708 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:20,709 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:20,805 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:20,805 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:20,805 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:20,805 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:20,805 - FGO - INFO - N: 804
2023-09-02 20:43:20,805 - FGO - INFO - N_s: 727
2023-09-02 20:43:20,805 - FGO - INFO - N_t: 77
2023-09-02 20:43:20,808 - CV - INFO - Begin Pretrain
2023-09-02 20:43:20,808 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:20,811 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:43:20,836 - FGO - INFO - Epoch  10 | Train Loss: 0.673 | Val Loss: 0.68 | Val F1: 0.51 |
2023-09-02 20:43:20,861 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.55 |
2023-09-02 20:43:20,885 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:43:20,910 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.55 | Val F1: 0.73 |
2023-09-02 20:43:20,935 - FGO - INFO - Epoch  50 | Train Loss: 0.396 | Val Loss: 0.47 | Val F1: 0.73 |
2023-09-02 20:43:20,959 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.40 | Val F1: 0.81 |
2023-09-02 20:43:20,984 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.34 | Val F1: 0.80 |
2023-09-02 20:43:21,008 - FGO - INFO - Epoch  80 | Train Loss: 0.172 | Val Loss: 0.29 | Val F1: 0.84 |
2023-09-02 20:43:21,033 - FGO - INFO - Epoch  90 | Train Loss: 0.142 | Val Loss: 0.26 | Val F1: 0.87 |
2023-09-02 20:43:21,057 - FGO - INFO - Epoch 100 | Train Loss: 0.122 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:43:21,057 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.147 | Val Loss: 0.27 | Val F1: 0.87 
2023-09-02 20:43:21,057 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:21,059 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:43:21,059 - CV - INFO - Begin OT Train
2023-09-02 20:43:21,059 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:21,160 - FGO - INFO - Epoch   0 | Train Loss: -3.240 | Val Loss: -0.11 | Val F1: 0.87 |
2023-09-02 20:43:22,024 - FGO - INFO - Epoch  10 | Train Loss: -3.612 | Val Loss: -0.15 | Val F1: 0.89 |
2023-09-02 20:43:22,859 - FGO - INFO - Epoch  20 | Train Loss: -3.912 | Val Loss: -0.16 | Val F1: 0.89 |
2023-09-02 20:43:23,669 - FGO - INFO - Epoch  30 | Train Loss: -4.083 | Val Loss: -0.15 | Val F1: 0.89 |
2023-09-02 20:43:24,507 - FGO - INFO - Epoch  40 | Train Loss: -4.159 | Val Loss: -0.14 | Val F1: 0.88 |
2023-09-02 20:43:25,187 - FGO - INFO - Best Epoch:  14 | Train Loss: -3.738 | Val Loss: -0.13 | Val F1: 0.91 |
2023-09-02 20:43:25,187 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:25,194 - CV - INFO - OT Train Complete, 14 epochs
2023-09-02 20:43:25,194 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:25,226 - FGO - INFO - Train CM:
[[371  19]
 [ 26 311]]
2023-09-02 20:43:25,226 - FGO - INFO - Val CM:
[[40  4]
 [ 5 28]]
2023-09-02 20:43:25,226 - FGO - INFO - Test CM:
[[40  4]
 [ 5 28]]
2023-09-02 20:43:25,231 - FGO - INFO - test statistical parity: 0.29487179487179493
2023-09-02 20:43:25,232 - FGO - INFO - test equal opportunity: 0.3709677419354839
2023-09-02 20:43:25,233 - FGO - INFO - test micro f1: 0.8831168831168831
2023-09-02 20:43:25,234 - FGO - INFO - test macro f1: 0.8802074330164217
2023-09-02 20:43:25,234 - CV - INFO - fold time: 4.529694080352783s (0.07549490133921305m)
2023-09-02 20:43:25,234 - CV - INFO - ----- BEGINNING FOLD SET (003:2)----------------------------------------------------------
2023-09-02 20:43:25,235 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/003/2
2023-09-02 20:43:25,236 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:25,236 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:25,236 - FGO - INFO - 	done: False
2023-09-02 20:43:25,236 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:25,236 - FGO - INFO - 	h1: 64
2023-09-02 20:43:25,236 - FGO - INFO - 	h2: 32
2023-09-02 20:43:25,236 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:25,236 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:25,236 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:25,236 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:25,236 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:25,236 - FGO - INFO - 	theta: 50
2023-09-02 20:43:25,236 - FGO - INFO - 	clip: 5
2023-09-02 20:43:25,236 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:25,236 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:25,236 - FGO - INFO - Source Total: 721
2023-09-02 20:43:25,236 - FGO - INFO - Target Total: 83
2023-09-02 20:43:25,236 - FGO - INFO - Train Total: 721
2023-09-02 20:43:25,236 - FGO - INFO - Val Total:   83
2023-09-02 20:43:25,236 - FGO - INFO - Test Total:  83
2023-09-02 20:43:25,236 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:25,236 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:25,236 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:25,236 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:25,236 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:25,237 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:25,237 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:25,237 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:25,237 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:25,237 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:25,238 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:25,239 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:25,342 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:25,342 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:25,342 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:25,342 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:25,342 - FGO - INFO - N: 804
2023-09-02 20:43:25,342 - FGO - INFO - N_s: 721
2023-09-02 20:43:25,342 - FGO - INFO - N_t: 83
2023-09-02 20:43:25,346 - CV - INFO - Begin Pretrain
2023-09-02 20:43:25,346 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:25,349 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:43:25,373 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.57 |
2023-09-02 20:43:25,398 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.64 | Val F1: 0.66 |
2023-09-02 20:43:25,423 - FGO - INFO - Epoch  30 | Train Loss: 0.594 | Val Loss: 0.60 | Val F1: 0.76 |
2023-09-02 20:43:25,447 - FGO - INFO - Epoch  40 | Train Loss: 0.506 | Val Loss: 0.52 | Val F1: 0.83 |
2023-09-02 20:43:25,472 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:43:25,496 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.34 | Val F1: 0.85 |
2023-09-02 20:43:25,520 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:43:25,545 - FGO - INFO - Epoch  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:43:25,569 - FGO - INFO - Epoch  90 | Train Loss: 0.140 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:43:25,594 - FGO - INFO - Epoch 100 | Train Loss: 0.119 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:43:25,594 - FGO - INFO - Best Epoch:  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 
2023-09-02 20:43:25,594 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:25,595 - CV - INFO - Pretrain Complete, 80 epochs
2023-09-02 20:43:25,595 - CV - INFO - Begin OT Train
2023-09-02 20:43:25,595 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:25,701 - FGO - INFO - Epoch   0 | Train Loss: -3.363 | Val Loss: -0.15 | Val F1: 0.87 |
2023-09-02 20:43:26,562 - FGO - INFO - Epoch  10 | Train Loss: -3.702 | Val Loss: -0.15 | Val F1: 0.91 |
2023-09-02 20:43:27,355 - FGO - INFO - Epoch  20 | Train Loss: -3.982 | Val Loss: -0.17 | Val F1: 0.91 |
2023-09-02 20:43:28,211 - FGO - INFO - Epoch  30 | Train Loss: -4.136 | Val Loss: -0.19 | Val F1: 0.90 |
2023-09-02 20:43:29,046 - FGO - INFO - Epoch  40 | Train Loss: -4.207 | Val Loss: -0.18 | Val F1: 0.90 |
2023-09-02 20:43:29,758 - FGO - INFO - Best Epoch:   8 | Train Loss: -3.646 | Val Loss: -0.14 | Val F1: 0.91 |
2023-09-02 20:43:29,758 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:29,761 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:43:29,762 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:29,788 - FGO - INFO - Train CM:
[[376   8]
 [ 34 303]]
2023-09-02 20:43:29,788 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:43:29,788 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:43:29,793 - FGO - INFO - test statistical parity: 0.11971830985915494
2023-09-02 20:43:29,795 - FGO - INFO - test equal opportunity: 0.05555555555555547
2023-09-02 20:43:29,795 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:43:29,796 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:43:29,796 - CV - INFO - fold time: 4.562089204788208s (0.07603482007980347m)
2023-09-02 20:43:29,796 - CV - INFO - ----- BEGINNING FOLD SET (003:3)----------------------------------------------------------
2023-09-02 20:43:29,798 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/003/3
2023-09-02 20:43:29,798 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:29,798 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:29,798 - FGO - INFO - 	done: False
2023-09-02 20:43:29,798 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:29,798 - FGO - INFO - 	h1: 64
2023-09-02 20:43:29,798 - FGO - INFO - 	h2: 32
2023-09-02 20:43:29,798 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:29,798 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:29,798 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:29,798 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:29,798 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:29,798 - FGO - INFO - 	theta: 50
2023-09-02 20:43:29,798 - FGO - INFO - 	clip: 5
2023-09-02 20:43:29,798 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:29,798 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:29,798 - FGO - INFO - Source Total: 729
2023-09-02 20:43:29,798 - FGO - INFO - Target Total: 75
2023-09-02 20:43:29,798 - FGO - INFO - Train Total: 729
2023-09-02 20:43:29,798 - FGO - INFO - Val Total:   75
2023-09-02 20:43:29,798 - FGO - INFO - Test Total:  75
2023-09-02 20:43:29,798 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:29,798 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:29,798 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:29,798 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:29,798 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:29,799 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:29,799 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:29,799 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:29,799 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:29,799 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:29,800 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:29,801 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:29,895 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:29,895 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:29,895 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:29,895 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:29,895 - FGO - INFO - N: 804
2023-09-02 20:43:29,895 - FGO - INFO - N_s: 729
2023-09-02 20:43:29,895 - FGO - INFO - N_t: 75
2023-09-02 20:43:29,898 - CV - INFO - Begin Pretrain
2023-09-02 20:43:29,898 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:29,901 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:43:29,926 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.67 | Val F1: 0.39 |
2023-09-02 20:43:29,951 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.64 |
2023-09-02 20:43:29,976 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.57 | Val F1: 0.86 |
2023-09-02 20:43:30,000 - FGO - INFO - Epoch  40 | Train Loss: 0.510 | Val Loss: 0.47 | Val F1: 0.92 |
2023-09-02 20:43:30,025 - FGO - INFO - Epoch  50 | Train Loss: 0.406 | Val Loss: 0.34 | Val F1: 0.93 |
2023-09-02 20:43:30,049 - FGO - INFO - Epoch  60 | Train Loss: 0.305 | Val Loss: 0.23 | Val F1: 0.97 |
2023-09-02 20:43:30,074 - FGO - INFO - Epoch  70 | Train Loss: 0.231 | Val Loss: 0.16 | Val F1: 0.99 |
2023-09-02 20:43:30,098 - FGO - INFO - Epoch  80 | Train Loss: 0.186 | Val Loss: 0.12 | Val F1: 0.99 |
2023-09-02 20:43:30,123 - FGO - INFO - Epoch  90 | Train Loss: 0.156 | Val Loss: 0.10 | Val F1: 0.99 |
2023-09-02 20:43:30,147 - FGO - INFO - Epoch 100 | Train Loss: 0.135 | Val Loss: 0.09 | Val F1: 0.97 |
2023-09-02 20:43:30,147 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.161 | Val Loss: 0.10 | Val F1: 0.99 
2023-09-02 20:43:30,147 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:30,149 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:43:30,149 - CV - INFO - Begin OT Train
2023-09-02 20:43:30,149 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:30,220 - FGO - INFO - Epoch   0 | Train Loss: -3.292 | Val Loss: -0.28 | Val F1: 0.99 |
2023-09-02 20:43:31,059 - FGO - INFO - Epoch  10 | Train Loss: -3.675 | Val Loss: -0.32 | Val F1: 0.99 |
2023-09-02 20:43:31,964 - FGO - INFO - Epoch  20 | Train Loss: -3.961 | Val Loss: -0.33 | Val F1: 0.99 |
2023-09-02 20:43:32,774 - FGO - INFO - Epoch  30 | Train Loss: -4.105 | Val Loss: -0.32 | Val F1: 0.97 |
2023-09-02 20:43:33,539 - FGO - INFO - Epoch  40 | Train Loss: -4.168 | Val Loss: -0.32 | Val F1: 0.99 |
2023-09-02 20:43:34,274 - FGO - INFO - Best Epoch:   8 | Train Loss: -3.612 | Val Loss: -0.30 | Val F1: 0.99 |
2023-09-02 20:43:34,274 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:34,277 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:43:34,278 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:34,308 - FGO - INFO - Train CM:
[[394   2]
 [ 36 297]]
2023-09-02 20:43:34,308 - FGO - INFO - Val CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:43:34,308 - FGO - INFO - Test CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:43:34,313 - FGO - INFO - test statistical parity: 0.046838407494145196
2023-09-02 20:43:34,314 - FGO - INFO - test equal opportunity: 0.10952380952380958
2023-09-02 20:43:34,315 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 20:43:34,315 - FGO - INFO - test macro f1: 0.9732905982905983
2023-09-02 20:43:34,315 - CV - INFO - fold time: 4.519502401351929s (0.07532504002253214m)
2023-09-02 20:43:34,316 - CV - INFO - ----- BEGINNING FOLD SET (003:4)----------------------------------------------------------
2023-09-02 20:43:34,317 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/003/4
2023-09-02 20:43:34,317 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:34,317 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:34,317 - FGO - INFO - 	done: False
2023-09-02 20:43:34,317 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:34,317 - FGO - INFO - 	h1: 64
2023-09-02 20:43:34,317 - FGO - INFO - 	h2: 32
2023-09-02 20:43:34,317 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:34,317 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:34,317 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:34,317 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:34,317 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:34,317 - FGO - INFO - 	theta: 50
2023-09-02 20:43:34,318 - FGO - INFO - 	clip: 5
2023-09-02 20:43:34,318 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:34,318 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:34,318 - FGO - INFO - Source Total: 732
2023-09-02 20:43:34,318 - FGO - INFO - Target Total: 72
2023-09-02 20:43:34,318 - FGO - INFO - Train Total: 732
2023-09-02 20:43:34,318 - FGO - INFO - Val Total:   72
2023-09-02 20:43:34,318 - FGO - INFO - Test Total:  72
2023-09-02 20:43:34,318 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:34,318 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:34,318 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:34,318 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:34,318 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:34,318 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:34,318 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:34,318 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:34,318 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:34,318 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:34,319 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:34,321 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:34,412 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:34,412 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:34,412 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:34,412 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:34,412 - FGO - INFO - N: 804
2023-09-02 20:43:34,412 - FGO - INFO - N_s: 732
2023-09-02 20:43:34,412 - FGO - INFO - N_t: 72
2023-09-02 20:43:34,416 - CV - INFO - Begin Pretrain
2023-09-02 20:43:34,416 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:34,419 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:43:34,444 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.68 | Val F1: 0.45 |
2023-09-02 20:43:34,469 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.66 | Val F1: 0.63 |
2023-09-02 20:43:34,493 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.60 | Val F1: 0.75 |
2023-09-02 20:43:34,518 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.50 | Val F1: 0.87 |
2023-09-02 20:43:34,543 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.39 | Val F1: 0.89 |
2023-09-02 20:43:34,567 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:43:34,592 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:43:34,617 - FGO - INFO - Epoch  80 | Train Loss: 0.179 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:43:34,641 - FGO - INFO - Epoch  90 | Train Loss: 0.150 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:43:34,666 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:43:34,666 - FGO - INFO - Best Epoch:  81 | Train Loss: 0.175 | Val Loss: 0.16 | Val F1: 0.97 
2023-09-02 20:43:34,666 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:34,667 - CV - INFO - Pretrain Complete, 81 epochs
2023-09-02 20:43:34,667 - CV - INFO - Begin OT Train
2023-09-02 20:43:34,667 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:34,755 - FGO - INFO - Epoch   0 | Train Loss: -3.449 | Val Loss: -0.24 | Val F1: 0.97 |
2023-09-02 20:43:35,596 - FGO - INFO - Epoch  10 | Train Loss: -3.822 | Val Loss: -0.27 | Val F1: 0.96 |
2023-09-02 20:43:36,442 - FGO - INFO - Epoch  20 | Train Loss: -4.095 | Val Loss: -0.27 | Val F1: 0.96 |
2023-09-02 20:43:37,287 - FGO - INFO - Epoch  30 | Train Loss: -4.195 | Val Loss: -0.28 | Val F1: 0.96 |
2023-09-02 20:43:38,045 - FGO - INFO - Epoch  40 | Train Loss: -4.251 | Val Loss: -0.28 | Val F1: 0.96 |
2023-09-02 20:43:38,725 - FGO - INFO - Best Epoch:   6 | Train Loss: -3.680 | Val Loss: -0.25 | Val F1: 0.97 |
2023-09-02 20:43:38,725 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:38,729 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:43:38,729 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:38,754 - FGO - INFO - Train CM:
[[388   9]
 [ 21 314]]
2023-09-02 20:43:38,754 - FGO - INFO - Val CM:
[[37  0]
 [ 3 32]]
2023-09-02 20:43:38,755 - FGO - INFO - Test CM:
[[37  0]
 [ 3 32]]
2023-09-02 20:43:38,760 - FGO - INFO - test statistical parity: 0.05161290322580642
2023-09-02 20:43:38,761 - FGO - INFO - test equal opportunity: 0.1333333333333333
2023-09-02 20:43:38,762 - FGO - INFO - test micro f1: 0.9583333333333334
2023-09-02 20:43:38,762 - FGO - INFO - test macro f1: 0.9581314208179881
2023-09-02 20:43:38,762 - CV - INFO - fold time: 4.4467856884002686s (0.07411309480667114m)
2023-09-02 20:43:38,762 - CV - INFO - ----- BEGINNING FOLD SET (003:5)----------------------------------------------------------
2023-09-02 20:43:38,764 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/003/5
2023-09-02 20:43:38,764 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:38,764 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:38,764 - FGO - INFO - 	done: False
2023-09-02 20:43:38,764 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:38,764 - FGO - INFO - 	h1: 64
2023-09-02 20:43:38,764 - FGO - INFO - 	h2: 32
2023-09-02 20:43:38,764 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:38,764 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:38,764 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:38,764 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:38,764 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:38,764 - FGO - INFO - 	theta: 50
2023-09-02 20:43:38,764 - FGO - INFO - 	clip: 5
2023-09-02 20:43:38,764 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:38,764 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:38,764 - FGO - INFO - Source Total: 726
2023-09-02 20:43:38,764 - FGO - INFO - Target Total: 78
2023-09-02 20:43:38,764 - FGO - INFO - Train Total: 726
2023-09-02 20:43:38,764 - FGO - INFO - Val Total:   78
2023-09-02 20:43:38,764 - FGO - INFO - Test Total:  78
2023-09-02 20:43:38,764 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:38,764 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:38,764 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:38,764 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:38,764 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:38,765 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:38,765 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:38,765 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:38,765 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:38,765 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:38,766 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:38,767 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:38,865 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:38,865 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:38,865 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:38,865 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:38,865 - FGO - INFO - N: 804
2023-09-02 20:43:38,865 - FGO - INFO - N_s: 726
2023-09-02 20:43:38,865 - FGO - INFO - N_t: 78
2023-09-02 20:43:38,868 - CV - INFO - Begin Pretrain
2023-09-02 20:43:38,868 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:38,871 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:43:38,896 - FGO - INFO - Epoch  10 | Train Loss: 0.669 | Val Loss: 0.72 | Val F1: 0.34 |
2023-09-02 20:43:38,921 - FGO - INFO - Epoch  20 | Train Loss: 0.644 | Val Loss: 0.69 | Val F1: 0.42 |
2023-09-02 20:43:38,945 - FGO - INFO - Epoch  30 | Train Loss: 0.591 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:43:38,970 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.53 | Val F1: 0.83 |
2023-09-02 20:43:38,994 - FGO - INFO - Epoch  50 | Train Loss: 0.397 | Val Loss: 0.41 | Val F1: 0.85 |
2023-09-02 20:43:39,019 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:43:39,043 - FGO - INFO - Epoch  70 | Train Loss: 0.220 | Val Loss: 0.27 | Val F1: 0.88 |
2023-09-02 20:43:39,067 - FGO - INFO - Epoch  80 | Train Loss: 0.175 | Val Loss: 0.25 | Val F1: 0.88 |
2023-09-02 20:43:39,092 - FGO - INFO - Epoch  90 | Train Loss: 0.148 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:43:39,116 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:43:39,116 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.209 | Val Loss: 0.26 | Val F1: 0.91 
2023-09-02 20:43:39,116 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:39,117 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:43:39,118 - CV - INFO - Begin OT Train
2023-09-02 20:43:39,118 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:39,189 - FGO - INFO - Epoch   0 | Train Loss: -3.358 | Val Loss: -0.15 | Val F1: 0.91 |
2023-09-02 20:43:40,129 - FGO - INFO - Epoch  10 | Train Loss: -3.718 | Val Loss: -0.14 | Val F1: 0.87 |
2023-09-02 20:43:40,910 - FGO - INFO - Epoch  20 | Train Loss: -4.001 | Val Loss: -0.12 | Val F1: 0.87 |
2023-09-02 20:43:41,802 - FGO - INFO - Epoch  30 | Train Loss: -4.125 | Val Loss: -0.11 | Val F1: 0.87 |
2023-09-02 20:43:42,615 - FGO - INFO - Epoch  40 | Train Loss: -4.180 | Val Loss: -0.12 | Val F1: 0.87 |
2023-09-02 20:43:43,290 - FGO - INFO - Best Epoch:   9 | Train Loss: -3.687 | Val Loss: -0.13 | Val F1: 0.88 |
2023-09-02 20:43:43,290 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:43,293 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:43:43,295 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:43,341 - FGO - INFO - Train CM:
[[399   1]
 [ 41 285]]
2023-09-02 20:43:43,341 - FGO - INFO - Val CM:
[[34  0]
 [10 34]]
2023-09-02 20:43:43,342 - FGO - INFO - Test CM:
[[34  0]
 [10 34]]
2023-09-02 20:43:43,346 - FGO - INFO - test statistical parity: 0.009661835748792258
2023-09-02 20:43:43,348 - FGO - INFO - test equal opportunity: 0.03076923076923077
2023-09-02 20:43:43,348 - FGO - INFO - test micro f1: 0.8717948717948718
2023-09-02 20:43:43,349 - FGO - INFO - test macro f1: 0.8717948717948718
2023-09-02 20:43:43,349 - CV - INFO - fold time: 4.586627721786499s (0.07644379536310832m)
2023-09-02 20:43:43,349 - CV - INFO - ----- BEGINNING FOLD SET (003:6)----------------------------------------------------------
2023-09-02 20:43:43,351 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/003/6
2023-09-02 20:43:43,351 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:43,351 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:43,351 - FGO - INFO - 	done: False
2023-09-02 20:43:43,351 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:43,351 - FGO - INFO - 	h1: 64
2023-09-02 20:43:43,351 - FGO - INFO - 	h2: 32
2023-09-02 20:43:43,351 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:43,351 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:43,351 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:43,351 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:43,351 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:43,351 - FGO - INFO - 	theta: 50
2023-09-02 20:43:43,351 - FGO - INFO - 	clip: 5
2023-09-02 20:43:43,351 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:43,351 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:43,351 - FGO - INFO - Source Total: 717
2023-09-02 20:43:43,351 - FGO - INFO - Target Total: 87
2023-09-02 20:43:43,351 - FGO - INFO - Train Total: 717
2023-09-02 20:43:43,351 - FGO - INFO - Val Total:   87
2023-09-02 20:43:43,351 - FGO - INFO - Test Total:  87
2023-09-02 20:43:43,351 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:43,351 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:43,351 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:43,351 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:43,351 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:43,352 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:43,352 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:43,352 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:43,352 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:43,352 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:43,353 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:43,354 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:43,460 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:43,460 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:43,460 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:43,460 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:43,460 - FGO - INFO - N: 804
2023-09-02 20:43:43,460 - FGO - INFO - N_s: 717
2023-09-02 20:43:43,460 - FGO - INFO - N_t: 87
2023-09-02 20:43:43,463 - CV - INFO - Begin Pretrain
2023-09-02 20:43:43,463 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:43,467 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:43:43,491 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.47 |
2023-09-02 20:43:43,516 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.63 |
2023-09-02 20:43:43,540 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.78 |
2023-09-02 20:43:43,565 - FGO - INFO - Epoch  40 | Train Loss: 0.509 | Val Loss: 0.50 | Val F1: 0.84 |
2023-09-02 20:43:43,589 - FGO - INFO - Epoch  50 | Train Loss: 0.402 | Val Loss: 0.40 | Val F1: 0.86 |
2023-09-02 20:43:43,613 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.31 | Val F1: 0.92 |
2023-09-02 20:43:43,638 - FGO - INFO - Epoch  70 | Train Loss: 0.228 | Val Loss: 0.23 | Val F1: 0.92 |
2023-09-02 20:43:43,662 - FGO - INFO - Epoch  80 | Train Loss: 0.183 | Val Loss: 0.19 | Val F1: 0.93 |
2023-09-02 20:43:43,686 - FGO - INFO - Epoch  90 | Train Loss: 0.154 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:43:43,711 - FGO - INFO - Epoch 100 | Train Loss: 0.134 | Val Loss: 0.14 | Val F1: 0.95 |
2023-09-02 20:43:43,711 - FGO - INFO - Best Epoch:  98 | Train Loss: 0.137 | Val Loss: 0.15 | Val F1: 0.95 
2023-09-02 20:43:43,711 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:43,712 - CV - INFO - Pretrain Complete, 98 epochs
2023-09-02 20:43:43,712 - CV - INFO - Begin OT Train
2023-09-02 20:43:43,712 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:43,782 - FGO - INFO - Epoch   0 | Train Loss: -3.421 | Val Loss: -0.31 | Val F1: 0.95 |
2023-09-02 20:43:44,636 - FGO - INFO - Epoch  10 | Train Loss: -3.777 | Val Loss: -0.36 | Val F1: 0.95 |
2023-09-02 20:43:45,533 - FGO - INFO - Epoch  20 | Train Loss: -4.033 | Val Loss: -0.38 | Val F1: 0.94 |
2023-09-02 20:43:46,344 - FGO - INFO - Epoch  30 | Train Loss: -4.132 | Val Loss: -0.39 | Val F1: 0.94 |
2023-09-02 20:43:47,202 - FGO - INFO - Epoch  40 | Train Loss: -4.189 | Val Loss: -0.41 | Val F1: 0.95 |
2023-09-02 20:43:47,943 - FGO - INFO - Best Epoch:   6 | Train Loss: -3.641 | Val Loss: -0.34 | Val F1: 0.95 |
2023-09-02 20:43:47,943 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:47,946 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:43:47,946 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:47,972 - FGO - INFO - Train CM:
[[381   4]
 [ 35 297]]
2023-09-02 20:43:47,972 - FGO - INFO - Val CM:
[[47  2]
 [ 2 36]]
2023-09-02 20:43:47,972 - FGO - INFO - Test CM:
[[47  2]
 [ 2 36]]
2023-09-02 20:43:47,977 - FGO - INFO - test statistical parity: 0.06962025316455694
2023-09-02 20:43:47,979 - FGO - INFO - test equal opportunity: 0.05882352941176472
2023-09-02 20:43:47,980 - FGO - INFO - test micro f1: 0.9540229885057472
2023-09-02 20:43:47,980 - FGO - INFO - test macro f1: 0.9532760472610096
2023-09-02 20:43:47,980 - CV - INFO - fold time: 4.631198167800903s (0.07718663613001506m)
2023-09-02 20:43:47,980 - CV - INFO - ----- BEGINNING FOLD SET (003:7)----------------------------------------------------------
2023-09-02 20:43:47,982 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/003/7
2023-09-02 20:43:47,982 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:47,982 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:47,982 - FGO - INFO - 	done: False
2023-09-02 20:43:47,982 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:47,982 - FGO - INFO - 	h1: 64
2023-09-02 20:43:47,982 - FGO - INFO - 	h2: 32
2023-09-02 20:43:47,982 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:47,982 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:47,982 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:47,982 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:47,982 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:47,982 - FGO - INFO - 	theta: 50
2023-09-02 20:43:47,982 - FGO - INFO - 	clip: 5
2023-09-02 20:43:47,982 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:47,982 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:47,982 - FGO - INFO - Source Total: 717
2023-09-02 20:43:47,982 - FGO - INFO - Target Total: 87
2023-09-02 20:43:47,982 - FGO - INFO - Train Total: 717
2023-09-02 20:43:47,982 - FGO - INFO - Val Total:   87
2023-09-02 20:43:47,982 - FGO - INFO - Test Total:  87
2023-09-02 20:43:47,982 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:47,982 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:47,982 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:47,982 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:47,982 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:47,983 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:47,983 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:47,983 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:47,983 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:47,983 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:47,984 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:47,985 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:48,091 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:48,091 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:48,091 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:48,091 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:48,091 - FGO - INFO - N: 804
2023-09-02 20:43:48,091 - FGO - INFO - N_s: 717
2023-09-02 20:43:48,091 - FGO - INFO - N_t: 87
2023-09-02 20:43:48,095 - CV - INFO - Begin Pretrain
2023-09-02 20:43:48,095 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:48,098 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:43:48,127 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.40 |
2023-09-02 20:43:48,155 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.62 |
2023-09-02 20:43:48,183 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.77 |
2023-09-02 20:43:48,217 - FGO - INFO - Epoch  40 | Train Loss: 0.507 | Val Loss: 0.52 | Val F1: 0.88 |
2023-09-02 20:43:48,245 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.41 | Val F1: 0.88 |
2023-09-02 20:43:48,270 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:43:48,294 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.23 | Val F1: 0.94 |
2023-09-02 20:43:48,319 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:43:48,343 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:43:48,368 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:43:48,368 - FGO - INFO - Best Epoch:  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.97 
2023-09-02 20:43:48,368 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:48,369 - CV - INFO - Pretrain Complete, 90 epochs
2023-09-02 20:43:48,369 - CV - INFO - Begin OT Train
2023-09-02 20:43:48,369 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:48,444 - FGO - INFO - Epoch   0 | Train Loss: -3.421 | Val Loss: -0.30 | Val F1: 0.97 |
2023-09-02 20:43:49,303 - FGO - INFO - Epoch  10 | Train Loss: -3.782 | Val Loss: -0.35 | Val F1: 0.98 |
2023-09-02 20:43:50,190 - FGO - INFO - Epoch  20 | Train Loss: -4.056 | Val Loss: -0.37 | Val F1: 0.98 |
2023-09-02 20:43:51,006 - FGO - INFO - Epoch  30 | Train Loss: -4.155 | Val Loss: -0.37 | Val F1: 0.97 |
2023-09-02 20:43:51,841 - FGO - INFO - Epoch  40 | Train Loss: -4.212 | Val Loss: -0.39 | Val F1: 0.97 |
2023-09-02 20:43:52,520 - FGO - INFO - Best Epoch:   6 | Train Loss: -3.643 | Val Loss: -0.34 | Val F1: 0.98 |
2023-09-02 20:43:52,520 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:52,523 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:43:52,523 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:52,551 - FGO - INFO - Train CM:
[[380   7]
 [ 25 305]]
2023-09-02 20:43:52,552 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:43:52,552 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:43:52,557 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:43:52,558 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:43:52,559 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:43:52,560 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:43:52,560 - CV - INFO - fold time: 4.5794172286987305s (0.07632362047831218m)
2023-09-02 20:43:52,560 - CV - INFO - ----- BEGINNING FOLD SET (003:8)----------------------------------------------------------
2023-09-02 20:43:52,561 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/003/8
2023-09-02 20:43:52,561 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:52,561 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:52,561 - FGO - INFO - 	done: False
2023-09-02 20:43:52,561 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:52,561 - FGO - INFO - 	h1: 64
2023-09-02 20:43:52,561 - FGO - INFO - 	h2: 32
2023-09-02 20:43:52,561 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:52,561 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:52,561 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:52,561 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:52,561 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:52,562 - FGO - INFO - 	theta: 50
2023-09-02 20:43:52,562 - FGO - INFO - 	clip: 5
2023-09-02 20:43:52,562 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:52,562 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:52,562 - FGO - INFO - Source Total: 734
2023-09-02 20:43:52,562 - FGO - INFO - Target Total: 70
2023-09-02 20:43:52,562 - FGO - INFO - Train Total: 734
2023-09-02 20:43:52,562 - FGO - INFO - Val Total:   70
2023-09-02 20:43:52,562 - FGO - INFO - Test Total:  70
2023-09-02 20:43:52,562 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:52,562 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:52,562 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:52,562 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:52,562 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:52,562 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:52,562 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:52,562 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:52,562 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:52,562 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:52,563 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:52,565 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:52,652 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:52,652 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:52,652 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:52,652 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:52,652 - FGO - INFO - N: 804
2023-09-02 20:43:52,652 - FGO - INFO - N_s: 734
2023-09-02 20:43:52,652 - FGO - INFO - N_t: 70
2023-09-02 20:43:52,656 - CV - INFO - Begin Pretrain
2023-09-02 20:43:52,656 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:52,659 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:43:52,684 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.69 | Val F1: 0.41 |
2023-09-02 20:43:52,709 - FGO - INFO - Epoch  20 | Train Loss: 0.645 | Val Loss: 0.66 | Val F1: 0.62 |
2023-09-02 20:43:52,734 - FGO - INFO - Epoch  30 | Train Loss: 0.588 | Val Loss: 0.61 | Val F1: 0.76 |
2023-09-02 20:43:52,759 - FGO - INFO - Epoch  40 | Train Loss: 0.498 | Val Loss: 0.53 | Val F1: 0.81 |
2023-09-02 20:43:52,783 - FGO - INFO - Epoch  50 | Train Loss: 0.392 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:43:52,808 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:43:52,833 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.27 | Val F1: 0.86 |
2023-09-02 20:43:52,858 - FGO - INFO - Epoch  80 | Train Loss: 0.181 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:43:52,882 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:43:52,907 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:43:52,907 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.157 | Val Loss: 0.19 | Val F1: 0.94 
2023-09-02 20:43:52,907 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:52,908 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:43:52,908 - CV - INFO - Begin OT Train
2023-09-02 20:43:52,908 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:52,997 - FGO - INFO - Epoch   0 | Train Loss: -3.414 | Val Loss: -0.17 | Val F1: 0.94 |
2023-09-02 20:43:53,894 - FGO - INFO - Epoch  10 | Train Loss: -3.762 | Val Loss: -0.17 | Val F1: 0.94 |
2023-09-02 20:43:54,715 - FGO - INFO - Epoch  20 | Train Loss: -4.036 | Val Loss: -0.16 | Val F1: 0.91 |
2023-09-02 20:43:55,527 - FGO - INFO - Epoch  30 | Train Loss: -4.149 | Val Loss: -0.15 | Val F1: 0.90 |
2023-09-02 20:43:56,363 - FGO - INFO - Epoch  40 | Train Loss: -4.213 | Val Loss: -0.17 | Val F1: 0.91 |
2023-09-02 20:43:57,113 - FGO - INFO - Best Epoch:   7 | Train Loss: -3.661 | Val Loss: -0.18 | Val F1: 0.94 |
2023-09-02 20:43:57,113 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:57,116 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:43:57,116 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:43:57,140 - FGO - INFO - Train CM:
[[396   4]
 [ 41 293]]
2023-09-02 20:43:57,141 - FGO - INFO - Val CM:
[[34  0]
 [ 6 30]]
2023-09-02 20:43:57,141 - FGO - INFO - Test CM:
[[34  0]
 [ 6 30]]
2023-09-02 20:43:57,145 - FGO - INFO - test statistical parity: 0.053981106612685514
2023-09-02 20:43:57,147 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:43:57,148 - FGO - INFO - test micro f1: 0.9142857142857143
2023-09-02 20:43:57,148 - FGO - INFO - test macro f1: 0.914004914004914
2023-09-02 20:43:57,148 - CV - INFO - fold time: 4.588418960571289s (0.07647364934285482m)
2023-09-02 20:43:57,148 - CV - INFO - ----- BEGINNING FOLD SET (003:9)----------------------------------------------------------
2023-09-02 20:43:57,150 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/003/9
2023-09-02 20:43:57,150 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:43:57,150 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:43:57,150 - FGO - INFO - 	done: False
2023-09-02 20:43:57,150 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:43:57,150 - FGO - INFO - 	h1: 64
2023-09-02 20:43:57,150 - FGO - INFO - 	h2: 32
2023-09-02 20:43:57,150 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:43:57,150 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:43:57,150 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:43:57,150 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:43:57,150 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:43:57,150 - FGO - INFO - 	theta: 50
2023-09-02 20:43:57,150 - FGO - INFO - 	clip: 5
2023-09-02 20:43:57,150 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:43:57,150 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:43:57,150 - FGO - INFO - Source Total: 725
2023-09-02 20:43:57,150 - FGO - INFO - Target Total: 79
2023-09-02 20:43:57,150 - FGO - INFO - Train Total: 725
2023-09-02 20:43:57,150 - FGO - INFO - Val Total:   79
2023-09-02 20:43:57,150 - FGO - INFO - Test Total:  79
2023-09-02 20:43:57,150 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:43:57,150 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:43:57,150 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:43:57,150 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:43:57,150 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:43:57,151 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:43:57,151 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:43:57,151 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:43:57,151 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:43:57,151 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:43:57,152 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:43:57,153 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:43:57,252 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:43:57,252 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:43:57,252 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:43:57,252 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:43:57,252 - FGO - INFO - N: 804
2023-09-02 20:43:57,252 - FGO - INFO - N_s: 725
2023-09-02 20:43:57,252 - FGO - INFO - N_t: 79
2023-09-02 20:43:57,255 - CV - INFO - Begin Pretrain
2023-09-02 20:43:57,255 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:43:57,259 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:43:57,283 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.50 |
2023-09-02 20:43:57,308 - FGO - INFO - Epoch  20 | Train Loss: 0.648 | Val Loss: 0.65 | Val F1: 0.59 |
2023-09-02 20:43:57,332 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.61 | Val F1: 0.69 |
2023-09-02 20:43:57,357 - FGO - INFO - Epoch  40 | Train Loss: 0.504 | Val Loss: 0.54 | Val F1: 0.78 |
2023-09-02 20:43:57,381 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:43:57,406 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.34 | Val F1: 0.90 |
2023-09-02 20:43:57,430 - FGO - INFO - Epoch  70 | Train Loss: 0.227 | Val Loss: 0.26 | Val F1: 0.92 |
2023-09-02 20:43:57,455 - FGO - INFO - Epoch  80 | Train Loss: 0.182 | Val Loss: 0.21 | Val F1: 0.96 |
2023-09-02 20:43:57,479 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:43:57,503 - FGO - INFO - Epoch 100 | Train Loss: 0.133 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:43:57,503 - FGO - INFO - Best Epoch:  85 | Train Loss: 0.165 | Val Loss: 0.19 | Val F1: 0.97 
2023-09-02 20:43:57,503 - FGO - INFO - Setting model to best state.
2023-09-02 20:43:57,505 - CV - INFO - Pretrain Complete, 85 epochs
2023-09-02 20:43:57,505 - CV - INFO - Begin OT Train
2023-09-02 20:43:57,505 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:43:57,577 - FGO - INFO - Epoch   0 | Train Loss: -3.328 | Val Loss: -0.22 | Val F1: 0.96 |
2023-09-02 20:43:58,519 - FGO - INFO - Epoch  10 | Train Loss: -3.677 | Val Loss: -0.24 | Val F1: 0.96 |
2023-09-02 20:43:59,359 - FGO - INFO - Epoch  20 | Train Loss: -3.963 | Val Loss: -0.28 | Val F1: 0.96 |
2023-09-02 20:44:00,161 - FGO - INFO - Epoch  30 | Train Loss: -4.100 | Val Loss: -0.29 | Val F1: 0.96 |
2023-09-02 20:44:00,958 - FGO - INFO - Epoch  40 | Train Loss: -4.170 | Val Loss: -0.30 | Val F1: 0.96 |
2023-09-02 20:44:01,688 - FGO - INFO - Best Epoch:   6 | Train Loss: -3.545 | Val Loss: -0.22 | Val F1: 0.96 |
2023-09-02 20:44:01,689 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:01,692 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:44:01,692 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:01,718 - FGO - INFO - Train CM:
[[378   7]
 [ 45 295]]
2023-09-02 20:44:01,718 - FGO - INFO - Val CM:
[[47  2]
 [ 1 29]]
2023-09-02 20:44:01,718 - FGO - INFO - Test CM:
[[47  2]
 [ 1 29]]
2023-09-02 20:44:01,723 - FGO - INFO - test statistical parity: 0.008695652173913049
2023-09-02 20:44:01,725 - FGO - INFO - test equal opportunity: 0.038461538461538436
2023-09-02 20:44:01,726 - FGO - INFO - test micro f1: 0.9620253164556962
2023-09-02 20:44:01,726 - FGO - INFO - test macro f1: 0.9599459185398006
2023-09-02 20:44:01,726 - CV - INFO - fold time: 4.57799220085144s (0.07629987001419067m)
2023-09-02 20:44:01,726 - CV - INFO - Mean Pretrain Epochs 85.6:
2023-09-02 20:44:01,726 - CV - INFO - Mean OT Train Epochs 7.6:
2023-09-02 20:44:01,726 - CV - INFO - Mean Val Macro F1 : 0.9322212065918956
2023-09-02 20:44:01,726 - CV - INFO - Mean Eval Stat : 0.9322212065918956 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:44:01,726 - CV - INFO - set time: 45.69141888618469s (0.7615236481030782m)
2023-09-02 20:44:01,726 - CV - INFO - script time so far: 139.67732405662537s (2.327955400943756m) (0.038799256682395936h)
2023-09-02 20:44:01,726 - CV - INFO - ===== BEGINNING OPTION SET (004)==========================================================
2023-09-02 20:44:01,726 - CV - INFO - 	done: False
2023-09-02 20:44:01,726 - CV - INFO - 	learning_rate: 0.001
2023-09-02 20:44:01,726 - CV - INFO - 	h1: 64
2023-09-02 20:44:01,726 - CV - INFO - 	h2: 32
2023-09-02 20:44:01,726 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:01,726 - CV - INFO - 	dropout: 0.0
2023-09-02 20:44:01,726 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:01,726 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:01,726 - CV - INFO - 	lambda: 0.03
2023-09-02 20:44:01,726 - CV - INFO - 	theta: 10
2023-09-02 20:44:01,726 - CV - INFO - 	clip: 5
2023-09-02 20:44:01,726 - CV - INFO - ----- BEGINNING FOLD SET (004:0)----------------------------------------------------------
2023-09-02 20:44:01,728 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/004/0
2023-09-02 20:44:01,728 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:01,728 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:01,728 - FGO - INFO - 	done: False
2023-09-02 20:44:01,728 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:01,728 - FGO - INFO - 	h1: 64
2023-09-02 20:44:01,728 - FGO - INFO - 	h2: 32
2023-09-02 20:44:01,728 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:01,728 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:01,728 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:01,728 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:01,728 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:01,728 - FGO - INFO - 	theta: 10
2023-09-02 20:44:01,728 - FGO - INFO - 	clip: 5
2023-09-02 20:44:01,728 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:01,728 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:01,728 - FGO - INFO - Source Total: 708
2023-09-02 20:44:01,728 - FGO - INFO - Target Total: 96
2023-09-02 20:44:01,728 - FGO - INFO - Train Total: 708
2023-09-02 20:44:01,728 - FGO - INFO - Val Total:   96
2023-09-02 20:44:01,728 - FGO - INFO - Test Total:  96
2023-09-02 20:44:01,728 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:01,728 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:01,728 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:01,728 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:01,729 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:01,729 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:01,729 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:01,729 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:01,729 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:01,729 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:01,730 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:01,731 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:01,846 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:01,846 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:01,846 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:01,846 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:01,846 - FGO - INFO - N: 804
2023-09-02 20:44:01,846 - FGO - INFO - N_s: 708
2023-09-02 20:44:01,846 - FGO - INFO - N_t: 96
2023-09-02 20:44:01,850 - CV - INFO - Begin Pretrain
2023-09-02 20:44:01,850 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:01,853 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:44:01,877 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:44:01,902 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.53 |
2023-09-02 20:44:01,926 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.61 | Val F1: 0.67 |
2023-09-02 20:44:01,950 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.52 | Val F1: 0.86 |
2023-09-02 20:44:01,975 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.41 | Val F1: 0.89 |
2023-09-02 20:44:01,999 - FGO - INFO - Epoch  60 | Train Loss: 0.298 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:44:02,023 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:44:02,047 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:44:02,071 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:44:02,096 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:44:02,096 - FGO - INFO - Best Epoch:  86 | Train Loss: 0.161 | Val Loss: 0.18 | Val F1: 0.95 
2023-09-02 20:44:02,096 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:02,097 - CV - INFO - Pretrain Complete, 86 epochs
2023-09-02 20:44:02,097 - CV - INFO - Begin OT Train
2023-09-02 20:44:02,097 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:02,190 - FGO - INFO - Epoch   0 | Train Loss: -2.359 | Val Loss: -0.21 | Val F1: 0.95 |
2023-09-02 20:44:02,945 - FGO - INFO - Epoch  10 | Train Loss: -2.413 | Val Loss: -0.25 | Val F1: 0.97 |
2023-09-02 20:44:03,791 - FGO - INFO - Epoch  20 | Train Loss: -2.461 | Val Loss: -0.25 | Val F1: 0.97 |
2023-09-02 20:44:04,593 - FGO - INFO - Epoch  30 | Train Loss: -2.494 | Val Loss: -0.26 | Val F1: 0.97 |
2023-09-02 20:44:05,462 - FGO - INFO - Epoch  40 | Train Loss: -2.517 | Val Loss: -0.26 | Val F1: 0.96 |
2023-09-02 20:44:06,133 - FGO - INFO - Best Epoch:   8 | Train Loss: -2.406 | Val Loss: -0.24 | Val F1: 0.98 |
2023-09-02 20:44:06,133 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:06,136 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:44:06,136 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:06,160 - FGO - INFO - Train CM:
[[375   7]
 [ 25 301]]
2023-09-02 20:44:06,160 - FGO - INFO - Val CM:
[[52  0]
 [ 4 40]]
2023-09-02 20:44:06,161 - FGO - INFO - Test CM:
[[52  0]
 [ 4 40]]
2023-09-02 20:44:06,166 - FGO - INFO - test statistical parity: 0.3508021390374332
2023-09-02 20:44:06,167 - FGO - INFO - test equal opportunity: 0.11111111111111116
2023-09-02 20:44:06,168 - FGO - INFO - test micro f1: 0.9583333333333334
2023-09-02 20:44:06,169 - FGO - INFO - test macro f1: 0.9576719576719577
2023-09-02 20:44:06,169 - CV - INFO - fold time: 4.4423747062683105s (0.07403957843780518m)
2023-09-02 20:44:06,169 - CV - INFO - ----- BEGINNING FOLD SET (004:1)----------------------------------------------------------
2023-09-02 20:44:06,170 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/004/1
2023-09-02 20:44:06,170 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:06,170 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:06,170 - FGO - INFO - 	done: False
2023-09-02 20:44:06,170 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:06,170 - FGO - INFO - 	h1: 64
2023-09-02 20:44:06,171 - FGO - INFO - 	h2: 32
2023-09-02 20:44:06,171 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:06,171 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:06,171 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:06,171 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:06,171 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:06,171 - FGO - INFO - 	theta: 10
2023-09-02 20:44:06,171 - FGO - INFO - 	clip: 5
2023-09-02 20:44:06,171 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:06,171 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:06,171 - FGO - INFO - Source Total: 727
2023-09-02 20:44:06,171 - FGO - INFO - Target Total: 77
2023-09-02 20:44:06,171 - FGO - INFO - Train Total: 727
2023-09-02 20:44:06,171 - FGO - INFO - Val Total:   77
2023-09-02 20:44:06,171 - FGO - INFO - Test Total:  77
2023-09-02 20:44:06,171 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:06,171 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:06,171 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:06,171 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:06,171 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:06,171 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:06,171 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:06,171 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:06,171 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:06,171 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:06,172 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:06,174 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:06,270 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:06,270 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:06,270 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:06,270 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:06,270 - FGO - INFO - N: 804
2023-09-02 20:44:06,270 - FGO - INFO - N_s: 727
2023-09-02 20:44:06,270 - FGO - INFO - N_t: 77
2023-09-02 20:44:06,273 - CV - INFO - Begin Pretrain
2023-09-02 20:44:06,273 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:06,277 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:44:06,301 - FGO - INFO - Epoch  10 | Train Loss: 0.673 | Val Loss: 0.68 | Val F1: 0.51 |
2023-09-02 20:44:06,326 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.55 |
2023-09-02 20:44:06,351 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:44:06,375 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.55 | Val F1: 0.73 |
2023-09-02 20:44:06,400 - FGO - INFO - Epoch  50 | Train Loss: 0.396 | Val Loss: 0.47 | Val F1: 0.73 |
2023-09-02 20:44:06,425 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.40 | Val F1: 0.81 |
2023-09-02 20:44:06,449 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.34 | Val F1: 0.80 |
2023-09-02 20:44:06,474 - FGO - INFO - Epoch  80 | Train Loss: 0.172 | Val Loss: 0.29 | Val F1: 0.83 |
2023-09-02 20:44:06,498 - FGO - INFO - Epoch  90 | Train Loss: 0.142 | Val Loss: 0.26 | Val F1: 0.87 |
2023-09-02 20:44:06,523 - FGO - INFO - Epoch 100 | Train Loss: 0.122 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:44:06,523 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.147 | Val Loss: 0.27 | Val F1: 0.87 
2023-09-02 20:44:06,523 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:06,524 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:44:06,524 - CV - INFO - Begin OT Train
2023-09-02 20:44:06,524 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:06,613 - FGO - INFO - Epoch   0 | Train Loss: -2.312 | Val Loss: -0.01 | Val F1: 0.87 |
2023-09-02 20:44:07,407 - FGO - INFO - Epoch  10 | Train Loss: -2.413 | Val Loss: -0.05 | Val F1: 0.92 |
2023-09-02 20:44:08,261 - FGO - INFO - Epoch  20 | Train Loss: -2.460 | Val Loss: -0.06 | Val F1: 0.93 |
2023-09-02 20:44:09,108 - FGO - INFO - Epoch  30 | Train Loss: -2.499 | Val Loss: -0.06 | Val F1: 0.92 |
2023-09-02 20:44:09,846 - FGO - INFO - Epoch  40 | Train Loss: -2.531 | Val Loss: -0.06 | Val F1: 0.91 |
2023-09-02 20:44:10,526 - FGO - INFO - Best Epoch:   9 | Train Loss: -2.410 | Val Loss: -0.05 | Val F1: 0.93 |
2023-09-02 20:44:10,526 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:10,529 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:44:10,529 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:10,554 - FGO - INFO - Train CM:
[[378  12]
 [ 17 320]]
2023-09-02 20:44:10,554 - FGO - INFO - Val CM:
[[41  3]
 [ 4 29]]
2023-09-02 20:44:10,555 - FGO - INFO - Test CM:
[[41  3]
 [ 4 29]]
2023-09-02 20:44:10,560 - FGO - INFO - test statistical parity: 0.29487179487179493
2023-09-02 20:44:10,561 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:44:10,562 - FGO - INFO - test micro f1: 0.9090909090909091
2023-09-02 20:44:10,562 - FGO - INFO - test macro f1: 0.9068280034572169
2023-09-02 20:44:10,562 - CV - INFO - fold time: 4.393570184707642s (0.07322616974512736m)
2023-09-02 20:44:10,562 - CV - INFO - ----- BEGINNING FOLD SET (004:2)----------------------------------------------------------
2023-09-02 20:44:10,564 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/004/2
2023-09-02 20:44:10,564 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:10,564 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:10,564 - FGO - INFO - 	done: False
2023-09-02 20:44:10,564 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:10,564 - FGO - INFO - 	h1: 64
2023-09-02 20:44:10,564 - FGO - INFO - 	h2: 32
2023-09-02 20:44:10,564 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:10,564 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:10,564 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:10,564 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:10,564 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:10,564 - FGO - INFO - 	theta: 10
2023-09-02 20:44:10,564 - FGO - INFO - 	clip: 5
2023-09-02 20:44:10,564 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:10,564 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:10,564 - FGO - INFO - Source Total: 721
2023-09-02 20:44:10,564 - FGO - INFO - Target Total: 83
2023-09-02 20:44:10,564 - FGO - INFO - Train Total: 721
2023-09-02 20:44:10,564 - FGO - INFO - Val Total:   83
2023-09-02 20:44:10,564 - FGO - INFO - Test Total:  83
2023-09-02 20:44:10,564 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:10,564 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:10,565 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:10,565 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:10,565 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:10,565 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:10,565 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:10,565 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:10,565 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:10,565 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:10,566 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:10,567 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:10,670 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:10,670 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:10,670 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:10,670 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:10,670 - FGO - INFO - N: 804
2023-09-02 20:44:10,670 - FGO - INFO - N_s: 721
2023-09-02 20:44:10,670 - FGO - INFO - N_t: 83
2023-09-02 20:44:10,673 - CV - INFO - Begin Pretrain
2023-09-02 20:44:10,673 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:10,677 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:44:10,701 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.57 |
2023-09-02 20:44:10,726 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.64 | Val F1: 0.66 |
2023-09-02 20:44:10,751 - FGO - INFO - Epoch  30 | Train Loss: 0.594 | Val Loss: 0.60 | Val F1: 0.76 |
2023-09-02 20:44:10,776 - FGO - INFO - Epoch  40 | Train Loss: 0.506 | Val Loss: 0.52 | Val F1: 0.83 |
2023-09-02 20:44:10,800 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:44:10,825 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.34 | Val F1: 0.85 |
2023-09-02 20:44:10,849 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:44:10,874 - FGO - INFO - Epoch  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:44:10,898 - FGO - INFO - Epoch  90 | Train Loss: 0.140 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:44:10,922 - FGO - INFO - Epoch 100 | Train Loss: 0.119 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:44:10,922 - FGO - INFO - Best Epoch:  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 
2023-09-02 20:44:10,922 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:10,924 - CV - INFO - Pretrain Complete, 80 epochs
2023-09-02 20:44:10,924 - CV - INFO - Begin OT Train
2023-09-02 20:44:10,924 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:10,989 - FGO - INFO - Epoch   0 | Train Loss: -2.394 | Val Loss: -0.04 | Val F1: 0.87 |
2023-09-02 20:44:11,813 - FGO - INFO - Epoch  10 | Train Loss: -2.463 | Val Loss: 0.01 | Val F1: 0.91 |
2023-09-02 20:44:12,629 - FGO - INFO - Epoch  20 | Train Loss: -2.511 | Val Loss: -0.00 | Val F1: 0.91 |
2023-09-02 20:44:13,382 - FGO - INFO - Epoch  30 | Train Loss: -2.547 | Val Loss: -0.00 | Val F1: 0.91 |
2023-09-02 20:44:14,179 - FGO - INFO - Epoch  40 | Train Loss: -2.575 | Val Loss: 0.00 | Val F1: 0.91 |
2023-09-02 20:44:14,889 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.441 | Val Loss: -0.03 | Val F1: 0.91 |
2023-09-02 20:44:14,889 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:14,892 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:44:14,892 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:14,918 - FGO - INFO - Train CM:
[[379   5]
 [ 18 319]]
2023-09-02 20:44:14,919 - FGO - INFO - Val CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:44:14,919 - FGO - INFO - Test CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:44:14,924 - FGO - INFO - test statistical parity: 0.10563380281690143
2023-09-02 20:44:14,925 - FGO - INFO - test equal opportunity: 0.09259259259259256
2023-09-02 20:44:14,926 - FGO - INFO - test micro f1: 0.9156626506024096
2023-09-02 20:44:14,927 - FGO - INFO - test macro f1: 0.9124076586763153
2023-09-02 20:44:14,927 - CV - INFO - fold time: 4.364287853240967s (0.07273813088734944m)
2023-09-02 20:44:14,927 - CV - INFO - ----- BEGINNING FOLD SET (004:3)----------------------------------------------------------
2023-09-02 20:44:14,928 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/004/3
2023-09-02 20:44:14,928 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:14,928 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:14,928 - FGO - INFO - 	done: False
2023-09-02 20:44:14,928 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:14,928 - FGO - INFO - 	h1: 64
2023-09-02 20:44:14,928 - FGO - INFO - 	h2: 32
2023-09-02 20:44:14,928 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:14,928 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:14,928 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:14,928 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:14,928 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:14,928 - FGO - INFO - 	theta: 10
2023-09-02 20:44:14,928 - FGO - INFO - 	clip: 5
2023-09-02 20:44:14,929 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:14,929 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:14,929 - FGO - INFO - Source Total: 729
2023-09-02 20:44:14,929 - FGO - INFO - Target Total: 75
2023-09-02 20:44:14,929 - FGO - INFO - Train Total: 729
2023-09-02 20:44:14,929 - FGO - INFO - Val Total:   75
2023-09-02 20:44:14,929 - FGO - INFO - Test Total:  75
2023-09-02 20:44:14,929 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:14,929 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:14,929 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:14,929 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:14,929 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:14,929 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:14,929 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:14,929 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:14,929 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:14,929 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:14,930 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:14,932 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:15,026 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:15,026 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:15,026 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:15,026 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:15,026 - FGO - INFO - N: 804
2023-09-02 20:44:15,026 - FGO - INFO - N_s: 729
2023-09-02 20:44:15,026 - FGO - INFO - N_t: 75
2023-09-02 20:44:15,029 - CV - INFO - Begin Pretrain
2023-09-02 20:44:15,029 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:15,033 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:44:15,057 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.67 | Val F1: 0.39 |
2023-09-02 20:44:15,082 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.64 |
2023-09-02 20:44:15,106 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.57 | Val F1: 0.86 |
2023-09-02 20:44:15,131 - FGO - INFO - Epoch  40 | Train Loss: 0.510 | Val Loss: 0.47 | Val F1: 0.92 |
2023-09-02 20:44:15,155 - FGO - INFO - Epoch  50 | Train Loss: 0.406 | Val Loss: 0.34 | Val F1: 0.93 |
2023-09-02 20:44:15,180 - FGO - INFO - Epoch  60 | Train Loss: 0.305 | Val Loss: 0.23 | Val F1: 0.97 |
2023-09-02 20:44:15,205 - FGO - INFO - Epoch  70 | Train Loss: 0.231 | Val Loss: 0.16 | Val F1: 0.99 |
2023-09-02 20:44:15,229 - FGO - INFO - Epoch  80 | Train Loss: 0.186 | Val Loss: 0.12 | Val F1: 0.99 |
2023-09-02 20:44:15,254 - FGO - INFO - Epoch  90 | Train Loss: 0.156 | Val Loss: 0.10 | Val F1: 0.99 |
2023-09-02 20:44:15,278 - FGO - INFO - Epoch 100 | Train Loss: 0.135 | Val Loss: 0.09 | Val F1: 0.97 |
2023-09-02 20:44:15,278 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.161 | Val Loss: 0.10 | Val F1: 0.99 
2023-09-02 20:44:15,278 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:15,280 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:44:15,280 - CV - INFO - Begin OT Train
2023-09-02 20:44:15,280 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:15,374 - FGO - INFO - Epoch   0 | Train Loss: -2.235 | Val Loss: -0.18 | Val F1: 0.99 |
2023-09-02 20:44:16,235 - FGO - INFO - Epoch  10 | Train Loss: -2.421 | Val Loss: -0.21 | Val F1: 0.99 |
2023-09-02 20:44:17,095 - FGO - INFO - Epoch  20 | Train Loss: -2.466 | Val Loss: -0.20 | Val F1: 0.99 |
2023-09-02 20:44:17,925 - FGO - INFO - Epoch  30 | Train Loss: -2.500 | Val Loss: -0.22 | Val F1: 0.99 |
2023-09-02 20:44:18,699 - FGO - INFO - Epoch  40 | Train Loss: -2.526 | Val Loss: -0.23 | Val F1: 0.99 |
2023-09-02 20:44:19,370 - FGO - INFO - Best Epoch:   7 | Train Loss: -2.424 | Val Loss: -0.19 | Val F1: 0.99 |
2023-09-02 20:44:19,370 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:19,374 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:44:19,374 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:19,398 - FGO - INFO - Train CM:
[[389   7]
 [ 25 308]]
2023-09-02 20:44:19,399 - FGO - INFO - Val CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:44:19,399 - FGO - INFO - Test CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:44:19,404 - FGO - INFO - test statistical parity: 0.024590163934426257
2023-09-02 20:44:19,405 - FGO - INFO - test equal opportunity: 0.033333333333333326
2023-09-02 20:44:19,406 - FGO - INFO - test micro f1: 0.9866666666666668
2023-09-02 20:44:19,407 - FGO - INFO - test macro f1: 0.9866571784380003
2023-09-02 20:44:19,407 - CV - INFO - fold time: 4.480168342590332s (0.07466947237650554m)
2023-09-02 20:44:19,407 - CV - INFO - ----- BEGINNING FOLD SET (004:4)----------------------------------------------------------
2023-09-02 20:44:19,408 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/004/4
2023-09-02 20:44:19,409 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:19,409 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:19,409 - FGO - INFO - 	done: False
2023-09-02 20:44:19,409 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:19,409 - FGO - INFO - 	h1: 64
2023-09-02 20:44:19,409 - FGO - INFO - 	h2: 32
2023-09-02 20:44:19,409 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:19,409 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:19,409 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:19,409 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:19,409 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:19,409 - FGO - INFO - 	theta: 10
2023-09-02 20:44:19,409 - FGO - INFO - 	clip: 5
2023-09-02 20:44:19,409 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:19,409 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:19,409 - FGO - INFO - Source Total: 732
2023-09-02 20:44:19,409 - FGO - INFO - Target Total: 72
2023-09-02 20:44:19,409 - FGO - INFO - Train Total: 732
2023-09-02 20:44:19,409 - FGO - INFO - Val Total:   72
2023-09-02 20:44:19,409 - FGO - INFO - Test Total:  72
2023-09-02 20:44:19,409 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:19,409 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:19,409 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:19,409 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:19,409 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:19,410 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:19,410 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:19,410 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:19,410 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:19,410 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:19,411 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:19,412 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:19,502 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:19,502 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:19,502 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:19,502 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:19,502 - FGO - INFO - N: 804
2023-09-02 20:44:19,502 - FGO - INFO - N_s: 732
2023-09-02 20:44:19,502 - FGO - INFO - N_t: 72
2023-09-02 20:44:19,506 - CV - INFO - Begin Pretrain
2023-09-02 20:44:19,506 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:19,509 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:44:19,534 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.68 | Val F1: 0.45 |
2023-09-02 20:44:19,558 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.66 | Val F1: 0.63 |
2023-09-02 20:44:19,583 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.60 | Val F1: 0.75 |
2023-09-02 20:44:19,608 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.50 | Val F1: 0.87 |
2023-09-02 20:44:19,632 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.39 | Val F1: 0.89 |
2023-09-02 20:44:19,657 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:44:19,682 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:44:19,706 - FGO - INFO - Epoch  80 | Train Loss: 0.179 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:44:19,731 - FGO - INFO - Epoch  90 | Train Loss: 0.150 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:44:19,755 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:44:19,755 - FGO - INFO - Best Epoch:  81 | Train Loss: 0.175 | Val Loss: 0.16 | Val F1: 0.97 
2023-09-02 20:44:19,755 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:19,757 - CV - INFO - Pretrain Complete, 81 epochs
2023-09-02 20:44:19,757 - CV - INFO - Begin OT Train
2023-09-02 20:44:19,757 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:19,851 - FGO - INFO - Epoch   0 | Train Loss: -2.397 | Val Loss: -0.14 | Val F1: 0.97 |
2023-09-02 20:44:20,687 - FGO - INFO - Epoch  10 | Train Loss: -2.462 | Val Loss: -0.12 | Val F1: 0.96 |
2023-09-02 20:44:21,472 - FGO - INFO - Epoch  20 | Train Loss: -2.510 | Val Loss: -0.14 | Val F1: 0.97 |
2023-09-02 20:44:22,296 - FGO - INFO - Epoch  30 | Train Loss: -2.543 | Val Loss: -0.14 | Val F1: 0.97 |
2023-09-02 20:44:23,126 - FGO - INFO - Epoch  40 | Train Loss: -2.566 | Val Loss: -0.14 | Val F1: 0.97 |
2023-09-02 20:44:23,852 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.437 | Val Loss: -0.14 | Val F1: 0.97 |
2023-09-02 20:44:23,852 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:23,855 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:44:23,855 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:23,881 - FGO - INFO - Train CM:
[[388   9]
 [ 22 313]]
2023-09-02 20:44:23,881 - FGO - INFO - Val CM:
[[37  0]
 [ 2 33]]
2023-09-02 20:44:23,881 - FGO - INFO - Test CM:
[[37  0]
 [ 2 33]]
2023-09-02 20:44:23,887 - FGO - INFO - test statistical parity: 0.06774193548387092
2023-09-02 20:44:23,888 - FGO - INFO - test equal opportunity: 0.16666666666666663
2023-09-02 20:44:23,889 - FGO - INFO - test micro f1: 0.9722222222222222
2023-09-02 20:44:23,889 - FGO - INFO - test macro f1: 0.9721362229102167
2023-09-02 20:44:23,889 - CV - INFO - fold time: 4.4824793338775635s (0.07470798889795939m)
2023-09-02 20:44:23,889 - CV - INFO - ----- BEGINNING FOLD SET (004:5)----------------------------------------------------------
2023-09-02 20:44:23,891 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/004/5
2023-09-02 20:44:23,891 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:23,891 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:23,891 - FGO - INFO - 	done: False
2023-09-02 20:44:23,891 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:23,891 - FGO - INFO - 	h1: 64
2023-09-02 20:44:23,891 - FGO - INFO - 	h2: 32
2023-09-02 20:44:23,891 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:23,891 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:23,891 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:23,891 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:23,891 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:23,891 - FGO - INFO - 	theta: 10
2023-09-02 20:44:23,891 - FGO - INFO - 	clip: 5
2023-09-02 20:44:23,891 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:23,891 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:23,891 - FGO - INFO - Source Total: 726
2023-09-02 20:44:23,891 - FGO - INFO - Target Total: 78
2023-09-02 20:44:23,891 - FGO - INFO - Train Total: 726
2023-09-02 20:44:23,891 - FGO - INFO - Val Total:   78
2023-09-02 20:44:23,891 - FGO - INFO - Test Total:  78
2023-09-02 20:44:23,891 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:23,891 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:23,891 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:23,891 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:23,891 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:23,892 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:23,892 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:23,892 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:23,892 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:23,892 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:23,893 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:23,894 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:23,992 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:23,992 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:23,992 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:23,992 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:23,992 - FGO - INFO - N: 804
2023-09-02 20:44:23,992 - FGO - INFO - N_s: 726
2023-09-02 20:44:23,992 - FGO - INFO - N_t: 78
2023-09-02 20:44:23,995 - CV - INFO - Begin Pretrain
2023-09-02 20:44:23,995 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:23,999 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:44:24,023 - FGO - INFO - Epoch  10 | Train Loss: 0.669 | Val Loss: 0.72 | Val F1: 0.34 |
2023-09-02 20:44:24,048 - FGO - INFO - Epoch  20 | Train Loss: 0.644 | Val Loss: 0.69 | Val F1: 0.42 |
2023-09-02 20:44:24,072 - FGO - INFO - Epoch  30 | Train Loss: 0.591 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:44:24,097 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.53 | Val F1: 0.83 |
2023-09-02 20:44:24,121 - FGO - INFO - Epoch  50 | Train Loss: 0.397 | Val Loss: 0.41 | Val F1: 0.85 |
2023-09-02 20:44:24,146 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:44:24,170 - FGO - INFO - Epoch  70 | Train Loss: 0.220 | Val Loss: 0.27 | Val F1: 0.88 |
2023-09-02 20:44:24,194 - FGO - INFO - Epoch  80 | Train Loss: 0.175 | Val Loss: 0.25 | Val F1: 0.88 |
2023-09-02 20:44:24,219 - FGO - INFO - Epoch  90 | Train Loss: 0.148 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:44:24,243 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.21 | Val F1: 0.91 |
2023-09-02 20:44:24,243 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.209 | Val Loss: 0.26 | Val F1: 0.91 
2023-09-02 20:44:24,243 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:24,244 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:44:24,244 - CV - INFO - Begin OT Train
2023-09-02 20:44:24,244 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:24,310 - FGO - INFO - Epoch   0 | Train Loss: -2.308 | Val Loss: -0.06 | Val F1: 0.91 |
2023-09-02 20:44:25,087 - FGO - INFO - Epoch  10 | Train Loss: -2.435 | Val Loss: -0.02 | Val F1: 0.91 |
2023-09-02 20:44:25,857 - FGO - INFO - Epoch  20 | Train Loss: -2.485 | Val Loss: 0.02 | Val F1: 0.91 |
2023-09-02 20:44:26,626 - FGO - INFO - Epoch  30 | Train Loss: -2.517 | Val Loss: 0.05 | Val F1: 0.87 |
2023-09-02 20:44:27,390 - FGO - INFO - Epoch  40 | Train Loss: -2.543 | Val Loss: 0.05 | Val F1: 0.90 |
2023-09-02 20:44:28,113 - FGO - INFO - Best Epoch:   8 | Train Loss: -2.429 | Val Loss: -0.02 | Val F1: 0.91 |
2023-09-02 20:44:28,113 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:28,117 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:44:28,117 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:28,140 - FGO - INFO - Train CM:
[[393   7]
 [ 24 302]]
2023-09-02 20:44:28,141 - FGO - INFO - Val CM:
[[34  0]
 [ 8 36]]
2023-09-02 20:44:28,141 - FGO - INFO - Test CM:
[[34  0]
 [ 8 36]]
2023-09-02 20:44:28,145 - FGO - INFO - test statistical parity: 0.106280193236715
2023-09-02 20:44:28,147 - FGO - INFO - test equal opportunity: 0.20512820512820518
2023-09-02 20:44:28,148 - FGO - INFO - test micro f1: 0.8974358974358975
2023-09-02 20:44:28,148 - FGO - INFO - test macro f1: 0.8973684210526316
2023-09-02 20:44:28,148 - CV - INFO - fold time: 4.258642673492432s (0.07097737789154053m)
2023-09-02 20:44:28,148 - CV - INFO - ----- BEGINNING FOLD SET (004:6)----------------------------------------------------------
2023-09-02 20:44:28,150 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/004/6
2023-09-02 20:44:28,150 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:28,150 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:28,150 - FGO - INFO - 	done: False
2023-09-02 20:44:28,150 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:28,150 - FGO - INFO - 	h1: 64
2023-09-02 20:44:28,150 - FGO - INFO - 	h2: 32
2023-09-02 20:44:28,150 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:28,150 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:28,150 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:28,150 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:28,150 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:28,150 - FGO - INFO - 	theta: 10
2023-09-02 20:44:28,150 - FGO - INFO - 	clip: 5
2023-09-02 20:44:28,150 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:28,150 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:28,150 - FGO - INFO - Source Total: 717
2023-09-02 20:44:28,150 - FGO - INFO - Target Total: 87
2023-09-02 20:44:28,150 - FGO - INFO - Train Total: 717
2023-09-02 20:44:28,150 - FGO - INFO - Val Total:   87
2023-09-02 20:44:28,150 - FGO - INFO - Test Total:  87
2023-09-02 20:44:28,150 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:28,150 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:28,150 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:28,150 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:28,150 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:28,151 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:28,151 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:28,151 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:28,151 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:28,151 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:28,152 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:28,153 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:28,259 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:28,259 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:28,259 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:28,259 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:28,259 - FGO - INFO - N: 804
2023-09-02 20:44:28,259 - FGO - INFO - N_s: 717
2023-09-02 20:44:28,259 - FGO - INFO - N_t: 87
2023-09-02 20:44:28,263 - CV - INFO - Begin Pretrain
2023-09-02 20:44:28,263 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:28,266 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:44:28,291 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.47 |
2023-09-02 20:44:28,315 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.63 |
2023-09-02 20:44:28,340 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.78 |
2023-09-02 20:44:28,364 - FGO - INFO - Epoch  40 | Train Loss: 0.509 | Val Loss: 0.50 | Val F1: 0.84 |
2023-09-02 20:44:28,389 - FGO - INFO - Epoch  50 | Train Loss: 0.402 | Val Loss: 0.40 | Val F1: 0.86 |
2023-09-02 20:44:28,413 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.31 | Val F1: 0.92 |
2023-09-02 20:44:28,437 - FGO - INFO - Epoch  70 | Train Loss: 0.228 | Val Loss: 0.23 | Val F1: 0.92 |
2023-09-02 20:44:28,462 - FGO - INFO - Epoch  80 | Train Loss: 0.184 | Val Loss: 0.19 | Val F1: 0.93 |
2023-09-02 20:44:28,486 - FGO - INFO - Epoch  90 | Train Loss: 0.154 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:44:28,510 - FGO - INFO - Epoch 100 | Train Loss: 0.134 | Val Loss: 0.14 | Val F1: 0.95 |
2023-09-02 20:44:28,510 - FGO - INFO - Best Epoch:  99 | Train Loss: 0.135 | Val Loss: 0.14 | Val F1: 0.95 
2023-09-02 20:44:28,510 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:28,512 - CV - INFO - Pretrain Complete, 99 epochs
2023-09-02 20:44:28,512 - CV - INFO - Begin OT Train
2023-09-02 20:44:28,512 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:28,576 - FGO - INFO - Epoch   0 | Train Loss: -2.364 | Val Loss: -0.19 | Val F1: 0.95 |
2023-09-02 20:44:29,365 - FGO - INFO - Epoch  10 | Train Loss: -2.421 | Val Loss: -0.19 | Val F1: 0.94 |
2023-09-02 20:44:30,189 - FGO - INFO - Epoch  20 | Train Loss: -2.467 | Val Loss: -0.21 | Val F1: 0.93 |
2023-09-02 20:44:30,950 - FGO - INFO - Epoch  30 | Train Loss: -2.501 | Val Loss: -0.23 | Val F1: 0.94 |
2023-09-02 20:44:31,750 - FGO - INFO - Epoch  40 | Train Loss: -2.524 | Val Loss: -0.24 | Val F1: 0.94 |
2023-09-02 20:44:32,463 - FGO - INFO - Best Epoch:  45 | Train Loss: -2.534 | Val Loss: -0.25 | Val F1: 0.98 |
2023-09-02 20:44:32,463 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:32,466 - CV - INFO - OT Train Complete, 45 epochs
2023-09-02 20:44:32,467 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:32,491 - FGO - INFO - Train CM:
[[377   8]
 [ 25 307]]
2023-09-02 20:44:32,492 - FGO - INFO - Val CM:
[[48  1]
 [ 2 36]]
2023-09-02 20:44:32,492 - FGO - INFO - Test CM:
[[48  1]
 [ 2 36]]
2023-09-02 20:44:32,497 - FGO - INFO - test statistical parity: 0.08227848101265822
2023-09-02 20:44:32,498 - FGO - INFO - test equal opportunity: 0.05882352941176472
2023-09-02 20:44:32,499 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:44:32,500 - FGO - INFO - test macro f1: 0.9648484848484848
2023-09-02 20:44:32,500 - CV - INFO - fold time: 4.351786851882935s (0.07252978086471558m)
2023-09-02 20:44:32,500 - CV - INFO - ----- BEGINNING FOLD SET (004:7)----------------------------------------------------------
2023-09-02 20:44:32,501 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/004/7
2023-09-02 20:44:32,502 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:32,502 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:32,502 - FGO - INFO - 	done: False
2023-09-02 20:44:32,502 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:32,502 - FGO - INFO - 	h1: 64
2023-09-02 20:44:32,502 - FGO - INFO - 	h2: 32
2023-09-02 20:44:32,502 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:32,502 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:32,502 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:32,502 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:32,502 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:32,502 - FGO - INFO - 	theta: 10
2023-09-02 20:44:32,502 - FGO - INFO - 	clip: 5
2023-09-02 20:44:32,502 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:32,502 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:32,502 - FGO - INFO - Source Total: 717
2023-09-02 20:44:32,502 - FGO - INFO - Target Total: 87
2023-09-02 20:44:32,502 - FGO - INFO - Train Total: 717
2023-09-02 20:44:32,502 - FGO - INFO - Val Total:   87
2023-09-02 20:44:32,502 - FGO - INFO - Test Total:  87
2023-09-02 20:44:32,502 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:32,502 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:32,502 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:32,502 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:32,502 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:32,503 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:32,503 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:32,503 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:32,503 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:32,503 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:32,504 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:32,505 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:32,611 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:32,611 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:32,611 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:32,611 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:32,611 - FGO - INFO - N: 804
2023-09-02 20:44:32,611 - FGO - INFO - N_s: 717
2023-09-02 20:44:32,611 - FGO - INFO - N_t: 87
2023-09-02 20:44:32,615 - CV - INFO - Begin Pretrain
2023-09-02 20:44:32,615 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:32,618 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:44:32,643 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.40 |
2023-09-02 20:44:32,668 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.62 |
2023-09-02 20:44:32,692 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.77 |
2023-09-02 20:44:32,717 - FGO - INFO - Epoch  40 | Train Loss: 0.507 | Val Loss: 0.52 | Val F1: 0.88 |
2023-09-02 20:44:32,741 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.41 | Val F1: 0.88 |
2023-09-02 20:44:32,766 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:44:32,790 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.23 | Val F1: 0.94 |
2023-09-02 20:44:32,815 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:44:32,840 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:44:32,864 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:44:32,864 - FGO - INFO - Best Epoch:  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.97 
2023-09-02 20:44:32,864 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:32,866 - CV - INFO - Pretrain Complete, 90 epochs
2023-09-02 20:44:32,866 - CV - INFO - Begin OT Train
2023-09-02 20:44:32,866 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:32,958 - FGO - INFO - Epoch   0 | Train Loss: -2.368 | Val Loss: -0.18 | Val F1: 0.97 |
2023-09-02 20:44:33,797 - FGO - INFO - Epoch  10 | Train Loss: -2.429 | Val Loss: -0.17 | Val F1: 0.95 |
2023-09-02 20:44:34,573 - FGO - INFO - Epoch  20 | Train Loss: -2.480 | Val Loss: -0.19 | Val F1: 0.95 |
2023-09-02 20:44:35,304 - FGO - INFO - Epoch  30 | Train Loss: -2.516 | Val Loss: -0.21 | Val F1: 0.97 |
2023-09-02 20:44:36,078 - FGO - INFO - Epoch  40 | Train Loss: -2.542 | Val Loss: -0.22 | Val F1: 0.98 |
2023-09-02 20:44:36,807 - FGO - INFO - Best Epoch:  34 | Train Loss: -2.528 | Val Loss: -0.22 | Val F1: 0.98 |
2023-09-02 20:44:36,807 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:36,810 - CV - INFO - OT Train Complete, 34 epochs
2023-09-02 20:44:36,810 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:36,835 - FGO - INFO - Train CM:
[[379   8]
 [ 24 306]]
2023-09-02 20:44:36,835 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:44:36,836 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:44:36,841 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:44:36,842 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:44:36,843 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:44:36,844 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:44:36,844 - CV - INFO - fold time: 4.3436689376831055s (0.07239448229471843m)
2023-09-02 20:44:36,844 - CV - INFO - ----- BEGINNING FOLD SET (004:8)----------------------------------------------------------
2023-09-02 20:44:36,845 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/004/8
2023-09-02 20:44:36,845 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:36,845 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:36,845 - FGO - INFO - 	done: False
2023-09-02 20:44:36,845 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:36,845 - FGO - INFO - 	h1: 64
2023-09-02 20:44:36,846 - FGO - INFO - 	h2: 32
2023-09-02 20:44:36,846 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:36,846 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:36,846 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:36,846 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:36,846 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:36,846 - FGO - INFO - 	theta: 10
2023-09-02 20:44:36,846 - FGO - INFO - 	clip: 5
2023-09-02 20:44:36,846 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:36,846 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:36,846 - FGO - INFO - Source Total: 734
2023-09-02 20:44:36,846 - FGO - INFO - Target Total: 70
2023-09-02 20:44:36,846 - FGO - INFO - Train Total: 734
2023-09-02 20:44:36,846 - FGO - INFO - Val Total:   70
2023-09-02 20:44:36,846 - FGO - INFO - Test Total:  70
2023-09-02 20:44:36,846 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:36,846 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:36,846 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:36,846 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:36,846 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:36,846 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:36,846 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:36,846 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:36,846 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:36,846 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:36,847 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:36,849 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:36,937 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:36,937 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:36,937 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:36,937 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:36,937 - FGO - INFO - N: 804
2023-09-02 20:44:36,937 - FGO - INFO - N_s: 734
2023-09-02 20:44:36,937 - FGO - INFO - N_t: 70
2023-09-02 20:44:36,941 - CV - INFO - Begin Pretrain
2023-09-02 20:44:36,941 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:36,944 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:44:36,969 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.69 | Val F1: 0.41 |
2023-09-02 20:44:36,994 - FGO - INFO - Epoch  20 | Train Loss: 0.645 | Val Loss: 0.66 | Val F1: 0.62 |
2023-09-02 20:44:37,019 - FGO - INFO - Epoch  30 | Train Loss: 0.588 | Val Loss: 0.61 | Val F1: 0.76 |
2023-09-02 20:44:37,044 - FGO - INFO - Epoch  40 | Train Loss: 0.498 | Val Loss: 0.53 | Val F1: 0.81 |
2023-09-02 20:44:37,069 - FGO - INFO - Epoch  50 | Train Loss: 0.392 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:44:37,093 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:44:37,118 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.27 | Val F1: 0.86 |
2023-09-02 20:44:37,143 - FGO - INFO - Epoch  80 | Train Loss: 0.181 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:44:37,168 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:44:37,192 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:44:37,192 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.157 | Val Loss: 0.19 | Val F1: 0.94 
2023-09-02 20:44:37,192 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:37,194 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:44:37,194 - CV - INFO - Begin OT Train
2023-09-02 20:44:37,194 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:37,259 - FGO - INFO - Epoch   0 | Train Loss: -2.314 | Val Loss: -0.08 | Val F1: 0.94 |
2023-09-02 20:44:38,119 - FGO - INFO - Epoch  10 | Train Loss: -2.429 | Val Loss: -0.06 | Val F1: 0.91 |
2023-09-02 20:44:38,865 - FGO - INFO - Epoch  20 | Train Loss: -2.472 | Val Loss: -0.05 | Val F1: 0.91 |
2023-09-02 20:44:39,629 - FGO - INFO - Epoch  30 | Train Loss: -2.509 | Val Loss: -0.02 | Val F1: 0.91 |
2023-09-02 20:44:40,433 - FGO - INFO - Epoch  40 | Train Loss: -2.536 | Val Loss: -0.02 | Val F1: 0.91 |
2023-09-02 20:44:41,180 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.418 | Val Loss: -0.04 | Val F1: 0.91 |
2023-09-02 20:44:41,180 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:41,184 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:44:41,184 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:41,209 - FGO - INFO - Train CM:
[[394   6]
 [ 33 301]]
2023-09-02 20:44:41,209 - FGO - INFO - Val CM:
[[34  0]
 [ 6 30]]
2023-09-02 20:44:41,210 - FGO - INFO - Test CM:
[[34  0]
 [ 6 30]]
2023-09-02 20:44:41,215 - FGO - INFO - test statistical parity: 0.053981106612685514
2023-09-02 20:44:41,216 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:44:41,217 - FGO - INFO - test micro f1: 0.9142857142857143
2023-09-02 20:44:41,217 - FGO - INFO - test macro f1: 0.914004914004914
2023-09-02 20:44:41,217 - CV - INFO - fold time: 4.373730421066284s (0.07289550701777141m)
2023-09-02 20:44:41,217 - CV - INFO - ----- BEGINNING FOLD SET (004:9)----------------------------------------------------------
2023-09-02 20:44:41,219 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/004/9
2023-09-02 20:44:41,219 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:41,219 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:41,219 - FGO - INFO - 	done: False
2023-09-02 20:44:41,219 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:41,219 - FGO - INFO - 	h1: 64
2023-09-02 20:44:41,219 - FGO - INFO - 	h2: 32
2023-09-02 20:44:41,219 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:41,219 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:41,219 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:41,219 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:41,219 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:41,219 - FGO - INFO - 	theta: 10
2023-09-02 20:44:41,219 - FGO - INFO - 	clip: 5
2023-09-02 20:44:41,219 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:41,219 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:41,219 - FGO - INFO - Source Total: 725
2023-09-02 20:44:41,219 - FGO - INFO - Target Total: 79
2023-09-02 20:44:41,219 - FGO - INFO - Train Total: 725
2023-09-02 20:44:41,219 - FGO - INFO - Val Total:   79
2023-09-02 20:44:41,219 - FGO - INFO - Test Total:  79
2023-09-02 20:44:41,219 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:41,219 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:41,219 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:41,219 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:41,219 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:41,220 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:41,220 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:41,220 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:41,220 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:41,220 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:41,221 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:41,222 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:41,321 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:41,321 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:41,321 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:41,321 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:41,321 - FGO - INFO - N: 804
2023-09-02 20:44:41,321 - FGO - INFO - N_s: 725
2023-09-02 20:44:41,321 - FGO - INFO - N_t: 79
2023-09-02 20:44:41,325 - CV - INFO - Begin Pretrain
2023-09-02 20:44:41,325 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:41,328 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:44:41,353 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.50 |
2023-09-02 20:44:41,378 - FGO - INFO - Epoch  20 | Train Loss: 0.648 | Val Loss: 0.65 | Val F1: 0.59 |
2023-09-02 20:44:41,402 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.61 | Val F1: 0.69 |
2023-09-02 20:44:41,427 - FGO - INFO - Epoch  40 | Train Loss: 0.504 | Val Loss: 0.54 | Val F1: 0.78 |
2023-09-02 20:44:41,451 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:44:41,476 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.34 | Val F1: 0.90 |
2023-09-02 20:44:41,500 - FGO - INFO - Epoch  70 | Train Loss: 0.227 | Val Loss: 0.26 | Val F1: 0.92 |
2023-09-02 20:44:41,524 - FGO - INFO - Epoch  80 | Train Loss: 0.182 | Val Loss: 0.21 | Val F1: 0.96 |
2023-09-02 20:44:41,549 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:44:41,573 - FGO - INFO - Epoch 100 | Train Loss: 0.133 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:44:41,573 - FGO - INFO - Best Epoch:  85 | Train Loss: 0.165 | Val Loss: 0.19 | Val F1: 0.97 
2023-09-02 20:44:41,573 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:41,575 - CV - INFO - Pretrain Complete, 85 epochs
2023-09-02 20:44:41,575 - CV - INFO - Begin OT Train
2023-09-02 20:44:41,575 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:41,668 - FGO - INFO - Epoch   0 | Train Loss: -2.354 | Val Loss: -0.12 | Val F1: 0.96 |
2023-09-02 20:44:42,427 - FGO - INFO - Epoch  10 | Train Loss: -2.410 | Val Loss: -0.12 | Val F1: 0.96 |
2023-09-02 20:44:43,253 - FGO - INFO - Epoch  20 | Train Loss: -2.461 | Val Loss: -0.15 | Val F1: 0.96 |
2023-09-02 20:44:44,021 - FGO - INFO - Epoch  30 | Train Loss: -2.501 | Val Loss: -0.17 | Val F1: 0.96 |
2023-09-02 20:44:44,842 - FGO - INFO - Epoch  40 | Train Loss: -2.529 | Val Loss: -0.18 | Val F1: 0.96 |
2023-09-02 20:44:45,547 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.389 | Val Loss: -0.13 | Val F1: 0.96 |
2023-09-02 20:44:45,547 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:45,550 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:44:45,551 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:45,578 - FGO - INFO - Train CM:
[[377   8]
 [ 25 315]]
2023-09-02 20:44:45,578 - FGO - INFO - Val CM:
[[47  2]
 [ 1 29]]
2023-09-02 20:44:45,579 - FGO - INFO - Test CM:
[[47  2]
 [ 1 29]]
2023-09-02 20:44:45,584 - FGO - INFO - test statistical parity: 0.008695652173913049
2023-09-02 20:44:45,585 - FGO - INFO - test equal opportunity: 0.038461538461538436
2023-09-02 20:44:45,586 - FGO - INFO - test micro f1: 0.9620253164556962
2023-09-02 20:44:45,587 - FGO - INFO - test macro f1: 0.9599459185398006
2023-09-02 20:44:45,587 - CV - INFO - fold time: 4.369328260421753s (0.07282213767369589m)
2023-09-02 20:44:45,587 - CV - INFO - Mean Pretrain Epochs 85.7:
2023-09-02 20:44:45,587 - CV - INFO - Mean OT Train Epochs 13.5:
2023-09-02 20:44:45,587 - CV - INFO - Mean Val Macro F1 : 0.9437091944143174
2023-09-02 20:44:45,587 - CV - INFO - Mean Eval Stat : 0.9437091944143174 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:44:45,587 - CV - INFO - set time: 43.860551834106445s (0.7310091972351074m)
2023-09-02 20:44:45,587 - CV - INFO - script time so far: 183.53792071342468s (3.058965345223745m) (0.050982755753729084h)
2023-09-02 20:44:45,587 - CV - INFO - ===== BEGINNING OPTION SET (005)==========================================================
2023-09-02 20:44:45,587 - CV - INFO - 	done: False
2023-09-02 20:44:45,587 - CV - INFO - 	learning_rate: 0.001
2023-09-02 20:44:45,587 - CV - INFO - 	h1: 64
2023-09-02 20:44:45,587 - CV - INFO - 	h2: 32
2023-09-02 20:44:45,587 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:45,587 - CV - INFO - 	dropout: 0.0
2023-09-02 20:44:45,587 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:45,587 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:45,587 - CV - INFO - 	lambda: 0.03
2023-09-02 20:44:45,587 - CV - INFO - 	theta: 30
2023-09-02 20:44:45,587 - CV - INFO - 	clip: 5
2023-09-02 20:44:45,587 - CV - INFO - ----- BEGINNING FOLD SET (005:0)----------------------------------------------------------
2023-09-02 20:44:45,589 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/005/0
2023-09-02 20:44:45,589 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:45,589 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:45,589 - FGO - INFO - 	done: False
2023-09-02 20:44:45,589 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:45,589 - FGO - INFO - 	h1: 64
2023-09-02 20:44:45,589 - FGO - INFO - 	h2: 32
2023-09-02 20:44:45,589 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:45,589 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:45,589 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:45,589 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:45,589 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:45,589 - FGO - INFO - 	theta: 30
2023-09-02 20:44:45,589 - FGO - INFO - 	clip: 5
2023-09-02 20:44:45,589 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:45,589 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:45,589 - FGO - INFO - Source Total: 708
2023-09-02 20:44:45,589 - FGO - INFO - Target Total: 96
2023-09-02 20:44:45,589 - FGO - INFO - Train Total: 708
2023-09-02 20:44:45,589 - FGO - INFO - Val Total:   96
2023-09-02 20:44:45,589 - FGO - INFO - Test Total:  96
2023-09-02 20:44:45,589 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:45,589 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:45,589 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:45,589 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:45,589 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:45,590 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:45,590 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:45,590 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:45,590 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:45,590 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:45,591 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:45,592 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:45,708 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:45,708 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:45,708 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:45,708 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:45,708 - FGO - INFO - N: 804
2023-09-02 20:44:45,708 - FGO - INFO - N_s: 708
2023-09-02 20:44:45,708 - FGO - INFO - N_t: 96
2023-09-02 20:44:45,711 - CV - INFO - Begin Pretrain
2023-09-02 20:44:45,711 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:45,714 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:44:45,739 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:44:45,763 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.53 |
2023-09-02 20:44:45,788 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.61 | Val F1: 0.67 |
2023-09-02 20:44:45,812 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.52 | Val F1: 0.86 |
2023-09-02 20:44:45,836 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.41 | Val F1: 0.89 |
2023-09-02 20:44:45,860 - FGO - INFO - Epoch  60 | Train Loss: 0.298 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:44:45,885 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:44:45,909 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:44:45,933 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:44:45,957 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:44:45,957 - FGO - INFO - Best Epoch:  86 | Train Loss: 0.161 | Val Loss: 0.18 | Val F1: 0.95 
2023-09-02 20:44:45,957 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:45,959 - CV - INFO - Pretrain Complete, 86 epochs
2023-09-02 20:44:45,959 - CV - INFO - Begin OT Train
2023-09-02 20:44:45,959 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:46,052 - FGO - INFO - Epoch   0 | Train Loss: -7.530 | Val Loss: -0.93 | Val F1: 0.95 |
2023-09-02 20:44:46,783 - FGO - INFO - Epoch  10 | Train Loss: -7.749 | Val Loss: -0.98 | Val F1: 0.98 |
2023-09-02 20:44:47,522 - FGO - INFO - Epoch  20 | Train Loss: -7.906 | Val Loss: -0.99 | Val F1: 0.95 |
2023-09-02 20:44:48,264 - FGO - INFO - Epoch  30 | Train Loss: -7.980 | Val Loss: -0.97 | Val F1: 0.91 |
2023-09-02 20:44:49,056 - FGO - INFO - Epoch  40 | Train Loss: -8.013 | Val Loss: -0.98 | Val F1: 0.91 |
2023-09-02 20:44:49,700 - FGO - INFO - Best Epoch:   8 | Train Loss: -7.710 | Val Loss: -0.97 | Val F1: 0.98 |
2023-09-02 20:44:49,700 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:49,702 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:44:49,703 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:49,728 - FGO - INFO - Train CM:
[[378   4]
 [ 59 267]]
2023-09-02 20:44:49,728 - FGO - INFO - Val CM:
[[52  0]
 [ 7 37]]
2023-09-02 20:44:49,728 - FGO - INFO - Test CM:
[[52  0]
 [ 7 37]]
2023-09-02 20:44:49,733 - FGO - INFO - test statistical parity: 0.18074866310160426
2023-09-02 20:44:49,735 - FGO - INFO - test equal opportunity: 0.11111111111111116
2023-09-02 20:44:49,736 - FGO - INFO - test micro f1: 0.9270833333333334
2023-09-02 20:44:49,736 - FGO - INFO - test macro f1: 0.9252585919252587
2023-09-02 20:44:49,736 - CV - INFO - fold time: 4.1490936279296875s (0.0691515604654948m)
2023-09-02 20:44:49,736 - CV - INFO - ----- BEGINNING FOLD SET (005:1)----------------------------------------------------------
2023-09-02 20:44:49,738 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/005/1
2023-09-02 20:44:49,738 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:49,738 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:49,738 - FGO - INFO - 	done: False
2023-09-02 20:44:49,738 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:49,738 - FGO - INFO - 	h1: 64
2023-09-02 20:44:49,738 - FGO - INFO - 	h2: 32
2023-09-02 20:44:49,738 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:49,738 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:49,738 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:49,738 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:49,738 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:49,738 - FGO - INFO - 	theta: 30
2023-09-02 20:44:49,738 - FGO - INFO - 	clip: 5
2023-09-02 20:44:49,738 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:49,738 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:49,738 - FGO - INFO - Source Total: 727
2023-09-02 20:44:49,738 - FGO - INFO - Target Total: 77
2023-09-02 20:44:49,738 - FGO - INFO - Train Total: 727
2023-09-02 20:44:49,738 - FGO - INFO - Val Total:   77
2023-09-02 20:44:49,738 - FGO - INFO - Test Total:  77
2023-09-02 20:44:49,738 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:49,738 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:49,738 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:49,738 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:49,738 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:49,739 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:49,739 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:49,739 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:49,739 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:49,739 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:49,740 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:49,741 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:49,837 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:49,837 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:49,837 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:49,837 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:49,837 - FGO - INFO - N: 804
2023-09-02 20:44:49,837 - FGO - INFO - N_s: 727
2023-09-02 20:44:49,837 - FGO - INFO - N_t: 77
2023-09-02 20:44:49,841 - CV - INFO - Begin Pretrain
2023-09-02 20:44:49,841 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:49,844 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:44:49,868 - FGO - INFO - Epoch  10 | Train Loss: 0.673 | Val Loss: 0.68 | Val F1: 0.51 |
2023-09-02 20:44:49,893 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.55 |
2023-09-02 20:44:49,918 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:44:49,942 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.55 | Val F1: 0.73 |
2023-09-02 20:44:49,967 - FGO - INFO - Epoch  50 | Train Loss: 0.396 | Val Loss: 0.47 | Val F1: 0.73 |
2023-09-02 20:44:49,991 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.40 | Val F1: 0.81 |
2023-09-02 20:44:50,016 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.34 | Val F1: 0.80 |
2023-09-02 20:44:50,040 - FGO - INFO - Epoch  80 | Train Loss: 0.172 | Val Loss: 0.29 | Val F1: 0.83 |
2023-09-02 20:44:50,065 - FGO - INFO - Epoch  90 | Train Loss: 0.142 | Val Loss: 0.26 | Val F1: 0.87 |
2023-09-02 20:44:50,089 - FGO - INFO - Epoch 100 | Train Loss: 0.122 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:44:50,089 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.147 | Val Loss: 0.27 | Val F1: 0.87 
2023-09-02 20:44:50,089 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:50,091 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:44:50,091 - CV - INFO - Begin OT Train
2023-09-02 20:44:50,091 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:50,186 - FGO - INFO - Epoch   0 | Train Loss: -7.536 | Val Loss: -0.54 | Val F1: 0.87 |
2023-09-02 20:44:50,984 - FGO - INFO - Epoch  10 | Train Loss: -7.778 | Val Loss: -0.59 | Val F1: 0.92 |
2023-09-02 20:44:51,760 - FGO - INFO - Epoch  20 | Train Loss: -7.957 | Val Loss: -0.60 | Val F1: 0.92 |
2023-09-02 20:44:52,582 - FGO - INFO - Epoch  30 | Train Loss: -8.063 | Val Loss: -0.60 | Val F1: 0.91 |
2023-09-02 20:44:53,317 - FGO - INFO - Epoch  40 | Train Loss: -8.113 | Val Loss: -0.59 | Val F1: 0.89 |
2023-09-02 20:44:54,038 - FGO - INFO - Best Epoch:  17 | Train Loss: -7.906 | Val Loss: -0.60 | Val F1: 0.93 |
2023-09-02 20:44:54,038 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:54,042 - CV - INFO - OT Train Complete, 17 epochs
2023-09-02 20:44:54,042 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:54,066 - FGO - INFO - Train CM:
[[374  16]
 [ 44 293]]
2023-09-02 20:44:54,066 - FGO - INFO - Val CM:
[[40  4]
 [ 5 28]]
2023-09-02 20:44:54,067 - FGO - INFO - Test CM:
[[40  4]
 [ 5 28]]
2023-09-02 20:44:54,072 - FGO - INFO - test statistical parity: 0.29487179487179493
2023-09-02 20:44:54,073 - FGO - INFO - test equal opportunity: 0.3709677419354839
2023-09-02 20:44:54,074 - FGO - INFO - test micro f1: 0.8831168831168831
2023-09-02 20:44:54,074 - FGO - INFO - test macro f1: 0.8802074330164217
2023-09-02 20:44:54,074 - CV - INFO - fold time: 4.338295221328735s (0.07230492035547892m)
2023-09-02 20:44:54,074 - CV - INFO - ----- BEGINNING FOLD SET (005:2)----------------------------------------------------------
2023-09-02 20:44:54,076 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/005/2
2023-09-02 20:44:54,076 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:54,076 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:54,076 - FGO - INFO - 	done: False
2023-09-02 20:44:54,076 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:54,076 - FGO - INFO - 	h1: 64
2023-09-02 20:44:54,076 - FGO - INFO - 	h2: 32
2023-09-02 20:44:54,076 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:54,076 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:54,076 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:54,076 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:54,076 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:54,076 - FGO - INFO - 	theta: 30
2023-09-02 20:44:54,076 - FGO - INFO - 	clip: 5
2023-09-02 20:44:54,076 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:54,076 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:54,076 - FGO - INFO - Source Total: 721
2023-09-02 20:44:54,076 - FGO - INFO - Target Total: 83
2023-09-02 20:44:54,076 - FGO - INFO - Train Total: 721
2023-09-02 20:44:54,076 - FGO - INFO - Val Total:   83
2023-09-02 20:44:54,076 - FGO - INFO - Test Total:  83
2023-09-02 20:44:54,076 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:54,076 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:54,076 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:54,076 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:54,076 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:54,077 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:54,077 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:54,077 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:54,077 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:54,077 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:54,078 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:54,079 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:54,182 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:54,182 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:54,182 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:54,182 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:54,182 - FGO - INFO - N: 804
2023-09-02 20:44:54,182 - FGO - INFO - N_s: 721
2023-09-02 20:44:54,182 - FGO - INFO - N_t: 83
2023-09-02 20:44:54,185 - CV - INFO - Begin Pretrain
2023-09-02 20:44:54,185 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:54,189 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:44:54,213 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.57 |
2023-09-02 20:44:54,238 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.64 | Val F1: 0.66 |
2023-09-02 20:44:54,262 - FGO - INFO - Epoch  30 | Train Loss: 0.594 | Val Loss: 0.60 | Val F1: 0.76 |
2023-09-02 20:44:54,287 - FGO - INFO - Epoch  40 | Train Loss: 0.506 | Val Loss: 0.52 | Val F1: 0.83 |
2023-09-02 20:44:54,311 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:44:54,335 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.34 | Val F1: 0.85 |
2023-09-02 20:44:54,360 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:44:54,384 - FGO - INFO - Epoch  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:44:54,409 - FGO - INFO - Epoch  90 | Train Loss: 0.140 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:44:54,433 - FGO - INFO - Epoch 100 | Train Loss: 0.119 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:44:54,433 - FGO - INFO - Best Epoch:  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 
2023-09-02 20:44:54,433 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:54,434 - CV - INFO - Pretrain Complete, 80 epochs
2023-09-02 20:44:54,435 - CV - INFO - Begin OT Train
2023-09-02 20:44:54,435 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:54,500 - FGO - INFO - Epoch   0 | Train Loss: -7.631 | Val Loss: -0.60 | Val F1: 0.87 |
2023-09-02 20:44:55,278 - FGO - INFO - Epoch  10 | Train Loss: -7.866 | Val Loss: -0.61 | Val F1: 0.91 |
2023-09-02 20:44:56,072 - FGO - INFO - Epoch  20 | Train Loss: -8.032 | Val Loss: -0.63 | Val F1: 0.90 |
2023-09-02 20:44:56,825 - FGO - INFO - Epoch  30 | Train Loss: -8.119 | Val Loss: -0.63 | Val F1: 0.90 |
2023-09-02 20:44:57,587 - FGO - INFO - Epoch  40 | Train Loss: -8.159 | Val Loss: -0.61 | Val F1: 0.89 |
2023-09-02 20:44:58,319 - FGO - INFO - Best Epoch:  10 | Train Loss: -7.866 | Val Loss: -0.61 | Val F1: 0.91 |
2023-09-02 20:44:58,320 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:58,322 - CV - INFO - OT Train Complete, 10 epochs
2023-09-02 20:44:58,323 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:44:58,348 - FGO - INFO - Train CM:
[[379   5]
 [ 43 294]]
2023-09-02 20:44:58,348 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:44:58,348 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:44:58,354 - FGO - INFO - test statistical parity: 0.11971830985915494
2023-09-02 20:44:58,355 - FGO - INFO - test equal opportunity: 0.05555555555555547
2023-09-02 20:44:58,356 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:44:58,356 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:44:58,356 - CV - INFO - fold time: 4.281813621520996s (0.07136356035868327m)
2023-09-02 20:44:58,356 - CV - INFO - ----- BEGINNING FOLD SET (005:3)----------------------------------------------------------
2023-09-02 20:44:58,358 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/005/3
2023-09-02 20:44:58,358 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:44:58,358 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:44:58,358 - FGO - INFO - 	done: False
2023-09-02 20:44:58,358 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:44:58,358 - FGO - INFO - 	h1: 64
2023-09-02 20:44:58,358 - FGO - INFO - 	h2: 32
2023-09-02 20:44:58,358 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:44:58,358 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:44:58,358 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:44:58,358 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:44:58,358 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:44:58,358 - FGO - INFO - 	theta: 30
2023-09-02 20:44:58,358 - FGO - INFO - 	clip: 5
2023-09-02 20:44:58,358 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:44:58,358 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:44:58,358 - FGO - INFO - Source Total: 729
2023-09-02 20:44:58,358 - FGO - INFO - Target Total: 75
2023-09-02 20:44:58,358 - FGO - INFO - Train Total: 729
2023-09-02 20:44:58,358 - FGO - INFO - Val Total:   75
2023-09-02 20:44:58,358 - FGO - INFO - Test Total:  75
2023-09-02 20:44:58,358 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:44:58,358 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:44:58,358 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:44:58,358 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:44:58,358 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:44:58,359 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:44:58,359 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:44:58,359 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:44:58,359 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:44:58,359 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:44:58,360 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:44:58,361 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:44:58,455 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:44:58,455 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:44:58,455 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:44:58,455 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:44:58,455 - FGO - INFO - N: 804
2023-09-02 20:44:58,455 - FGO - INFO - N_s: 729
2023-09-02 20:44:58,455 - FGO - INFO - N_t: 75
2023-09-02 20:44:58,458 - CV - INFO - Begin Pretrain
2023-09-02 20:44:58,458 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:44:58,462 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:44:58,486 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.67 | Val F1: 0.39 |
2023-09-02 20:44:58,511 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.64 |
2023-09-02 20:44:58,536 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.57 | Val F1: 0.86 |
2023-09-02 20:44:58,560 - FGO - INFO - Epoch  40 | Train Loss: 0.510 | Val Loss: 0.47 | Val F1: 0.92 |
2023-09-02 20:44:58,585 - FGO - INFO - Epoch  50 | Train Loss: 0.406 | Val Loss: 0.34 | Val F1: 0.93 |
2023-09-02 20:44:58,609 - FGO - INFO - Epoch  60 | Train Loss: 0.305 | Val Loss: 0.23 | Val F1: 0.97 |
2023-09-02 20:44:58,634 - FGO - INFO - Epoch  70 | Train Loss: 0.231 | Val Loss: 0.16 | Val F1: 0.99 |
2023-09-02 20:44:58,658 - FGO - INFO - Epoch  80 | Train Loss: 0.186 | Val Loss: 0.12 | Val F1: 0.99 |
2023-09-02 20:44:58,683 - FGO - INFO - Epoch  90 | Train Loss: 0.156 | Val Loss: 0.10 | Val F1: 0.99 |
2023-09-02 20:44:58,707 - FGO - INFO - Epoch 100 | Train Loss: 0.135 | Val Loss: 0.09 | Val F1: 0.97 |
2023-09-02 20:44:58,707 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.161 | Val Loss: 0.10 | Val F1: 0.99 
2023-09-02 20:44:58,707 - FGO - INFO - Setting model to best state.
2023-09-02 20:44:58,709 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:44:58,709 - CV - INFO - Begin OT Train
2023-09-02 20:44:58,709 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:44:58,774 - FGO - INFO - Epoch   0 | Train Loss: -7.419 | Val Loss: -0.72 | Val F1: 0.99 |
2023-09-02 20:44:59,548 - FGO - INFO - Epoch  10 | Train Loss: -7.742 | Val Loss: -0.75 | Val F1: 0.99 |
2023-09-02 20:45:00,348 - FGO - INFO - Epoch  20 | Train Loss: -7.909 | Val Loss: -0.74 | Val F1: 0.95 |
2023-09-02 20:45:01,124 - FGO - INFO - Epoch  30 | Train Loss: -8.022 | Val Loss: -0.76 | Val F1: 0.95 |
2023-09-02 20:45:01,891 - FGO - INFO - Epoch  40 | Train Loss: -8.076 | Val Loss: -0.76 | Val F1: 0.95 |
2023-09-02 20:45:02,540 - FGO - INFO - Best Epoch:   7 | Train Loss: -7.689 | Val Loss: -0.72 | Val F1: 0.99 |
2023-09-02 20:45:02,540 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:02,543 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:45:02,543 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:02,567 - FGO - INFO - Train CM:
[[394   2]
 [ 57 276]]
2023-09-02 20:45:02,568 - FGO - INFO - Val CM:
[[38  0]
 [ 4 33]]
2023-09-02 20:45:02,568 - FGO - INFO - Test CM:
[[38  0]
 [ 4 33]]
2023-09-02 20:45:02,573 - FGO - INFO - test statistical parity: 0.10187353629976581
2023-09-02 20:45:02,575 - FGO - INFO - test equal opportunity: 0.21904761904761905
2023-09-02 20:45:02,576 - FGO - INFO - test micro f1: 0.9466666666666667
2023-09-02 20:45:02,576 - FGO - INFO - test macro f1: 0.9464285714285714
2023-09-02 20:45:02,576 - CV - INFO - fold time: 4.2196900844573975s (0.07032816807428996m)
2023-09-02 20:45:02,576 - CV - INFO - ----- BEGINNING FOLD SET (005:4)----------------------------------------------------------
2023-09-02 20:45:02,577 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/005/4
2023-09-02 20:45:02,578 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:02,578 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:02,578 - FGO - INFO - 	done: False
2023-09-02 20:45:02,578 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:02,578 - FGO - INFO - 	h1: 64
2023-09-02 20:45:02,578 - FGO - INFO - 	h2: 32
2023-09-02 20:45:02,578 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:02,578 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:02,578 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:02,578 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:02,578 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:02,578 - FGO - INFO - 	theta: 30
2023-09-02 20:45:02,578 - FGO - INFO - 	clip: 5
2023-09-02 20:45:02,578 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:02,578 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:02,578 - FGO - INFO - Source Total: 732
2023-09-02 20:45:02,578 - FGO - INFO - Target Total: 72
2023-09-02 20:45:02,578 - FGO - INFO - Train Total: 732
2023-09-02 20:45:02,578 - FGO - INFO - Val Total:   72
2023-09-02 20:45:02,578 - FGO - INFO - Test Total:  72
2023-09-02 20:45:02,578 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:02,578 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:02,578 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:02,578 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:02,578 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:02,579 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:02,579 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:02,579 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:02,579 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:02,579 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:02,580 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:02,581 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:02,671 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:02,671 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:02,671 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:02,671 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:02,671 - FGO - INFO - N: 804
2023-09-02 20:45:02,671 - FGO - INFO - N_s: 732
2023-09-02 20:45:02,671 - FGO - INFO - N_t: 72
2023-09-02 20:45:02,675 - CV - INFO - Begin Pretrain
2023-09-02 20:45:02,675 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:02,678 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:45:02,703 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.68 | Val F1: 0.45 |
2023-09-02 20:45:02,728 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.66 | Val F1: 0.63 |
2023-09-02 20:45:02,752 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.60 | Val F1: 0.75 |
2023-09-02 20:45:02,777 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.50 | Val F1: 0.87 |
2023-09-02 20:45:02,802 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.39 | Val F1: 0.89 |
2023-09-02 20:45:02,826 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:45:02,851 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:45:02,876 - FGO - INFO - Epoch  80 | Train Loss: 0.179 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:45:02,900 - FGO - INFO - Epoch  90 | Train Loss: 0.150 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:45:02,925 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:45:02,925 - FGO - INFO - Best Epoch:  81 | Train Loss: 0.175 | Val Loss: 0.16 | Val F1: 0.97 
2023-09-02 20:45:02,925 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:02,926 - CV - INFO - Pretrain Complete, 81 epochs
2023-09-02 20:45:02,926 - CV - INFO - Begin OT Train
2023-09-02 20:45:02,926 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:02,992 - FGO - INFO - Epoch   0 | Train Loss: -7.594 | Val Loss: -0.67 | Val F1: 0.97 |
2023-09-02 20:45:03,800 - FGO - INFO - Epoch  10 | Train Loss: -7.838 | Val Loss: -0.67 | Val F1: 0.94 |
2023-09-02 20:45:04,583 - FGO - INFO - Epoch  20 | Train Loss: -8.001 | Val Loss: -0.68 | Val F1: 0.94 |
2023-09-02 20:45:05,355 - FGO - INFO - Epoch  30 | Train Loss: -8.079 | Val Loss: -0.67 | Val F1: 0.92 |
2023-09-02 20:45:06,110 - FGO - INFO - Epoch  40 | Train Loss: -8.117 | Val Loss: -0.67 | Val F1: 0.93 |
2023-09-02 20:45:06,812 - FGO - INFO - Best Epoch:   6 | Train Loss: -7.746 | Val Loss: -0.68 | Val F1: 0.97 |
2023-09-02 20:45:06,812 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:06,816 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:45:06,816 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:06,849 - FGO - INFO - Train CM:
[[396   1]
 [ 48 287]]
2023-09-02 20:45:06,849 - FGO - INFO - Val CM:
[[37  0]
 [ 5 30]]
2023-09-02 20:45:06,849 - FGO - INFO - Test CM:
[[37  0]
 [ 5 30]]
2023-09-02 20:45:06,854 - FGO - INFO - test statistical parity: 0.019354838709677413
2023-09-02 20:45:06,855 - FGO - INFO - test equal opportunity: 0.06666666666666665
2023-09-02 20:45:06,856 - FGO - INFO - test micro f1: 0.9305555555555556
2023-09-02 20:45:06,857 - FGO - INFO - test macro f1: 0.9298928919182083
2023-09-02 20:45:06,857 - CV - INFO - fold time: 4.280600547790527s (0.07134334246317546m)
2023-09-02 20:45:06,857 - CV - INFO - ----- BEGINNING FOLD SET (005:5)----------------------------------------------------------
2023-09-02 20:45:06,858 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/005/5
2023-09-02 20:45:06,858 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:06,858 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:06,858 - FGO - INFO - 	done: False
2023-09-02 20:45:06,858 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:06,858 - FGO - INFO - 	h1: 64
2023-09-02 20:45:06,858 - FGO - INFO - 	h2: 32
2023-09-02 20:45:06,858 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:06,858 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:06,858 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:06,858 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:06,859 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:06,859 - FGO - INFO - 	theta: 30
2023-09-02 20:45:06,859 - FGO - INFO - 	clip: 5
2023-09-02 20:45:06,859 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:06,859 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:06,859 - FGO - INFO - Source Total: 726
2023-09-02 20:45:06,859 - FGO - INFO - Target Total: 78
2023-09-02 20:45:06,859 - FGO - INFO - Train Total: 726
2023-09-02 20:45:06,859 - FGO - INFO - Val Total:   78
2023-09-02 20:45:06,859 - FGO - INFO - Test Total:  78
2023-09-02 20:45:06,859 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:06,859 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:06,859 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:06,859 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:06,859 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:06,859 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:06,859 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:06,859 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:06,859 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:06,859 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:06,860 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:06,862 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:06,958 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:06,958 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:06,959 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:06,959 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:06,959 - FGO - INFO - N: 804
2023-09-02 20:45:06,959 - FGO - INFO - N_s: 726
2023-09-02 20:45:06,959 - FGO - INFO - N_t: 78
2023-09-02 20:45:06,962 - CV - INFO - Begin Pretrain
2023-09-02 20:45:06,962 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:06,965 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:45:06,990 - FGO - INFO - Epoch  10 | Train Loss: 0.669 | Val Loss: 0.72 | Val F1: 0.34 |
2023-09-02 20:45:07,014 - FGO - INFO - Epoch  20 | Train Loss: 0.644 | Val Loss: 0.69 | Val F1: 0.42 |
2023-09-02 20:45:07,039 - FGO - INFO - Epoch  30 | Train Loss: 0.591 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:45:07,064 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.53 | Val F1: 0.83 |
2023-09-02 20:45:07,088 - FGO - INFO - Epoch  50 | Train Loss: 0.397 | Val Loss: 0.41 | Val F1: 0.85 |
2023-09-02 20:45:07,113 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:45:07,137 - FGO - INFO - Epoch  70 | Train Loss: 0.220 | Val Loss: 0.27 | Val F1: 0.88 |
2023-09-02 20:45:07,162 - FGO - INFO - Epoch  80 | Train Loss: 0.175 | Val Loss: 0.25 | Val F1: 0.88 |
2023-09-02 20:45:07,186 - FGO - INFO - Epoch  90 | Train Loss: 0.148 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:45:07,210 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.21 | Val F1: 0.91 |
2023-09-02 20:45:07,210 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.209 | Val Loss: 0.26 | Val F1: 0.91 
2023-09-02 20:45:07,210 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:07,212 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:45:07,212 - CV - INFO - Begin OT Train
2023-09-02 20:45:07,212 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:07,277 - FGO - INFO - Epoch   0 | Train Loss: -7.513 | Val Loss: -0.60 | Val F1: 0.91 |
2023-09-02 20:45:08,037 - FGO - INFO - Epoch  10 | Train Loss: -7.783 | Val Loss: -0.57 | Val F1: 0.91 |
2023-09-02 20:45:08,853 - FGO - INFO - Epoch  20 | Train Loss: -7.964 | Val Loss: -0.54 | Val F1: 0.87 |
2023-09-02 20:45:09,701 - FGO - INFO - Epoch  30 | Train Loss: -8.059 | Val Loss: -0.53 | Val F1: 0.86 |
2023-09-02 20:45:10,421 - FGO - INFO - Epoch  40 | Train Loss: -8.107 | Val Loss: -0.52 | Val F1: 0.86 |
2023-09-02 20:45:11,217 - FGO - INFO - Best Epoch:   9 | Train Loss: -7.764 | Val Loss: -0.57 | Val F1: 0.91 |
2023-09-02 20:45:11,217 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:11,224 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:45:11,225 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:11,254 - FGO - INFO - Train CM:
[[397   3]
 [ 53 273]]
2023-09-02 20:45:11,254 - FGO - INFO - Val CM:
[[34  0]
 [11 33]]
2023-09-02 20:45:11,254 - FGO - INFO - Test CM:
[[34  0]
 [11 33]]
2023-09-02 20:45:11,259 - FGO - INFO - test statistical parity: 0.024154589371980673
2023-09-02 20:45:11,261 - FGO - INFO - test equal opportunity: 0.05641025641025643
2023-09-02 20:45:11,262 - FGO - INFO - test micro f1: 0.8589743589743589
2023-09-02 20:45:11,262 - FGO - INFO - test macro f1: 0.8589511754068716
2023-09-02 20:45:11,262 - CV - INFO - fold time: 4.405365467071533s (0.07342275778452555m)
2023-09-02 20:45:11,262 - CV - INFO - ----- BEGINNING FOLD SET (005:6)----------------------------------------------------------
2023-09-02 20:45:11,264 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/005/6
2023-09-02 20:45:11,264 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:11,264 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:11,264 - FGO - INFO - 	done: False
2023-09-02 20:45:11,264 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:11,264 - FGO - INFO - 	h1: 64
2023-09-02 20:45:11,264 - FGO - INFO - 	h2: 32
2023-09-02 20:45:11,264 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:11,264 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:11,264 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:11,264 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:11,264 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:11,264 - FGO - INFO - 	theta: 30
2023-09-02 20:45:11,264 - FGO - INFO - 	clip: 5
2023-09-02 20:45:11,264 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:11,264 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:11,264 - FGO - INFO - Source Total: 717
2023-09-02 20:45:11,264 - FGO - INFO - Target Total: 87
2023-09-02 20:45:11,264 - FGO - INFO - Train Total: 717
2023-09-02 20:45:11,264 - FGO - INFO - Val Total:   87
2023-09-02 20:45:11,264 - FGO - INFO - Test Total:  87
2023-09-02 20:45:11,264 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:11,264 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:11,264 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:11,264 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:11,264 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:11,265 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:11,265 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:11,265 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:11,265 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:11,265 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:11,266 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:11,267 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:11,374 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:11,374 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:11,374 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:11,374 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:11,374 - FGO - INFO - N: 804
2023-09-02 20:45:11,374 - FGO - INFO - N_s: 717
2023-09-02 20:45:11,374 - FGO - INFO - N_t: 87
2023-09-02 20:45:11,378 - CV - INFO - Begin Pretrain
2023-09-02 20:45:11,378 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:11,381 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:45:11,405 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.47 |
2023-09-02 20:45:11,430 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.63 |
2023-09-02 20:45:11,454 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.78 |
2023-09-02 20:45:11,479 - FGO - INFO - Epoch  40 | Train Loss: 0.509 | Val Loss: 0.50 | Val F1: 0.84 |
2023-09-02 20:45:11,504 - FGO - INFO - Epoch  50 | Train Loss: 0.402 | Val Loss: 0.40 | Val F1: 0.86 |
2023-09-02 20:45:11,528 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.31 | Val F1: 0.92 |
2023-09-02 20:45:11,552 - FGO - INFO - Epoch  70 | Train Loss: 0.228 | Val Loss: 0.23 | Val F1: 0.92 |
2023-09-02 20:45:11,577 - FGO - INFO - Epoch  80 | Train Loss: 0.183 | Val Loss: 0.19 | Val F1: 0.93 |
2023-09-02 20:45:11,601 - FGO - INFO - Epoch  90 | Train Loss: 0.154 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:45:11,626 - FGO - INFO - Epoch 100 | Train Loss: 0.134 | Val Loss: 0.14 | Val F1: 0.95 |
2023-09-02 20:45:11,626 - FGO - INFO - Best Epoch:  98 | Train Loss: 0.137 | Val Loss: 0.15 | Val F1: 0.95 
2023-09-02 20:45:11,626 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:11,627 - CV - INFO - Pretrain Complete, 98 epochs
2023-09-02 20:45:11,627 - CV - INFO - Begin OT Train
2023-09-02 20:45:11,627 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:11,691 - FGO - INFO - Epoch   0 | Train Loss: -7.542 | Val Loss: -0.85 | Val F1: 0.95 |
2023-09-02 20:45:12,472 - FGO - INFO - Epoch  10 | Train Loss: -7.762 | Val Loss: -0.86 | Val F1: 0.94 |
2023-09-02 20:45:13,244 - FGO - INFO - Epoch  20 | Train Loss: -7.922 | Val Loss: -0.89 | Val F1: 0.94 |
2023-09-02 20:45:14,055 - FGO - INFO - Epoch  30 | Train Loss: -7.999 | Val Loss: -0.89 | Val F1: 0.92 |
2023-09-02 20:45:14,850 - FGO - INFO - Epoch  40 | Train Loss: -8.038 | Val Loss: -0.90 | Val F1: 0.92 |
2023-09-02 20:45:15,595 - FGO - INFO - Best Epoch:   7 | Train Loss: -7.700 | Val Loss: -0.86 | Val F1: 0.95 |
2023-09-02 20:45:15,595 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:15,599 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:45:15,599 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:15,627 - FGO - INFO - Train CM:
[[382   3]
 [ 57 275]]
2023-09-02 20:45:15,627 - FGO - INFO - Val CM:
[[47  2]
 [ 5 33]]
2023-09-02 20:45:15,628 - FGO - INFO - Test CM:
[[47  2]
 [ 5 33]]
2023-09-02 20:45:15,633 - FGO - INFO - test statistical parity: 0.10759493670886078
2023-09-02 20:45:15,635 - FGO - INFO - test equal opportunity: 0.1470588235294118
2023-09-02 20:45:15,635 - FGO - INFO - test micro f1: 0.9195402298850575
2023-09-02 20:45:15,636 - FGO - INFO - test macro f1: 0.9174013291740133
2023-09-02 20:45:15,636 - CV - INFO - fold time: 4.373946666717529s (0.07289911111195882m)
2023-09-02 20:45:15,636 - CV - INFO - ----- BEGINNING FOLD SET (005:7)----------------------------------------------------------
2023-09-02 20:45:15,637 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/005/7
2023-09-02 20:45:15,638 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:15,638 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:15,638 - FGO - INFO - 	done: False
2023-09-02 20:45:15,638 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:15,638 - FGO - INFO - 	h1: 64
2023-09-02 20:45:15,638 - FGO - INFO - 	h2: 32
2023-09-02 20:45:15,638 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:15,638 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:15,638 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:15,638 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:15,638 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:15,638 - FGO - INFO - 	theta: 30
2023-09-02 20:45:15,638 - FGO - INFO - 	clip: 5
2023-09-02 20:45:15,638 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:15,638 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:15,638 - FGO - INFO - Source Total: 717
2023-09-02 20:45:15,638 - FGO - INFO - Target Total: 87
2023-09-02 20:45:15,638 - FGO - INFO - Train Total: 717
2023-09-02 20:45:15,638 - FGO - INFO - Val Total:   87
2023-09-02 20:45:15,638 - FGO - INFO - Test Total:  87
2023-09-02 20:45:15,638 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:15,638 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:15,638 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:15,638 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:15,638 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:15,639 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:15,639 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:15,639 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:15,639 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:15,639 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:15,640 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:15,641 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:15,746 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:15,746 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:15,746 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:15,746 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:15,746 - FGO - INFO - N: 804
2023-09-02 20:45:15,746 - FGO - INFO - N_s: 717
2023-09-02 20:45:15,746 - FGO - INFO - N_t: 87
2023-09-02 20:45:15,750 - CV - INFO - Begin Pretrain
2023-09-02 20:45:15,750 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:15,753 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:45:15,793 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.40 |
2023-09-02 20:45:15,820 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.62 |
2023-09-02 20:45:15,845 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.77 |
2023-09-02 20:45:15,869 - FGO - INFO - Epoch  40 | Train Loss: 0.507 | Val Loss: 0.52 | Val F1: 0.88 |
2023-09-02 20:45:15,894 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.41 | Val F1: 0.88 |
2023-09-02 20:45:15,918 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:45:15,943 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.23 | Val F1: 0.94 |
2023-09-02 20:45:15,967 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:45:15,992 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:45:16,016 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:45:16,016 - FGO - INFO - Best Epoch:  91 | Train Loss: 0.149 | Val Loss: 0.15 | Val F1: 0.97 
2023-09-02 20:45:16,016 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:16,018 - CV - INFO - Pretrain Complete, 91 epochs
2023-09-02 20:45:16,018 - CV - INFO - Begin OT Train
2023-09-02 20:45:16,018 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:16,083 - FGO - INFO - Epoch   0 | Train Loss: -7.579 | Val Loss: -0.81 | Val F1: 0.97 |
2023-09-02 20:45:16,844 - FGO - INFO - Epoch  10 | Train Loss: -7.806 | Val Loss: -0.81 | Val F1: 0.93 |
2023-09-02 20:45:17,645 - FGO - INFO - Epoch  20 | Train Loss: -7.972 | Val Loss: -0.83 | Val F1: 0.94 |
2023-09-02 20:45:18,437 - FGO - INFO - Epoch  30 | Train Loss: -8.054 | Val Loss: -0.84 | Val F1: 0.93 |
2023-09-02 20:45:19,203 - FGO - INFO - Epoch  40 | Train Loss: -8.095 | Val Loss: -0.85 | Val F1: 0.93 |
2023-09-02 20:45:19,843 - FGO - INFO - Best Epoch:   6 | Train Loss: -7.719 | Val Loss: -0.82 | Val F1: 0.97 |
2023-09-02 20:45:19,843 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:19,847 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:45:19,847 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:19,873 - FGO - INFO - Train CM:
[[385   2]
 [ 56 274]]
2023-09-02 20:45:19,873 - FGO - INFO - Val CM:
[[47  0]
 [ 5 35]]
2023-09-02 20:45:19,873 - FGO - INFO - Test CM:
[[47  0]
 [ 5 35]]
2023-09-02 20:45:19,878 - FGO - INFO - test statistical parity: 0.4033333333333333
2023-09-02 20:45:19,880 - FGO - INFO - test equal opportunity: 0.16129032258064513
2023-09-02 20:45:19,881 - FGO - INFO - test micro f1: 0.9425287356321839
2023-09-02 20:45:19,881 - FGO - INFO - test macro f1: 0.9414141414141415
2023-09-02 20:45:19,881 - CV - INFO - fold time: 4.245154619216919s (0.07075257698694865m)
2023-09-02 20:45:19,881 - CV - INFO - ----- BEGINNING FOLD SET (005:8)----------------------------------------------------------
2023-09-02 20:45:19,883 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/005/8
2023-09-02 20:45:19,883 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:19,883 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:19,883 - FGO - INFO - 	done: False
2023-09-02 20:45:19,883 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:19,883 - FGO - INFO - 	h1: 64
2023-09-02 20:45:19,883 - FGO - INFO - 	h2: 32
2023-09-02 20:45:19,883 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:19,883 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:19,883 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:19,883 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:19,883 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:19,883 - FGO - INFO - 	theta: 30
2023-09-02 20:45:19,883 - FGO - INFO - 	clip: 5
2023-09-02 20:45:19,883 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:19,883 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:19,883 - FGO - INFO - Source Total: 734
2023-09-02 20:45:19,883 - FGO - INFO - Target Total: 70
2023-09-02 20:45:19,883 - FGO - INFO - Train Total: 734
2023-09-02 20:45:19,883 - FGO - INFO - Val Total:   70
2023-09-02 20:45:19,883 - FGO - INFO - Test Total:  70
2023-09-02 20:45:19,883 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:19,883 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:19,883 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:19,883 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:19,883 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:19,884 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:19,884 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:19,884 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:19,884 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:19,884 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:19,885 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:19,886 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:19,975 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:19,975 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:19,975 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:19,975 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:19,975 - FGO - INFO - N: 804
2023-09-02 20:45:19,975 - FGO - INFO - N_s: 734
2023-09-02 20:45:19,975 - FGO - INFO - N_t: 70
2023-09-02 20:45:19,978 - CV - INFO - Begin Pretrain
2023-09-02 20:45:19,978 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:19,982 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:45:20,007 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.69 | Val F1: 0.41 |
2023-09-02 20:45:20,031 - FGO - INFO - Epoch  20 | Train Loss: 0.645 | Val Loss: 0.66 | Val F1: 0.62 |
2023-09-02 20:45:20,056 - FGO - INFO - Epoch  30 | Train Loss: 0.588 | Val Loss: 0.61 | Val F1: 0.76 |
2023-09-02 20:45:20,081 - FGO - INFO - Epoch  40 | Train Loss: 0.498 | Val Loss: 0.53 | Val F1: 0.81 |
2023-09-02 20:45:20,106 - FGO - INFO - Epoch  50 | Train Loss: 0.392 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:45:20,130 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:45:20,155 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.27 | Val F1: 0.86 |
2023-09-02 20:45:20,180 - FGO - INFO - Epoch  80 | Train Loss: 0.181 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:45:20,204 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:45:20,229 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:45:20,229 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.157 | Val Loss: 0.19 | Val F1: 0.94 
2023-09-02 20:45:20,229 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:20,230 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:45:20,230 - CV - INFO - Begin OT Train
2023-09-02 20:45:20,230 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:20,296 - FGO - INFO - Epoch   0 | Train Loss: -7.545 | Val Loss: -0.57 | Val F1: 0.94 |
2023-09-02 20:45:21,024 - FGO - INFO - Epoch  10 | Train Loss: -7.794 | Val Loss: -0.56 | Val F1: 0.91 |
2023-09-02 20:45:21,756 - FGO - INFO - Epoch  20 | Train Loss: -7.969 | Val Loss: -0.54 | Val F1: 0.91 |
2023-09-02 20:45:22,567 - FGO - INFO - Epoch  30 | Train Loss: -8.069 | Val Loss: -0.51 | Val F1: 0.88 |
2023-09-02 20:45:23,376 - FGO - INFO - Epoch  40 | Train Loss: -8.113 | Val Loss: -0.49 | Val F1: 0.88 |
2023-09-02 20:45:24,046 - FGO - INFO - Best Epoch:   6 | Train Loss: -7.725 | Val Loss: -0.53 | Val F1: 0.91 |
2023-09-02 20:45:24,046 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:24,049 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:45:24,049 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:24,074 - FGO - INFO - Train CM:
[[399   1]
 [ 71 263]]
2023-09-02 20:45:24,074 - FGO - INFO - Val CM:
[[34  0]
 [ 8 28]]
2023-09-02 20:45:24,075 - FGO - INFO - Test CM:
[[34  0]
 [ 8 28]]
2023-09-02 20:45:24,080 - FGO - INFO - test statistical parity: 0.018893387314439902
2023-09-02 20:45:24,081 - FGO - INFO - test equal opportunity: 0.06666666666666665
2023-09-02 20:45:24,082 - FGO - INFO - test micro f1: 0.8857142857142857
2023-09-02 20:45:24,083 - FGO - INFO - test macro f1: 0.8848684210526316
2023-09-02 20:45:24,083 - CV - INFO - fold time: 4.201497554779053s (0.07002495924631755m)
2023-09-02 20:45:24,083 - CV - INFO - ----- BEGINNING FOLD SET (005:9)----------------------------------------------------------
2023-09-02 20:45:24,084 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/005/9
2023-09-02 20:45:24,084 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:24,084 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:24,084 - FGO - INFO - 	done: False
2023-09-02 20:45:24,084 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:24,084 - FGO - INFO - 	h1: 64
2023-09-02 20:45:24,084 - FGO - INFO - 	h2: 32
2023-09-02 20:45:24,084 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:24,084 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:24,084 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:24,084 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:24,084 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:24,085 - FGO - INFO - 	theta: 30
2023-09-02 20:45:24,085 - FGO - INFO - 	clip: 5
2023-09-02 20:45:24,085 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:24,085 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:24,085 - FGO - INFO - Source Total: 725
2023-09-02 20:45:24,085 - FGO - INFO - Target Total: 79
2023-09-02 20:45:24,085 - FGO - INFO - Train Total: 725
2023-09-02 20:45:24,085 - FGO - INFO - Val Total:   79
2023-09-02 20:45:24,085 - FGO - INFO - Test Total:  79
2023-09-02 20:45:24,085 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:24,085 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:24,085 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:24,085 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:24,085 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:24,085 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:24,085 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:24,085 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:24,085 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:24,085 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:24,086 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:24,088 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:24,186 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:24,186 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:24,186 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:24,186 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:24,186 - FGO - INFO - N: 804
2023-09-02 20:45:24,186 - FGO - INFO - N_s: 725
2023-09-02 20:45:24,186 - FGO - INFO - N_t: 79
2023-09-02 20:45:24,190 - CV - INFO - Begin Pretrain
2023-09-02 20:45:24,190 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:24,193 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:45:24,217 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.50 |
2023-09-02 20:45:24,242 - FGO - INFO - Epoch  20 | Train Loss: 0.648 | Val Loss: 0.65 | Val F1: 0.59 |
2023-09-02 20:45:24,266 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.61 | Val F1: 0.69 |
2023-09-02 20:45:24,291 - FGO - INFO - Epoch  40 | Train Loss: 0.504 | Val Loss: 0.54 | Val F1: 0.78 |
2023-09-02 20:45:24,315 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:45:24,340 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.34 | Val F1: 0.90 |
2023-09-02 20:45:24,364 - FGO - INFO - Epoch  70 | Train Loss: 0.227 | Val Loss: 0.26 | Val F1: 0.92 |
2023-09-02 20:45:24,389 - FGO - INFO - Epoch  80 | Train Loss: 0.182 | Val Loss: 0.21 | Val F1: 0.96 |
2023-09-02 20:45:24,413 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:45:24,437 - FGO - INFO - Epoch 100 | Train Loss: 0.133 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:45:24,437 - FGO - INFO - Best Epoch:  85 | Train Loss: 0.165 | Val Loss: 0.19 | Val F1: 0.97 
2023-09-02 20:45:24,437 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:24,439 - CV - INFO - Pretrain Complete, 85 epochs
2023-09-02 20:45:24,439 - CV - INFO - Begin OT Train
2023-09-02 20:45:24,439 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:24,504 - FGO - INFO - Epoch   0 | Train Loss: -7.579 | Val Loss: -0.68 | Val F1: 0.96 |
2023-09-02 20:45:25,330 - FGO - INFO - Epoch  10 | Train Loss: -7.803 | Val Loss: -0.71 | Val F1: 0.96 |
2023-09-02 20:45:26,174 - FGO - INFO - Epoch  20 | Train Loss: -7.974 | Val Loss: -0.75 | Val F1: 0.96 |
2023-09-02 20:45:27,007 - FGO - INFO - Epoch  30 | Train Loss: -8.060 | Val Loss: -0.76 | Val F1: 0.96 |
2023-09-02 20:45:27,768 - FGO - INFO - Epoch  40 | Train Loss: -8.103 | Val Loss: -0.77 | Val F1: 0.96 |
2023-09-02 20:45:28,461 - FGO - INFO - Best Epoch:  14 | Train Loss: -7.880 | Val Loss: -0.74 | Val F1: 0.97 |
2023-09-02 20:45:28,461 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:28,468 - CV - INFO - OT Train Complete, 14 epochs
2023-09-02 20:45:28,468 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:28,497 - FGO - INFO - Train CM:
[[384   1]
 [ 68 272]]
2023-09-02 20:45:28,498 - FGO - INFO - Val CM:
[[47  2]
 [ 1 29]]
2023-09-02 20:45:28,498 - FGO - INFO - Test CM:
[[47  2]
 [ 1 29]]
2023-09-02 20:45:28,503 - FGO - INFO - test statistical parity: 0.008695652173913049
2023-09-02 20:45:28,504 - FGO - INFO - test equal opportunity: 0.038461538461538436
2023-09-02 20:45:28,505 - FGO - INFO - test micro f1: 0.9620253164556962
2023-09-02 20:45:28,506 - FGO - INFO - test macro f1: 0.9599459185398006
2023-09-02 20:45:28,506 - CV - INFO - fold time: 4.423218250274658s (0.0737203041712443m)
2023-09-02 20:45:28,506 - CV - INFO - Mean Pretrain Epochs 85.7:
2023-09-02 20:45:28,506 - CV - INFO - Mean OT Train Epochs 9.0:
2023-09-02 20:45:28,506 - CV - INFO - Mean Val Macro F1 : 0.9143762413269858
2023-09-02 20:45:28,506 - CV - INFO - Mean Eval Stat : 0.9143762413269858 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:45:28,506 - CV - INFO - set time: 42.919201135635376s (0.7153200189272563m)
2023-09-02 20:45:28,506 - CV - INFO - script time so far: 226.45716834068298s (3.774286139011383m) (0.06290476898352305h)
2023-09-02 20:45:28,506 - CV - INFO - ===== BEGINNING OPTION SET (006)==========================================================
2023-09-02 20:45:28,506 - CV - INFO - 	done: False
2023-09-02 20:45:28,506 - CV - INFO - 	learning_rate: 0.001
2023-09-02 20:45:28,506 - CV - INFO - 	h1: 64
2023-09-02 20:45:28,506 - CV - INFO - 	h2: 32
2023-09-02 20:45:28,506 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:28,506 - CV - INFO - 	dropout: 0.0
2023-09-02 20:45:28,506 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:28,506 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:28,506 - CV - INFO - 	lambda: 0.03
2023-09-02 20:45:28,506 - CV - INFO - 	theta: 50
2023-09-02 20:45:28,506 - CV - INFO - 	clip: 5
2023-09-02 20:45:28,506 - CV - INFO - ----- BEGINNING FOLD SET (006:0)----------------------------------------------------------
2023-09-02 20:45:28,508 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/006/0
2023-09-02 20:45:28,508 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:28,508 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:28,508 - FGO - INFO - 	done: False
2023-09-02 20:45:28,508 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:28,508 - FGO - INFO - 	h1: 64
2023-09-02 20:45:28,508 - FGO - INFO - 	h2: 32
2023-09-02 20:45:28,508 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:28,508 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:28,508 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:28,508 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:28,508 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:28,508 - FGO - INFO - 	theta: 50
2023-09-02 20:45:28,508 - FGO - INFO - 	clip: 5
2023-09-02 20:45:28,508 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:28,508 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:28,508 - FGO - INFO - Source Total: 708
2023-09-02 20:45:28,508 - FGO - INFO - Target Total: 96
2023-09-02 20:45:28,508 - FGO - INFO - Train Total: 708
2023-09-02 20:45:28,508 - FGO - INFO - Val Total:   96
2023-09-02 20:45:28,508 - FGO - INFO - Test Total:  96
2023-09-02 20:45:28,508 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:28,508 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:28,508 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:28,508 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:28,508 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:28,509 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:28,509 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:28,509 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:28,509 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:28,509 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:28,510 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:28,511 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:28,627 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:28,627 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:28,627 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:28,627 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:28,627 - FGO - INFO - N: 804
2023-09-02 20:45:28,627 - FGO - INFO - N_s: 708
2023-09-02 20:45:28,627 - FGO - INFO - N_t: 96
2023-09-02 20:45:28,630 - CV - INFO - Begin Pretrain
2023-09-02 20:45:28,630 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:28,633 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:45:28,658 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:45:28,682 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.53 |
2023-09-02 20:45:28,707 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.61 | Val F1: 0.67 |
2023-09-02 20:45:28,731 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.52 | Val F1: 0.86 |
2023-09-02 20:45:28,756 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.41 | Val F1: 0.89 |
2023-09-02 20:45:28,780 - FGO - INFO - Epoch  60 | Train Loss: 0.298 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:45:28,804 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:45:28,828 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:45:28,852 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:45:28,877 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:45:28,877 - FGO - INFO - Best Epoch:  86 | Train Loss: 0.161 | Val Loss: 0.18 | Val F1: 0.95 
2023-09-02 20:45:28,877 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:28,878 - CV - INFO - Pretrain Complete, 86 epochs
2023-09-02 20:45:28,878 - CV - INFO - Begin OT Train
2023-09-02 20:45:28,878 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:28,942 - FGO - INFO - Epoch   0 | Train Loss: -12.700 | Val Loss: -1.65 | Val F1: 0.95 |
2023-09-02 20:45:29,691 - FGO - INFO - Epoch  10 | Train Loss: -13.128 | Val Loss: -1.72 | Val F1: 0.95 |
2023-09-02 20:45:30,549 - FGO - INFO - Epoch  20 | Train Loss: -13.434 | Val Loss: -1.73 | Val F1: 0.93 |
2023-09-02 20:45:31,344 - FGO - INFO - Epoch  30 | Train Loss: -13.559 | Val Loss: -1.69 | Val F1: 0.90 |
2023-09-02 20:45:32,040 - FGO - INFO - Epoch  40 | Train Loss: -13.618 | Val Loss: -1.69 | Val F1: 0.93 |
2023-09-02 20:45:32,723 - FGO - INFO - Best Epoch:   6 | Train Loss: -12.964 | Val Loss: -1.69 | Val F1: 0.95 |
2023-09-02 20:45:32,723 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:32,726 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:45:32,727 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:32,750 - FGO - INFO - Train CM:
[[381   1]
 [219 107]]
2023-09-02 20:45:32,750 - FGO - INFO - Val CM:
[[52  0]
 [10 34]]
2023-09-02 20:45:32,751 - FGO - INFO - Test CM:
[[52  0]
 [10 34]]
2023-09-02 20:45:32,756 - FGO - INFO - test statistical parity: 0.31871657754010696
2023-09-02 20:45:32,758 - FGO - INFO - test equal opportunity: 0.125
2023-09-02 20:45:32,758 - FGO - INFO - test micro f1: 0.8958333333333334
2023-09-02 20:45:32,759 - FGO - INFO - test macro f1: 0.8920377867746289
2023-09-02 20:45:32,759 - CV - INFO - fold time: 4.252722263336182s (0.07087870438893636m)
2023-09-02 20:45:32,759 - CV - INFO - ----- BEGINNING FOLD SET (006:1)----------------------------------------------------------
2023-09-02 20:45:32,761 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/006/1
2023-09-02 20:45:32,761 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:32,761 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:32,761 - FGO - INFO - 	done: False
2023-09-02 20:45:32,761 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:32,761 - FGO - INFO - 	h1: 64
2023-09-02 20:45:32,761 - FGO - INFO - 	h2: 32
2023-09-02 20:45:32,761 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:32,761 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:32,761 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:32,761 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:32,761 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:32,761 - FGO - INFO - 	theta: 50
2023-09-02 20:45:32,761 - FGO - INFO - 	clip: 5
2023-09-02 20:45:32,761 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:32,761 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:32,761 - FGO - INFO - Source Total: 727
2023-09-02 20:45:32,761 - FGO - INFO - Target Total: 77
2023-09-02 20:45:32,761 - FGO - INFO - Train Total: 727
2023-09-02 20:45:32,761 - FGO - INFO - Val Total:   77
2023-09-02 20:45:32,761 - FGO - INFO - Test Total:  77
2023-09-02 20:45:32,761 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:32,761 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:32,761 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:32,761 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:32,761 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:32,762 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:32,762 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:32,762 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:32,762 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:32,762 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:32,763 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:32,764 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:32,860 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:32,860 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:32,860 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:32,860 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:32,860 - FGO - INFO - N: 804
2023-09-02 20:45:32,860 - FGO - INFO - N_s: 727
2023-09-02 20:45:32,860 - FGO - INFO - N_t: 77
2023-09-02 20:45:32,864 - CV - INFO - Begin Pretrain
2023-09-02 20:45:32,864 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:32,867 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:45:32,892 - FGO - INFO - Epoch  10 | Train Loss: 0.673 | Val Loss: 0.68 | Val F1: 0.51 |
2023-09-02 20:45:32,916 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.55 |
2023-09-02 20:45:32,941 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:45:32,966 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.55 | Val F1: 0.73 |
2023-09-02 20:45:32,990 - FGO - INFO - Epoch  50 | Train Loss: 0.396 | Val Loss: 0.47 | Val F1: 0.73 |
2023-09-02 20:45:33,015 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.40 | Val F1: 0.81 |
2023-09-02 20:45:33,040 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.34 | Val F1: 0.80 |
2023-09-02 20:45:33,064 - FGO - INFO - Epoch  80 | Train Loss: 0.172 | Val Loss: 0.29 | Val F1: 0.84 |
2023-09-02 20:45:33,089 - FGO - INFO - Epoch  90 | Train Loss: 0.142 | Val Loss: 0.26 | Val F1: 0.87 |
2023-09-02 20:45:33,113 - FGO - INFO - Epoch 100 | Train Loss: 0.122 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:45:33,113 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.147 | Val Loss: 0.27 | Val F1: 0.87 
2023-09-02 20:45:33,113 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:33,115 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:45:33,115 - CV - INFO - Begin OT Train
2023-09-02 20:45:33,115 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:33,190 - FGO - INFO - Epoch   0 | Train Loss: -12.759 | Val Loss: -1.06 | Val F1: 0.87 |
2023-09-02 20:45:33,920 - FGO - INFO - Epoch  10 | Train Loss: -13.207 | Val Loss: -1.13 | Val F1: 0.92 |
2023-09-02 20:45:34,715 - FGO - INFO - Epoch  20 | Train Loss: -13.553 | Val Loss: -1.15 | Val F1: 0.92 |
2023-09-02 20:45:35,470 - FGO - INFO - Epoch  30 | Train Loss: -13.741 | Val Loss: -1.12 | Val F1: 0.93 |
2023-09-02 20:45:36,209 - FGO - INFO - Epoch  40 | Train Loss: -13.839 | Val Loss: -1.06 | Val F1: 0.86 |
2023-09-02 20:45:36,946 - FGO - INFO - Best Epoch:  30 | Train Loss: -13.741 | Val Loss: -1.12 | Val F1: 0.93 |
2023-09-02 20:45:36,946 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:36,949 - CV - INFO - OT Train Complete, 30 epochs
2023-09-02 20:45:36,950 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:36,976 - FGO - INFO - Train CM:
[[390   0]
 [220 117]]
2023-09-02 20:45:36,977 - FGO - INFO - Val CM:
[[44  0]
 [14 19]]
2023-09-02 20:45:36,977 - FGO - INFO - Test CM:
[[44  0]
 [14 19]]
2023-09-02 20:45:36,982 - FGO - INFO - test statistical parity: 0.19358974358974362
2023-09-02 20:45:36,984 - FGO - INFO - test equal opportunity: 0.08064516129032262
2023-09-02 20:45:36,985 - FGO - INFO - test micro f1: 0.8181818181818182
2023-09-02 20:45:36,985 - FGO - INFO - test macro f1: 0.7967571644042233
2023-09-02 20:45:36,985 - CV - INFO - fold time: 4.226163625717163s (0.07043606042861938m)
2023-09-02 20:45:36,985 - CV - INFO - ----- BEGINNING FOLD SET (006:2)----------------------------------------------------------
2023-09-02 20:45:36,987 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/006/2
2023-09-02 20:45:36,987 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:36,987 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:36,987 - FGO - INFO - 	done: False
2023-09-02 20:45:36,987 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:36,987 - FGO - INFO - 	h1: 64
2023-09-02 20:45:36,987 - FGO - INFO - 	h2: 32
2023-09-02 20:45:36,987 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:36,987 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:36,987 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:36,987 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:36,987 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:36,987 - FGO - INFO - 	theta: 50
2023-09-02 20:45:36,987 - FGO - INFO - 	clip: 5
2023-09-02 20:45:36,987 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:36,987 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:36,987 - FGO - INFO - Source Total: 721
2023-09-02 20:45:36,987 - FGO - INFO - Target Total: 83
2023-09-02 20:45:36,987 - FGO - INFO - Train Total: 721
2023-09-02 20:45:36,987 - FGO - INFO - Val Total:   83
2023-09-02 20:45:36,987 - FGO - INFO - Test Total:  83
2023-09-02 20:45:36,987 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:36,987 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:36,987 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:36,987 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:36,987 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:36,988 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:36,988 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:36,988 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:36,988 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:36,988 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:36,989 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:36,990 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:37,093 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:37,093 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:37,093 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:37,093 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:37,093 - FGO - INFO - N: 804
2023-09-02 20:45:37,093 - FGO - INFO - N_s: 721
2023-09-02 20:45:37,093 - FGO - INFO - N_t: 83
2023-09-02 20:45:37,097 - CV - INFO - Begin Pretrain
2023-09-02 20:45:37,097 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:37,101 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:45:37,129 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.57 |
2023-09-02 20:45:37,157 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.64 | Val F1: 0.66 |
2023-09-02 20:45:37,185 - FGO - INFO - Epoch  30 | Train Loss: 0.594 | Val Loss: 0.60 | Val F1: 0.76 |
2023-09-02 20:45:37,213 - FGO - INFO - Epoch  40 | Train Loss: 0.506 | Val Loss: 0.52 | Val F1: 0.83 |
2023-09-02 20:45:37,241 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:45:37,269 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.34 | Val F1: 0.85 |
2023-09-02 20:45:37,297 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:45:37,324 - FGO - INFO - Epoch  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:45:37,351 - FGO - INFO - Epoch  90 | Train Loss: 0.140 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:45:37,376 - FGO - INFO - Epoch 100 | Train Loss: 0.119 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:45:37,376 - FGO - INFO - Best Epoch:  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 
2023-09-02 20:45:37,376 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:37,377 - CV - INFO - Pretrain Complete, 80 epochs
2023-09-02 20:45:37,377 - CV - INFO - Begin OT Train
2023-09-02 20:45:37,377 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:37,449 - FGO - INFO - Epoch   0 | Train Loss: -12.868 | Val Loss: -1.17 | Val F1: 0.87 |
2023-09-02 20:45:38,255 - FGO - INFO - Epoch  10 | Train Loss: -13.314 | Val Loss: -1.21 | Val F1: 0.90 |
2023-09-02 20:45:39,016 - FGO - INFO - Epoch  20 | Train Loss: -13.637 | Val Loss: -1.24 | Val F1: 0.87 |
2023-09-02 20:45:39,774 - FGO - INFO - Epoch  30 | Train Loss: -13.780 | Val Loss: -1.23 | Val F1: 0.86 |
2023-09-02 20:45:40,546 - FGO - INFO - Epoch  40 | Train Loss: -13.842 | Val Loss: -1.22 | Val F1: 0.87 |
2023-09-02 20:45:41,289 - FGO - INFO - Best Epoch:   9 | Train Loss: -13.273 | Val Loss: -1.21 | Val F1: 0.90 |
2023-09-02 20:45:41,290 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:41,293 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:45:41,293 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:41,317 - FGO - INFO - Train CM:
[[384   0]
 [116 221]]
2023-09-02 20:45:41,318 - FGO - INFO - Val CM:
[[47  3]
 [ 6 27]]
2023-09-02 20:45:41,318 - FGO - INFO - Test CM:
[[47  3]
 [ 6 27]]
2023-09-02 20:45:41,323 - FGO - INFO - test statistical parity: 0.06455399061032868
2023-09-02 20:45:41,325 - FGO - INFO - test equal opportunity: 0.18518518518518523
2023-09-02 20:45:41,326 - FGO - INFO - test micro f1: 0.891566265060241
2023-09-02 20:45:41,326 - FGO - INFO - test macro f1: 0.8848821081830791
2023-09-02 20:45:41,326 - CV - INFO - fold time: 4.340791463851929s (0.07234652439753214m)
2023-09-02 20:45:41,326 - CV - INFO - ----- BEGINNING FOLD SET (006:3)----------------------------------------------------------
2023-09-02 20:45:41,328 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/006/3
2023-09-02 20:45:41,328 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:41,328 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:41,328 - FGO - INFO - 	done: False
2023-09-02 20:45:41,328 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:41,328 - FGO - INFO - 	h1: 64
2023-09-02 20:45:41,328 - FGO - INFO - 	h2: 32
2023-09-02 20:45:41,328 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:41,328 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:41,328 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:41,328 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:41,328 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:41,328 - FGO - INFO - 	theta: 50
2023-09-02 20:45:41,328 - FGO - INFO - 	clip: 5
2023-09-02 20:45:41,328 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:41,328 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:41,328 - FGO - INFO - Source Total: 729
2023-09-02 20:45:41,328 - FGO - INFO - Target Total: 75
2023-09-02 20:45:41,328 - FGO - INFO - Train Total: 729
2023-09-02 20:45:41,328 - FGO - INFO - Val Total:   75
2023-09-02 20:45:41,328 - FGO - INFO - Test Total:  75
2023-09-02 20:45:41,328 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:41,328 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:41,328 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:41,328 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:41,328 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:41,329 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:41,329 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:41,329 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:41,329 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:41,329 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:41,330 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:41,331 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:41,426 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:41,426 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:41,426 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:41,426 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:41,426 - FGO - INFO - N: 804
2023-09-02 20:45:41,426 - FGO - INFO - N_s: 729
2023-09-02 20:45:41,426 - FGO - INFO - N_t: 75
2023-09-02 20:45:41,430 - CV - INFO - Begin Pretrain
2023-09-02 20:45:41,430 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:41,433 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:45:41,458 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.67 | Val F1: 0.39 |
2023-09-02 20:45:41,483 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.64 |
2023-09-02 20:45:41,508 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.57 | Val F1: 0.86 |
2023-09-02 20:45:41,533 - FGO - INFO - Epoch  40 | Train Loss: 0.510 | Val Loss: 0.47 | Val F1: 0.92 |
2023-09-02 20:45:41,558 - FGO - INFO - Epoch  50 | Train Loss: 0.406 | Val Loss: 0.34 | Val F1: 0.93 |
2023-09-02 20:45:41,582 - FGO - INFO - Epoch  60 | Train Loss: 0.305 | Val Loss: 0.23 | Val F1: 0.97 |
2023-09-02 20:45:41,607 - FGO - INFO - Epoch  70 | Train Loss: 0.231 | Val Loss: 0.16 | Val F1: 0.99 |
2023-09-02 20:45:41,632 - FGO - INFO - Epoch  80 | Train Loss: 0.186 | Val Loss: 0.12 | Val F1: 0.99 |
2023-09-02 20:45:41,656 - FGO - INFO - Epoch  90 | Train Loss: 0.156 | Val Loss: 0.10 | Val F1: 0.99 |
2023-09-02 20:45:41,681 - FGO - INFO - Epoch 100 | Train Loss: 0.135 | Val Loss: 0.09 | Val F1: 0.97 |
2023-09-02 20:45:41,681 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.161 | Val Loss: 0.10 | Val F1: 0.99 
2023-09-02 20:45:41,681 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:41,682 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:45:41,682 - CV - INFO - Begin OT Train
2023-09-02 20:45:41,682 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:41,748 - FGO - INFO - Epoch   0 | Train Loss: -12.603 | Val Loss: -1.26 | Val F1: 0.99 |
2023-09-02 20:45:42,554 - FGO - INFO - Epoch  10 | Train Loss: -13.127 | Val Loss: -1.30 | Val F1: 0.99 |
2023-09-02 20:45:43,322 - FGO - INFO - Epoch  20 | Train Loss: -13.460 | Val Loss: -1.30 | Val F1: 0.95 |
2023-09-02 20:45:44,190 - FGO - INFO - Epoch  30 | Train Loss: -13.648 | Val Loss: -1.30 | Val F1: 0.95 |
2023-09-02 20:45:44,949 - FGO - INFO - Epoch  40 | Train Loss: -13.732 | Val Loss: -1.27 | Val F1: 0.95 |
2023-09-02 20:45:45,603 - FGO - INFO - Best Epoch:   8 | Train Loss: -13.049 | Val Loss: -1.27 | Val F1: 0.99 |
2023-09-02 20:45:45,603 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:45,610 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:45:45,610 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:45,636 - FGO - INFO - Train CM:
[[395   1]
 [143 190]]
2023-09-02 20:45:45,636 - FGO - INFO - Val CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:45:45,636 - FGO - INFO - Test CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:45:45,642 - FGO - INFO - test statistical parity: 0.046838407494145196
2023-09-02 20:45:45,643 - FGO - INFO - test equal opportunity: 0.10952380952380958
2023-09-02 20:45:45,644 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 20:45:45,644 - FGO - INFO - test macro f1: 0.9732905982905983
2023-09-02 20:45:45,644 - CV - INFO - fold time: 4.318267583847046s (0.07197112639745076m)
2023-09-02 20:45:45,644 - CV - INFO - ----- BEGINNING FOLD SET (006:4)----------------------------------------------------------
2023-09-02 20:45:45,646 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/006/4
2023-09-02 20:45:45,646 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:45,646 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:45,646 - FGO - INFO - 	done: False
2023-09-02 20:45:45,646 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:45,646 - FGO - INFO - 	h1: 64
2023-09-02 20:45:45,646 - FGO - INFO - 	h2: 32
2023-09-02 20:45:45,646 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:45,646 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:45,646 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:45,646 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:45,646 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:45,646 - FGO - INFO - 	theta: 50
2023-09-02 20:45:45,646 - FGO - INFO - 	clip: 5
2023-09-02 20:45:45,646 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:45,646 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:45,646 - FGO - INFO - Source Total: 732
2023-09-02 20:45:45,646 - FGO - INFO - Target Total: 72
2023-09-02 20:45:45,646 - FGO - INFO - Train Total: 732
2023-09-02 20:45:45,646 - FGO - INFO - Val Total:   72
2023-09-02 20:45:45,646 - FGO - INFO - Test Total:  72
2023-09-02 20:45:45,646 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:45,646 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:45,646 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:45,646 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:45,646 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:45,647 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:45,647 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:45,647 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:45,647 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:45,647 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:45,648 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:45,649 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:45,740 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:45,740 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:45,740 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:45,740 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:45,740 - FGO - INFO - N: 804
2023-09-02 20:45:45,740 - FGO - INFO - N_s: 732
2023-09-02 20:45:45,740 - FGO - INFO - N_t: 72
2023-09-02 20:45:45,743 - CV - INFO - Begin Pretrain
2023-09-02 20:45:45,743 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:45,747 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:45:45,772 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.68 | Val F1: 0.45 |
2023-09-02 20:45:45,796 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.66 | Val F1: 0.63 |
2023-09-02 20:45:45,821 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.60 | Val F1: 0.75 |
2023-09-02 20:45:45,846 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.50 | Val F1: 0.87 |
2023-09-02 20:45:45,870 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.39 | Val F1: 0.89 |
2023-09-02 20:45:45,895 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:45:45,920 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:45:45,944 - FGO - INFO - Epoch  80 | Train Loss: 0.179 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:45:45,969 - FGO - INFO - Epoch  90 | Train Loss: 0.150 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:45:45,993 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:45:45,993 - FGO - INFO - Best Epoch:  81 | Train Loss: 0.175 | Val Loss: 0.16 | Val F1: 0.97 
2023-09-02 20:45:45,993 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:45,995 - CV - INFO - Pretrain Complete, 81 epochs
2023-09-02 20:45:45,995 - CV - INFO - Begin OT Train
2023-09-02 20:45:45,995 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:46,064 - FGO - INFO - Epoch   0 | Train Loss: -12.791 | Val Loss: -1.20 | Val F1: 0.97 |
2023-09-02 20:45:46,907 - FGO - INFO - Epoch  10 | Train Loss: -13.257 | Val Loss: -1.22 | Val F1: 0.94 |
2023-09-02 20:45:47,726 - FGO - INFO - Epoch  20 | Train Loss: -13.572 | Val Loss: -1.22 | Val F1: 0.90 |
2023-09-02 20:45:48,458 - FGO - INFO - Epoch  30 | Train Loss: -13.702 | Val Loss: -1.21 | Val F1: 0.90 |
2023-09-02 20:45:49,260 - FGO - INFO - Epoch  40 | Train Loss: -13.763 | Val Loss: -1.22 | Val F1: 0.92 |
2023-09-02 20:45:49,961 - FGO - INFO - Best Epoch:   7 | Train Loss: -13.126 | Val Loss: -1.22 | Val F1: 0.97 |
2023-09-02 20:45:49,962 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:49,965 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:45:49,965 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:49,990 - FGO - INFO - Train CM:
[[396   1]
 [ 72 263]]
2023-09-02 20:45:49,990 - FGO - INFO - Val CM:
[[37  0]
 [ 4 31]]
2023-09-02 20:45:49,991 - FGO - INFO - Test CM:
[[37  0]
 [ 4 31]]
2023-09-02 20:45:49,996 - FGO - INFO - test statistical parity: 0.035483870967741915
2023-09-02 20:45:49,997 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:45:49,998 - FGO - INFO - test micro f1: 0.9444444444444444
2023-09-02 20:45:49,999 - FGO - INFO - test macro f1: 0.9440559440559441
2023-09-02 20:45:49,999 - CV - INFO - fold time: 4.354524612426758s (0.07257541020711263m)
2023-09-02 20:45:49,999 - CV - INFO - ----- BEGINNING FOLD SET (006:5)----------------------------------------------------------
2023-09-02 20:45:50,000 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/006/5
2023-09-02 20:45:50,001 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:50,001 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:50,001 - FGO - INFO - 	done: False
2023-09-02 20:45:50,001 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:50,001 - FGO - INFO - 	h1: 64
2023-09-02 20:45:50,001 - FGO - INFO - 	h2: 32
2023-09-02 20:45:50,001 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:50,001 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:50,001 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:50,001 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:50,001 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:50,001 - FGO - INFO - 	theta: 50
2023-09-02 20:45:50,001 - FGO - INFO - 	clip: 5
2023-09-02 20:45:50,001 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:50,001 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:50,001 - FGO - INFO - Source Total: 726
2023-09-02 20:45:50,001 - FGO - INFO - Target Total: 78
2023-09-02 20:45:50,001 - FGO - INFO - Train Total: 726
2023-09-02 20:45:50,001 - FGO - INFO - Val Total:   78
2023-09-02 20:45:50,001 - FGO - INFO - Test Total:  78
2023-09-02 20:45:50,001 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:50,001 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:50,001 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:50,001 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:50,001 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:50,002 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:50,002 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:50,002 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:50,002 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:50,002 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:50,003 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:50,004 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:50,102 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:50,102 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:50,102 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:50,102 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:50,102 - FGO - INFO - N: 804
2023-09-02 20:45:50,102 - FGO - INFO - N_s: 726
2023-09-02 20:45:50,102 - FGO - INFO - N_t: 78
2023-09-02 20:45:50,105 - CV - INFO - Begin Pretrain
2023-09-02 20:45:50,105 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:50,109 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:45:50,133 - FGO - INFO - Epoch  10 | Train Loss: 0.669 | Val Loss: 0.72 | Val F1: 0.34 |
2023-09-02 20:45:50,158 - FGO - INFO - Epoch  20 | Train Loss: 0.644 | Val Loss: 0.69 | Val F1: 0.42 |
2023-09-02 20:45:50,182 - FGO - INFO - Epoch  30 | Train Loss: 0.591 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:45:50,207 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.53 | Val F1: 0.83 |
2023-09-02 20:45:50,231 - FGO - INFO - Epoch  50 | Train Loss: 0.397 | Val Loss: 0.41 | Val F1: 0.85 |
2023-09-02 20:45:50,256 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:45:50,280 - FGO - INFO - Epoch  70 | Train Loss: 0.220 | Val Loss: 0.27 | Val F1: 0.88 |
2023-09-02 20:45:50,304 - FGO - INFO - Epoch  80 | Train Loss: 0.175 | Val Loss: 0.25 | Val F1: 0.88 |
2023-09-02 20:45:50,329 - FGO - INFO - Epoch  90 | Train Loss: 0.148 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:45:50,353 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.21 | Val F1: 0.91 |
2023-09-02 20:45:50,353 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.209 | Val Loss: 0.26 | Val F1: 0.91 
2023-09-02 20:45:50,353 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:50,354 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:45:50,354 - CV - INFO - Begin OT Train
2023-09-02 20:45:50,354 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:50,419 - FGO - INFO - Epoch   0 | Train Loss: -12.718 | Val Loss: -1.15 | Val F1: 0.91 |
2023-09-02 20:45:51,294 - FGO - INFO - Epoch  10 | Train Loss: -13.192 | Val Loss: -1.12 | Val F1: 0.88 |
2023-09-02 20:45:52,107 - FGO - INFO - Epoch  20 | Train Loss: -13.537 | Val Loss: -1.10 | Val F1: 0.86 |
2023-09-02 20:45:52,900 - FGO - INFO - Epoch  30 | Train Loss: -13.708 | Val Loss: -1.10 | Val F1: 0.82 |
2023-09-02 20:45:53,707 - FGO - INFO - Epoch  40 | Train Loss: -13.779 | Val Loss: -1.11 | Val F1: 0.86 |
2023-09-02 20:45:54,483 - FGO - INFO - Best Epoch:   9 | Train Loss: -13.154 | Val Loss: -1.11 | Val F1: 0.88 |
2023-09-02 20:45:54,483 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:54,486 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:45:54,486 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:54,514 - FGO - INFO - Train CM:
[[399   1]
 [133 193]]
2023-09-02 20:45:54,514 - FGO - INFO - Val CM:
[[34  0]
 [11 33]]
2023-09-02 20:45:54,514 - FGO - INFO - Test CM:
[[34  0]
 [11 33]]
2023-09-02 20:45:54,520 - FGO - INFO - test statistical parity: 0.024154589371980673
2023-09-02 20:45:54,521 - FGO - INFO - test equal opportunity: 0.05641025641025643
2023-09-02 20:45:54,522 - FGO - INFO - test micro f1: 0.8589743589743589
2023-09-02 20:45:54,523 - FGO - INFO - test macro f1: 0.8589511754068716
2023-09-02 20:45:54,523 - CV - INFO - fold time: 4.523703336715698s (0.0753950556119283m)
2023-09-02 20:45:54,523 - CV - INFO - ----- BEGINNING FOLD SET (006:6)----------------------------------------------------------
2023-09-02 20:45:54,524 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/006/6
2023-09-02 20:45:54,524 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:54,524 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:54,524 - FGO - INFO - 	done: False
2023-09-02 20:45:54,524 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:54,524 - FGO - INFO - 	h1: 64
2023-09-02 20:45:54,524 - FGO - INFO - 	h2: 32
2023-09-02 20:45:54,524 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:54,524 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:54,524 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:54,524 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:54,524 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:54,524 - FGO - INFO - 	theta: 50
2023-09-02 20:45:54,524 - FGO - INFO - 	clip: 5
2023-09-02 20:45:54,524 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:54,524 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:54,524 - FGO - INFO - Source Total: 717
2023-09-02 20:45:54,524 - FGO - INFO - Target Total: 87
2023-09-02 20:45:54,525 - FGO - INFO - Train Total: 717
2023-09-02 20:45:54,525 - FGO - INFO - Val Total:   87
2023-09-02 20:45:54,525 - FGO - INFO - Test Total:  87
2023-09-02 20:45:54,525 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:54,525 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:54,525 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:54,525 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:54,525 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:54,525 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:54,525 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:54,525 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:54,525 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:54,525 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:54,526 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:54,527 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:54,634 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:54,634 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:54,634 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:54,634 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:54,634 - FGO - INFO - N: 804
2023-09-02 20:45:54,634 - FGO - INFO - N_s: 717
2023-09-02 20:45:54,634 - FGO - INFO - N_t: 87
2023-09-02 20:45:54,638 - CV - INFO - Begin Pretrain
2023-09-02 20:45:54,638 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:54,641 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:45:54,675 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.47 |
2023-09-02 20:45:54,700 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.63 |
2023-09-02 20:45:54,726 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.78 |
2023-09-02 20:45:54,750 - FGO - INFO - Epoch  40 | Train Loss: 0.509 | Val Loss: 0.50 | Val F1: 0.84 |
2023-09-02 20:45:54,774 - FGO - INFO - Epoch  50 | Train Loss: 0.402 | Val Loss: 0.40 | Val F1: 0.86 |
2023-09-02 20:45:54,799 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.31 | Val F1: 0.92 |
2023-09-02 20:45:54,823 - FGO - INFO - Epoch  70 | Train Loss: 0.228 | Val Loss: 0.23 | Val F1: 0.92 |
2023-09-02 20:45:54,847 - FGO - INFO - Epoch  80 | Train Loss: 0.183 | Val Loss: 0.19 | Val F1: 0.93 |
2023-09-02 20:45:54,872 - FGO - INFO - Epoch  90 | Train Loss: 0.154 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:45:54,896 - FGO - INFO - Epoch 100 | Train Loss: 0.134 | Val Loss: 0.14 | Val F1: 0.95 |
2023-09-02 20:45:54,896 - FGO - INFO - Best Epoch:  98 | Train Loss: 0.137 | Val Loss: 0.15 | Val F1: 0.95 
2023-09-02 20:45:54,896 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:54,897 - CV - INFO - Pretrain Complete, 98 epochs
2023-09-02 20:45:54,897 - CV - INFO - Begin OT Train
2023-09-02 20:45:54,897 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:54,965 - FGO - INFO - Epoch   0 | Train Loss: -12.719 | Val Loss: -1.50 | Val F1: 0.95 |
2023-09-02 20:45:55,832 - FGO - INFO - Epoch  10 | Train Loss: -13.159 | Val Loss: -1.55 | Val F1: 0.94 |
2023-09-02 20:45:56,618 - FGO - INFO - Epoch  20 | Train Loss: -13.467 | Val Loss: -1.58 | Val F1: 0.94 |
2023-09-02 20:45:57,381 - FGO - INFO - Epoch  30 | Train Loss: -13.596 | Val Loss: -1.56 | Val F1: 0.90 |
2023-09-02 20:45:58,250 - FGO - INFO - Epoch  40 | Train Loss: -13.656 | Val Loss: -1.55 | Val F1: 0.94 |
2023-09-02 20:45:58,913 - FGO - INFO - Best Epoch:   6 | Train Loss: -12.990 | Val Loss: -1.54 | Val F1: 0.95 |
2023-09-02 20:45:58,913 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:58,915 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:45:58,916 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:45:58,948 - FGO - INFO - Train CM:
[[385   0]
 [164 168]]
2023-09-02 20:45:58,948 - FGO - INFO - Val CM:
[[49  0]
 [ 7 31]]
2023-09-02 20:45:58,948 - FGO - INFO - Test CM:
[[49  0]
 [ 7 31]]
2023-09-02 20:45:58,953 - FGO - INFO - test statistical parity: 0.15822784810126583
2023-09-02 20:45:58,955 - FGO - INFO - test equal opportunity: 0.20588235294117652
2023-09-02 20:45:58,955 - FGO - INFO - test micro f1: 0.9195402298850575
2023-09-02 20:45:58,956 - FGO - INFO - test macro f1: 0.9159420289855071
2023-09-02 20:45:58,956 - CV - INFO - fold time: 4.433343410491943s (0.0738890568415324m)
2023-09-02 20:45:58,956 - CV - INFO - ----- BEGINNING FOLD SET (006:7)----------------------------------------------------------
2023-09-02 20:45:58,957 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/006/7
2023-09-02 20:45:58,958 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:45:58,958 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:45:58,958 - FGO - INFO - 	done: False
2023-09-02 20:45:58,958 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:45:58,958 - FGO - INFO - 	h1: 64
2023-09-02 20:45:58,958 - FGO - INFO - 	h2: 32
2023-09-02 20:45:58,958 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:45:58,958 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:45:58,958 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:45:58,958 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:45:58,958 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:45:58,958 - FGO - INFO - 	theta: 50
2023-09-02 20:45:58,958 - FGO - INFO - 	clip: 5
2023-09-02 20:45:58,958 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:45:58,958 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:45:58,958 - FGO - INFO - Source Total: 717
2023-09-02 20:45:58,958 - FGO - INFO - Target Total: 87
2023-09-02 20:45:58,958 - FGO - INFO - Train Total: 717
2023-09-02 20:45:58,958 - FGO - INFO - Val Total:   87
2023-09-02 20:45:58,958 - FGO - INFO - Test Total:  87
2023-09-02 20:45:58,958 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:45:58,958 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:45:58,958 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:45:58,958 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:45:58,958 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:45:58,959 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:45:58,959 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:45:58,959 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:45:58,959 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:45:58,959 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:45:58,960 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:45:58,961 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:45:59,067 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:45:59,067 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:45:59,067 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:45:59,067 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:45:59,067 - FGO - INFO - N: 804
2023-09-02 20:45:59,067 - FGO - INFO - N_s: 717
2023-09-02 20:45:59,067 - FGO - INFO - N_t: 87
2023-09-02 20:45:59,071 - CV - INFO - Begin Pretrain
2023-09-02 20:45:59,071 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:45:59,074 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:45:59,099 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.40 |
2023-09-02 20:45:59,123 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.62 |
2023-09-02 20:45:59,148 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.77 |
2023-09-02 20:45:59,173 - FGO - INFO - Epoch  40 | Train Loss: 0.507 | Val Loss: 0.52 | Val F1: 0.88 |
2023-09-02 20:45:59,197 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.41 | Val F1: 0.88 |
2023-09-02 20:45:59,222 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:45:59,246 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.23 | Val F1: 0.94 |
2023-09-02 20:45:59,271 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:45:59,295 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:45:59,320 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:45:59,320 - FGO - INFO - Best Epoch:  91 | Train Loss: 0.149 | Val Loss: 0.15 | Val F1: 0.97 
2023-09-02 20:45:59,320 - FGO - INFO - Setting model to best state.
2023-09-02 20:45:59,321 - CV - INFO - Pretrain Complete, 91 epochs
2023-09-02 20:45:59,321 - CV - INFO - Begin OT Train
2023-09-02 20:45:59,321 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:45:59,409 - FGO - INFO - Epoch   0 | Train Loss: -12.789 | Val Loss: -1.44 | Val F1: 0.97 |
2023-09-02 20:46:00,173 - FGO - INFO - Epoch  10 | Train Loss: -13.243 | Val Loss: -1.46 | Val F1: 0.93 |
2023-09-02 20:46:00,948 - FGO - INFO - Epoch  20 | Train Loss: -13.565 | Val Loss: -1.48 | Val F1: 0.92 |
2023-09-02 20:46:01,713 - FGO - INFO - Epoch  30 | Train Loss: -13.695 | Val Loss: -1.45 | Val F1: 0.89 |
2023-09-02 20:46:02,487 - FGO - INFO - Epoch  40 | Train Loss: -13.754 | Val Loss: -1.43 | Val F1: 0.92 |
2023-09-02 20:46:03,203 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.072 | Val Loss: -1.46 | Val F1: 0.95 |
2023-09-02 20:46:03,203 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:03,206 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:46:03,206 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:03,233 - FGO - INFO - Train CM:
[[387   0]
 [193 137]]
2023-09-02 20:46:03,233 - FGO - INFO - Val CM:
[[47  0]
 [12 28]]
2023-09-02 20:46:03,234 - FGO - INFO - Test CM:
[[47  0]
 [12 28]]
2023-09-02 20:46:03,239 - FGO - INFO - test statistical parity: 0.30333333333333334
2023-09-02 20:46:03,240 - FGO - INFO - test equal opportunity: 0.10035842293906816
2023-09-02 20:46:03,241 - FGO - INFO - test micro f1: 0.8620689655172413
2023-09-02 20:46:03,242 - FGO - INFO - test macro f1: 0.8551609322974472
2023-09-02 20:46:03,242 - CV - INFO - fold time: 4.285866022109985s (0.07143110036849976m)
2023-09-02 20:46:03,242 - CV - INFO - ----- BEGINNING FOLD SET (006:8)----------------------------------------------------------
2023-09-02 20:46:03,243 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/006/8
2023-09-02 20:46:03,244 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:03,244 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:03,244 - FGO - INFO - 	done: False
2023-09-02 20:46:03,244 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:03,244 - FGO - INFO - 	h1: 64
2023-09-02 20:46:03,244 - FGO - INFO - 	h2: 32
2023-09-02 20:46:03,244 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:03,244 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:03,244 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:03,244 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:03,244 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:46:03,244 - FGO - INFO - 	theta: 50
2023-09-02 20:46:03,244 - FGO - INFO - 	clip: 5
2023-09-02 20:46:03,244 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:03,244 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:03,244 - FGO - INFO - Source Total: 734
2023-09-02 20:46:03,244 - FGO - INFO - Target Total: 70
2023-09-02 20:46:03,244 - FGO - INFO - Train Total: 734
2023-09-02 20:46:03,244 - FGO - INFO - Val Total:   70
2023-09-02 20:46:03,244 - FGO - INFO - Test Total:  70
2023-09-02 20:46:03,244 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:03,244 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:03,244 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:03,244 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:03,244 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:03,244 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:03,245 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:03,245 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:03,245 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:03,245 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:03,246 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:03,247 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:03,334 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:03,334 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:03,334 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:03,334 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:03,334 - FGO - INFO - N: 804
2023-09-02 20:46:03,334 - FGO - INFO - N_s: 734
2023-09-02 20:46:03,334 - FGO - INFO - N_t: 70
2023-09-02 20:46:03,338 - CV - INFO - Begin Pretrain
2023-09-02 20:46:03,338 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:03,341 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:46:03,366 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.69 | Val F1: 0.41 |
2023-09-02 20:46:03,391 - FGO - INFO - Epoch  20 | Train Loss: 0.645 | Val Loss: 0.66 | Val F1: 0.62 |
2023-09-02 20:46:03,416 - FGO - INFO - Epoch  30 | Train Loss: 0.588 | Val Loss: 0.61 | Val F1: 0.76 |
2023-09-02 20:46:03,441 - FGO - INFO - Epoch  40 | Train Loss: 0.498 | Val Loss: 0.53 | Val F1: 0.81 |
2023-09-02 20:46:03,466 - FGO - INFO - Epoch  50 | Train Loss: 0.392 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:46:03,491 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:46:03,515 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.27 | Val F1: 0.86 |
2023-09-02 20:46:03,540 - FGO - INFO - Epoch  80 | Train Loss: 0.181 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:46:03,565 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:46:03,590 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:46:03,590 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.157 | Val Loss: 0.19 | Val F1: 0.94 
2023-09-02 20:46:03,590 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:03,591 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:46:03,591 - CV - INFO - Begin OT Train
2023-09-02 20:46:03,591 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:03,657 - FGO - INFO - Epoch   0 | Train Loss: -12.776 | Val Loss: -1.06 | Val F1: 0.94 |
2023-09-02 20:46:04,509 - FGO - INFO - Epoch  10 | Train Loss: -13.225 | Val Loss: -1.06 | Val F1: 0.91 |
2023-09-02 20:46:05,335 - FGO - INFO - Epoch  20 | Train Loss: -13.566 | Val Loss: -1.02 | Val F1: 0.88 |
2023-09-02 20:46:06,179 - FGO - INFO - Epoch  30 | Train Loss: -13.734 | Val Loss: -0.98 | Val F1: 0.84 |
2023-09-02 20:46:06,920 - FGO - INFO - Epoch  40 | Train Loss: -13.804 | Val Loss: -0.98 | Val F1: 0.87 |
2023-09-02 20:46:07,640 - FGO - INFO - Best Epoch:   7 | Train Loss: -13.114 | Val Loss: -1.03 | Val F1: 0.91 |
2023-09-02 20:46:07,640 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:07,643 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:46:07,643 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:07,667 - FGO - INFO - Train CM:
[[400   0]
 [188 146]]
2023-09-02 20:46:07,667 - FGO - INFO - Val CM:
[[34  0]
 [ 8 28]]
2023-09-02 20:46:07,668 - FGO - INFO - Test CM:
[[34  0]
 [ 8 28]]
2023-09-02 20:46:07,673 - FGO - INFO - test statistical parity: 0.018893387314439902
2023-09-02 20:46:07,674 - FGO - INFO - test equal opportunity: 0.06666666666666665
2023-09-02 20:46:07,675 - FGO - INFO - test micro f1: 0.8857142857142857
2023-09-02 20:46:07,676 - FGO - INFO - test macro f1: 0.8848684210526316
2023-09-02 20:46:07,676 - CV - INFO - fold time: 4.433843374252319s (0.07389738957087198m)
2023-09-02 20:46:07,676 - CV - INFO - ----- BEGINNING FOLD SET (006:9)----------------------------------------------------------
2023-09-02 20:46:07,677 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/006/9
2023-09-02 20:46:07,677 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:07,677 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:07,677 - FGO - INFO - 	done: False
2023-09-02 20:46:07,677 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:07,677 - FGO - INFO - 	h1: 64
2023-09-02 20:46:07,677 - FGO - INFO - 	h2: 32
2023-09-02 20:46:07,677 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:07,677 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:07,678 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:07,678 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:07,678 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:46:07,678 - FGO - INFO - 	theta: 50
2023-09-02 20:46:07,678 - FGO - INFO - 	clip: 5
2023-09-02 20:46:07,678 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:07,678 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:07,678 - FGO - INFO - Source Total: 725
2023-09-02 20:46:07,678 - FGO - INFO - Target Total: 79
2023-09-02 20:46:07,678 - FGO - INFO - Train Total: 725
2023-09-02 20:46:07,678 - FGO - INFO - Val Total:   79
2023-09-02 20:46:07,678 - FGO - INFO - Test Total:  79
2023-09-02 20:46:07,678 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:07,678 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:07,678 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:07,678 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:07,678 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:07,678 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:07,678 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:07,678 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:07,678 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:07,678 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:07,679 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:07,681 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:07,779 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:07,779 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:07,779 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:07,779 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:07,779 - FGO - INFO - N: 804
2023-09-02 20:46:07,779 - FGO - INFO - N_s: 725
2023-09-02 20:46:07,779 - FGO - INFO - N_t: 79
2023-09-02 20:46:07,783 - CV - INFO - Begin Pretrain
2023-09-02 20:46:07,783 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:07,786 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:46:07,811 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.50 |
2023-09-02 20:46:07,836 - FGO - INFO - Epoch  20 | Train Loss: 0.648 | Val Loss: 0.65 | Val F1: 0.59 |
2023-09-02 20:46:07,860 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.61 | Val F1: 0.69 |
2023-09-02 20:46:07,884 - FGO - INFO - Epoch  40 | Train Loss: 0.504 | Val Loss: 0.54 | Val F1: 0.78 |
2023-09-02 20:46:07,909 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:46:07,933 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.34 | Val F1: 0.90 |
2023-09-02 20:46:07,957 - FGO - INFO - Epoch  70 | Train Loss: 0.227 | Val Loss: 0.26 | Val F1: 0.92 |
2023-09-02 20:46:07,982 - FGO - INFO - Epoch  80 | Train Loss: 0.182 | Val Loss: 0.21 | Val F1: 0.96 |
2023-09-02 20:46:08,007 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:46:08,031 - FGO - INFO - Epoch 100 | Train Loss: 0.133 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:46:08,031 - FGO - INFO - Best Epoch:  85 | Train Loss: 0.165 | Val Loss: 0.19 | Val F1: 0.97 
2023-09-02 20:46:08,031 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:08,032 - CV - INFO - Pretrain Complete, 85 epochs
2023-09-02 20:46:08,032 - CV - INFO - Begin OT Train
2023-09-02 20:46:08,032 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:08,097 - FGO - INFO - Epoch   0 | Train Loss: -12.803 | Val Loss: -1.25 | Val F1: 0.96 |
2023-09-02 20:46:08,918 - FGO - INFO - Epoch  10 | Train Loss: -13.242 | Val Loss: -1.30 | Val F1: 0.96 |
2023-09-02 20:46:09,742 - FGO - INFO - Epoch  20 | Train Loss: -13.563 | Val Loss: -1.33 | Val F1: 0.95 |
2023-09-02 20:46:10,510 - FGO - INFO - Epoch  30 | Train Loss: -13.713 | Val Loss: -1.31 | Val F1: 0.95 |
2023-09-02 20:46:11,276 - FGO - INFO - Epoch  40 | Train Loss: -13.786 | Val Loss: -1.28 | Val F1: 0.96 |
2023-09-02 20:46:11,961 - FGO - INFO - Best Epoch:  13 | Train Loss: -13.356 | Val Loss: -1.32 | Val F1: 0.97 |
2023-09-02 20:46:11,961 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:11,964 - CV - INFO - OT Train Complete, 13 epochs
2023-09-02 20:46:11,964 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:11,993 - FGO - INFO - Train CM:
[[385   0]
 [236 104]]
2023-09-02 20:46:11,993 - FGO - INFO - Val CM:
[[48  1]
 [ 2 28]]
2023-09-02 20:46:11,994 - FGO - INFO - Test CM:
[[48  1]
 [ 2 28]]
2023-09-02 20:46:11,999 - FGO - INFO - test statistical parity: 0.03768115942028988
2023-09-02 20:46:12,000 - FGO - INFO - test equal opportunity: 0.07692307692307687
2023-09-02 20:46:12,001 - FGO - INFO - test micro f1: 0.9620253164556962
2023-09-02 20:46:12,001 - FGO - INFO - test macro f1: 0.9594247560349256
2023-09-02 20:46:12,001 - CV - INFO - fold time: 4.325687646865845s (0.07209479411443075m)
2023-09-02 20:46:12,001 - CV - INFO - Mean Pretrain Epochs 85.7:
2023-09-02 20:46:12,001 - CV - INFO - Mean OT Train Epochs 10.1:
2023-09-02 20:46:12,001 - CV - INFO - Mean Val Macro F1 : 0.8965370915485856
2023-09-02 20:46:12,001 - CV - INFO - Mean Eval Stat : 0.8965370915485856 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:46:12,002 - CV - INFO - set time: 43.4954354763031s (0.7249239246050517m)
2023-09-02 20:46:12,002 - CV - INFO - script time so far: 269.9526479244232s (4.499210798740387m) (0.07498684664567312h)
2023-09-02 20:46:12,002 - CV - INFO - ===== BEGINNING OPTION SET (007)==========================================================
2023-09-02 20:46:12,002 - CV - INFO - 	done: False
2023-09-02 20:46:12,002 - CV - INFO - 	learning_rate: 0.001
2023-09-02 20:46:12,002 - CV - INFO - 	h1: 64
2023-09-02 20:46:12,002 - CV - INFO - 	h2: 32
2023-09-02 20:46:12,002 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:12,002 - CV - INFO - 	dropout: 0.0
2023-09-02 20:46:12,002 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:12,002 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:12,002 - CV - INFO - 	lambda: 0.05
2023-09-02 20:46:12,002 - CV - INFO - 	theta: 10
2023-09-02 20:46:12,002 - CV - INFO - 	clip: 5
2023-09-02 20:46:12,002 - CV - INFO - ----- BEGINNING FOLD SET (007:0)----------------------------------------------------------
2023-09-02 20:46:12,003 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/007/0
2023-09-02 20:46:12,003 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:12,003 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:12,003 - FGO - INFO - 	done: False
2023-09-02 20:46:12,003 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:12,003 - FGO - INFO - 	h1: 64
2023-09-02 20:46:12,004 - FGO - INFO - 	h2: 32
2023-09-02 20:46:12,004 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:12,004 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:12,004 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:12,004 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:12,004 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:12,004 - FGO - INFO - 	theta: 10
2023-09-02 20:46:12,004 - FGO - INFO - 	clip: 5
2023-09-02 20:46:12,004 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:12,004 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:12,004 - FGO - INFO - Source Total: 708
2023-09-02 20:46:12,004 - FGO - INFO - Target Total: 96
2023-09-02 20:46:12,004 - FGO - INFO - Train Total: 708
2023-09-02 20:46:12,004 - FGO - INFO - Val Total:   96
2023-09-02 20:46:12,004 - FGO - INFO - Test Total:  96
2023-09-02 20:46:12,004 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:12,004 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:12,004 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:12,004 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:12,004 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:12,004 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:12,004 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:12,004 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:12,004 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:12,004 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:12,005 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:12,007 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:12,122 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:12,122 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:12,122 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:12,122 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:12,122 - FGO - INFO - N: 804
2023-09-02 20:46:12,123 - FGO - INFO - N_s: 708
2023-09-02 20:46:12,123 - FGO - INFO - N_t: 96
2023-09-02 20:46:12,126 - CV - INFO - Begin Pretrain
2023-09-02 20:46:12,126 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:12,129 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:46:12,156 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:46:12,183 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.53 |
2023-09-02 20:46:12,207 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.61 | Val F1: 0.67 |
2023-09-02 20:46:12,232 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.52 | Val F1: 0.86 |
2023-09-02 20:46:12,256 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.41 | Val F1: 0.89 |
2023-09-02 20:46:12,280 - FGO - INFO - Epoch  60 | Train Loss: 0.298 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:46:12,305 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:46:12,329 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:46:12,353 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:46:12,377 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:46:12,377 - FGO - INFO - Best Epoch:  86 | Train Loss: 0.161 | Val Loss: 0.18 | Val F1: 0.95 
2023-09-02 20:46:12,377 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:12,379 - CV - INFO - Pretrain Complete, 86 epochs
2023-09-02 20:46:12,379 - CV - INFO - Begin OT Train
2023-09-02 20:46:12,379 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:12,472 - FGO - INFO - Epoch   0 | Train Loss: -4.234 | Val Loss: -0.48 | Val F1: 0.95 |
2023-09-02 20:46:13,267 - FGO - INFO - Epoch  10 | Train Loss: -4.297 | Val Loss: -0.50 | Val F1: 0.95 |
2023-09-02 20:46:14,053 - FGO - INFO - Epoch  20 | Train Loss: -4.342 | Val Loss: -0.50 | Val F1: 0.95 |
2023-09-02 20:46:14,776 - FGO - INFO - Epoch  30 | Train Loss: -4.374 | Val Loss: -0.51 | Val F1: 0.95 |
2023-09-02 20:46:15,547 - FGO - INFO - Epoch  40 | Train Loss: -4.397 | Val Loss: -0.52 | Val F1: 0.96 |
2023-09-02 20:46:16,268 - FGO - INFO - Best Epoch:   6 | Train Loss: -4.273 | Val Loss: -0.51 | Val F1: 0.96 |
2023-09-02 20:46:16,268 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:16,271 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:46:16,272 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:16,296 - FGO - INFO - Train CM:
[[377   5]
 [ 34 292]]
2023-09-02 20:46:16,297 - FGO - INFO - Val CM:
[[52  0]
 [ 4 40]]
2023-09-02 20:46:16,297 - FGO - INFO - Test CM:
[[52  0]
 [ 4 40]]
2023-09-02 20:46:16,302 - FGO - INFO - test statistical parity: 0.3508021390374332
2023-09-02 20:46:16,304 - FGO - INFO - test equal opportunity: 0.11111111111111116
2023-09-02 20:46:16,305 - FGO - INFO - test micro f1: 0.9583333333333334
2023-09-02 20:46:16,305 - FGO - INFO - test macro f1: 0.9576719576719577
2023-09-02 20:46:16,305 - CV - INFO - fold time: 4.303421974182129s (0.07172369956970215m)
2023-09-02 20:46:16,305 - CV - INFO - ----- BEGINNING FOLD SET (007:1)----------------------------------------------------------
2023-09-02 20:46:16,307 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/007/1
2023-09-02 20:46:16,307 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:16,307 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:16,307 - FGO - INFO - 	done: False
2023-09-02 20:46:16,307 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:16,307 - FGO - INFO - 	h1: 64
2023-09-02 20:46:16,307 - FGO - INFO - 	h2: 32
2023-09-02 20:46:16,307 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:16,307 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:16,307 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:16,307 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:16,307 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:16,307 - FGO - INFO - 	theta: 10
2023-09-02 20:46:16,307 - FGO - INFO - 	clip: 5
2023-09-02 20:46:16,307 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:16,307 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:16,307 - FGO - INFO - Source Total: 727
2023-09-02 20:46:16,307 - FGO - INFO - Target Total: 77
2023-09-02 20:46:16,307 - FGO - INFO - Train Total: 727
2023-09-02 20:46:16,307 - FGO - INFO - Val Total:   77
2023-09-02 20:46:16,307 - FGO - INFO - Test Total:  77
2023-09-02 20:46:16,307 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:16,307 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:16,307 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:16,307 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:16,307 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:16,308 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:16,308 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:16,308 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:16,308 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:16,308 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:16,309 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:16,310 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:16,406 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:16,406 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:16,406 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:16,406 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:16,406 - FGO - INFO - N: 804
2023-09-02 20:46:16,406 - FGO - INFO - N_s: 727
2023-09-02 20:46:16,406 - FGO - INFO - N_t: 77
2023-09-02 20:46:16,409 - CV - INFO - Begin Pretrain
2023-09-02 20:46:16,409 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:16,413 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:46:16,437 - FGO - INFO - Epoch  10 | Train Loss: 0.673 | Val Loss: 0.68 | Val F1: 0.51 |
2023-09-02 20:46:16,462 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.55 |
2023-09-02 20:46:16,487 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:46:16,512 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.55 | Val F1: 0.73 |
2023-09-02 20:46:16,537 - FGO - INFO - Epoch  50 | Train Loss: 0.396 | Val Loss: 0.47 | Val F1: 0.73 |
2023-09-02 20:46:16,561 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.40 | Val F1: 0.81 |
2023-09-02 20:46:16,586 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.34 | Val F1: 0.80 |
2023-09-02 20:46:16,611 - FGO - INFO - Epoch  80 | Train Loss: 0.172 | Val Loss: 0.29 | Val F1: 0.84 |
2023-09-02 20:46:16,635 - FGO - INFO - Epoch  90 | Train Loss: 0.142 | Val Loss: 0.26 | Val F1: 0.87 |
2023-09-02 20:46:16,660 - FGO - INFO - Epoch 100 | Train Loss: 0.122 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:46:16,660 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.147 | Val Loss: 0.27 | Val F1: 0.87 
2023-09-02 20:46:16,660 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:16,662 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:46:16,662 - CV - INFO - Begin OT Train
2023-09-02 20:46:16,662 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:16,726 - FGO - INFO - Epoch   0 | Train Loss: -4.244 | Val Loss: -0.21 | Val F1: 0.87 |
2023-09-02 20:46:17,558 - FGO - INFO - Epoch  10 | Train Loss: -4.313 | Val Loss: -0.25 | Val F1: 0.93 |
2023-09-02 20:46:18,318 - FGO - INFO - Epoch  20 | Train Loss: -4.361 | Val Loss: -0.26 | Val F1: 0.93 |
2023-09-02 20:46:19,204 - FGO - INFO - Epoch  30 | Train Loss: -4.401 | Val Loss: -0.26 | Val F1: 0.93 |
2023-09-02 20:46:19,990 - FGO - INFO - Epoch  40 | Train Loss: -4.432 | Val Loss: -0.26 | Val F1: 0.93 |
2023-09-02 20:46:20,708 - FGO - INFO - Best Epoch:  18 | Train Loss: -4.355 | Val Loss: -0.26 | Val F1: 0.93 |
2023-09-02 20:46:20,708 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:20,711 - CV - INFO - OT Train Complete, 18 epochs
2023-09-02 20:46:20,712 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:20,736 - FGO - INFO - Train CM:
[[382   8]
 [ 27 310]]
2023-09-02 20:46:20,737 - FGO - INFO - Val CM:
[[42  2]
 [ 4 29]]
2023-09-02 20:46:20,737 - FGO - INFO - Test CM:
[[42  2]
 [ 4 29]]
2023-09-02 20:46:20,742 - FGO - INFO - test statistical parity: 0.2794871794871795
2023-09-02 20:46:20,743 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:46:20,744 - FGO - INFO - test micro f1: 0.922077922077922
2023-09-02 20:46:20,745 - FGO - INFO - test macro f1: 0.9197916666666666
2023-09-02 20:46:20,745 - CV - INFO - fold time: 4.439674377441406s (0.07399457295735677m)
2023-09-02 20:46:20,745 - CV - INFO - ----- BEGINNING FOLD SET (007:2)----------------------------------------------------------
2023-09-02 20:46:20,746 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/007/2
2023-09-02 20:46:20,747 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:20,747 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:20,747 - FGO - INFO - 	done: False
2023-09-02 20:46:20,747 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:20,747 - FGO - INFO - 	h1: 64
2023-09-02 20:46:20,747 - FGO - INFO - 	h2: 32
2023-09-02 20:46:20,747 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:20,747 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:20,747 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:20,747 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:20,747 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:20,747 - FGO - INFO - 	theta: 10
2023-09-02 20:46:20,747 - FGO - INFO - 	clip: 5
2023-09-02 20:46:20,747 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:20,747 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:20,747 - FGO - INFO - Source Total: 721
2023-09-02 20:46:20,747 - FGO - INFO - Target Total: 83
2023-09-02 20:46:20,747 - FGO - INFO - Train Total: 721
2023-09-02 20:46:20,747 - FGO - INFO - Val Total:   83
2023-09-02 20:46:20,747 - FGO - INFO - Test Total:  83
2023-09-02 20:46:20,747 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:20,747 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:20,747 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:20,747 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:20,747 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:20,748 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:20,748 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:20,748 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:20,748 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:20,748 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:20,749 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:20,750 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:20,852 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:20,852 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:20,852 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:20,852 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:20,852 - FGO - INFO - N: 804
2023-09-02 20:46:20,852 - FGO - INFO - N_s: 721
2023-09-02 20:46:20,852 - FGO - INFO - N_t: 83
2023-09-02 20:46:20,856 - CV - INFO - Begin Pretrain
2023-09-02 20:46:20,856 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:20,859 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:46:20,884 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.57 |
2023-09-02 20:46:20,908 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.64 | Val F1: 0.66 |
2023-09-02 20:46:20,933 - FGO - INFO - Epoch  30 | Train Loss: 0.594 | Val Loss: 0.60 | Val F1: 0.76 |
2023-09-02 20:46:20,957 - FGO - INFO - Epoch  40 | Train Loss: 0.506 | Val Loss: 0.52 | Val F1: 0.83 |
2023-09-02 20:46:20,982 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:46:21,006 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.34 | Val F1: 0.85 |
2023-09-02 20:46:21,030 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:46:21,055 - FGO - INFO - Epoch  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:46:21,079 - FGO - INFO - Epoch  90 | Train Loss: 0.140 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:46:21,104 - FGO - INFO - Epoch 100 | Train Loss: 0.119 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:46:21,104 - FGO - INFO - Best Epoch:  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 
2023-09-02 20:46:21,104 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:21,105 - CV - INFO - Pretrain Complete, 80 epochs
2023-09-02 20:46:21,105 - CV - INFO - Begin OT Train
2023-09-02 20:46:21,105 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:21,184 - FGO - INFO - Epoch   0 | Train Loss: -4.315 | Val Loss: -0.25 | Val F1: 0.87 |
2023-09-02 20:46:21,995 - FGO - INFO - Epoch  10 | Train Loss: -4.360 | Val Loss: -0.23 | Val F1: 0.91 |
2023-09-02 20:46:22,764 - FGO - INFO - Epoch  20 | Train Loss: -4.403 | Val Loss: -0.22 | Val F1: 0.91 |
2023-09-02 20:46:23,519 - FGO - INFO - Epoch  30 | Train Loss: -4.437 | Val Loss: -0.22 | Val F1: 0.91 |
2023-09-02 20:46:24,286 - FGO - INFO - Epoch  40 | Train Loss: -4.465 | Val Loss: -0.21 | Val F1: 0.90 |
2023-09-02 20:46:25,011 - FGO - INFO - Best Epoch:   8 | Train Loss: -4.351 | Val Loss: -0.23 | Val F1: 0.91 |
2023-09-02 20:46:25,011 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:25,020 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:46:25,020 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:25,054 - FGO - INFO - Train CM:
[[379   5]
 [ 26 311]]
2023-09-02 20:46:25,055 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:46:25,055 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:46:25,059 - FGO - INFO - test statistical parity: 0.11971830985915494
2023-09-02 20:46:25,061 - FGO - INFO - test equal opportunity: 0.05555555555555547
2023-09-02 20:46:25,062 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:46:25,062 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:46:25,062 - CV - INFO - fold time: 4.317113399505615s (0.07195188999176025m)
2023-09-02 20:46:25,062 - CV - INFO - ----- BEGINNING FOLD SET (007:3)----------------------------------------------------------
2023-09-02 20:46:25,064 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/007/3
2023-09-02 20:46:25,064 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:25,064 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:25,064 - FGO - INFO - 	done: False
2023-09-02 20:46:25,064 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:25,064 - FGO - INFO - 	h1: 64
2023-09-02 20:46:25,064 - FGO - INFO - 	h2: 32
2023-09-02 20:46:25,064 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:25,064 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:25,064 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:25,064 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:25,064 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:25,064 - FGO - INFO - 	theta: 10
2023-09-02 20:46:25,064 - FGO - INFO - 	clip: 5
2023-09-02 20:46:25,064 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:25,064 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:25,064 - FGO - INFO - Source Total: 729
2023-09-02 20:46:25,064 - FGO - INFO - Target Total: 75
2023-09-02 20:46:25,064 - FGO - INFO - Train Total: 729
2023-09-02 20:46:25,064 - FGO - INFO - Val Total:   75
2023-09-02 20:46:25,064 - FGO - INFO - Test Total:  75
2023-09-02 20:46:25,064 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:25,064 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:25,064 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:25,064 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:25,064 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:25,065 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:25,065 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:25,065 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:25,065 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:25,065 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:25,066 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:25,067 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:25,161 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:25,161 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:25,161 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:25,161 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:25,161 - FGO - INFO - N: 804
2023-09-02 20:46:25,161 - FGO - INFO - N_s: 729
2023-09-02 20:46:25,161 - FGO - INFO - N_t: 75
2023-09-02 20:46:25,165 - CV - INFO - Begin Pretrain
2023-09-02 20:46:25,165 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:25,168 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:46:25,192 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.67 | Val F1: 0.39 |
2023-09-02 20:46:25,217 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.64 |
2023-09-02 20:46:25,242 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.57 | Val F1: 0.86 |
2023-09-02 20:46:25,267 - FGO - INFO - Epoch  40 | Train Loss: 0.510 | Val Loss: 0.47 | Val F1: 0.92 |
2023-09-02 20:46:25,291 - FGO - INFO - Epoch  50 | Train Loss: 0.406 | Val Loss: 0.34 | Val F1: 0.93 |
2023-09-02 20:46:25,316 - FGO - INFO - Epoch  60 | Train Loss: 0.305 | Val Loss: 0.23 | Val F1: 0.97 |
2023-09-02 20:46:25,340 - FGO - INFO - Epoch  70 | Train Loss: 0.231 | Val Loss: 0.16 | Val F1: 0.99 |
2023-09-02 20:46:25,365 - FGO - INFO - Epoch  80 | Train Loss: 0.186 | Val Loss: 0.12 | Val F1: 0.99 |
2023-09-02 20:46:25,389 - FGO - INFO - Epoch  90 | Train Loss: 0.156 | Val Loss: 0.10 | Val F1: 0.99 |
2023-09-02 20:46:25,414 - FGO - INFO - Epoch 100 | Train Loss: 0.135 | Val Loss: 0.09 | Val F1: 0.97 |
2023-09-02 20:46:25,414 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.161 | Val Loss: 0.10 | Val F1: 0.99 
2023-09-02 20:46:25,414 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:25,415 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:46:25,416 - CV - INFO - Begin OT Train
2023-09-02 20:46:25,416 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:25,509 - FGO - INFO - Epoch   0 | Train Loss: -3.978 | Val Loss: -0.39 | Val F1: 0.99 |
2023-09-02 20:46:26,393 - FGO - INFO - Epoch  10 | Train Loss: -4.297 | Val Loss: -0.41 | Val F1: 0.99 |
2023-09-02 20:46:27,168 - FGO - INFO - Epoch  20 | Train Loss: -4.344 | Val Loss: -0.38 | Val F1: 0.97 |
2023-09-02 20:46:27,957 - FGO - INFO - Epoch  30 | Train Loss: -4.378 | Val Loss: -0.41 | Val F1: 0.97 |
2023-09-02 20:46:28,753 - FGO - INFO - Epoch  40 | Train Loss: -4.403 | Val Loss: -0.42 | Val F1: 0.99 |
2023-09-02 20:46:29,454 - FGO - INFO - Best Epoch:   8 | Train Loss: -4.311 | Val Loss: -0.39 | Val F1: 0.99 |
2023-09-02 20:46:29,454 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:29,458 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:46:29,458 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:29,486 - FGO - INFO - Train CM:
[[393   3]
 [ 41 292]]
2023-09-02 20:46:29,487 - FGO - INFO - Val CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:46:29,487 - FGO - INFO - Test CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:46:29,491 - FGO - INFO - test statistical parity: 0.024590163934426257
2023-09-02 20:46:29,493 - FGO - INFO - test equal opportunity: 0.033333333333333326
2023-09-02 20:46:29,493 - FGO - INFO - test micro f1: 0.9866666666666668
2023-09-02 20:46:29,494 - FGO - INFO - test macro f1: 0.9866571784380003
2023-09-02 20:46:29,494 - CV - INFO - fold time: 4.431907653808594s (0.07386512756347656m)
2023-09-02 20:46:29,494 - CV - INFO - ----- BEGINNING FOLD SET (007:4)----------------------------------------------------------
2023-09-02 20:46:29,495 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/007/4
2023-09-02 20:46:29,496 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:29,496 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:29,496 - FGO - INFO - 	done: False
2023-09-02 20:46:29,496 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:29,496 - FGO - INFO - 	h1: 64
2023-09-02 20:46:29,496 - FGO - INFO - 	h2: 32
2023-09-02 20:46:29,496 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:29,496 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:29,496 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:29,496 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:29,496 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:29,496 - FGO - INFO - 	theta: 10
2023-09-02 20:46:29,496 - FGO - INFO - 	clip: 5
2023-09-02 20:46:29,496 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:29,496 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:29,496 - FGO - INFO - Source Total: 732
2023-09-02 20:46:29,496 - FGO - INFO - Target Total: 72
2023-09-02 20:46:29,496 - FGO - INFO - Train Total: 732
2023-09-02 20:46:29,496 - FGO - INFO - Val Total:   72
2023-09-02 20:46:29,496 - FGO - INFO - Test Total:  72
2023-09-02 20:46:29,496 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:29,496 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:29,496 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:29,496 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:29,496 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:29,497 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:29,497 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:29,497 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:29,497 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:29,497 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:29,498 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:29,499 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:29,589 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:29,589 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:29,589 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:29,589 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:29,589 - FGO - INFO - N: 804
2023-09-02 20:46:29,589 - FGO - INFO - N_s: 732
2023-09-02 20:46:29,589 - FGO - INFO - N_t: 72
2023-09-02 20:46:29,593 - CV - INFO - Begin Pretrain
2023-09-02 20:46:29,593 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:29,596 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:46:29,621 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.68 | Val F1: 0.45 |
2023-09-02 20:46:29,646 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.66 | Val F1: 0.63 |
2023-09-02 20:46:29,670 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.60 | Val F1: 0.75 |
2023-09-02 20:46:29,695 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.50 | Val F1: 0.87 |
2023-09-02 20:46:29,720 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.39 | Val F1: 0.89 |
2023-09-02 20:46:29,744 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:46:29,769 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:46:29,793 - FGO - INFO - Epoch  80 | Train Loss: 0.179 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:46:29,818 - FGO - INFO - Epoch  90 | Train Loss: 0.150 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:46:29,843 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:46:29,843 - FGO - INFO - Best Epoch:  81 | Train Loss: 0.175 | Val Loss: 0.16 | Val F1: 0.97 
2023-09-02 20:46:29,843 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:29,844 - CV - INFO - Pretrain Complete, 81 epochs
2023-09-02 20:46:29,844 - CV - INFO - Begin OT Train
2023-09-02 20:46:29,844 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:29,909 - FGO - INFO - Epoch   0 | Train Loss: -4.247 | Val Loss: -0.34 | Val F1: 0.97 |
2023-09-02 20:46:30,738 - FGO - INFO - Epoch  10 | Train Loss: -4.336 | Val Loss: -0.32 | Val F1: 0.96 |
2023-09-02 20:46:31,510 - FGO - INFO - Epoch  20 | Train Loss: -4.374 | Val Loss: -0.33 | Val F1: 0.96 |
2023-09-02 20:46:32,241 - FGO - INFO - Epoch  30 | Train Loss: -4.408 | Val Loss: -0.32 | Val F1: 0.96 |
2023-09-02 20:46:33,044 - FGO - INFO - Epoch  40 | Train Loss: -4.431 | Val Loss: -0.32 | Val F1: 0.96 |
2023-09-02 20:46:33,740 - FGO - INFO - Best Epoch:   7 | Train Loss: -4.314 | Val Loss: -0.33 | Val F1: 0.97 |
2023-09-02 20:46:33,740 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:33,743 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:46:33,743 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:33,766 - FGO - INFO - Train CM:
[[395   2]
 [ 39 296]]
2023-09-02 20:46:33,766 - FGO - INFO - Val CM:
[[37  0]
 [ 3 32]]
2023-09-02 20:46:33,767 - FGO - INFO - Test CM:
[[37  0]
 [ 3 32]]
2023-09-02 20:46:33,771 - FGO - INFO - test statistical parity: 0.05161290322580642
2023-09-02 20:46:33,773 - FGO - INFO - test equal opportunity: 0.1333333333333333
2023-09-02 20:46:33,773 - FGO - INFO - test micro f1: 0.9583333333333334
2023-09-02 20:46:33,774 - FGO - INFO - test macro f1: 0.9581314208179881
2023-09-02 20:46:33,774 - CV - INFO - fold time: 4.279964923858643s (0.07133274873097738m)
2023-09-02 20:46:33,774 - CV - INFO - ----- BEGINNING FOLD SET (007:5)----------------------------------------------------------
2023-09-02 20:46:33,775 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/007/5
2023-09-02 20:46:33,776 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:33,776 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:33,776 - FGO - INFO - 	done: False
2023-09-02 20:46:33,776 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:33,776 - FGO - INFO - 	h1: 64
2023-09-02 20:46:33,776 - FGO - INFO - 	h2: 32
2023-09-02 20:46:33,776 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:33,776 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:33,776 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:33,776 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:33,776 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:33,776 - FGO - INFO - 	theta: 10
2023-09-02 20:46:33,776 - FGO - INFO - 	clip: 5
2023-09-02 20:46:33,776 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:33,776 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:33,776 - FGO - INFO - Source Total: 726
2023-09-02 20:46:33,776 - FGO - INFO - Target Total: 78
2023-09-02 20:46:33,776 - FGO - INFO - Train Total: 726
2023-09-02 20:46:33,776 - FGO - INFO - Val Total:   78
2023-09-02 20:46:33,776 - FGO - INFO - Test Total:  78
2023-09-02 20:46:33,776 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:33,776 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:33,776 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:33,776 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:33,776 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:33,777 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:33,777 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:33,777 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:33,777 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:33,777 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:33,778 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:33,779 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:33,877 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:33,877 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:33,877 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:33,877 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:33,877 - FGO - INFO - N: 804
2023-09-02 20:46:33,877 - FGO - INFO - N_s: 726
2023-09-02 20:46:33,877 - FGO - INFO - N_t: 78
2023-09-02 20:46:33,881 - CV - INFO - Begin Pretrain
2023-09-02 20:46:33,881 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:33,884 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:46:33,911 - FGO - INFO - Epoch  10 | Train Loss: 0.669 | Val Loss: 0.72 | Val F1: 0.34 |
2023-09-02 20:46:33,937 - FGO - INFO - Epoch  20 | Train Loss: 0.644 | Val Loss: 0.69 | Val F1: 0.42 |
2023-09-02 20:46:33,962 - FGO - INFO - Epoch  30 | Train Loss: 0.591 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:46:33,986 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.53 | Val F1: 0.83 |
2023-09-02 20:46:34,011 - FGO - INFO - Epoch  50 | Train Loss: 0.397 | Val Loss: 0.41 | Val F1: 0.85 |
2023-09-02 20:46:34,035 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:46:34,060 - FGO - INFO - Epoch  70 | Train Loss: 0.220 | Val Loss: 0.27 | Val F1: 0.88 |
2023-09-02 20:46:34,084 - FGO - INFO - Epoch  80 | Train Loss: 0.175 | Val Loss: 0.25 | Val F1: 0.88 |
2023-09-02 20:46:34,108 - FGO - INFO - Epoch  90 | Train Loss: 0.148 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:46:34,132 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.21 | Val F1: 0.91 |
2023-09-02 20:46:34,133 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.209 | Val Loss: 0.26 | Val F1: 0.91 
2023-09-02 20:46:34,133 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:34,134 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:46:34,134 - CV - INFO - Begin OT Train
2023-09-02 20:46:34,134 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:34,198 - FGO - INFO - Epoch   0 | Train Loss: -4.109 | Val Loss: -0.27 | Val F1: 0.91 |
2023-09-02 20:46:34,990 - FGO - INFO - Epoch  10 | Train Loss: -4.318 | Val Loss: -0.20 | Val F1: 0.90 |
2023-09-02 20:46:35,727 - FGO - INFO - Epoch  20 | Train Loss: -4.370 | Val Loss: -0.14 | Val F1: 0.88 |
2023-09-02 20:46:36,517 - FGO - INFO - Epoch  30 | Train Loss: -4.399 | Val Loss: -0.09 | Val F1: 0.86 |
2023-09-02 20:46:37,317 - FGO - INFO - Epoch  40 | Train Loss: -4.426 | Val Loss: -0.10 | Val F1: 0.87 |
2023-09-02 20:46:38,002 - FGO - INFO - Best Epoch:   8 | Train Loss: -4.315 | Val Loss: -0.19 | Val F1: 0.90 |
2023-09-02 20:46:38,002 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:38,005 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:46:38,005 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:38,032 - FGO - INFO - Train CM:
[[396   4]
 [ 34 292]]
2023-09-02 20:46:38,033 - FGO - INFO - Val CM:
[[34  0]
 [ 9 35]]
2023-09-02 20:46:38,033 - FGO - INFO - Test CM:
[[34  0]
 [ 9 35]]
2023-09-02 20:46:38,038 - FGO - INFO - test statistical parity: 0.12077294685990342
2023-09-02 20:46:38,040 - FGO - INFO - test equal opportunity: 0.23076923076923073
2023-09-02 20:46:38,041 - FGO - INFO - test micro f1: 0.8846153846153846
2023-09-02 20:46:38,041 - FGO - INFO - test macro f1: 0.8845964162419858
2023-09-02 20:46:38,041 - CV - INFO - fold time: 4.26716685295105s (0.07111944754918416m)
2023-09-02 20:46:38,041 - CV - INFO - ----- BEGINNING FOLD SET (007:6)----------------------------------------------------------
2023-09-02 20:46:38,043 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/007/6
2023-09-02 20:46:38,043 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:38,043 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:38,043 - FGO - INFO - 	done: False
2023-09-02 20:46:38,043 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:38,043 - FGO - INFO - 	h1: 64
2023-09-02 20:46:38,043 - FGO - INFO - 	h2: 32
2023-09-02 20:46:38,043 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:38,043 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:38,043 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:38,043 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:38,043 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:38,043 - FGO - INFO - 	theta: 10
2023-09-02 20:46:38,043 - FGO - INFO - 	clip: 5
2023-09-02 20:46:38,043 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:38,043 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:38,043 - FGO - INFO - Source Total: 717
2023-09-02 20:46:38,043 - FGO - INFO - Target Total: 87
2023-09-02 20:46:38,043 - FGO - INFO - Train Total: 717
2023-09-02 20:46:38,043 - FGO - INFO - Val Total:   87
2023-09-02 20:46:38,043 - FGO - INFO - Test Total:  87
2023-09-02 20:46:38,043 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:38,043 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:38,043 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:38,043 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:38,043 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:38,044 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:38,044 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:38,044 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:38,044 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:38,044 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:38,045 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:38,046 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:38,153 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:38,153 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:38,153 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:38,153 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:38,153 - FGO - INFO - N: 804
2023-09-02 20:46:38,153 - FGO - INFO - N_s: 717
2023-09-02 20:46:38,153 - FGO - INFO - N_t: 87
2023-09-02 20:46:38,156 - CV - INFO - Begin Pretrain
2023-09-02 20:46:38,156 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:38,160 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:46:38,184 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.47 |
2023-09-02 20:46:38,209 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.63 |
2023-09-02 20:46:38,233 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.78 |
2023-09-02 20:46:38,258 - FGO - INFO - Epoch  40 | Train Loss: 0.509 | Val Loss: 0.50 | Val F1: 0.84 |
2023-09-02 20:46:38,282 - FGO - INFO - Epoch  50 | Train Loss: 0.402 | Val Loss: 0.40 | Val F1: 0.86 |
2023-09-02 20:46:38,307 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.31 | Val F1: 0.92 |
2023-09-02 20:46:38,331 - FGO - INFO - Epoch  70 | Train Loss: 0.228 | Val Loss: 0.23 | Val F1: 0.92 |
2023-09-02 20:46:38,356 - FGO - INFO - Epoch  80 | Train Loss: 0.184 | Val Loss: 0.19 | Val F1: 0.93 |
2023-09-02 20:46:38,380 - FGO - INFO - Epoch  90 | Train Loss: 0.154 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:46:38,404 - FGO - INFO - Epoch 100 | Train Loss: 0.134 | Val Loss: 0.14 | Val F1: 0.95 |
2023-09-02 20:46:38,404 - FGO - INFO - Best Epoch:  99 | Train Loss: 0.135 | Val Loss: 0.14 | Val F1: 0.95 
2023-09-02 20:46:38,404 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:38,406 - CV - INFO - Pretrain Complete, 99 epochs
2023-09-02 20:46:38,406 - CV - INFO - Begin OT Train
2023-09-02 20:46:38,406 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:38,498 - FGO - INFO - Epoch   0 | Train Loss: -4.201 | Val Loss: -0.43 | Val F1: 0.95 |
2023-09-02 20:46:39,346 - FGO - INFO - Epoch  10 | Train Loss: -4.287 | Val Loss: -0.43 | Val F1: 0.94 |
2023-09-02 20:46:40,119 - FGO - INFO - Epoch  20 | Train Loss: -4.324 | Val Loss: -0.45 | Val F1: 0.93 |
2023-09-02 20:46:40,939 - FGO - INFO - Epoch  30 | Train Loss: -4.356 | Val Loss: -0.46 | Val F1: 0.92 |
2023-09-02 20:46:41,706 - FGO - INFO - Epoch  40 | Train Loss: -4.381 | Val Loss: -0.47 | Val F1: 0.92 |
2023-09-02 20:46:42,459 - FGO - INFO - Best Epoch:   6 | Train Loss: -4.260 | Val Loss: -0.44 | Val F1: 0.94 |
2023-09-02 20:46:42,459 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:42,466 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:46:42,467 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:42,495 - FGO - INFO - Train CM:
[[381   4]
 [ 39 293]]
2023-09-02 20:46:42,495 - FGO - INFO - Val CM:
[[48  1]
 [ 5 33]]
2023-09-02 20:46:42,496 - FGO - INFO - Test CM:
[[48  1]
 [ 5 33]]
2023-09-02 20:46:42,501 - FGO - INFO - test statistical parity: 0.120253164556962
2023-09-02 20:46:42,502 - FGO - INFO - test equal opportunity: 0.1470588235294118
2023-09-02 20:46:42,503 - FGO - INFO - test micro f1: 0.9310344827586207
2023-09-02 20:46:42,503 - FGO - INFO - test macro f1: 0.928921568627451
2023-09-02 20:46:42,504 - CV - INFO - fold time: 4.462387561798096s (0.07437312602996826m)
2023-09-02 20:46:42,504 - CV - INFO - ----- BEGINNING FOLD SET (007:7)----------------------------------------------------------
2023-09-02 20:46:42,505 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/007/7
2023-09-02 20:46:42,505 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:42,505 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:42,505 - FGO - INFO - 	done: False
2023-09-02 20:46:42,505 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:42,505 - FGO - INFO - 	h1: 64
2023-09-02 20:46:42,505 - FGO - INFO - 	h2: 32
2023-09-02 20:46:42,505 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:42,505 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:42,505 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:42,505 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:42,505 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:42,505 - FGO - INFO - 	theta: 10
2023-09-02 20:46:42,505 - FGO - INFO - 	clip: 5
2023-09-02 20:46:42,505 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:42,505 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:42,505 - FGO - INFO - Source Total: 717
2023-09-02 20:46:42,505 - FGO - INFO - Target Total: 87
2023-09-02 20:46:42,505 - FGO - INFO - Train Total: 717
2023-09-02 20:46:42,505 - FGO - INFO - Val Total:   87
2023-09-02 20:46:42,506 - FGO - INFO - Test Total:  87
2023-09-02 20:46:42,506 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:42,506 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:42,506 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:42,506 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:42,506 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:42,506 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:42,506 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:42,506 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:42,506 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:42,506 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:42,507 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:42,508 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:42,614 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:42,614 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:42,614 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:42,614 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:42,614 - FGO - INFO - N: 804
2023-09-02 20:46:42,614 - FGO - INFO - N_s: 717
2023-09-02 20:46:42,614 - FGO - INFO - N_t: 87
2023-09-02 20:46:42,618 - CV - INFO - Begin Pretrain
2023-09-02 20:46:42,618 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:42,621 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:46:42,645 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.40 |
2023-09-02 20:46:42,670 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.62 |
2023-09-02 20:46:42,695 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.77 |
2023-09-02 20:46:42,719 - FGO - INFO - Epoch  40 | Train Loss: 0.507 | Val Loss: 0.52 | Val F1: 0.88 |
2023-09-02 20:46:42,744 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.41 | Val F1: 0.88 |
2023-09-02 20:46:42,768 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:46:42,793 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.23 | Val F1: 0.94 |
2023-09-02 20:46:42,817 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:46:42,842 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:46:42,866 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:46:42,866 - FGO - INFO - Best Epoch:  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.97 
2023-09-02 20:46:42,866 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:42,868 - CV - INFO - Pretrain Complete, 90 epochs
2023-09-02 20:46:42,868 - CV - INFO - Begin OT Train
2023-09-02 20:46:42,868 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:42,935 - FGO - INFO - Epoch   0 | Train Loss: -4.228 | Val Loss: -0.42 | Val F1: 0.97 |
2023-09-02 20:46:43,877 - FGO - INFO - Epoch  10 | Train Loss: -4.302 | Val Loss: -0.37 | Val F1: 0.93 |
2023-09-02 20:46:44,675 - FGO - INFO - Epoch  20 | Train Loss: -4.350 | Val Loss: -0.39 | Val F1: 0.93 |
2023-09-02 20:46:45,506 - FGO - INFO - Epoch  30 | Train Loss: -4.386 | Val Loss: -0.40 | Val F1: 0.94 |
2023-09-02 20:46:46,290 - FGO - INFO - Epoch  40 | Train Loss: -4.414 | Val Loss: -0.41 | Val F1: 0.95 |
2023-09-02 20:46:47,010 - FGO - INFO - Best Epoch:   6 | Train Loss: -4.273 | Val Loss: -0.41 | Val F1: 0.95 |
2023-09-02 20:46:47,010 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:47,013 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:46:47,013 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:47,037 - FGO - INFO - Train CM:
[[380   7]
 [ 33 297]]
2023-09-02 20:46:47,038 - FGO - INFO - Val CM:
[[47  0]
 [ 4 36]]
2023-09-02 20:46:47,038 - FGO - INFO - Test CM:
[[47  0]
 [ 4 36]]
2023-09-02 20:46:47,043 - FGO - INFO - test statistical parity: 0.39
2023-09-02 20:46:47,045 - FGO - INFO - test equal opportunity: 0.12903225806451613
2023-09-02 20:46:47,046 - FGO - INFO - test micro f1: 0.9540229885057472
2023-09-02 20:46:47,046 - FGO - INFO - test macro f1: 0.9532760472610098
2023-09-02 20:46:47,046 - CV - INFO - fold time: 4.542582273483276s (0.0757097045580546m)
2023-09-02 20:46:47,046 - CV - INFO - ----- BEGINNING FOLD SET (007:8)----------------------------------------------------------
2023-09-02 20:46:47,048 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/007/8
2023-09-02 20:46:47,048 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:47,048 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:47,048 - FGO - INFO - 	done: False
2023-09-02 20:46:47,048 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:47,048 - FGO - INFO - 	h1: 64
2023-09-02 20:46:47,048 - FGO - INFO - 	h2: 32
2023-09-02 20:46:47,048 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:47,048 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:47,048 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:47,048 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:47,048 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:47,048 - FGO - INFO - 	theta: 10
2023-09-02 20:46:47,048 - FGO - INFO - 	clip: 5
2023-09-02 20:46:47,048 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:47,048 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:47,048 - FGO - INFO - Source Total: 734
2023-09-02 20:46:47,048 - FGO - INFO - Target Total: 70
2023-09-02 20:46:47,048 - FGO - INFO - Train Total: 734
2023-09-02 20:46:47,048 - FGO - INFO - Val Total:   70
2023-09-02 20:46:47,048 - FGO - INFO - Test Total:  70
2023-09-02 20:46:47,048 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:47,048 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:47,048 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:47,048 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:47,048 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:47,049 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:47,049 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:47,049 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:47,049 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:47,049 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:47,050 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:47,051 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:47,139 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:47,139 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:47,139 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:47,139 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:47,139 - FGO - INFO - N: 804
2023-09-02 20:46:47,139 - FGO - INFO - N_s: 734
2023-09-02 20:46:47,139 - FGO - INFO - N_t: 70
2023-09-02 20:46:47,143 - CV - INFO - Begin Pretrain
2023-09-02 20:46:47,143 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:47,146 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:46:47,171 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.69 | Val F1: 0.41 |
2023-09-02 20:46:47,196 - FGO - INFO - Epoch  20 | Train Loss: 0.645 | Val Loss: 0.66 | Val F1: 0.62 |
2023-09-02 20:46:47,221 - FGO - INFO - Epoch  30 | Train Loss: 0.588 | Val Loss: 0.61 | Val F1: 0.76 |
2023-09-02 20:46:47,246 - FGO - INFO - Epoch  40 | Train Loss: 0.498 | Val Loss: 0.53 | Val F1: 0.81 |
2023-09-02 20:46:47,271 - FGO - INFO - Epoch  50 | Train Loss: 0.392 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:46:47,295 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:46:47,320 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.27 | Val F1: 0.86 |
2023-09-02 20:46:47,345 - FGO - INFO - Epoch  80 | Train Loss: 0.181 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:46:47,369 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:46:47,394 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:46:47,394 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.157 | Val Loss: 0.19 | Val F1: 0.94 
2023-09-02 20:46:47,394 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:47,395 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:46:47,395 - CV - INFO - Begin OT Train
2023-09-02 20:46:47,395 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:47,490 - FGO - INFO - Epoch   0 | Train Loss: -4.122 | Val Loss: -0.26 | Val F1: 0.94 |
2023-09-02 20:46:48,250 - FGO - INFO - Epoch  10 | Train Loss: -4.314 | Val Loss: -0.22 | Val F1: 0.91 |
2023-09-02 20:46:49,041 - FGO - INFO - Epoch  20 | Train Loss: -4.357 | Val Loss: -0.20 | Val F1: 0.91 |
2023-09-02 20:46:49,806 - FGO - INFO - Epoch  30 | Train Loss: -4.393 | Val Loss: -0.16 | Val F1: 0.90 |
2023-09-02 20:46:50,583 - FGO - INFO - Epoch  40 | Train Loss: -4.420 | Val Loss: -0.15 | Val F1: 0.90 |
2023-09-02 20:46:51,271 - FGO - INFO - Best Epoch:   7 | Train Loss: -4.304 | Val Loss: -0.22 | Val F1: 0.91 |
2023-09-02 20:46:51,271 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:51,275 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:46:51,275 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:51,309 - FGO - INFO - Train CM:
[[398   2]
 [ 47 287]]
2023-09-02 20:46:51,309 - FGO - INFO - Val CM:
[[34  0]
 [ 6 30]]
2023-09-02 20:46:51,309 - FGO - INFO - Test CM:
[[34  0]
 [ 6 30]]
2023-09-02 20:46:51,314 - FGO - INFO - test statistical parity: 0.053981106612685514
2023-09-02 20:46:51,315 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:46:51,316 - FGO - INFO - test micro f1: 0.9142857142857143
2023-09-02 20:46:51,317 - FGO - INFO - test macro f1: 0.914004914004914
2023-09-02 20:46:51,317 - CV - INFO - fold time: 4.270395278930664s (0.0711732546488444m)
2023-09-02 20:46:51,317 - CV - INFO - ----- BEGINNING FOLD SET (007:9)----------------------------------------------------------
2023-09-02 20:46:51,318 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/007/9
2023-09-02 20:46:51,318 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:51,318 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:51,318 - FGO - INFO - 	done: False
2023-09-02 20:46:51,318 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:51,318 - FGO - INFO - 	h1: 64
2023-09-02 20:46:51,318 - FGO - INFO - 	h2: 32
2023-09-02 20:46:51,318 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:51,318 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:51,318 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:51,318 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:51,318 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:51,318 - FGO - INFO - 	theta: 10
2023-09-02 20:46:51,318 - FGO - INFO - 	clip: 5
2023-09-02 20:46:51,318 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:51,318 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:51,319 - FGO - INFO - Source Total: 725
2023-09-02 20:46:51,319 - FGO - INFO - Target Total: 79
2023-09-02 20:46:51,319 - FGO - INFO - Train Total: 725
2023-09-02 20:46:51,319 - FGO - INFO - Val Total:   79
2023-09-02 20:46:51,319 - FGO - INFO - Test Total:  79
2023-09-02 20:46:51,319 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:51,319 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:51,319 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:51,319 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:51,319 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:51,319 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:51,319 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:51,319 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:51,319 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:51,319 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:51,320 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:51,321 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:51,420 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:51,420 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:51,420 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:51,420 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:51,420 - FGO - INFO - N: 804
2023-09-02 20:46:51,420 - FGO - INFO - N_s: 725
2023-09-02 20:46:51,420 - FGO - INFO - N_t: 79
2023-09-02 20:46:51,424 - CV - INFO - Begin Pretrain
2023-09-02 20:46:51,424 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:51,427 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:46:51,451 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.50 |
2023-09-02 20:46:51,476 - FGO - INFO - Epoch  20 | Train Loss: 0.648 | Val Loss: 0.65 | Val F1: 0.59 |
2023-09-02 20:46:51,500 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.61 | Val F1: 0.69 |
2023-09-02 20:46:51,525 - FGO - INFO - Epoch  40 | Train Loss: 0.504 | Val Loss: 0.54 | Val F1: 0.78 |
2023-09-02 20:46:51,549 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:46:51,574 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.34 | Val F1: 0.90 |
2023-09-02 20:46:51,598 - FGO - INFO - Epoch  70 | Train Loss: 0.227 | Val Loss: 0.26 | Val F1: 0.92 |
2023-09-02 20:46:51,623 - FGO - INFO - Epoch  80 | Train Loss: 0.182 | Val Loss: 0.21 | Val F1: 0.96 |
2023-09-02 20:46:51,647 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:46:51,672 - FGO - INFO - Epoch 100 | Train Loss: 0.133 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:46:51,672 - FGO - INFO - Best Epoch:  85 | Train Loss: 0.165 | Val Loss: 0.19 | Val F1: 0.97 
2023-09-02 20:46:51,672 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:51,673 - CV - INFO - Pretrain Complete, 85 epochs
2023-09-02 20:46:51,673 - CV - INFO - Begin OT Train
2023-09-02 20:46:51,673 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:51,761 - FGO - INFO - Epoch   0 | Train Loss: -4.246 | Val Loss: -0.33 | Val F1: 0.96 |
2023-09-02 20:46:52,543 - FGO - INFO - Epoch  10 | Train Loss: -4.310 | Val Loss: -0.35 | Val F1: 0.96 |
2023-09-02 20:46:53,318 - FGO - INFO - Epoch  20 | Train Loss: -4.361 | Val Loss: -0.37 | Val F1: 0.96 |
2023-09-02 20:46:54,094 - FGO - INFO - Epoch  30 | Train Loss: -4.399 | Val Loss: -0.38 | Val F1: 0.96 |
2023-09-02 20:46:54,868 - FGO - INFO - Epoch  40 | Train Loss: -4.427 | Val Loss: -0.39 | Val F1: 0.96 |
2023-09-02 20:46:55,584 - FGO - INFO - Best Epoch:  36 | Train Loss: -4.417 | Val Loss: -0.39 | Val F1: 0.97 |
2023-09-02 20:46:55,584 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:55,587 - CV - INFO - OT Train Complete, 36 epochs
2023-09-02 20:46:55,587 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:55,612 - FGO - INFO - Train CM:
[[383   2]
 [ 44 296]]
2023-09-02 20:46:55,612 - FGO - INFO - Val CM:
[[47  2]
 [ 1 29]]
2023-09-02 20:46:55,612 - FGO - INFO - Test CM:
[[47  2]
 [ 1 29]]
2023-09-02 20:46:55,618 - FGO - INFO - test statistical parity: 0.008695652173913049
2023-09-02 20:46:55,619 - FGO - INFO - test equal opportunity: 0.038461538461538436
2023-09-02 20:46:55,620 - FGO - INFO - test micro f1: 0.9620253164556962
2023-09-02 20:46:55,620 - FGO - INFO - test macro f1: 0.9599459185398006
2023-09-02 20:46:55,620 - CV - INFO - fold time: 4.303697109222412s (0.07172828515370687m)
2023-09-02 20:46:55,620 - CV - INFO - Mean Pretrain Epochs 85.7:
2023-09-02 20:46:55,620 - CV - INFO - Mean OT Train Epochs 11.0:
2023-09-02 20:46:55,620 - CV - INFO - Mean Val Macro F1 : 0.9362391027663713
2023-09-02 20:46:55,620 - CV - INFO - Mean Eval Stat : 0.9362391027663713 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:46:55,620 - CV - INFO - set time: 43.61883068084717s (0.7269805113474528m)
2023-09-02 20:46:55,620 - CV - INFO - script time so far: 313.57152581214905s (5.226192096869151m) (0.08710320161448586h)
2023-09-02 20:46:55,620 - CV - INFO - ===== BEGINNING OPTION SET (008)==========================================================
2023-09-02 20:46:55,620 - CV - INFO - 	done: False
2023-09-02 20:46:55,621 - CV - INFO - 	learning_rate: 0.001
2023-09-02 20:46:55,621 - CV - INFO - 	h1: 64
2023-09-02 20:46:55,621 - CV - INFO - 	h2: 32
2023-09-02 20:46:55,621 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:55,621 - CV - INFO - 	dropout: 0.0
2023-09-02 20:46:55,621 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:55,621 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:55,621 - CV - INFO - 	lambda: 0.05
2023-09-02 20:46:55,621 - CV - INFO - 	theta: 30
2023-09-02 20:46:55,621 - CV - INFO - 	clip: 5
2023-09-02 20:46:55,621 - CV - INFO - ----- BEGINNING FOLD SET (008:0)----------------------------------------------------------
2023-09-02 20:46:55,622 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/008/0
2023-09-02 20:46:55,622 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:55,622 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:55,622 - FGO - INFO - 	done: False
2023-09-02 20:46:55,622 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:55,622 - FGO - INFO - 	h1: 64
2023-09-02 20:46:55,622 - FGO - INFO - 	h2: 32
2023-09-02 20:46:55,622 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:55,622 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:55,622 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:55,622 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:55,623 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:55,623 - FGO - INFO - 	theta: 30
2023-09-02 20:46:55,623 - FGO - INFO - 	clip: 5
2023-09-02 20:46:55,623 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:55,623 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:55,623 - FGO - INFO - Source Total: 708
2023-09-02 20:46:55,623 - FGO - INFO - Target Total: 96
2023-09-02 20:46:55,623 - FGO - INFO - Train Total: 708
2023-09-02 20:46:55,623 - FGO - INFO - Val Total:   96
2023-09-02 20:46:55,623 - FGO - INFO - Test Total:  96
2023-09-02 20:46:55,623 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:55,623 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:55,623 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:55,623 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:55,623 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:55,623 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:55,623 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:55,623 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:55,623 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:55,623 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:55,624 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:55,626 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:46:55,741 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:46:55,741 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:46:55,741 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:46:55,741 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:46:55,741 - FGO - INFO - N: 804
2023-09-02 20:46:55,741 - FGO - INFO - N_s: 708
2023-09-02 20:46:55,741 - FGO - INFO - N_t: 96
2023-09-02 20:46:55,744 - CV - INFO - Begin Pretrain
2023-09-02 20:46:55,744 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:46:55,748 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:46:55,772 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:46:55,796 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.53 |
2023-09-02 20:46:55,820 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.61 | Val F1: 0.67 |
2023-09-02 20:46:55,845 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.52 | Val F1: 0.86 |
2023-09-02 20:46:55,869 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.41 | Val F1: 0.89 |
2023-09-02 20:46:55,893 - FGO - INFO - Epoch  60 | Train Loss: 0.298 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:46:55,917 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:46:55,941 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:46:55,965 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:46:55,989 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:46:55,989 - FGO - INFO - Best Epoch:  86 | Train Loss: 0.161 | Val Loss: 0.18 | Val F1: 0.95 
2023-09-02 20:46:55,989 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:55,991 - CV - INFO - Pretrain Complete, 86 epochs
2023-09-02 20:46:55,991 - CV - INFO - Begin OT Train
2023-09-02 20:46:55,991 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:46:56,058 - FGO - INFO - Epoch   0 | Train Loss: -13.258 | Val Loss: -1.74 | Val F1: 0.95 |
2023-09-02 20:46:56,836 - FGO - INFO - Epoch  10 | Train Loss: -13.492 | Val Loss: -1.77 | Val F1: 0.94 |
2023-09-02 20:46:57,601 - FGO - INFO - Epoch  20 | Train Loss: -13.650 | Val Loss: -1.78 | Val F1: 0.93 |
2023-09-02 20:46:58,435 - FGO - INFO - Epoch  30 | Train Loss: -13.716 | Val Loss: -1.76 | Val F1: 0.91 |
2023-09-02 20:46:59,220 - FGO - INFO - Epoch  40 | Train Loss: -13.746 | Val Loss: -1.78 | Val F1: 0.89 |
2023-09-02 20:46:59,878 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.406 | Val Loss: -1.77 | Val F1: 0.95 |
2023-09-02 20:46:59,879 - FGO - INFO - Setting model to best state.
2023-09-02 20:46:59,882 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:46:59,882 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:46:59,905 - FGO - INFO - Train CM:
[[379   3]
 [ 66 260]]
2023-09-02 20:46:59,906 - FGO - INFO - Val CM:
[[52  0]
 [ 9 35]]
2023-09-02 20:46:59,906 - FGO - INFO - Test CM:
[[52  0]
 [ 9 35]]
2023-09-02 20:46:59,911 - FGO - INFO - test statistical parity: 0.2042780748663101
2023-09-02 20:46:59,913 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:46:59,914 - FGO - INFO - test micro f1: 0.90625
2023-09-02 20:46:59,914 - FGO - INFO - test macro f1: 0.9032149658339867
2023-09-02 20:46:59,914 - CV - INFO - fold time: 4.293489694595337s (0.07155816157658895m)
2023-09-02 20:46:59,914 - CV - INFO - ----- BEGINNING FOLD SET (008:1)----------------------------------------------------------
2023-09-02 20:46:59,916 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/008/1
2023-09-02 20:46:59,916 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:46:59,916 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:46:59,916 - FGO - INFO - 	done: False
2023-09-02 20:46:59,916 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:46:59,916 - FGO - INFO - 	h1: 64
2023-09-02 20:46:59,916 - FGO - INFO - 	h2: 32
2023-09-02 20:46:59,916 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:46:59,916 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:46:59,916 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:46:59,916 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:46:59,916 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:46:59,916 - FGO - INFO - 	theta: 30
2023-09-02 20:46:59,916 - FGO - INFO - 	clip: 5
2023-09-02 20:46:59,916 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:46:59,916 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:46:59,916 - FGO - INFO - Source Total: 727
2023-09-02 20:46:59,916 - FGO - INFO - Target Total: 77
2023-09-02 20:46:59,916 - FGO - INFO - Train Total: 727
2023-09-02 20:46:59,916 - FGO - INFO - Val Total:   77
2023-09-02 20:46:59,916 - FGO - INFO - Test Total:  77
2023-09-02 20:46:59,916 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:46:59,916 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:46:59,916 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:46:59,916 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:46:59,916 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:46:59,917 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:46:59,917 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:46:59,917 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:46:59,917 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:46:59,917 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:46:59,918 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:46:59,919 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:00,015 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:00,015 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:00,015 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:00,015 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:00,015 - FGO - INFO - N: 804
2023-09-02 20:47:00,015 - FGO - INFO - N_s: 727
2023-09-02 20:47:00,015 - FGO - INFO - N_t: 77
2023-09-02 20:47:00,019 - CV - INFO - Begin Pretrain
2023-09-02 20:47:00,019 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:00,022 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:47:00,047 - FGO - INFO - Epoch  10 | Train Loss: 0.673 | Val Loss: 0.68 | Val F1: 0.51 |
2023-09-02 20:47:00,072 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.55 |
2023-09-02 20:47:00,096 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:47:00,121 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.55 | Val F1: 0.73 |
2023-09-02 20:47:00,146 - FGO - INFO - Epoch  50 | Train Loss: 0.396 | Val Loss: 0.47 | Val F1: 0.73 |
2023-09-02 20:47:00,170 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.40 | Val F1: 0.81 |
2023-09-02 20:47:00,195 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.34 | Val F1: 0.80 |
2023-09-02 20:47:00,220 - FGO - INFO - Epoch  80 | Train Loss: 0.172 | Val Loss: 0.29 | Val F1: 0.83 |
2023-09-02 20:47:00,244 - FGO - INFO - Epoch  90 | Train Loss: 0.142 | Val Loss: 0.26 | Val F1: 0.87 |
2023-09-02 20:47:00,269 - FGO - INFO - Epoch 100 | Train Loss: 0.122 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:47:00,269 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.147 | Val Loss: 0.27 | Val F1: 0.87 
2023-09-02 20:47:00,269 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:00,270 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:47:00,270 - CV - INFO - Begin OT Train
2023-09-02 20:47:00,270 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:00,365 - FGO - INFO - Epoch   0 | Train Loss: -13.394 | Val Loss: -1.13 | Val F1: 0.87 |
2023-09-02 20:47:01,138 - FGO - INFO - Epoch  10 | Train Loss: -13.612 | Val Loss: -1.18 | Val F1: 0.93 |
2023-09-02 20:47:01,927 - FGO - INFO - Epoch  20 | Train Loss: -13.796 | Val Loss: -1.20 | Val F1: 0.92 |
2023-09-02 20:47:02,722 - FGO - INFO - Epoch  30 | Train Loss: -13.911 | Val Loss: -1.18 | Val F1: 0.92 |
2023-09-02 20:47:03,492 - FGO - INFO - Epoch  40 | Train Loss: -13.958 | Val Loss: -1.17 | Val F1: 0.92 |
2023-09-02 20:47:04,182 - FGO - INFO - Best Epoch:  10 | Train Loss: -13.612 | Val Loss: -1.18 | Val F1: 0.93 |
2023-09-02 20:47:04,182 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:04,185 - CV - INFO - OT Train Complete, 10 epochs
2023-09-02 20:47:04,185 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:04,210 - FGO - INFO - Train CM:
[[389   1]
 [ 95 242]]
2023-09-02 20:47:04,210 - FGO - INFO - Val CM:
[[43  1]
 [ 5 28]]
2023-09-02 20:47:04,210 - FGO - INFO - Test CM:
[[43  1]
 [ 5 28]]
2023-09-02 20:47:04,215 - FGO - INFO - test statistical parity: 0.3474358974358975
2023-09-02 20:47:04,217 - FGO - INFO - test equal opportunity: 0.3709677419354839
2023-09-02 20:47:04,218 - FGO - INFO - test micro f1: 0.922077922077922
2023-09-02 20:47:04,218 - FGO - INFO - test macro f1: 0.9190042075736325
2023-09-02 20:47:04,218 - CV - INFO - fold time: 4.303953170776367s (0.07173255284627279m)
2023-09-02 20:47:04,218 - CV - INFO - ----- BEGINNING FOLD SET (008:2)----------------------------------------------------------
2023-09-02 20:47:04,220 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/008/2
2023-09-02 20:47:04,220 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:04,220 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:04,220 - FGO - INFO - 	done: False
2023-09-02 20:47:04,220 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:04,220 - FGO - INFO - 	h1: 64
2023-09-02 20:47:04,220 - FGO - INFO - 	h2: 32
2023-09-02 20:47:04,220 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:04,220 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:04,220 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:04,220 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:04,220 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:04,220 - FGO - INFO - 	theta: 30
2023-09-02 20:47:04,220 - FGO - INFO - 	clip: 5
2023-09-02 20:47:04,220 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:04,220 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:04,220 - FGO - INFO - Source Total: 721
2023-09-02 20:47:04,220 - FGO - INFO - Target Total: 83
2023-09-02 20:47:04,220 - FGO - INFO - Train Total: 721
2023-09-02 20:47:04,220 - FGO - INFO - Val Total:   83
2023-09-02 20:47:04,220 - FGO - INFO - Test Total:  83
2023-09-02 20:47:04,220 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:04,220 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:04,220 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:04,220 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:04,220 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:04,221 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:04,221 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:04,221 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:04,221 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:04,221 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:04,222 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:04,223 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:04,325 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:04,325 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:04,325 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:04,325 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:04,325 - FGO - INFO - N: 804
2023-09-02 20:47:04,325 - FGO - INFO - N_s: 721
2023-09-02 20:47:04,326 - FGO - INFO - N_t: 83
2023-09-02 20:47:04,329 - CV - INFO - Begin Pretrain
2023-09-02 20:47:04,329 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:04,332 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:47:04,357 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.57 |
2023-09-02 20:47:04,382 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.64 | Val F1: 0.66 |
2023-09-02 20:47:04,406 - FGO - INFO - Epoch  30 | Train Loss: 0.594 | Val Loss: 0.60 | Val F1: 0.76 |
2023-09-02 20:47:04,431 - FGO - INFO - Epoch  40 | Train Loss: 0.506 | Val Loss: 0.52 | Val F1: 0.83 |
2023-09-02 20:47:04,455 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:47:04,480 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.34 | Val F1: 0.85 |
2023-09-02 20:47:04,504 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:47:04,529 - FGO - INFO - Epoch  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:47:04,554 - FGO - INFO - Epoch  90 | Train Loss: 0.140 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:47:04,578 - FGO - INFO - Epoch 100 | Train Loss: 0.119 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:47:04,578 - FGO - INFO - Best Epoch:  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 
2023-09-02 20:47:04,578 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:04,579 - CV - INFO - Pretrain Complete, 80 epochs
2023-09-02 20:47:04,580 - CV - INFO - Begin OT Train
2023-09-02 20:47:04,580 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:04,673 - FGO - INFO - Epoch   0 | Train Loss: -13.468 | Val Loss: -1.24 | Val F1: 0.87 |
2023-09-02 20:47:05,464 - FGO - INFO - Epoch  10 | Train Loss: -13.696 | Val Loss: -1.25 | Val F1: 0.89 |
2023-09-02 20:47:06,275 - FGO - INFO - Epoch  20 | Train Loss: -13.864 | Val Loss: -1.27 | Val F1: 0.89 |
2023-09-02 20:47:07,004 - FGO - INFO - Epoch  30 | Train Loss: -13.950 | Val Loss: -1.26 | Val F1: 0.88 |
2023-09-02 20:47:07,741 - FGO - INFO - Epoch  40 | Train Loss: -13.985 | Val Loss: -1.25 | Val F1: 0.88 |
2023-09-02 20:47:08,421 - FGO - INFO - Best Epoch:   8 | Train Loss: -13.653 | Val Loss: -1.25 | Val F1: 0.90 |
2023-09-02 20:47:08,421 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:08,424 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:47:08,425 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:08,447 - FGO - INFO - Train CM:
[[384   0]
 [ 68 269]]
2023-09-02 20:47:08,448 - FGO - INFO - Val CM:
[[47  3]
 [ 6 27]]
2023-09-02 20:47:08,448 - FGO - INFO - Test CM:
[[47  3]
 [ 6 27]]
2023-09-02 20:47:08,452 - FGO - INFO - test statistical parity: 0.06455399061032868
2023-09-02 20:47:08,454 - FGO - INFO - test equal opportunity: 0.18518518518518523
2023-09-02 20:47:08,455 - FGO - INFO - test micro f1: 0.891566265060241
2023-09-02 20:47:08,455 - FGO - INFO - test macro f1: 0.8848821081830791
2023-09-02 20:47:08,455 - CV - INFO - fold time: 4.236982583999634s (0.0706163763999939m)
2023-09-02 20:47:08,455 - CV - INFO - ----- BEGINNING FOLD SET (008:3)----------------------------------------------------------
2023-09-02 20:47:08,457 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/008/3
2023-09-02 20:47:08,457 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:08,457 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:08,457 - FGO - INFO - 	done: False
2023-09-02 20:47:08,457 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:08,457 - FGO - INFO - 	h1: 64
2023-09-02 20:47:08,457 - FGO - INFO - 	h2: 32
2023-09-02 20:47:08,457 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:08,457 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:08,457 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:08,457 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:08,457 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:08,457 - FGO - INFO - 	theta: 30
2023-09-02 20:47:08,457 - FGO - INFO - 	clip: 5
2023-09-02 20:47:08,457 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:08,457 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:08,457 - FGO - INFO - Source Total: 729
2023-09-02 20:47:08,457 - FGO - INFO - Target Total: 75
2023-09-02 20:47:08,457 - FGO - INFO - Train Total: 729
2023-09-02 20:47:08,457 - FGO - INFO - Val Total:   75
2023-09-02 20:47:08,457 - FGO - INFO - Test Total:  75
2023-09-02 20:47:08,457 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:08,457 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:08,457 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:08,457 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:08,457 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:08,458 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:08,458 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:08,458 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:08,458 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:08,458 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:08,459 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:08,460 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:08,553 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:08,553 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:08,553 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:08,553 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:08,553 - FGO - INFO - N: 804
2023-09-02 20:47:08,553 - FGO - INFO - N_s: 729
2023-09-02 20:47:08,553 - FGO - INFO - N_t: 75
2023-09-02 20:47:08,557 - CV - INFO - Begin Pretrain
2023-09-02 20:47:08,557 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:08,560 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:47:08,585 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.67 | Val F1: 0.39 |
2023-09-02 20:47:08,609 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.64 |
2023-09-02 20:47:08,634 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.57 | Val F1: 0.86 |
2023-09-02 20:47:08,659 - FGO - INFO - Epoch  40 | Train Loss: 0.510 | Val Loss: 0.47 | Val F1: 0.92 |
2023-09-02 20:47:08,683 - FGO - INFO - Epoch  50 | Train Loss: 0.406 | Val Loss: 0.34 | Val F1: 0.93 |
2023-09-02 20:47:08,708 - FGO - INFO - Epoch  60 | Train Loss: 0.305 | Val Loss: 0.23 | Val F1: 0.97 |
2023-09-02 20:47:08,732 - FGO - INFO - Epoch  70 | Train Loss: 0.231 | Val Loss: 0.16 | Val F1: 0.99 |
2023-09-02 20:47:08,757 - FGO - INFO - Epoch  80 | Train Loss: 0.186 | Val Loss: 0.12 | Val F1: 0.99 |
2023-09-02 20:47:08,781 - FGO - INFO - Epoch  90 | Train Loss: 0.156 | Val Loss: 0.10 | Val F1: 0.99 |
2023-09-02 20:47:08,806 - FGO - INFO - Epoch 100 | Train Loss: 0.135 | Val Loss: 0.09 | Val F1: 0.97 |
2023-09-02 20:47:08,806 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.161 | Val Loss: 0.10 | Val F1: 0.99 
2023-09-02 20:47:08,806 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:08,807 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:47:08,807 - CV - INFO - Begin OT Train
2023-09-02 20:47:08,807 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:08,901 - FGO - INFO - Epoch   0 | Train Loss: -13.054 | Val Loss: -1.33 | Val F1: 0.99 |
2023-09-02 20:47:09,703 - FGO - INFO - Epoch  10 | Train Loss: -13.503 | Val Loss: -1.35 | Val F1: 0.99 |
2023-09-02 20:47:10,501 - FGO - INFO - Epoch  20 | Train Loss: -13.665 | Val Loss: -1.33 | Val F1: 0.95 |
2023-09-02 20:47:11,253 - FGO - INFO - Epoch  30 | Train Loss: -13.789 | Val Loss: -1.37 | Val F1: 0.95 |
2023-09-02 20:47:12,026 - FGO - INFO - Epoch  40 | Train Loss: -13.853 | Val Loss: -1.36 | Val F1: 0.95 |
2023-09-02 20:47:12,725 - FGO - INFO - Best Epoch:   8 | Train Loss: -13.481 | Val Loss: -1.33 | Val F1: 0.99 |
2023-09-02 20:47:12,725 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:12,728 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:47:12,728 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:12,754 - FGO - INFO - Train CM:
[[395   1]
 [ 71 262]]
2023-09-02 20:47:12,755 - FGO - INFO - Val CM:
[[38  0]
 [ 4 33]]
2023-09-02 20:47:12,755 - FGO - INFO - Test CM:
[[38  0]
 [ 4 33]]
2023-09-02 20:47:12,760 - FGO - INFO - test statistical parity: 0.10187353629976581
2023-09-02 20:47:12,762 - FGO - INFO - test equal opportunity: 0.21904761904761905
2023-09-02 20:47:12,763 - FGO - INFO - test micro f1: 0.9466666666666667
2023-09-02 20:47:12,763 - FGO - INFO - test macro f1: 0.9464285714285714
2023-09-02 20:47:12,763 - CV - INFO - fold time: 4.307926654815674s (0.07179877758026124m)
2023-09-02 20:47:12,763 - CV - INFO - ----- BEGINNING FOLD SET (008:4)----------------------------------------------------------
2023-09-02 20:47:12,765 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/008/4
2023-09-02 20:47:12,765 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:12,765 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:12,765 - FGO - INFO - 	done: False
2023-09-02 20:47:12,765 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:12,765 - FGO - INFO - 	h1: 64
2023-09-02 20:47:12,765 - FGO - INFO - 	h2: 32
2023-09-02 20:47:12,765 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:12,765 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:12,765 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:12,765 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:12,765 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:12,765 - FGO - INFO - 	theta: 30
2023-09-02 20:47:12,765 - FGO - INFO - 	clip: 5
2023-09-02 20:47:12,765 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:12,765 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:12,765 - FGO - INFO - Source Total: 732
2023-09-02 20:47:12,765 - FGO - INFO - Target Total: 72
2023-09-02 20:47:12,765 - FGO - INFO - Train Total: 732
2023-09-02 20:47:12,765 - FGO - INFO - Val Total:   72
2023-09-02 20:47:12,765 - FGO - INFO - Test Total:  72
2023-09-02 20:47:12,765 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:12,765 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:12,765 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:12,765 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:12,765 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:12,766 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:12,766 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:12,766 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:12,766 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:12,766 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:12,767 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:12,768 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:12,861 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:12,861 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:12,861 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:12,861 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:12,861 - FGO - INFO - N: 804
2023-09-02 20:47:12,861 - FGO - INFO - N_s: 732
2023-09-02 20:47:12,861 - FGO - INFO - N_t: 72
2023-09-02 20:47:12,865 - CV - INFO - Begin Pretrain
2023-09-02 20:47:12,865 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:12,868 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:47:12,893 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.68 | Val F1: 0.45 |
2023-09-02 20:47:12,917 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.66 | Val F1: 0.63 |
2023-09-02 20:47:12,942 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.60 | Val F1: 0.75 |
2023-09-02 20:47:12,967 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.50 | Val F1: 0.87 |
2023-09-02 20:47:12,992 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.39 | Val F1: 0.89 |
2023-09-02 20:47:13,016 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:47:13,041 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:47:13,065 - FGO - INFO - Epoch  80 | Train Loss: 0.179 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:47:13,090 - FGO - INFO - Epoch  90 | Train Loss: 0.150 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:47:13,114 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:47:13,114 - FGO - INFO - Best Epoch:  81 | Train Loss: 0.175 | Val Loss: 0.16 | Val F1: 0.97 
2023-09-02 20:47:13,114 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:13,116 - CV - INFO - Pretrain Complete, 81 epochs
2023-09-02 20:47:13,116 - CV - INFO - Begin OT Train
2023-09-02 20:47:13,116 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:13,181 - FGO - INFO - Epoch   0 | Train Loss: -13.333 | Val Loss: -1.27 | Val F1: 0.97 |
2023-09-02 20:47:14,046 - FGO - INFO - Epoch  10 | Train Loss: -13.571 | Val Loss: -1.27 | Val F1: 0.94 |
2023-09-02 20:47:14,934 - FGO - INFO - Epoch  20 | Train Loss: -13.743 | Val Loss: -1.27 | Val F1: 0.92 |
2023-09-02 20:47:15,701 - FGO - INFO - Epoch  30 | Train Loss: -13.837 | Val Loss: -1.24 | Val F1: 0.90 |
2023-09-02 20:47:16,523 - FGO - INFO - Epoch  40 | Train Loss: -13.877 | Val Loss: -1.25 | Val F1: 0.90 |
2023-09-02 20:47:17,220 - FGO - INFO - Best Epoch:   7 | Train Loss: -13.508 | Val Loss: -1.27 | Val F1: 0.96 |
2023-09-02 20:47:17,220 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:17,227 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:47:17,227 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:17,257 - FGO - INFO - Train CM:
[[396   1]
 [ 70 265]]
2023-09-02 20:47:17,257 - FGO - INFO - Val CM:
[[37  0]
 [ 7 28]]
2023-09-02 20:47:17,258 - FGO - INFO - Test CM:
[[37  0]
 [ 7 28]]
2023-09-02 20:47:17,263 - FGO - INFO - test statistical parity: 0.012903225806451646
2023-09-02 20:47:17,264 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:47:17,265 - FGO - INFO - test micro f1: 0.9027777777777778
2023-09-02 20:47:17,265 - FGO - INFO - test macro f1: 0.9012345679012346
2023-09-02 20:47:17,265 - CV - INFO - fold time: 4.502216577529907s (0.07503694295883179m)
2023-09-02 20:47:17,265 - CV - INFO - ----- BEGINNING FOLD SET (008:5)----------------------------------------------------------
2023-09-02 20:47:17,267 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/008/5
2023-09-02 20:47:17,267 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:17,267 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:17,267 - FGO - INFO - 	done: False
2023-09-02 20:47:17,267 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:17,267 - FGO - INFO - 	h1: 64
2023-09-02 20:47:17,267 - FGO - INFO - 	h2: 32
2023-09-02 20:47:17,267 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:17,267 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:17,267 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:17,267 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:17,267 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:17,267 - FGO - INFO - 	theta: 30
2023-09-02 20:47:17,267 - FGO - INFO - 	clip: 5
2023-09-02 20:47:17,267 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:17,267 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:17,267 - FGO - INFO - Source Total: 726
2023-09-02 20:47:17,267 - FGO - INFO - Target Total: 78
2023-09-02 20:47:17,267 - FGO - INFO - Train Total: 726
2023-09-02 20:47:17,267 - FGO - INFO - Val Total:   78
2023-09-02 20:47:17,267 - FGO - INFO - Test Total:  78
2023-09-02 20:47:17,267 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:17,267 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:17,267 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:17,267 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:17,267 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:17,268 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:17,268 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:17,268 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:17,268 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:17,268 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:17,269 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:17,270 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:17,368 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:17,368 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:17,368 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:17,368 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:17,368 - FGO - INFO - N: 804
2023-09-02 20:47:17,368 - FGO - INFO - N_s: 726
2023-09-02 20:47:17,368 - FGO - INFO - N_t: 78
2023-09-02 20:47:17,371 - CV - INFO - Begin Pretrain
2023-09-02 20:47:17,371 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:17,374 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:47:17,399 - FGO - INFO - Epoch  10 | Train Loss: 0.669 | Val Loss: 0.72 | Val F1: 0.34 |
2023-09-02 20:47:17,424 - FGO - INFO - Epoch  20 | Train Loss: 0.644 | Val Loss: 0.69 | Val F1: 0.42 |
2023-09-02 20:47:17,448 - FGO - INFO - Epoch  30 | Train Loss: 0.591 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:47:17,473 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.53 | Val F1: 0.83 |
2023-09-02 20:47:17,497 - FGO - INFO - Epoch  50 | Train Loss: 0.397 | Val Loss: 0.41 | Val F1: 0.85 |
2023-09-02 20:47:17,522 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:47:17,546 - FGO - INFO - Epoch  70 | Train Loss: 0.220 | Val Loss: 0.27 | Val F1: 0.88 |
2023-09-02 20:47:17,571 - FGO - INFO - Epoch  80 | Train Loss: 0.175 | Val Loss: 0.25 | Val F1: 0.88 |
2023-09-02 20:47:17,595 - FGO - INFO - Epoch  90 | Train Loss: 0.148 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:47:17,619 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.21 | Val F1: 0.91 |
2023-09-02 20:47:17,619 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.209 | Val Loss: 0.26 | Val F1: 0.91 
2023-09-02 20:47:17,619 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:17,621 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:47:17,621 - CV - INFO - Begin OT Train
2023-09-02 20:47:17,621 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:17,685 - FGO - INFO - Epoch   0 | Train Loss: -13.220 | Val Loss: -1.22 | Val F1: 0.91 |
2023-09-02 20:47:18,496 - FGO - INFO - Epoch  10 | Train Loss: -13.556 | Val Loss: -1.17 | Val F1: 0.90 |
2023-09-02 20:47:19,217 - FGO - INFO - Epoch  20 | Train Loss: -13.740 | Val Loss: -1.13 | Val F1: 0.86 |
2023-09-02 20:47:19,982 - FGO - INFO - Epoch  30 | Train Loss: -13.850 | Val Loss: -1.13 | Val F1: 0.85 |
2023-09-02 20:47:20,741 - FGO - INFO - Epoch  40 | Train Loss: -13.908 | Val Loss: -1.14 | Val F1: 0.85 |
2023-09-02 20:47:21,420 - FGO - INFO - Best Epoch:   9 | Train Loss: -13.538 | Val Loss: -1.17 | Val F1: 0.90 |
2023-09-02 20:47:21,420 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:21,423 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:47:21,424 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:21,450 - FGO - INFO - Train CM:
[[399   1]
 [ 70 256]]
2023-09-02 20:47:21,450 - FGO - INFO - Val CM:
[[34  0]
 [11 33]]
2023-09-02 20:47:21,451 - FGO - INFO - Test CM:
[[34  0]
 [11 33]]
2023-09-02 20:47:21,456 - FGO - INFO - test statistical parity: 0.024154589371980673
2023-09-02 20:47:21,457 - FGO - INFO - test equal opportunity: 0.05641025641025643
2023-09-02 20:47:21,458 - FGO - INFO - test micro f1: 0.8589743589743589
2023-09-02 20:47:21,459 - FGO - INFO - test macro f1: 0.8589511754068716
2023-09-02 20:47:21,459 - CV - INFO - fold time: 4.193427085876465s (0.06989045143127441m)
2023-09-02 20:47:21,459 - CV - INFO - ----- BEGINNING FOLD SET (008:6)----------------------------------------------------------
2023-09-02 20:47:21,460 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/008/6
2023-09-02 20:47:21,460 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:21,460 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:21,461 - FGO - INFO - 	done: False
2023-09-02 20:47:21,461 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:21,461 - FGO - INFO - 	h1: 64
2023-09-02 20:47:21,461 - FGO - INFO - 	h2: 32
2023-09-02 20:47:21,461 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:21,461 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:21,461 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:21,461 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:21,461 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:21,461 - FGO - INFO - 	theta: 30
2023-09-02 20:47:21,461 - FGO - INFO - 	clip: 5
2023-09-02 20:47:21,461 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:21,461 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:21,461 - FGO - INFO - Source Total: 717
2023-09-02 20:47:21,461 - FGO - INFO - Target Total: 87
2023-09-02 20:47:21,461 - FGO - INFO - Train Total: 717
2023-09-02 20:47:21,461 - FGO - INFO - Val Total:   87
2023-09-02 20:47:21,461 - FGO - INFO - Test Total:  87
2023-09-02 20:47:21,461 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:21,461 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:21,461 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:21,461 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:21,461 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:21,461 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:21,461 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:21,461 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:21,461 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:21,461 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:21,462 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:21,464 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:21,571 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:21,571 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:21,571 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:21,571 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:21,571 - FGO - INFO - N: 804
2023-09-02 20:47:21,571 - FGO - INFO - N_s: 717
2023-09-02 20:47:21,571 - FGO - INFO - N_t: 87
2023-09-02 20:47:21,575 - CV - INFO - Begin Pretrain
2023-09-02 20:47:21,575 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:21,578 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:47:21,602 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.47 |
2023-09-02 20:47:21,627 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.63 |
2023-09-02 20:47:21,651 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.78 |
2023-09-02 20:47:21,676 - FGO - INFO - Epoch  40 | Train Loss: 0.509 | Val Loss: 0.50 | Val F1: 0.84 |
2023-09-02 20:47:21,700 - FGO - INFO - Epoch  50 | Train Loss: 0.402 | Val Loss: 0.40 | Val F1: 0.86 |
2023-09-02 20:47:21,725 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.31 | Val F1: 0.92 |
2023-09-02 20:47:21,749 - FGO - INFO - Epoch  70 | Train Loss: 0.228 | Val Loss: 0.23 | Val F1: 0.92 |
2023-09-02 20:47:21,773 - FGO - INFO - Epoch  80 | Train Loss: 0.184 | Val Loss: 0.19 | Val F1: 0.93 |
2023-09-02 20:47:21,798 - FGO - INFO - Epoch  90 | Train Loss: 0.154 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:47:21,822 - FGO - INFO - Epoch 100 | Train Loss: 0.134 | Val Loss: 0.14 | Val F1: 0.95 |
2023-09-02 20:47:21,822 - FGO - INFO - Best Epoch:  99 | Train Loss: 0.135 | Val Loss: 0.14 | Val F1: 0.95 
2023-09-02 20:47:21,822 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:21,824 - CV - INFO - Pretrain Complete, 99 epochs
2023-09-02 20:47:21,824 - CV - INFO - Begin OT Train
2023-09-02 20:47:21,824 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:21,917 - FGO - INFO - Epoch   0 | Train Loss: -13.241 | Val Loss: -1.58 | Val F1: 0.95 |
2023-09-02 20:47:22,796 - FGO - INFO - Epoch  10 | Train Loss: -13.465 | Val Loss: -1.60 | Val F1: 0.94 |
2023-09-02 20:47:23,658 - FGO - INFO - Epoch  20 | Train Loss: -13.624 | Val Loss: -1.63 | Val F1: 0.94 |
2023-09-02 20:47:24,437 - FGO - INFO - Epoch  30 | Train Loss: -13.720 | Val Loss: -1.63 | Val F1: 0.93 |
2023-09-02 20:47:25,241 - FGO - INFO - Epoch  40 | Train Loss: -13.763 | Val Loss: -1.64 | Val F1: 0.93 |
2023-09-02 20:47:25,902 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.384 | Val Loss: -1.59 | Val F1: 0.94 |
2023-09-02 20:47:25,902 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:25,905 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:47:25,905 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:25,929 - FGO - INFO - Train CM:
[[384   1]
 [ 68 264]]
2023-09-02 20:47:25,929 - FGO - INFO - Val CM:
[[49  0]
 [ 5 33]]
2023-09-02 20:47:25,930 - FGO - INFO - Test CM:
[[49  0]
 [ 5 33]]
2023-09-02 20:47:25,935 - FGO - INFO - test statistical parity: 0.13291139240506328
2023-09-02 20:47:25,936 - FGO - INFO - test equal opportunity: 0.1470588235294118
2023-09-02 20:47:25,937 - FGO - INFO - test micro f1: 0.9425287356321839
2023-09-02 20:47:25,938 - FGO - INFO - test macro f1: 0.9405168877341721
2023-09-02 20:47:25,938 - CV - INFO - fold time: 4.478908538818359s (0.07464847564697266m)
2023-09-02 20:47:25,938 - CV - INFO - ----- BEGINNING FOLD SET (008:7)----------------------------------------------------------
2023-09-02 20:47:25,939 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/008/7
2023-09-02 20:47:25,939 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:25,939 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:25,939 - FGO - INFO - 	done: False
2023-09-02 20:47:25,939 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:25,939 - FGO - INFO - 	h1: 64
2023-09-02 20:47:25,939 - FGO - INFO - 	h2: 32
2023-09-02 20:47:25,939 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:25,939 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:25,939 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:25,939 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:25,939 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:25,939 - FGO - INFO - 	theta: 30
2023-09-02 20:47:25,939 - FGO - INFO - 	clip: 5
2023-09-02 20:47:25,939 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:25,940 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:25,940 - FGO - INFO - Source Total: 717
2023-09-02 20:47:25,940 - FGO - INFO - Target Total: 87
2023-09-02 20:47:25,940 - FGO - INFO - Train Total: 717
2023-09-02 20:47:25,940 - FGO - INFO - Val Total:   87
2023-09-02 20:47:25,940 - FGO - INFO - Test Total:  87
2023-09-02 20:47:25,940 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:25,940 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:25,940 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:25,940 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:25,940 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:25,940 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:25,940 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:25,940 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:25,940 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:25,940 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:25,941 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:25,942 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:26,048 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:26,048 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:26,048 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:26,048 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:26,048 - FGO - INFO - N: 804
2023-09-02 20:47:26,048 - FGO - INFO - N_s: 717
2023-09-02 20:47:26,048 - FGO - INFO - N_t: 87
2023-09-02 20:47:26,051 - CV - INFO - Begin Pretrain
2023-09-02 20:47:26,052 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:26,055 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:47:26,079 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.40 |
2023-09-02 20:47:26,104 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.62 |
2023-09-02 20:47:26,129 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.77 |
2023-09-02 20:47:26,153 - FGO - INFO - Epoch  40 | Train Loss: 0.507 | Val Loss: 0.52 | Val F1: 0.88 |
2023-09-02 20:47:26,178 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.41 | Val F1: 0.88 |
2023-09-02 20:47:26,202 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:47:26,227 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.23 | Val F1: 0.94 |
2023-09-02 20:47:26,251 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:47:26,276 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:47:26,300 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:47:26,300 - FGO - INFO - Best Epoch:  91 | Train Loss: 0.149 | Val Loss: 0.15 | Val F1: 0.97 
2023-09-02 20:47:26,300 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:26,302 - CV - INFO - Pretrain Complete, 91 epochs
2023-09-02 20:47:26,302 - CV - INFO - Begin OT Train
2023-09-02 20:47:26,302 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:26,394 - FGO - INFO - Epoch   0 | Train Loss: -13.330 | Val Loss: -1.51 | Val F1: 0.97 |
2023-09-02 20:47:27,175 - FGO - INFO - Epoch  10 | Train Loss: -13.550 | Val Loss: -1.50 | Val F1: 0.93 |
2023-09-02 20:47:27,951 - FGO - INFO - Epoch  20 | Train Loss: -13.718 | Val Loss: -1.53 | Val F1: 0.93 |
2023-09-02 20:47:28,742 - FGO - INFO - Epoch  30 | Train Loss: -13.816 | Val Loss: -1.53 | Val F1: 0.92 |
2023-09-02 20:47:29,481 - FGO - INFO - Epoch  40 | Train Loss: -13.859 | Val Loss: -1.52 | Val F1: 0.92 |
2023-09-02 20:47:30,177 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.462 | Val Loss: -1.52 | Val F1: 0.95 |
2023-09-02 20:47:30,177 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:30,180 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:47:30,180 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:30,203 - FGO - INFO - Train CM:
[[386   1]
 [ 76 254]]
2023-09-02 20:47:30,203 - FGO - INFO - Val CM:
[[47  0]
 [ 6 34]]
2023-09-02 20:47:30,204 - FGO - INFO - Test CM:
[[47  0]
 [ 6 34]]
2023-09-02 20:47:30,209 - FGO - INFO - test statistical parity: 0.4166666666666667
2023-09-02 20:47:30,210 - FGO - INFO - test equal opportunity: 0.19354838709677424
2023-09-02 20:47:30,211 - FGO - INFO - test micro f1: 0.9310344827586207
2023-09-02 20:47:30,212 - FGO - INFO - test macro f1: 0.9294594594594594
2023-09-02 20:47:30,212 - CV - INFO - fold time: 4.274146795272827s (0.07123577992121378m)
2023-09-02 20:47:30,212 - CV - INFO - ----- BEGINNING FOLD SET (008:8)----------------------------------------------------------
2023-09-02 20:47:30,213 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/008/8
2023-09-02 20:47:30,214 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:30,214 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:30,214 - FGO - INFO - 	done: False
2023-09-02 20:47:30,214 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:30,214 - FGO - INFO - 	h1: 64
2023-09-02 20:47:30,214 - FGO - INFO - 	h2: 32
2023-09-02 20:47:30,214 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:30,214 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:30,214 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:30,214 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:30,214 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:30,214 - FGO - INFO - 	theta: 30
2023-09-02 20:47:30,214 - FGO - INFO - 	clip: 5
2023-09-02 20:47:30,214 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:30,214 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:30,214 - FGO - INFO - Source Total: 734
2023-09-02 20:47:30,214 - FGO - INFO - Target Total: 70
2023-09-02 20:47:30,214 - FGO - INFO - Train Total: 734
2023-09-02 20:47:30,214 - FGO - INFO - Val Total:   70
2023-09-02 20:47:30,214 - FGO - INFO - Test Total:  70
2023-09-02 20:47:30,214 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:30,214 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:30,214 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:30,214 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:30,214 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:30,214 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:30,215 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:30,215 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:30,215 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:30,215 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:30,216 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:30,217 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:30,305 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:30,305 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:30,305 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:30,305 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:30,305 - FGO - INFO - N: 804
2023-09-02 20:47:30,305 - FGO - INFO - N_s: 734
2023-09-02 20:47:30,305 - FGO - INFO - N_t: 70
2023-09-02 20:47:30,309 - CV - INFO - Begin Pretrain
2023-09-02 20:47:30,309 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:30,312 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:47:30,337 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.69 | Val F1: 0.41 |
2023-09-02 20:47:30,361 - FGO - INFO - Epoch  20 | Train Loss: 0.645 | Val Loss: 0.66 | Val F1: 0.62 |
2023-09-02 20:47:30,386 - FGO - INFO - Epoch  30 | Train Loss: 0.588 | Val Loss: 0.61 | Val F1: 0.76 |
2023-09-02 20:47:30,411 - FGO - INFO - Epoch  40 | Train Loss: 0.498 | Val Loss: 0.53 | Val F1: 0.81 |
2023-09-02 20:47:30,436 - FGO - INFO - Epoch  50 | Train Loss: 0.392 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:47:30,462 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:47:30,488 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.27 | Val F1: 0.86 |
2023-09-02 20:47:30,513 - FGO - INFO - Epoch  80 | Train Loss: 0.181 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:47:30,537 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:47:30,562 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:47:30,562 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.157 | Val Loss: 0.19 | Val F1: 0.94 
2023-09-02 20:47:30,562 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:30,563 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:47:30,563 - CV - INFO - Begin OT Train
2023-09-02 20:47:30,563 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:30,628 - FGO - INFO - Epoch   0 | Train Loss: -13.265 | Val Loss: -1.12 | Val F1: 0.94 |
2023-09-02 20:47:31,458 - FGO - INFO - Epoch  10 | Train Loss: -13.579 | Val Loss: -1.10 | Val F1: 0.91 |
2023-09-02 20:47:32,222 - FGO - INFO - Epoch  20 | Train Loss: -13.759 | Val Loss: -1.07 | Val F1: 0.88 |
2023-09-02 20:47:33,062 - FGO - INFO - Epoch  30 | Train Loss: -13.873 | Val Loss: -1.04 | Val F1: 0.88 |
2023-09-02 20:47:33,859 - FGO - INFO - Epoch  40 | Train Loss: -13.926 | Val Loss: -1.03 | Val F1: 0.87 |
2023-09-02 20:47:34,523 - FGO - INFO - Best Epoch:   8 | Train Loss: -13.543 | Val Loss: -1.09 | Val F1: 0.91 |
2023-09-02 20:47:34,523 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:34,527 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:47:34,527 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:34,553 - FGO - INFO - Train CM:
[[399   1]
 [ 85 249]]
2023-09-02 20:47:34,553 - FGO - INFO - Val CM:
[[34  0]
 [ 8 28]]
2023-09-02 20:47:34,554 - FGO - INFO - Test CM:
[[34  0]
 [ 8 28]]
2023-09-02 20:47:34,559 - FGO - INFO - test statistical parity: 0.018893387314439902
2023-09-02 20:47:34,561 - FGO - INFO - test equal opportunity: 0.06666666666666665
2023-09-02 20:47:34,561 - FGO - INFO - test micro f1: 0.8857142857142857
2023-09-02 20:47:34,562 - FGO - INFO - test macro f1: 0.8848684210526316
2023-09-02 20:47:34,562 - CV - INFO - fold time: 4.35006046295166s (0.072501007715861m)
2023-09-02 20:47:34,562 - CV - INFO - ----- BEGINNING FOLD SET (008:9)----------------------------------------------------------
2023-09-02 20:47:34,563 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/008/9
2023-09-02 20:47:34,564 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:34,564 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:34,564 - FGO - INFO - 	done: False
2023-09-02 20:47:34,564 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:34,564 - FGO - INFO - 	h1: 64
2023-09-02 20:47:34,564 - FGO - INFO - 	h2: 32
2023-09-02 20:47:34,564 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:34,564 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:34,564 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:34,564 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:34,564 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:34,564 - FGO - INFO - 	theta: 30
2023-09-02 20:47:34,564 - FGO - INFO - 	clip: 5
2023-09-02 20:47:34,564 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:34,564 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:34,564 - FGO - INFO - Source Total: 725
2023-09-02 20:47:34,564 - FGO - INFO - Target Total: 79
2023-09-02 20:47:34,564 - FGO - INFO - Train Total: 725
2023-09-02 20:47:34,564 - FGO - INFO - Val Total:   79
2023-09-02 20:47:34,564 - FGO - INFO - Test Total:  79
2023-09-02 20:47:34,564 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:34,564 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:34,564 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:34,564 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:34,564 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:34,565 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:34,565 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:34,565 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:34,565 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:34,565 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:34,566 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:34,567 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:34,665 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:34,665 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:34,665 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:34,665 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:34,665 - FGO - INFO - N: 804
2023-09-02 20:47:34,665 - FGO - INFO - N_s: 725
2023-09-02 20:47:34,665 - FGO - INFO - N_t: 79
2023-09-02 20:47:34,669 - CV - INFO - Begin Pretrain
2023-09-02 20:47:34,669 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:34,672 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:47:34,697 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.50 |
2023-09-02 20:47:34,721 - FGO - INFO - Epoch  20 | Train Loss: 0.648 | Val Loss: 0.65 | Val F1: 0.59 |
2023-09-02 20:47:34,746 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.61 | Val F1: 0.69 |
2023-09-02 20:47:34,770 - FGO - INFO - Epoch  40 | Train Loss: 0.504 | Val Loss: 0.54 | Val F1: 0.78 |
2023-09-02 20:47:34,795 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:47:34,820 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.34 | Val F1: 0.90 |
2023-09-02 20:47:34,844 - FGO - INFO - Epoch  70 | Train Loss: 0.227 | Val Loss: 0.26 | Val F1: 0.92 |
2023-09-02 20:47:34,869 - FGO - INFO - Epoch  80 | Train Loss: 0.182 | Val Loss: 0.21 | Val F1: 0.96 |
2023-09-02 20:47:34,893 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:47:34,917 - FGO - INFO - Epoch 100 | Train Loss: 0.133 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:47:34,917 - FGO - INFO - Best Epoch:  85 | Train Loss: 0.165 | Val Loss: 0.19 | Val F1: 0.97 
2023-09-02 20:47:34,917 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:34,919 - CV - INFO - Pretrain Complete, 85 epochs
2023-09-02 20:47:34,919 - CV - INFO - Begin OT Train
2023-09-02 20:47:34,919 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:35,013 - FGO - INFO - Epoch   0 | Train Loss: -13.380 | Val Loss: -1.32 | Val F1: 0.96 |
2023-09-02 20:47:35,821 - FGO - INFO - Epoch  10 | Train Loss: -13.617 | Val Loss: -1.37 | Val F1: 0.96 |
2023-09-02 20:47:36,667 - FGO - INFO - Epoch  20 | Train Loss: -13.789 | Val Loss: -1.39 | Val F1: 0.95 |
2023-09-02 20:47:37,406 - FGO - INFO - Epoch  30 | Train Loss: -13.870 | Val Loss: -1.39 | Val F1: 0.95 |
2023-09-02 20:47:38,142 - FGO - INFO - Epoch  40 | Train Loss: -13.909 | Val Loss: -1.40 | Val F1: 0.96 |
2023-09-02 20:47:38,819 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.527 | Val Loss: -1.34 | Val F1: 0.96 |
2023-09-02 20:47:38,819 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:38,822 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:47:38,822 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:38,851 - FGO - INFO - Train CM:
[[384   1]
 [ 75 265]]
2023-09-02 20:47:38,852 - FGO - INFO - Val CM:
[[48  1]
 [ 2 28]]
2023-09-02 20:47:38,852 - FGO - INFO - Test CM:
[[48  1]
 [ 2 28]]
2023-09-02 20:47:38,857 - FGO - INFO - test statistical parity: 0.03768115942028988
2023-09-02 20:47:38,858 - FGO - INFO - test equal opportunity: 0.07692307692307687
2023-09-02 20:47:38,859 - FGO - INFO - test micro f1: 0.9620253164556962
2023-09-02 20:47:38,860 - FGO - INFO - test macro f1: 0.9594247560349256
2023-09-02 20:47:38,860 - CV - INFO - fold time: 4.2978293895721436s (0.07163048982620239m)
2023-09-02 20:47:38,860 - CV - INFO - Mean Pretrain Epochs 85.8:
2023-09-02 20:47:38,860 - CV - INFO - Mean OT Train Epochs 7.4:
2023-09-02 20:47:38,860 - CV - INFO - Mean Val Macro F1 : 0.9127985120608564
2023-09-02 20:47:38,860 - CV - INFO - Mean Eval Stat : 0.9127985120608564 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:47:38,860 - CV - INFO - set time: 43.23947286605835s (0.7206578811009725m)
2023-09-02 20:47:38,860 - CV - INFO - script time so far: 356.8110423088074s (5.946850705146789m) (0.09911417841911316h)
2023-09-02 20:47:38,860 - CV - INFO - ===== BEGINNING OPTION SET (009)==========================================================
2023-09-02 20:47:38,860 - CV - INFO - 	done: False
2023-09-02 20:47:38,860 - CV - INFO - 	learning_rate: 0.001
2023-09-02 20:47:38,860 - CV - INFO - 	h1: 64
2023-09-02 20:47:38,860 - CV - INFO - 	h2: 32
2023-09-02 20:47:38,860 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:38,860 - CV - INFO - 	dropout: 0.0
2023-09-02 20:47:38,860 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:38,860 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:38,860 - CV - INFO - 	lambda: 0.05
2023-09-02 20:47:38,860 - CV - INFO - 	theta: 50
2023-09-02 20:47:38,860 - CV - INFO - 	clip: 5
2023-09-02 20:47:38,860 - CV - INFO - ----- BEGINNING FOLD SET (009:0)----------------------------------------------------------
2023-09-02 20:47:38,862 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/009/0
2023-09-02 20:47:38,862 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:38,862 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:38,862 - FGO - INFO - 	done: False
2023-09-02 20:47:38,862 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:38,862 - FGO - INFO - 	h1: 64
2023-09-02 20:47:38,862 - FGO - INFO - 	h2: 32
2023-09-02 20:47:38,862 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:38,862 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:38,862 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:38,862 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:38,862 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:38,862 - FGO - INFO - 	theta: 50
2023-09-02 20:47:38,862 - FGO - INFO - 	clip: 5
2023-09-02 20:47:38,862 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:38,862 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:38,862 - FGO - INFO - Source Total: 708
2023-09-02 20:47:38,862 - FGO - INFO - Target Total: 96
2023-09-02 20:47:38,862 - FGO - INFO - Train Total: 708
2023-09-02 20:47:38,862 - FGO - INFO - Val Total:   96
2023-09-02 20:47:38,862 - FGO - INFO - Test Total:  96
2023-09-02 20:47:38,862 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:38,862 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:38,862 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:38,862 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:38,862 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:38,863 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:38,863 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:38,863 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:38,863 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:38,863 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:38,864 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:38,865 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:38,981 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:38,981 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:38,981 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:38,981 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:38,981 - FGO - INFO - N: 804
2023-09-02 20:47:38,981 - FGO - INFO - N_s: 708
2023-09-02 20:47:38,981 - FGO - INFO - N_t: 96
2023-09-02 20:47:38,985 - CV - INFO - Begin Pretrain
2023-09-02 20:47:38,985 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:38,988 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:47:39,012 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:47:39,037 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.53 |
2023-09-02 20:47:39,061 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.61 | Val F1: 0.67 |
2023-09-02 20:47:39,085 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.52 | Val F1: 0.86 |
2023-09-02 20:47:39,110 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.41 | Val F1: 0.89 |
2023-09-02 20:47:39,134 - FGO - INFO - Epoch  60 | Train Loss: 0.298 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:47:39,158 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:47:39,183 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:47:39,207 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:47:39,231 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:47:39,231 - FGO - INFO - Best Epoch:  86 | Train Loss: 0.161 | Val Loss: 0.18 | Val F1: 0.95 
2023-09-02 20:47:39,231 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:39,233 - CV - INFO - Pretrain Complete, 86 epochs
2023-09-02 20:47:39,233 - CV - INFO - Begin OT Train
2023-09-02 20:47:39,233 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:39,296 - FGO - INFO - Epoch   0 | Train Loss: -22.281 | Val Loss: -3.00 | Val F1: 0.95 |
2023-09-02 20:47:40,057 - FGO - INFO - Epoch  10 | Train Loss: -22.748 | Val Loss: -3.05 | Val F1: 0.93 |
2023-09-02 20:47:40,785 - FGO - INFO - Epoch  20 | Train Loss: -23.085 | Val Loss: -3.04 | Val F1: 0.87 |
2023-09-02 20:47:41,560 - FGO - INFO - Epoch  30 | Train Loss: -23.273 | Val Loss: -2.98 | Val F1: 0.83 |
2023-09-02 20:47:42,331 - FGO - INFO - Epoch  40 | Train Loss: -23.546 | Val Loss: -2.77 | Val F1: 0.93 |
2023-09-02 20:47:43,018 - FGO - INFO - Best Epoch:   6 | Train Loss: -22.572 | Val Loss: -3.04 | Val F1: 0.95 |
2023-09-02 20:47:43,018 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:43,021 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:47:43,022 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:43,045 - FGO - INFO - Train CM:
[[  0 382]
 [  0 326]]
2023-09-02 20:47:43,045 - FGO - INFO - Val CM:
[[52  0]
 [41  3]]
2023-09-02 20:47:43,046 - FGO - INFO - Test CM:
[[52  0]
 [41  3]]
2023-09-02 20:47:43,051 - FGO - INFO - test statistical parity: 0.03529411764705882
2023-09-02 20:47:43,052 - FGO - INFO - test equal opportunity: 0.08333333333333333
2023-09-02 20:47:43,053 - FGO - INFO - test micro f1: 0.5729166666666666
2023-09-02 20:47:43,054 - FGO - INFO - test macro f1: 0.42245047688921494
2023-09-02 20:47:43,054 - CV - INFO - fold time: 4.193501710891724s (0.06989169518152873m)
2023-09-02 20:47:43,054 - CV - INFO - ----- BEGINNING FOLD SET (009:1)----------------------------------------------------------
2023-09-02 20:47:43,055 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/009/1
2023-09-02 20:47:43,055 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:43,055 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:43,055 - FGO - INFO - 	done: False
2023-09-02 20:47:43,055 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:43,055 - FGO - INFO - 	h1: 64
2023-09-02 20:47:43,055 - FGO - INFO - 	h2: 32
2023-09-02 20:47:43,055 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:43,055 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:43,055 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:43,055 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:43,055 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:43,055 - FGO - INFO - 	theta: 50
2023-09-02 20:47:43,055 - FGO - INFO - 	clip: 5
2023-09-02 20:47:43,055 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:43,055 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:43,055 - FGO - INFO - Source Total: 727
2023-09-02 20:47:43,055 - FGO - INFO - Target Total: 77
2023-09-02 20:47:43,056 - FGO - INFO - Train Total: 727
2023-09-02 20:47:43,056 - FGO - INFO - Val Total:   77
2023-09-02 20:47:43,056 - FGO - INFO - Test Total:  77
2023-09-02 20:47:43,056 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:43,056 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:43,056 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:43,056 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:43,056 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:43,056 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:43,056 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:43,056 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:43,056 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:43,056 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:43,057 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:43,058 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:43,153 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:43,153 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:43,153 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:43,153 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:43,153 - FGO - INFO - N: 804
2023-09-02 20:47:43,153 - FGO - INFO - N_s: 727
2023-09-02 20:47:43,153 - FGO - INFO - N_t: 77
2023-09-02 20:47:43,157 - CV - INFO - Begin Pretrain
2023-09-02 20:47:43,157 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:43,160 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:47:43,185 - FGO - INFO - Epoch  10 | Train Loss: 0.673 | Val Loss: 0.68 | Val F1: 0.51 |
2023-09-02 20:47:43,210 - FGO - INFO - Epoch  20 | Train Loss: 0.647 | Val Loss: 0.66 | Val F1: 0.55 |
2023-09-02 20:47:43,234 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:47:43,259 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.55 | Val F1: 0.73 |
2023-09-02 20:47:43,284 - FGO - INFO - Epoch  50 | Train Loss: 0.396 | Val Loss: 0.47 | Val F1: 0.73 |
2023-09-02 20:47:43,308 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.40 | Val F1: 0.81 |
2023-09-02 20:47:43,333 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.34 | Val F1: 0.80 |
2023-09-02 20:47:43,357 - FGO - INFO - Epoch  80 | Train Loss: 0.172 | Val Loss: 0.29 | Val F1: 0.84 |
2023-09-02 20:47:43,382 - FGO - INFO - Epoch  90 | Train Loss: 0.142 | Val Loss: 0.26 | Val F1: 0.87 |
2023-09-02 20:47:43,407 - FGO - INFO - Epoch 100 | Train Loss: 0.122 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:47:43,407 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.147 | Val Loss: 0.27 | Val F1: 0.87 
2023-09-02 20:47:43,407 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:43,408 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:47:43,408 - CV - INFO - Begin OT Train
2023-09-02 20:47:43,408 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:43,473 - FGO - INFO - Epoch   0 | Train Loss: -22.544 | Val Loss: -2.04 | Val F1: 0.87 |
2023-09-02 20:47:44,259 - FGO - INFO - Epoch  10 | Train Loss: -22.999 | Val Loss: -2.11 | Val F1: 0.92 |
2023-09-02 20:47:45,027 - FGO - INFO - Epoch  20 | Train Loss: -23.371 | Val Loss: -2.12 | Val F1: 0.92 |
2023-09-02 20:47:45,843 - FGO - INFO - Epoch  30 | Train Loss: -23.613 | Val Loss: -2.07 | Val F1: 0.83 |
2023-09-02 20:47:46,661 - FGO - INFO - Epoch  40 | Train Loss: -23.850 | Val Loss: -1.94 | Val F1: 0.76 |
2023-09-02 20:47:47,355 - FGO - INFO - Best Epoch:   7 | Train Loss: -22.871 | Val Loss: -2.09 | Val F1: 0.92 |
2023-09-02 20:47:47,355 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:47,359 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:47:47,359 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:47,383 - FGO - INFO - Train CM:
[[390   0]
 [291  46]]
2023-09-02 20:47:47,383 - FGO - INFO - Val CM:
[[44  0]
 [27  6]]
2023-09-02 20:47:47,383 - FGO - INFO - Test CM:
[[44  0]
 [27  6]]
2023-09-02 20:47:47,389 - FGO - INFO - test statistical parity: 0.09230769230769231
2023-09-02 20:47:47,390 - FGO - INFO - test equal opportunity: 0.1935483870967742
2023-09-02 20:47:47,391 - FGO - INFO - test micro f1: 0.6493506493506493
2023-09-02 20:47:47,391 - FGO - INFO - test macro f1: 0.5364548494983277
2023-09-02 20:47:47,391 - CV - INFO - fold time: 4.337622165679932s (0.0722937027613322m)
2023-09-02 20:47:47,391 - CV - INFO - ----- BEGINNING FOLD SET (009:2)----------------------------------------------------------
2023-09-02 20:47:47,393 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/009/2
2023-09-02 20:47:47,393 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:47,393 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:47,393 - FGO - INFO - 	done: False
2023-09-02 20:47:47,393 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:47,393 - FGO - INFO - 	h1: 64
2023-09-02 20:47:47,393 - FGO - INFO - 	h2: 32
2023-09-02 20:47:47,393 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:47,393 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:47,393 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:47,393 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:47,393 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:47,393 - FGO - INFO - 	theta: 50
2023-09-02 20:47:47,393 - FGO - INFO - 	clip: 5
2023-09-02 20:47:47,393 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:47,393 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:47,393 - FGO - INFO - Source Total: 721
2023-09-02 20:47:47,393 - FGO - INFO - Target Total: 83
2023-09-02 20:47:47,393 - FGO - INFO - Train Total: 721
2023-09-02 20:47:47,393 - FGO - INFO - Val Total:   83
2023-09-02 20:47:47,393 - FGO - INFO - Test Total:  83
2023-09-02 20:47:47,393 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:47,393 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:47,393 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:47,393 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:47,393 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:47,394 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:47,394 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:47,394 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:47,394 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:47,394 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:47,395 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:47,396 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:47,498 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:47,498 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:47,498 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:47,498 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:47,498 - FGO - INFO - N: 804
2023-09-02 20:47:47,498 - FGO - INFO - N_s: 721
2023-09-02 20:47:47,498 - FGO - INFO - N_t: 83
2023-09-02 20:47:47,502 - CV - INFO - Begin Pretrain
2023-09-02 20:47:47,502 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:47,505 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:47:47,530 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.57 |
2023-09-02 20:47:47,554 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.64 | Val F1: 0.66 |
2023-09-02 20:47:47,579 - FGO - INFO - Epoch  30 | Train Loss: 0.594 | Val Loss: 0.60 | Val F1: 0.76 |
2023-09-02 20:47:47,603 - FGO - INFO - Epoch  40 | Train Loss: 0.506 | Val Loss: 0.52 | Val F1: 0.83 |
2023-09-02 20:47:47,628 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:47:47,652 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.34 | Val F1: 0.85 |
2023-09-02 20:47:47,677 - FGO - INFO - Epoch  70 | Train Loss: 0.219 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:47:47,701 - FGO - INFO - Epoch  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:47:47,725 - FGO - INFO - Epoch  90 | Train Loss: 0.140 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:47:47,750 - FGO - INFO - Epoch 100 | Train Loss: 0.119 | Val Loss: 0.25 | Val F1: 0.87 |
2023-09-02 20:47:47,750 - FGO - INFO - Best Epoch:  80 | Train Loss: 0.171 | Val Loss: 0.25 | Val F1: 0.91 
2023-09-02 20:47:47,750 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:47,751 - CV - INFO - Pretrain Complete, 80 epochs
2023-09-02 20:47:47,751 - CV - INFO - Begin OT Train
2023-09-02 20:47:47,751 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:47,816 - FGO - INFO - Epoch   0 | Train Loss: -22.621 | Val Loss: -2.22 | Val F1: 0.87 |
2023-09-02 20:47:48,628 - FGO - INFO - Epoch  10 | Train Loss: -23.096 | Val Loss: -2.27 | Val F1: 0.87 |
2023-09-02 20:47:49,357 - FGO - INFO - Epoch  20 | Train Loss: -23.447 | Val Loss: -2.29 | Val F1: 0.88 |
2023-09-02 20:47:50,082 - FGO - INFO - Epoch  30 | Train Loss: -23.643 | Val Loss: -2.27 | Val F1: 0.84 |
2023-09-02 20:47:50,802 - FGO - INFO - Epoch  40 | Train Loss: -23.881 | Val Loss: -2.09 | Val F1: 0.88 |
2023-09-02 20:47:51,493 - FGO - INFO - Best Epoch:   8 | Train Loss: -23.009 | Val Loss: -2.27 | Val F1: 0.89 |
2023-09-02 20:47:51,493 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:51,496 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:47:51,497 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:51,521 - FGO - INFO - Train CM:
[[  0 384]
 [  0 337]]
2023-09-02 20:47:51,522 - FGO - INFO - Val CM:
[[50  0]
 [30  3]]
2023-09-02 20:47:51,522 - FGO - INFO - Test CM:
[[50  0]
 [30  3]]
2023-09-02 20:47:51,527 - FGO - INFO - test statistical parity: 0.04225352112676056
2023-09-02 20:47:51,529 - FGO - INFO - test equal opportunity: 0.1111111111111111
2023-09-02 20:47:51,530 - FGO - INFO - test micro f1: 0.6385542168674698
2023-09-02 20:47:51,530 - FGO - INFO - test macro f1: 0.46794871794871795
2023-09-02 20:47:51,530 - CV - INFO - fold time: 4.13874888420105s (0.0689791480700175m)
2023-09-02 20:47:51,530 - CV - INFO - ----- BEGINNING FOLD SET (009:3)----------------------------------------------------------
2023-09-02 20:47:51,532 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/009/3
2023-09-02 20:47:51,532 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:51,532 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:51,532 - FGO - INFO - 	done: False
2023-09-02 20:47:51,532 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:51,532 - FGO - INFO - 	h1: 64
2023-09-02 20:47:51,532 - FGO - INFO - 	h2: 32
2023-09-02 20:47:51,532 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:51,532 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:51,532 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:51,532 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:51,532 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:51,532 - FGO - INFO - 	theta: 50
2023-09-02 20:47:51,532 - FGO - INFO - 	clip: 5
2023-09-02 20:47:51,532 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:51,532 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:51,532 - FGO - INFO - Source Total: 729
2023-09-02 20:47:51,532 - FGO - INFO - Target Total: 75
2023-09-02 20:47:51,532 - FGO - INFO - Train Total: 729
2023-09-02 20:47:51,532 - FGO - INFO - Val Total:   75
2023-09-02 20:47:51,532 - FGO - INFO - Test Total:  75
2023-09-02 20:47:51,532 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:51,532 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:51,532 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:51,532 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:51,532 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:51,533 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:51,533 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:51,533 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:51,533 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:51,533 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:51,534 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:51,535 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:51,628 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:51,628 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:51,628 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:51,628 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:51,628 - FGO - INFO - N: 804
2023-09-02 20:47:51,628 - FGO - INFO - N_s: 729
2023-09-02 20:47:51,628 - FGO - INFO - N_t: 75
2023-09-02 20:47:51,632 - CV - INFO - Begin Pretrain
2023-09-02 20:47:51,632 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:51,635 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:47:51,660 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.67 | Val F1: 0.39 |
2023-09-02 20:47:51,684 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.64 |
2023-09-02 20:47:51,709 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.57 | Val F1: 0.86 |
2023-09-02 20:47:51,734 - FGO - INFO - Epoch  40 | Train Loss: 0.510 | Val Loss: 0.47 | Val F1: 0.92 |
2023-09-02 20:47:51,758 - FGO - INFO - Epoch  50 | Train Loss: 0.406 | Val Loss: 0.34 | Val F1: 0.93 |
2023-09-02 20:47:51,783 - FGO - INFO - Epoch  60 | Train Loss: 0.305 | Val Loss: 0.23 | Val F1: 0.97 |
2023-09-02 20:47:51,807 - FGO - INFO - Epoch  70 | Train Loss: 0.231 | Val Loss: 0.16 | Val F1: 0.99 |
2023-09-02 20:47:51,832 - FGO - INFO - Epoch  80 | Train Loss: 0.186 | Val Loss: 0.12 | Val F1: 0.99 |
2023-09-02 20:47:51,857 - FGO - INFO - Epoch  90 | Train Loss: 0.156 | Val Loss: 0.10 | Val F1: 0.99 |
2023-09-02 20:47:51,881 - FGO - INFO - Epoch 100 | Train Loss: 0.135 | Val Loss: 0.09 | Val F1: 0.97 |
2023-09-02 20:47:51,881 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.161 | Val Loss: 0.10 | Val F1: 0.99 
2023-09-02 20:47:51,881 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:51,883 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:47:51,883 - CV - INFO - Begin OT Train
2023-09-02 20:47:51,883 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:51,947 - FGO - INFO - Epoch   0 | Train Loss: -22.129 | Val Loss: -2.28 | Val F1: 0.99 |
2023-09-02 20:47:52,787 - FGO - INFO - Epoch  10 | Train Loss: -22.792 | Val Loss: -2.31 | Val F1: 0.99 |
2023-09-02 20:47:53,638 - FGO - INFO - Epoch  20 | Train Loss: -23.140 | Val Loss: -2.29 | Val F1: 0.91 |
2023-09-02 20:47:54,376 - FGO - INFO - Epoch  30 | Train Loss: -23.387 | Val Loss: -2.32 | Val F1: 0.95 |
2023-09-02 20:47:55,170 - FGO - INFO - Epoch  40 | Train Loss: -23.569 | Val Loss: -2.20 | Val F1: 0.88 |
2023-09-02 20:47:55,857 - FGO - INFO - Best Epoch:   9 | Train Loss: -22.756 | Val Loss: -2.29 | Val F1: 0.99 |
2023-09-02 20:47:55,857 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:55,861 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:47:55,861 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:47:55,883 - FGO - INFO - Train CM:
[[396   0]
 [333   0]]
2023-09-02 20:47:55,884 - FGO - INFO - Val CM:
[[38  0]
 [26 11]]
2023-09-02 20:47:55,884 - FGO - INFO - Test CM:
[[38  0]
 [26 11]]
2023-09-02 20:47:55,888 - FGO - INFO - test statistical parity: 0.09250585480093676
2023-09-02 20:47:55,890 - FGO - INFO - test equal opportunity: 0.19047619047619047
2023-09-02 20:47:55,891 - FGO - INFO - test micro f1: 0.6533333333333333
2023-09-02 20:47:55,891 - FGO - INFO - test macro f1: 0.6017156862745098
2023-09-02 20:47:55,891 - CV - INFO - fold time: 4.361069202423096s (0.07268448670705159m)
2023-09-02 20:47:55,891 - CV - INFO - ----- BEGINNING FOLD SET (009:4)----------------------------------------------------------
2023-09-02 20:47:55,893 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/009/4
2023-09-02 20:47:55,893 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:47:55,893 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:47:55,893 - FGO - INFO - 	done: False
2023-09-02 20:47:55,893 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:47:55,893 - FGO - INFO - 	h1: 64
2023-09-02 20:47:55,893 - FGO - INFO - 	h2: 32
2023-09-02 20:47:55,893 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:47:55,893 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:47:55,893 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:47:55,893 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:47:55,893 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:47:55,893 - FGO - INFO - 	theta: 50
2023-09-02 20:47:55,893 - FGO - INFO - 	clip: 5
2023-09-02 20:47:55,893 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:47:55,893 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:47:55,893 - FGO - INFO - Source Total: 732
2023-09-02 20:47:55,893 - FGO - INFO - Target Total: 72
2023-09-02 20:47:55,893 - FGO - INFO - Train Total: 732
2023-09-02 20:47:55,893 - FGO - INFO - Val Total:   72
2023-09-02 20:47:55,893 - FGO - INFO - Test Total:  72
2023-09-02 20:47:55,893 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:47:55,893 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:47:55,893 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:47:55,893 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:47:55,893 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:47:55,894 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:47:55,894 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:47:55,894 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:47:55,894 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:47:55,894 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:47:55,895 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:47:55,896 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:47:55,987 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:47:55,987 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:47:55,987 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:47:55,987 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:47:55,987 - FGO - INFO - N: 804
2023-09-02 20:47:55,987 - FGO - INFO - N_s: 732
2023-09-02 20:47:55,987 - FGO - INFO - N_t: 72
2023-09-02 20:47:55,991 - CV - INFO - Begin Pretrain
2023-09-02 20:47:55,991 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:47:55,994 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:47:56,019 - FGO - INFO - Epoch  10 | Train Loss: 0.674 | Val Loss: 0.68 | Val F1: 0.45 |
2023-09-02 20:47:56,043 - FGO - INFO - Epoch  20 | Train Loss: 0.649 | Val Loss: 0.66 | Val F1: 0.63 |
2023-09-02 20:47:56,068 - FGO - INFO - Epoch  30 | Train Loss: 0.596 | Val Loss: 0.60 | Val F1: 0.75 |
2023-09-02 20:47:56,093 - FGO - INFO - Epoch  40 | Train Loss: 0.508 | Val Loss: 0.50 | Val F1: 0.87 |
2023-09-02 20:47:56,118 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.39 | Val F1: 0.89 |
2023-09-02 20:47:56,142 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:47:56,167 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:47:56,192 - FGO - INFO - Epoch  80 | Train Loss: 0.179 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:47:56,216 - FGO - INFO - Epoch  90 | Train Loss: 0.150 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:47:56,240 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:47:56,240 - FGO - INFO - Best Epoch:  81 | Train Loss: 0.175 | Val Loss: 0.16 | Val F1: 0.97 
2023-09-02 20:47:56,241 - FGO - INFO - Setting model to best state.
2023-09-02 20:47:56,242 - CV - INFO - Pretrain Complete, 81 epochs
2023-09-02 20:47:56,242 - CV - INFO - Begin OT Train
2023-09-02 20:47:56,242 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:47:56,307 - FGO - INFO - Epoch   0 | Train Loss: -22.418 | Val Loss: -2.20 | Val F1: 0.97 |
2023-09-02 20:47:57,069 - FGO - INFO - Epoch  10 | Train Loss: -22.891 | Val Loss: -2.22 | Val F1: 0.94 |
2023-09-02 20:47:57,835 - FGO - INFO - Epoch  20 | Train Loss: -23.242 | Val Loss: -2.21 | Val F1: 0.90 |
2023-09-02 20:47:58,661 - FGO - INFO - Epoch  30 | Train Loss: -23.434 | Val Loss: -2.17 | Val F1: 0.89 |
2023-09-02 20:47:59,472 - FGO - INFO - Epoch  40 | Train Loss: -23.606 | Val Loss: -2.08 | Val F1: 0.84 |
2023-09-02 20:48:00,196 - FGO - INFO - Best Epoch:   6 | Train Loss: -22.720 | Val Loss: -2.19 | Val F1: 0.94 |
2023-09-02 20:48:00,197 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:00,204 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:48:00,204 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:00,229 - FGO - INFO - Train CM:
[[  0 397]
 [  0 335]]
2023-09-02 20:48:00,230 - FGO - INFO - Val CM:
[[37  0]
 [26  9]]
2023-09-02 20:48:00,230 - FGO - INFO - Test CM:
[[37  0]
 [26  9]]
2023-09-02 20:48:00,235 - FGO - INFO - test statistical parity: 0.14516129032258066
2023-09-02 20:48:00,236 - FGO - INFO - test equal opportunity: 0.3
2023-09-02 20:48:00,237 - FGO - INFO - test micro f1: 0.6388888888888888
2023-09-02 20:48:00,238 - FGO - INFO - test macro f1: 0.5745454545454545
2023-09-02 20:48:00,238 - CV - INFO - fold time: 4.346564769744873s (0.07244274616241456m)
2023-09-02 20:48:00,238 - CV - INFO - ----- BEGINNING FOLD SET (009:5)----------------------------------------------------------
2023-09-02 20:48:00,239 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/009/5
2023-09-02 20:48:00,240 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:00,240 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:00,240 - FGO - INFO - 	done: False
2023-09-02 20:48:00,240 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:48:00,240 - FGO - INFO - 	h1: 64
2023-09-02 20:48:00,240 - FGO - INFO - 	h2: 32
2023-09-02 20:48:00,240 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:00,240 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:00,240 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:00,240 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:00,240 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:48:00,240 - FGO - INFO - 	theta: 50
2023-09-02 20:48:00,240 - FGO - INFO - 	clip: 5
2023-09-02 20:48:00,240 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:00,240 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:00,240 - FGO - INFO - Source Total: 726
2023-09-02 20:48:00,240 - FGO - INFO - Target Total: 78
2023-09-02 20:48:00,240 - FGO - INFO - Train Total: 726
2023-09-02 20:48:00,240 - FGO - INFO - Val Total:   78
2023-09-02 20:48:00,240 - FGO - INFO - Test Total:  78
2023-09-02 20:48:00,240 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:00,240 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:00,240 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:00,240 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:00,240 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:00,241 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:00,241 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:00,241 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:00,241 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:00,241 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:00,242 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:00,243 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:00,340 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:00,340 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:00,340 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:00,340 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:00,340 - FGO - INFO - N: 804
2023-09-02 20:48:00,340 - FGO - INFO - N_s: 726
2023-09-02 20:48:00,340 - FGO - INFO - N_t: 78
2023-09-02 20:48:00,344 - CV - INFO - Begin Pretrain
2023-09-02 20:48:00,344 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:00,347 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:48:00,372 - FGO - INFO - Epoch  10 | Train Loss: 0.669 | Val Loss: 0.72 | Val F1: 0.34 |
2023-09-02 20:48:00,396 - FGO - INFO - Epoch  20 | Train Loss: 0.644 | Val Loss: 0.69 | Val F1: 0.42 |
2023-09-02 20:48:00,421 - FGO - INFO - Epoch  30 | Train Loss: 0.591 | Val Loss: 0.63 | Val F1: 0.61 |
2023-09-02 20:48:00,446 - FGO - INFO - Epoch  40 | Train Loss: 0.505 | Val Loss: 0.53 | Val F1: 0.83 |
2023-09-02 20:48:00,470 - FGO - INFO - Epoch  50 | Train Loss: 0.397 | Val Loss: 0.41 | Val F1: 0.85 |
2023-09-02 20:48:00,495 - FGO - INFO - Epoch  60 | Train Loss: 0.294 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:48:00,519 - FGO - INFO - Epoch  70 | Train Loss: 0.220 | Val Loss: 0.27 | Val F1: 0.88 |
2023-09-02 20:48:00,543 - FGO - INFO - Epoch  80 | Train Loss: 0.175 | Val Loss: 0.25 | Val F1: 0.88 |
2023-09-02 20:48:00,568 - FGO - INFO - Epoch  90 | Train Loss: 0.148 | Val Loss: 0.24 | Val F1: 0.90 |
2023-09-02 20:48:00,592 - FGO - INFO - Epoch 100 | Train Loss: 0.130 | Val Loss: 0.21 | Val F1: 0.91 |
2023-09-02 20:48:00,592 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.209 | Val Loss: 0.26 | Val F1: 0.91 
2023-09-02 20:48:00,592 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:00,594 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:48:00,594 - CV - INFO - Begin OT Train
2023-09-02 20:48:00,594 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:00,693 - FGO - INFO - Epoch   0 | Train Loss: -22.331 | Val Loss: -2.17 | Val F1: 0.91 |
2023-09-02 20:48:01,526 - FGO - INFO - Epoch  10 | Train Loss: -22.882 | Val Loss: -2.14 | Val F1: 0.88 |
2023-09-02 20:48:02,342 - FGO - INFO - Epoch  20 | Train Loss: -23.255 | Val Loss: -2.12 | Val F1: 0.85 |
2023-09-02 20:48:03,128 - FGO - INFO - Epoch  30 | Train Loss: -23.486 | Val Loss: -2.14 | Val F1: 0.82 |
2023-09-02 20:48:03,909 - FGO - INFO - Epoch  40 | Train Loss: -23.661 | Val Loss: -2.10 | Val F1: 0.81 |
2023-09-02 20:48:04,628 - FGO - INFO - Best Epoch:  10 | Train Loss: -22.882 | Val Loss: -2.14 | Val F1: 0.88 |
2023-09-02 20:48:04,628 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:04,631 - CV - INFO - OT Train Complete, 10 epochs
2023-09-02 20:48:04,632 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:04,655 - FGO - INFO - Train CM:
[[  0 400]
 [  0 326]]
2023-09-02 20:48:04,656 - FGO - INFO - Val CM:
[[34  0]
 [32 12]]
2023-09-02 20:48:04,656 - FGO - INFO - Test CM:
[[34  0]
 [32 12]]
2023-09-02 20:48:04,661 - FGO - INFO - test statistical parity: 0.048309178743961345
2023-09-02 20:48:04,663 - FGO - INFO - test equal opportunity: 0.08205128205128204
2023-09-02 20:48:04,664 - FGO - INFO - test micro f1: 0.5897435897435898
2023-09-02 20:48:04,664 - FGO - INFO - test macro f1: 0.5542857142857143
2023-09-02 20:48:04,664 - CV - INFO - fold time: 4.4262354373931885s (0.0737705906232198m)
2023-09-02 20:48:04,664 - CV - INFO - ----- BEGINNING FOLD SET (009:6)----------------------------------------------------------
2023-09-02 20:48:04,666 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/009/6
2023-09-02 20:48:04,666 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:04,666 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:04,666 - FGO - INFO - 	done: False
2023-09-02 20:48:04,666 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:48:04,666 - FGO - INFO - 	h1: 64
2023-09-02 20:48:04,666 - FGO - INFO - 	h2: 32
2023-09-02 20:48:04,666 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:04,666 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:04,666 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:04,666 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:04,666 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:48:04,666 - FGO - INFO - 	theta: 50
2023-09-02 20:48:04,666 - FGO - INFO - 	clip: 5
2023-09-02 20:48:04,666 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:04,666 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:04,666 - FGO - INFO - Source Total: 717
2023-09-02 20:48:04,666 - FGO - INFO - Target Total: 87
2023-09-02 20:48:04,666 - FGO - INFO - Train Total: 717
2023-09-02 20:48:04,666 - FGO - INFO - Val Total:   87
2023-09-02 20:48:04,666 - FGO - INFO - Test Total:  87
2023-09-02 20:48:04,666 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:04,666 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:04,666 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:04,666 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:04,666 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:04,667 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:04,667 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:04,667 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:04,667 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:04,667 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:04,668 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:04,669 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:04,775 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:04,775 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:04,775 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:04,775 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:04,775 - FGO - INFO - N: 804
2023-09-02 20:48:04,775 - FGO - INFO - N_s: 717
2023-09-02 20:48:04,775 - FGO - INFO - N_t: 87
2023-09-02 20:48:04,779 - CV - INFO - Begin Pretrain
2023-09-02 20:48:04,779 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:04,782 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:48:04,807 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.47 |
2023-09-02 20:48:04,831 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.63 |
2023-09-02 20:48:04,856 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.78 |
2023-09-02 20:48:04,880 - FGO - INFO - Epoch  40 | Train Loss: 0.509 | Val Loss: 0.50 | Val F1: 0.84 |
2023-09-02 20:48:04,905 - FGO - INFO - Epoch  50 | Train Loss: 0.402 | Val Loss: 0.40 | Val F1: 0.86 |
2023-09-02 20:48:04,929 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.31 | Val F1: 0.92 |
2023-09-02 20:48:04,954 - FGO - INFO - Epoch  70 | Train Loss: 0.228 | Val Loss: 0.23 | Val F1: 0.92 |
2023-09-02 20:48:04,978 - FGO - INFO - Epoch  80 | Train Loss: 0.184 | Val Loss: 0.19 | Val F1: 0.93 |
2023-09-02 20:48:05,002 - FGO - INFO - Epoch  90 | Train Loss: 0.154 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:48:05,027 - FGO - INFO - Epoch 100 | Train Loss: 0.134 | Val Loss: 0.14 | Val F1: 0.95 |
2023-09-02 20:48:05,027 - FGO - INFO - Best Epoch:  99 | Train Loss: 0.135 | Val Loss: 0.14 | Val F1: 0.95 
2023-09-02 20:48:05,027 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:05,028 - CV - INFO - Pretrain Complete, 99 epochs
2023-09-02 20:48:05,028 - CV - INFO - Begin OT Train
2023-09-02 20:48:05,028 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:05,092 - FGO - INFO - Epoch   0 | Train Loss: -22.280 | Val Loss: -2.73 | Val F1: 0.95 |
2023-09-02 20:48:05,859 - FGO - INFO - Epoch  10 | Train Loss: -22.725 | Val Loss: -2.77 | Val F1: 0.94 |
2023-09-02 20:48:06,690 - FGO - INFO - Epoch  20 | Train Loss: -23.068 | Val Loss: -2.81 | Val F1: 0.92 |
2023-09-02 20:48:07,506 - FGO - INFO - Epoch  30 | Train Loss: -23.271 | Val Loss: -2.76 | Val F1: 0.89 |
2023-09-02 20:48:08,301 - FGO - INFO - Epoch  40 | Train Loss: -23.477 | Val Loss: -2.61 | Val F1: 0.81 |
2023-09-02 20:48:09,005 - FGO - INFO - Best Epoch:   6 | Train Loss: -22.561 | Val Loss: -2.75 | Val F1: 0.94 |
2023-09-02 20:48:09,005 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:09,008 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:48:09,008 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:09,034 - FGO - INFO - Train CM:
[[  0 385]
 [  0 332]]
2023-09-02 20:48:09,035 - FGO - INFO - Val CM:
[[48  1]
 [32  6]]
2023-09-02 20:48:09,035 - FGO - INFO - Test CM:
[[48  1]
 [32  6]]
2023-09-02 20:48:09,040 - FGO - INFO - test statistical parity: 0.08860759493670886
2023-09-02 20:48:09,042 - FGO - INFO - test equal opportunity: 0.17647058823529413
2023-09-02 20:48:09,043 - FGO - INFO - test micro f1: 0.6206896551724138
2023-09-02 20:48:09,043 - FGO - INFO - test macro f1: 0.5054263565891473
2023-09-02 20:48:09,043 - CV - INFO - fold time: 4.379239082336426s (0.07298731803894043m)
2023-09-02 20:48:09,043 - CV - INFO - ----- BEGINNING FOLD SET (009:7)----------------------------------------------------------
2023-09-02 20:48:09,045 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/009/7
2023-09-02 20:48:09,045 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:09,045 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:09,045 - FGO - INFO - 	done: False
2023-09-02 20:48:09,045 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:48:09,045 - FGO - INFO - 	h1: 64
2023-09-02 20:48:09,045 - FGO - INFO - 	h2: 32
2023-09-02 20:48:09,045 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:09,045 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:09,045 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:09,045 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:09,045 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:48:09,045 - FGO - INFO - 	theta: 50
2023-09-02 20:48:09,045 - FGO - INFO - 	clip: 5
2023-09-02 20:48:09,045 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:09,045 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:09,045 - FGO - INFO - Source Total: 717
2023-09-02 20:48:09,045 - FGO - INFO - Target Total: 87
2023-09-02 20:48:09,045 - FGO - INFO - Train Total: 717
2023-09-02 20:48:09,045 - FGO - INFO - Val Total:   87
2023-09-02 20:48:09,045 - FGO - INFO - Test Total:  87
2023-09-02 20:48:09,045 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:09,045 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:09,045 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:09,045 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:09,045 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:09,046 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:09,046 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:09,046 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:09,046 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:09,046 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:09,047 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:09,048 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:09,154 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:09,154 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:09,154 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:09,154 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:09,154 - FGO - INFO - N: 804
2023-09-02 20:48:09,154 - FGO - INFO - N_s: 717
2023-09-02 20:48:09,154 - FGO - INFO - N_t: 87
2023-09-02 20:48:09,157 - CV - INFO - Begin Pretrain
2023-09-02 20:48:09,158 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:09,161 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:48:09,185 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.40 |
2023-09-02 20:48:09,210 - FGO - INFO - Epoch  20 | Train Loss: 0.650 | Val Loss: 0.64 | Val F1: 0.62 |
2023-09-02 20:48:09,235 - FGO - INFO - Epoch  30 | Train Loss: 0.595 | Val Loss: 0.59 | Val F1: 0.77 |
2023-09-02 20:48:09,259 - FGO - INFO - Epoch  40 | Train Loss: 0.507 | Val Loss: 0.52 | Val F1: 0.88 |
2023-09-02 20:48:09,284 - FGO - INFO - Epoch  50 | Train Loss: 0.398 | Val Loss: 0.41 | Val F1: 0.88 |
2023-09-02 20:48:09,308 - FGO - INFO - Epoch  60 | Train Loss: 0.297 | Val Loss: 0.31 | Val F1: 0.91 |
2023-09-02 20:48:09,332 - FGO - INFO - Epoch  70 | Train Loss: 0.224 | Val Loss: 0.23 | Val F1: 0.94 |
2023-09-02 20:48:09,357 - FGO - INFO - Epoch  80 | Train Loss: 0.180 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:48:09,381 - FGO - INFO - Epoch  90 | Train Loss: 0.151 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:48:09,406 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:48:09,406 - FGO - INFO - Best Epoch:  91 | Train Loss: 0.149 | Val Loss: 0.15 | Val F1: 0.97 
2023-09-02 20:48:09,406 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:09,407 - CV - INFO - Pretrain Complete, 91 epochs
2023-09-02 20:48:09,407 - CV - INFO - Begin OT Train
2023-09-02 20:48:09,407 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:09,501 - FGO - INFO - Epoch   0 | Train Loss: -22.431 | Val Loss: -2.61 | Val F1: 0.97 |
2023-09-02 20:48:10,245 - FGO - INFO - Epoch  10 | Train Loss: -22.880 | Val Loss: -2.63 | Val F1: 0.93 |
2023-09-02 20:48:11,052 - FGO - INFO - Epoch  20 | Train Loss: -23.226 | Val Loss: -2.66 | Val F1: 0.93 |
2023-09-02 20:48:11,822 - FGO - INFO - Epoch  30 | Train Loss: -23.440 | Val Loss: -2.60 | Val F1: 0.88 |
2023-09-02 20:48:12,664 - FGO - INFO - Epoch  40 | Train Loss: -23.649 | Val Loss: -2.48 | Val F1: 0.75 |
2023-09-02 20:48:13,349 - FGO - INFO - Best Epoch:   6 | Train Loss: -22.708 | Val Loss: -2.62 | Val F1: 0.95 |
2023-09-02 20:48:13,349 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:13,354 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:48:13,354 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:13,376 - FGO - INFO - Train CM:
[[  0 387]
 [  0 330]]
2023-09-02 20:48:13,376 - FGO - INFO - Val CM:
[[47  0]
 [31  9]]
2023-09-02 20:48:13,377 - FGO - INFO - Test CM:
[[47  0]
 [31  9]]
2023-09-02 20:48:13,381 - FGO - INFO - test statistical parity: 0.12
2023-09-02 20:48:13,382 - FGO - INFO - test equal opportunity: 0.2903225806451613
2023-09-02 20:48:13,383 - FGO - INFO - test micro f1: 0.6436781609195402
2023-09-02 20:48:13,384 - FGO - INFO - test macro f1: 0.559673469387755
2023-09-02 20:48:13,384 - CV - INFO - fold time: 4.340418100357056s (0.0723403016726176m)
2023-09-02 20:48:13,384 - CV - INFO - ----- BEGINNING FOLD SET (009:8)----------------------------------------------------------
2023-09-02 20:48:13,385 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/009/8
2023-09-02 20:48:13,385 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:13,385 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:13,385 - FGO - INFO - 	done: False
2023-09-02 20:48:13,385 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:48:13,385 - FGO - INFO - 	h1: 64
2023-09-02 20:48:13,385 - FGO - INFO - 	h2: 32
2023-09-02 20:48:13,385 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:13,385 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:13,385 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:13,386 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:13,386 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:48:13,386 - FGO - INFO - 	theta: 50
2023-09-02 20:48:13,386 - FGO - INFO - 	clip: 5
2023-09-02 20:48:13,386 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:13,386 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:13,386 - FGO - INFO - Source Total: 734
2023-09-02 20:48:13,386 - FGO - INFO - Target Total: 70
2023-09-02 20:48:13,386 - FGO - INFO - Train Total: 734
2023-09-02 20:48:13,386 - FGO - INFO - Val Total:   70
2023-09-02 20:48:13,386 - FGO - INFO - Test Total:  70
2023-09-02 20:48:13,386 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:13,386 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:13,386 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:13,386 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:13,386 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:13,386 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:13,386 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:13,386 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:13,386 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:13,386 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:13,387 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:13,389 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:13,477 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:13,477 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:13,477 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:13,477 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:13,477 - FGO - INFO - N: 804
2023-09-02 20:48:13,477 - FGO - INFO - N_s: 734
2023-09-02 20:48:13,477 - FGO - INFO - N_t: 70
2023-09-02 20:48:13,480 - CV - INFO - Begin Pretrain
2023-09-02 20:48:13,480 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:13,484 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:48:13,509 - FGO - INFO - Epoch  10 | Train Loss: 0.672 | Val Loss: 0.69 | Val F1: 0.41 |
2023-09-02 20:48:13,533 - FGO - INFO - Epoch  20 | Train Loss: 0.645 | Val Loss: 0.66 | Val F1: 0.62 |
2023-09-02 20:48:13,558 - FGO - INFO - Epoch  30 | Train Loss: 0.588 | Val Loss: 0.61 | Val F1: 0.76 |
2023-09-02 20:48:13,583 - FGO - INFO - Epoch  40 | Train Loss: 0.498 | Val Loss: 0.53 | Val F1: 0.81 |
2023-09-02 20:48:13,608 - FGO - INFO - Epoch  50 | Train Loss: 0.392 | Val Loss: 0.43 | Val F1: 0.84 |
2023-09-02 20:48:13,633 - FGO - INFO - Epoch  60 | Train Loss: 0.295 | Val Loss: 0.33 | Val F1: 0.87 |
2023-09-02 20:48:13,657 - FGO - INFO - Epoch  70 | Train Loss: 0.225 | Val Loss: 0.27 | Val F1: 0.86 |
2023-09-02 20:48:13,682 - FGO - INFO - Epoch  80 | Train Loss: 0.181 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:48:13,707 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:48:13,732 - FGO - INFO - Epoch 100 | Train Loss: 0.132 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:48:13,732 - FGO - INFO - Best Epoch:  88 | Train Loss: 0.157 | Val Loss: 0.19 | Val F1: 0.94 
2023-09-02 20:48:13,732 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:13,733 - CV - INFO - Pretrain Complete, 88 epochs
2023-09-02 20:48:13,733 - CV - INFO - Begin OT Train
2023-09-02 20:48:13,733 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:13,812 - FGO - INFO - Epoch   0 | Train Loss: -22.409 | Val Loss: -1.98 | Val F1: 0.94 |
2023-09-02 20:48:14,614 - FGO - INFO - Epoch  10 | Train Loss: -22.931 | Val Loss: -1.97 | Val F1: 0.91 |
2023-09-02 20:48:15,383 - FGO - INFO - Epoch  20 | Train Loss: -23.302 | Val Loss: -1.93 | Val F1: 0.87 |
2023-09-02 20:48:16,198 - FGO - INFO - Epoch  30 | Train Loss: -23.533 | Val Loss: -1.90 | Val F1: 0.84 |
2023-09-02 20:48:16,957 - FGO - INFO - Epoch  40 | Train Loss: -23.704 | Val Loss: -1.83 | Val F1: 0.81 |
2023-09-02 20:48:17,628 - FGO - INFO - Best Epoch:   9 | Train Loss: -22.892 | Val Loss: -1.96 | Val F1: 0.91 |
2023-09-02 20:48:17,628 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:17,630 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:48:17,631 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:17,655 - FGO - INFO - Train CM:
[[  0 400]
 [  0 334]]
2023-09-02 20:48:17,655 - FGO - INFO - Val CM:
[[34  0]
 [29  7]]
2023-09-02 20:48:17,656 - FGO - INFO - Test CM:
[[34  0]
 [29  7]]
2023-09-02 20:48:17,661 - FGO - INFO - test statistical parity: 0.02834008097165991
2023-09-02 20:48:17,662 - FGO - INFO - test equal opportunity: 0.033333333333333354
2023-09-02 20:48:17,663 - FGO - INFO - test micro f1: 0.5857142857142857
2023-09-02 20:48:17,663 - FGO - INFO - test macro f1: 0.5133061615919444
2023-09-02 20:48:17,663 - CV - INFO - fold time: 4.279704809188843s (0.07132841348648071m)
2023-09-02 20:48:17,663 - CV - INFO - ----- BEGINNING FOLD SET (009:9)----------------------------------------------------------
2023-09-02 20:48:17,665 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/009/9
2023-09-02 20:48:17,665 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:17,665 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:17,665 - FGO - INFO - 	done: False
2023-09-02 20:48:17,665 - FGO - INFO - 	learning_rate: 0.001
2023-09-02 20:48:17,665 - FGO - INFO - 	h1: 64
2023-09-02 20:48:17,665 - FGO - INFO - 	h2: 32
2023-09-02 20:48:17,665 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:17,665 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:17,665 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:17,665 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:17,665 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:48:17,665 - FGO - INFO - 	theta: 50
2023-09-02 20:48:17,665 - FGO - INFO - 	clip: 5
2023-09-02 20:48:17,665 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:17,665 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:17,665 - FGO - INFO - Source Total: 725
2023-09-02 20:48:17,665 - FGO - INFO - Target Total: 79
2023-09-02 20:48:17,665 - FGO - INFO - Train Total: 725
2023-09-02 20:48:17,665 - FGO - INFO - Val Total:   79
2023-09-02 20:48:17,665 - FGO - INFO - Test Total:  79
2023-09-02 20:48:17,665 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:17,665 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:17,665 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:17,665 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:17,665 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:17,666 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:17,666 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:17,666 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:17,666 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:17,666 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:17,667 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:17,668 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:17,766 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:17,766 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:17,766 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:17,766 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:17,766 - FGO - INFO - N: 804
2023-09-02 20:48:17,766 - FGO - INFO - N_s: 725
2023-09-02 20:48:17,766 - FGO - INFO - N_t: 79
2023-09-02 20:48:17,770 - CV - INFO - Begin Pretrain
2023-09-02 20:48:17,770 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:17,773 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:48:17,798 - FGO - INFO - Epoch  10 | Train Loss: 0.675 | Val Loss: 0.67 | Val F1: 0.50 |
2023-09-02 20:48:17,822 - FGO - INFO - Epoch  20 | Train Loss: 0.648 | Val Loss: 0.65 | Val F1: 0.59 |
2023-09-02 20:48:17,847 - FGO - INFO - Epoch  30 | Train Loss: 0.593 | Val Loss: 0.61 | Val F1: 0.69 |
2023-09-02 20:48:17,871 - FGO - INFO - Epoch  40 | Train Loss: 0.504 | Val Loss: 0.54 | Val F1: 0.78 |
2023-09-02 20:48:17,896 - FGO - INFO - Epoch  50 | Train Loss: 0.399 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:48:17,920 - FGO - INFO - Epoch  60 | Train Loss: 0.301 | Val Loss: 0.34 | Val F1: 0.90 |
2023-09-02 20:48:17,945 - FGO - INFO - Epoch  70 | Train Loss: 0.227 | Val Loss: 0.26 | Val F1: 0.92 |
2023-09-02 20:48:17,969 - FGO - INFO - Epoch  80 | Train Loss: 0.182 | Val Loss: 0.21 | Val F1: 0.96 |
2023-09-02 20:48:17,993 - FGO - INFO - Epoch  90 | Train Loss: 0.152 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:48:18,018 - FGO - INFO - Epoch 100 | Train Loss: 0.133 | Val Loss: 0.16 | Val F1: 0.96 |
2023-09-02 20:48:18,018 - FGO - INFO - Best Epoch:  85 | Train Loss: 0.165 | Val Loss: 0.19 | Val F1: 0.97 
2023-09-02 20:48:18,018 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:18,019 - CV - INFO - Pretrain Complete, 85 epochs
2023-09-02 20:48:18,019 - CV - INFO - Begin OT Train
2023-09-02 20:48:18,019 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:18,113 - FGO - INFO - Epoch   0 | Train Loss: -22.513 | Val Loss: -2.31 | Val F1: 0.96 |
2023-09-02 20:48:18,946 - FGO - INFO - Epoch  10 | Train Loss: -22.984 | Val Loss: -2.38 | Val F1: 0.96 |
2023-09-02 20:48:19,728 - FGO - INFO - Epoch  20 | Train Loss: -23.333 | Val Loss: -2.39 | Val F1: 0.93 |
2023-09-02 20:48:20,462 - FGO - INFO - Epoch  30 | Train Loss: -23.553 | Val Loss: -2.33 | Val F1: 0.92 |
2023-09-02 20:48:21,277 - FGO - INFO - Epoch  40 | Train Loss: -23.817 | Val Loss: -2.08 | Val F1: 0.95 |
2023-09-02 20:48:21,955 - FGO - INFO - Best Epoch:   9 | Train Loss: -22.942 | Val Loss: -2.37 | Val F1: 0.97 |
2023-09-02 20:48:21,955 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:21,958 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:48:21,958 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:21,984 - FGO - INFO - Train CM:
[[  0 385]
 [  0 340]]
2023-09-02 20:48:21,985 - FGO - INFO - Val CM:
[[49  0]
 [25  5]]
2023-09-02 20:48:21,985 - FGO - INFO - Test CM:
[[49  0]
 [25  5]]
2023-09-02 20:48:21,990 - FGO - INFO - test statistical parity: 0.07246376811594203
2023-09-02 20:48:21,992 - FGO - INFO - test equal opportunity: 0.19230769230769232
2023-09-02 20:48:21,992 - FGO - INFO - test micro f1: 0.6835443037974683
2023-09-02 20:48:21,993 - FGO - INFO - test macro f1: 0.5412311265969802
2023-09-02 20:48:21,993 - CV - INFO - fold time: 4.329479932785034s (0.07215799887975057m)
2023-09-02 20:48:21,993 - CV - INFO - Mean Pretrain Epochs 85.8:
2023-09-02 20:48:21,993 - CV - INFO - Mean OT Train Epochs 7.6:
2023-09-02 20:48:21,993 - CV - INFO - Mean Val Macro F1 : 0.5277038013607767
2023-09-02 20:48:21,993 - CV - INFO - Mean Eval Stat : 0.5277038013607767 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:48:21,993 - CV - INFO - set time: 43.13311958312988s (0.7188853263854981m)
2023-09-02 20:48:21,993 - CV - INFO - script time so far: 399.9442069530487s (6.665736782550812m) (0.11109561304251353h)
2023-09-02 20:48:21,993 - CV - INFO - ===== BEGINNING OPTION SET (010)==========================================================
2023-09-02 20:48:21,993 - CV - INFO - 	done: False
2023-09-02 20:48:21,993 - CV - INFO - 	learning_rate: 0.005
2023-09-02 20:48:21,993 - CV - INFO - 	h1: 64
2023-09-02 20:48:21,993 - CV - INFO - 	h2: 32
2023-09-02 20:48:21,993 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:21,993 - CV - INFO - 	dropout: 0.0
2023-09-02 20:48:21,993 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:21,993 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:21,993 - CV - INFO - 	lambda: 0.01
2023-09-02 20:48:21,993 - CV - INFO - 	theta: 10
2023-09-02 20:48:21,993 - CV - INFO - 	clip: 5
2023-09-02 20:48:21,993 - CV - INFO - ----- BEGINNING FOLD SET (010:0)----------------------------------------------------------
2023-09-02 20:48:21,995 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/010/0
2023-09-02 20:48:21,995 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:21,995 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:21,995 - FGO - INFO - 	done: False
2023-09-02 20:48:21,995 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:48:21,995 - FGO - INFO - 	h1: 64
2023-09-02 20:48:21,995 - FGO - INFO - 	h2: 32
2023-09-02 20:48:21,995 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:21,995 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:21,995 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:21,995 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:21,995 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:48:21,995 - FGO - INFO - 	theta: 10
2023-09-02 20:48:21,995 - FGO - INFO - 	clip: 5
2023-09-02 20:48:21,995 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:21,995 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:21,995 - FGO - INFO - Source Total: 708
2023-09-02 20:48:21,995 - FGO - INFO - Target Total: 96
2023-09-02 20:48:21,995 - FGO - INFO - Train Total: 708
2023-09-02 20:48:21,995 - FGO - INFO - Val Total:   96
2023-09-02 20:48:21,995 - FGO - INFO - Test Total:  96
2023-09-02 20:48:21,995 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:21,995 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:21,995 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:21,995 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:21,995 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:21,996 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:21,996 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:21,996 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:21,996 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:21,996 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:21,997 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:21,998 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:22,113 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:22,113 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:22,113 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:22,113 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:22,113 - FGO - INFO - N: 804
2023-09-02 20:48:22,113 - FGO - INFO - N_s: 708
2023-09-02 20:48:22,113 - FGO - INFO - N_t: 96
2023-09-02 20:48:22,117 - CV - INFO - Begin Pretrain
2023-09-02 20:48:22,117 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:22,120 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:48:22,145 - FGO - INFO - Epoch  10 | Train Loss: 0.572 | Val Loss: 0.59 | Val F1: 0.62 |
2023-09-02 20:48:22,169 - FGO - INFO - Epoch  20 | Train Loss: 0.245 | Val Loss: 0.25 | Val F1: 0.93 |
2023-09-02 20:48:22,193 - FGO - INFO - Epoch  30 | Train Loss: 0.127 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:48:22,218 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:48:22,242 - FGO - INFO - Epoch  50 | Train Loss: 0.083 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:48:22,266 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:48:22,291 - FGO - INFO - Epoch  70 | Train Loss: 0.067 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:48:22,315 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:48:22,339 - FGO - INFO - Epoch  90 | Train Loss: 0.060 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:48:22,363 - FGO - INFO - Epoch 100 | Train Loss: 0.058 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:48:22,363 - FGO - INFO - Best Epoch:  39 | Train Loss: 0.095 | Val Loss: 0.10 | Val F1: 0.98 
2023-09-02 20:48:22,363 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:22,364 - CV - INFO - Pretrain Complete, 39 epochs
2023-09-02 20:48:22,364 - CV - INFO - Begin OT Train
2023-09-02 20:48:22,364 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:22,494 - FGO - INFO - Epoch   0 | Train Loss: -0.546 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:48:23,415 - FGO - INFO - Epoch  10 | Train Loss: -0.596 | Val Loss: 0.04 | Val F1: 0.93 |
2023-09-02 20:48:24,448 - FGO - INFO - Epoch  20 | Train Loss: -0.685 | Val Loss: -0.01 | Val F1: 0.97 |
2023-09-02 20:48:25,343 - FGO - INFO - Epoch  30 | Train Loss: -0.722 | Val Loss: -0.00 | Val F1: 0.97 |
2023-09-02 20:48:26,259 - FGO - INFO - Epoch  40 | Train Loss: -0.752 | Val Loss: -0.03 | Val F1: 0.98 |
2023-09-02 20:48:27,011 - FGO - INFO - Best Epoch:  24 | Train Loss: -0.707 | Val Loss: -0.03 | Val F1: 0.99 |
2023-09-02 20:48:27,011 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:27,014 - CV - INFO - OT Train Complete, 24 epochs
2023-09-02 20:48:27,015 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:27,042 - FGO - INFO - Train CM:
[[373   9]
 [ 10 316]]
2023-09-02 20:48:27,043 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:48:27,043 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:48:27,048 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:48:27,049 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:48:27,050 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:48:27,050 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:48:27,050 - CV - INFO - fold time: 5.05716872215271s (0.08428614536921183m)
2023-09-02 20:48:27,050 - CV - INFO - ----- BEGINNING FOLD SET (010:1)----------------------------------------------------------
2023-09-02 20:48:27,052 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/010/1
2023-09-02 20:48:27,052 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:27,052 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:27,052 - FGO - INFO - 	done: False
2023-09-02 20:48:27,052 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:48:27,052 - FGO - INFO - 	h1: 64
2023-09-02 20:48:27,052 - FGO - INFO - 	h2: 32
2023-09-02 20:48:27,052 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:27,052 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:27,052 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:27,052 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:27,052 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:48:27,052 - FGO - INFO - 	theta: 10
2023-09-02 20:48:27,052 - FGO - INFO - 	clip: 5
2023-09-02 20:48:27,052 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:27,052 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:27,052 - FGO - INFO - Source Total: 727
2023-09-02 20:48:27,052 - FGO - INFO - Target Total: 77
2023-09-02 20:48:27,052 - FGO - INFO - Train Total: 727
2023-09-02 20:48:27,052 - FGO - INFO - Val Total:   77
2023-09-02 20:48:27,052 - FGO - INFO - Test Total:  77
2023-09-02 20:48:27,052 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:27,053 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:27,053 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:27,053 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:27,053 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:27,053 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:27,053 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:27,053 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:27,053 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:27,053 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:27,054 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:27,055 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:27,152 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:27,152 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:27,152 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:27,152 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:27,152 - FGO - INFO - N: 804
2023-09-02 20:48:27,152 - FGO - INFO - N_s: 727
2023-09-02 20:48:27,152 - FGO - INFO - N_t: 77
2023-09-02 20:48:27,156 - CV - INFO - Begin Pretrain
2023-09-02 20:48:27,156 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:27,159 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:48:27,188 - FGO - INFO - Epoch  10 | Train Loss: 0.577 | Val Loss: 0.61 | Val F1: 0.66 |
2023-09-02 20:48:27,216 - FGO - INFO - Epoch  20 | Train Loss: 0.255 | Val Loss: 0.38 | Val F1: 0.83 |
2023-09-02 20:48:27,244 - FGO - INFO - Epoch  30 | Train Loss: 0.122 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:48:27,276 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.20 | Val F1: 0.89 |
2023-09-02 20:48:27,307 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.87 |
2023-09-02 20:48:27,331 - FGO - INFO - Epoch  60 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.89 |
2023-09-02 20:48:27,356 - FGO - INFO - Epoch  70 | Train Loss: 0.063 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:48:27,380 - FGO - INFO - Epoch  80 | Train Loss: 0.060 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:48:27,405 - FGO - INFO - Epoch  90 | Train Loss: 0.057 | Val Loss: 0.21 | Val F1: 0.90 |
2023-09-02 20:48:27,429 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.20 | Val F1: 0.92 |
2023-09-02 20:48:27,429 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.097 | Val Loss: 0.18 | Val F1: 0.93 
2023-09-02 20:48:27,429 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:27,431 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:48:27,431 - CV - INFO - Begin OT Train
2023-09-02 20:48:27,431 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:27,544 - FGO - INFO - Epoch   0 | Train Loss: -0.419 | Val Loss: 0.17 | Val F1: 0.89 |
2023-09-02 20:48:28,541 - FGO - INFO - Epoch  10 | Train Loss: -0.477 | Val Loss: 0.43 | Val F1: 0.87 |
2023-09-02 20:48:29,449 - FGO - INFO - Epoch  20 | Train Loss: -0.659 | Val Loss: 0.09 | Val F1: 0.93 |
2023-09-02 20:48:30,381 - FGO - INFO - Epoch  30 | Train Loss: -0.715 | Val Loss: 0.08 | Val F1: 0.93 |
2023-09-02 20:48:31,224 - FGO - INFO - Epoch  40 | Train Loss: -0.749 | Val Loss: 0.10 | Val F1: 0.91 |
2023-09-02 20:48:31,948 - FGO - INFO - Best Epoch:  23 | Train Loss: -0.687 | Val Loss: 0.09 | Val F1: 0.93 |
2023-09-02 20:48:31,948 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:31,952 - CV - INFO - OT Train Complete, 23 epochs
2023-09-02 20:48:31,952 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:31,981 - FGO - INFO - Train CM:
[[382   8]
 [  9 328]]
2023-09-02 20:48:31,981 - FGO - INFO - Val CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:48:31,981 - FGO - INFO - Test CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:48:31,986 - FGO - INFO - test statistical parity: 0.36282051282051286
2023-09-02 20:48:31,988 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:48:31,989 - FGO - INFO - test micro f1: 0.935064935064935
2023-09-02 20:48:31,989 - FGO - INFO - test macro f1: 0.9328449328449329
2023-09-02 20:48:31,989 - CV - INFO - fold time: 4.938733100891113s (0.08231221834818522m)
2023-09-02 20:48:31,989 - CV - INFO - ----- BEGINNING FOLD SET (010:2)----------------------------------------------------------
2023-09-02 20:48:31,991 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/010/2
2023-09-02 20:48:31,991 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:31,991 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:31,991 - FGO - INFO - 	done: False
2023-09-02 20:48:31,991 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:48:31,991 - FGO - INFO - 	h1: 64
2023-09-02 20:48:31,991 - FGO - INFO - 	h2: 32
2023-09-02 20:48:31,991 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:31,991 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:31,991 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:31,991 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:31,991 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:48:31,991 - FGO - INFO - 	theta: 10
2023-09-02 20:48:31,991 - FGO - INFO - 	clip: 5
2023-09-02 20:48:31,991 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:31,991 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:31,991 - FGO - INFO - Source Total: 721
2023-09-02 20:48:31,991 - FGO - INFO - Target Total: 83
2023-09-02 20:48:31,991 - FGO - INFO - Train Total: 721
2023-09-02 20:48:31,991 - FGO - INFO - Val Total:   83
2023-09-02 20:48:31,991 - FGO - INFO - Test Total:  83
2023-09-02 20:48:31,991 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:31,991 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:31,991 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:31,991 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:31,991 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:31,992 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:31,992 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:31,992 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:31,992 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:31,992 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:31,993 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:31,994 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:32,097 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:32,097 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:32,097 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:32,097 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:32,097 - FGO - INFO - N: 804
2023-09-02 20:48:32,097 - FGO - INFO - N_s: 721
2023-09-02 20:48:32,097 - FGO - INFO - N_t: 83
2023-09-02 20:48:32,101 - CV - INFO - Begin Pretrain
2023-09-02 20:48:32,101 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:32,104 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:48:32,133 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.76 |
2023-09-02 20:48:32,159 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.33 | Val F1: 0.88 |
2023-09-02 20:48:32,183 - FGO - INFO - Epoch  30 | Train Loss: 0.120 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:48:32,208 - FGO - INFO - Epoch  40 | Train Loss: 0.083 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:48:32,240 - FGO - INFO - Epoch  50 | Train Loss: 0.071 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:48:32,267 - FGO - INFO - Epoch  60 | Train Loss: 0.062 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:48:32,291 - FGO - INFO - Epoch  70 | Train Loss: 0.059 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:48:32,315 - FGO - INFO - Epoch  80 | Train Loss: 0.055 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:48:32,340 - FGO - INFO - Epoch  90 | Train Loss: 0.053 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:48:32,364 - FGO - INFO - Epoch 100 | Train Loss: 0.051 | Val Loss: 0.26 | Val F1: 0.91 |
2023-09-02 20:48:32,364 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.063 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:48:32,364 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:32,366 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:48:32,366 - CV - INFO - Begin OT Train
2023-09-02 20:48:32,366 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:32,520 - FGO - INFO - Epoch   0 | Train Loss: -0.394 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:48:33,613 - FGO - INFO - Epoch  10 | Train Loss: -0.590 | Val Loss: 0.58 | Val F1: 0.85 |
2023-09-02 20:48:34,503 - FGO - INFO - Epoch  20 | Train Loss: -0.708 | Val Loss: 0.26 | Val F1: 0.93 |
2023-09-02 20:48:35,409 - FGO - INFO - Epoch  30 | Train Loss: -0.746 | Val Loss: 0.17 | Val F1: 0.91 |
2023-09-02 20:48:36,251 - FGO - INFO - Epoch  40 | Train Loss: -0.786 | Val Loss: 0.19 | Val F1: 0.91 |
2023-09-02 20:48:36,955 - FGO - INFO - Best Epoch:  16 | Train Loss: -0.676 | Val Loss: 0.34 | Val F1: 0.93 |
2023-09-02 20:48:36,955 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:36,958 - CV - INFO - OT Train Complete, 16 epochs
2023-09-02 20:48:36,959 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:36,986 - FGO - INFO - Train CM:
[[379   5]
 [  8 329]]
2023-09-02 20:48:36,986 - FGO - INFO - Val CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:48:36,986 - FGO - INFO - Test CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:48:36,991 - FGO - INFO - test statistical parity: 0.10563380281690143
2023-09-02 20:48:36,992 - FGO - INFO - test equal opportunity: 0.09259259259259256
2023-09-02 20:48:36,993 - FGO - INFO - test micro f1: 0.9156626506024096
2023-09-02 20:48:36,994 - FGO - INFO - test macro f1: 0.9124076586763153
2023-09-02 20:48:36,994 - CV - INFO - fold time: 5.004672288894653s (0.08341120481491089m)
2023-09-02 20:48:36,994 - CV - INFO - ----- BEGINNING FOLD SET (010:3)----------------------------------------------------------
2023-09-02 20:48:36,996 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/010/3
2023-09-02 20:48:36,996 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:36,996 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:36,996 - FGO - INFO - 	done: False
2023-09-02 20:48:36,996 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:48:36,996 - FGO - INFO - 	h1: 64
2023-09-02 20:48:36,996 - FGO - INFO - 	h2: 32
2023-09-02 20:48:36,996 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:36,996 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:36,996 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:36,996 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:36,996 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:48:36,996 - FGO - INFO - 	theta: 10
2023-09-02 20:48:36,996 - FGO - INFO - 	clip: 5
2023-09-02 20:48:36,996 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:36,996 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:36,996 - FGO - INFO - Source Total: 729
2023-09-02 20:48:36,996 - FGO - INFO - Target Total: 75
2023-09-02 20:48:36,996 - FGO - INFO - Train Total: 729
2023-09-02 20:48:36,996 - FGO - INFO - Val Total:   75
2023-09-02 20:48:36,996 - FGO - INFO - Test Total:  75
2023-09-02 20:48:36,996 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:36,996 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:36,996 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:36,996 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:36,996 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:36,997 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:36,997 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:36,997 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:36,997 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:36,997 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:36,998 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:36,999 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:37,092 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:37,092 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:37,092 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:37,092 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:37,092 - FGO - INFO - N: 804
2023-09-02 20:48:37,092 - FGO - INFO - N_s: 729
2023-09-02 20:48:37,093 - FGO - INFO - N_t: 75
2023-09-02 20:48:37,096 - CV - INFO - Begin Pretrain
2023-09-02 20:48:37,096 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:37,099 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:48:37,124 - FGO - INFO - Epoch  10 | Train Loss: 0.580 | Val Loss: 0.56 | Val F1: 0.75 |
2023-09-02 20:48:37,149 - FGO - INFO - Epoch  20 | Train Loss: 0.266 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:48:37,174 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.07 | Val F1: 0.99 |
2023-09-02 20:48:37,198 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:48:37,223 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:48:37,247 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:48:37,272 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:48:37,296 - FGO - INFO - Epoch  80 | Train Loss: 0.076 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:48:37,321 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:48:37,345 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:48:37,345 - FGO - INFO - Best Epoch:  24 | Train Loss: 0.189 | Val Loss: 0.10 | Val F1: 1.00 
2023-09-02 20:48:37,345 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:37,346 - CV - INFO - Pretrain Complete, 24 epochs
2023-09-02 20:48:37,347 - CV - INFO - Begin OT Train
2023-09-02 20:48:37,347 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:37,457 - FGO - INFO - Epoch   0 | Train Loss: -0.321 | Val Loss: -0.02 | Val F1: 0.97 |
2023-09-02 20:48:38,390 - FGO - INFO - Epoch  10 | Train Loss: -0.651 | Val Loss: 0.00 | Val F1: 0.97 |
2023-09-02 20:48:39,316 - FGO - INFO - Epoch  20 | Train Loss: -0.717 | Val Loss: -0.03 | Val F1: 0.97 |
2023-09-02 20:48:40,128 - FGO - INFO - Epoch  30 | Train Loss: -0.751 | Val Loss: -0.02 | Val F1: 0.97 |
2023-09-02 20:48:41,056 - FGO - INFO - Epoch  40 | Train Loss: -0.773 | Val Loss: -0.03 | Val F1: 0.96 |
2023-09-02 20:48:41,842 - FGO - INFO - Best Epoch:  27 | Train Loss: -0.745 | Val Loss: -0.03 | Val F1: 0.99 |
2023-09-02 20:48:41,842 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:41,850 - CV - INFO - OT Train Complete, 27 epochs
2023-09-02 20:48:41,850 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:41,882 - FGO - INFO - Train CM:
[[389   7]
 [ 15 318]]
2023-09-02 20:48:41,882 - FGO - INFO - Val CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:48:41,883 - FGO - INFO - Test CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:48:41,887 - FGO - INFO - test statistical parity: 0.046838407494145196
2023-09-02 20:48:41,888 - FGO - INFO - test equal opportunity: 0.10952380952380958
2023-09-02 20:48:41,889 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 20:48:41,890 - FGO - INFO - test macro f1: 0.9732905982905983
2023-09-02 20:48:41,890 - CV - INFO - fold time: 4.8958516120910645s (0.0815975268681844m)
2023-09-02 20:48:41,890 - CV - INFO - ----- BEGINNING FOLD SET (010:4)----------------------------------------------------------
2023-09-02 20:48:41,891 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/010/4
2023-09-02 20:48:41,892 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:41,892 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:41,892 - FGO - INFO - 	done: False
2023-09-02 20:48:41,892 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:48:41,892 - FGO - INFO - 	h1: 64
2023-09-02 20:48:41,892 - FGO - INFO - 	h2: 32
2023-09-02 20:48:41,892 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:41,892 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:41,892 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:41,892 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:41,892 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:48:41,892 - FGO - INFO - 	theta: 10
2023-09-02 20:48:41,892 - FGO - INFO - 	clip: 5
2023-09-02 20:48:41,892 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:41,892 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:41,892 - FGO - INFO - Source Total: 732
2023-09-02 20:48:41,892 - FGO - INFO - Target Total: 72
2023-09-02 20:48:41,892 - FGO - INFO - Train Total: 732
2023-09-02 20:48:41,892 - FGO - INFO - Val Total:   72
2023-09-02 20:48:41,892 - FGO - INFO - Test Total:  72
2023-09-02 20:48:41,892 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:41,892 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:41,892 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:41,892 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:41,892 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:41,892 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:41,893 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:41,893 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:41,893 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:41,893 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:41,894 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:41,895 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:41,985 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:41,985 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:41,986 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:41,986 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:41,986 - FGO - INFO - N: 804
2023-09-02 20:48:41,986 - FGO - INFO - N_s: 732
2023-09-02 20:48:41,986 - FGO - INFO - N_t: 72
2023-09-02 20:48:41,989 - CV - INFO - Begin Pretrain
2023-09-02 20:48:41,989 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:41,992 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:48:42,017 - FGO - INFO - Epoch  10 | Train Loss: 0.578 | Val Loss: 0.58 | Val F1: 0.78 |
2023-09-02 20:48:42,042 - FGO - INFO - Epoch  20 | Train Loss: 0.258 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:48:42,067 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:48:42,091 - FGO - INFO - Epoch  40 | Train Loss: 0.095 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:48:42,116 - FGO - INFO - Epoch  50 | Train Loss: 0.084 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:48:42,140 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:48:42,165 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:48:42,189 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:48:42,214 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:48:42,238 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:48:42,238 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.99 
2023-09-02 20:48:42,238 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:42,240 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:48:42,240 - CV - INFO - Begin OT Train
2023-09-02 20:48:42,240 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:42,365 - FGO - INFO - Epoch   0 | Train Loss: -0.615 | Val Loss: -0.01 | Val F1: 0.99 |
2023-09-02 20:48:43,414 - FGO - INFO - Epoch  10 | Train Loss: -0.655 | Val Loss: 0.02 | Val F1: 0.97 |
2023-09-02 20:48:44,326 - FGO - INFO - Epoch  20 | Train Loss: -0.722 | Val Loss: -0.00 | Val F1: 0.99 |
2023-09-02 20:48:45,232 - FGO - INFO - Epoch  30 | Train Loss: -0.748 | Val Loss: -0.02 | Val F1: 0.99 |
2023-09-02 20:48:46,034 - FGO - INFO - Epoch  40 | Train Loss: -0.770 | Val Loss: -0.01 | Val F1: 0.99 |
2023-09-02 20:48:46,790 - FGO - INFO - Best Epoch:   6 | Train Loss: -0.649 | Val Loss: 0.01 | Val F1: 0.99 |
2023-09-02 20:48:46,791 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:46,794 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:48:46,794 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:46,821 - FGO - INFO - Train CM:
[[388   9]
 [ 11 324]]
2023-09-02 20:48:46,822 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:48:46,822 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:48:46,827 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:48:46,828 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:48:46,829 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:48:46,829 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:48:46,830 - CV - INFO - fold time: 4.939692735671997s (0.08232821226119995m)
2023-09-02 20:48:46,830 - CV - INFO - ----- BEGINNING FOLD SET (010:5)----------------------------------------------------------
2023-09-02 20:48:46,831 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/010/5
2023-09-02 20:48:46,831 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:46,831 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:46,831 - FGO - INFO - 	done: False
2023-09-02 20:48:46,831 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:48:46,831 - FGO - INFO - 	h1: 64
2023-09-02 20:48:46,831 - FGO - INFO - 	h2: 32
2023-09-02 20:48:46,831 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:46,831 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:46,831 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:46,831 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:46,831 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:48:46,831 - FGO - INFO - 	theta: 10
2023-09-02 20:48:46,831 - FGO - INFO - 	clip: 5
2023-09-02 20:48:46,831 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:46,831 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:46,831 - FGO - INFO - Source Total: 726
2023-09-02 20:48:46,831 - FGO - INFO - Target Total: 78
2023-09-02 20:48:46,832 - FGO - INFO - Train Total: 726
2023-09-02 20:48:46,832 - FGO - INFO - Val Total:   78
2023-09-02 20:48:46,832 - FGO - INFO - Test Total:  78
2023-09-02 20:48:46,832 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:46,832 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:46,832 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:46,832 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:46,832 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:46,832 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:46,832 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:46,832 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:46,832 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:46,832 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:46,833 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:46,834 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:46,932 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:46,932 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:46,932 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:46,932 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:46,932 - FGO - INFO - N: 804
2023-09-02 20:48:46,932 - FGO - INFO - N_s: 726
2023-09-02 20:48:46,932 - FGO - INFO - N_t: 78
2023-09-02 20:48:46,936 - CV - INFO - Begin Pretrain
2023-09-02 20:48:46,936 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:46,939 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:48:46,964 - FGO - INFO - Epoch  10 | Train Loss: 0.582 | Val Loss: 0.61 | Val F1: 0.72 |
2023-09-02 20:48:46,988 - FGO - INFO - Epoch  20 | Train Loss: 0.268 | Val Loss: 0.31 | Val F1: 0.87 |
2023-09-02 20:48:47,013 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.25 | Val F1: 0.92 |
2023-09-02 20:48:47,037 - FGO - INFO - Epoch  40 | Train Loss: 0.100 | Val Loss: 0.22 | Val F1: 0.92 |
2023-09-02 20:48:47,062 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:48:47,086 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:48:47,110 - FGO - INFO - Epoch  70 | Train Loss: 0.072 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:48:47,135 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.08 | Val F1: 0.96 |
2023-09-02 20:48:47,159 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:48:47,183 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:48:47,184 - FGO - INFO - Best Epoch:  77 | Train Loss: 0.070 | Val Loss: 0.10 | Val F1: 0.96 
2023-09-02 20:48:47,184 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:47,185 - CV - INFO - Pretrain Complete, 77 epochs
2023-09-02 20:48:47,185 - CV - INFO - Begin OT Train
2023-09-02 20:48:47,185 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:47,290 - FGO - INFO - Epoch   0 | Train Loss: -0.278 | Val Loss: 0.01 | Val F1: 0.96 |
2023-09-02 20:48:48,230 - FGO - INFO - Epoch  10 | Train Loss: -0.598 | Val Loss: 0.33 | Val F1: 0.90 |
2023-09-02 20:48:49,120 - FGO - INFO - Epoch  20 | Train Loss: -0.700 | Val Loss: 0.09 | Val F1: 0.94 |
2023-09-02 20:48:49,921 - FGO - INFO - Epoch  30 | Train Loss: -0.742 | Val Loss: 0.08 | Val F1: 0.94 |
2023-09-02 20:48:50,765 - FGO - INFO - Epoch  40 | Train Loss: -0.766 | Val Loss: 0.11 | Val F1: 0.92 |
2023-09-02 20:48:51,537 - FGO - INFO - Best Epoch:   7 | Train Loss: -0.617 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:48:51,537 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:51,540 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:48:51,541 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:51,568 - FGO - INFO - Train CM:
[[394   6]
 [ 12 314]]
2023-09-02 20:48:51,568 - FGO - INFO - Val CM:
[[34  0]
 [ 5 39]]
2023-09-02 20:48:51,568 - FGO - INFO - Test CM:
[[34  0]
 [ 5 39]]
2023-09-02 20:48:51,573 - FGO - INFO - test statistical parity: 0.06280193236714976
2023-09-02 20:48:51,575 - FGO - INFO - test equal opportunity: 0.1282051282051282
2023-09-02 20:48:51,576 - FGO - INFO - test micro f1: 0.9358974358974359
2023-09-02 20:48:51,576 - FGO - INFO - test macro f1: 0.9356329427298234
2023-09-02 20:48:51,576 - CV - INFO - fold time: 4.746479272842407s (0.07910798788070679m)
2023-09-02 20:48:51,576 - CV - INFO - ----- BEGINNING FOLD SET (010:6)----------------------------------------------------------
2023-09-02 20:48:51,578 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/010/6
2023-09-02 20:48:51,578 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:51,578 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:51,578 - FGO - INFO - 	done: False
2023-09-02 20:48:51,578 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:48:51,578 - FGO - INFO - 	h1: 64
2023-09-02 20:48:51,578 - FGO - INFO - 	h2: 32
2023-09-02 20:48:51,578 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:51,578 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:51,578 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:51,578 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:51,578 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:48:51,578 - FGO - INFO - 	theta: 10
2023-09-02 20:48:51,578 - FGO - INFO - 	clip: 5
2023-09-02 20:48:51,578 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:51,578 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:51,578 - FGO - INFO - Source Total: 717
2023-09-02 20:48:51,578 - FGO - INFO - Target Total: 87
2023-09-02 20:48:51,578 - FGO - INFO - Train Total: 717
2023-09-02 20:48:51,578 - FGO - INFO - Val Total:   87
2023-09-02 20:48:51,578 - FGO - INFO - Test Total:  87
2023-09-02 20:48:51,578 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:51,578 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:51,578 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:51,578 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:51,578 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:51,579 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:51,579 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:51,579 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:51,579 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:51,579 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:51,580 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:51,581 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:51,687 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:51,688 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:51,688 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:51,688 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:51,688 - FGO - INFO - N: 804
2023-09-02 20:48:51,688 - FGO - INFO - N_s: 717
2023-09-02 20:48:51,688 - FGO - INFO - N_t: 87
2023-09-02 20:48:51,691 - CV - INFO - Begin Pretrain
2023-09-02 20:48:51,691 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:51,694 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:48:51,719 - FGO - INFO - Epoch  10 | Train Loss: 0.585 | Val Loss: 0.57 | Val F1: 0.75 |
2023-09-02 20:48:51,743 - FGO - INFO - Epoch  20 | Train Loss: 0.271 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:48:51,768 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:48:51,792 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:48:51,817 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:48:51,841 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:48:51,865 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:48:51,889 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:48:51,914 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:48:51,938 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:48:51,938 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.107 | Val Loss: 0.08 | Val F1: 0.99 
2023-09-02 20:48:51,938 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:51,939 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:48:51,939 - CV - INFO - Begin OT Train
2023-09-02 20:48:51,939 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:52,050 - FGO - INFO - Epoch   0 | Train Loss: -0.598 | Val Loss: -0.04 | Val F1: 0.99 |
2023-09-02 20:48:52,959 - FGO - INFO - Epoch  10 | Train Loss: -0.499 | Val Loss: 0.26 | Val F1: 0.87 |
2023-09-02 20:48:53,843 - FGO - INFO - Epoch  20 | Train Loss: -0.669 | Val Loss: 0.04 | Val F1: 0.93 |
2023-09-02 20:48:54,809 - FGO - INFO - Epoch  30 | Train Loss: -0.726 | Val Loss: -0.03 | Val F1: 0.97 |
2023-09-02 20:48:55,732 - FGO - INFO - Epoch  40 | Train Loss: -0.744 | Val Loss: -0.04 | Val F1: 0.98 |
2023-09-02 20:48:56,520 - FGO - INFO - Best Epoch:  22 | Train Loss: -0.702 | Val Loss: -0.06 | Val F1: 1.00 |
2023-09-02 20:48:56,520 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:56,525 - CV - INFO - OT Train Complete, 22 epochs
2023-09-02 20:48:56,525 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:48:56,557 - FGO - INFO - Train CM:
[[376   9]
 [ 13 319]]
2023-09-02 20:48:56,557 - FGO - INFO - Val CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:48:56,557 - FGO - INFO - Test CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:48:56,562 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 20:48:56,563 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:48:56,564 - FGO - INFO - test micro f1: 0.9885057471264368
2023-09-02 20:48:56,564 - FGO - INFO - test macro f1: 0.9883518543312357
2023-09-02 20:48:56,565 - CV - INFO - fold time: 4.98849081993103s (0.08314151366551717m)
2023-09-02 20:48:56,565 - CV - INFO - ----- BEGINNING FOLD SET (010:7)----------------------------------------------------------
2023-09-02 20:48:56,566 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/010/7
2023-09-02 20:48:56,566 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:48:56,566 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:48:56,566 - FGO - INFO - 	done: False
2023-09-02 20:48:56,566 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:48:56,566 - FGO - INFO - 	h1: 64
2023-09-02 20:48:56,566 - FGO - INFO - 	h2: 32
2023-09-02 20:48:56,566 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:48:56,566 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:48:56,566 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:48:56,566 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:48:56,566 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:48:56,566 - FGO - INFO - 	theta: 10
2023-09-02 20:48:56,566 - FGO - INFO - 	clip: 5
2023-09-02 20:48:56,566 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:48:56,567 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:48:56,567 - FGO - INFO - Source Total: 717
2023-09-02 20:48:56,567 - FGO - INFO - Target Total: 87
2023-09-02 20:48:56,567 - FGO - INFO - Train Total: 717
2023-09-02 20:48:56,567 - FGO - INFO - Val Total:   87
2023-09-02 20:48:56,567 - FGO - INFO - Test Total:  87
2023-09-02 20:48:56,567 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:48:56,567 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:48:56,567 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:48:56,567 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:48:56,567 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:48:56,567 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:48:56,567 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:48:56,567 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:48:56,567 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:48:56,567 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:48:56,568 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:48:56,569 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:48:56,675 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:48:56,675 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:48:56,675 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:48:56,675 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:48:56,675 - FGO - INFO - N: 804
2023-09-02 20:48:56,675 - FGO - INFO - N_s: 717
2023-09-02 20:48:56,675 - FGO - INFO - N_t: 87
2023-09-02 20:48:56,679 - CV - INFO - Begin Pretrain
2023-09-02 20:48:56,679 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:48:56,682 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:48:56,707 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.72 |
2023-09-02 20:48:56,731 - FGO - INFO - Epoch  20 | Train Loss: 0.265 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:48:56,756 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:48:56,780 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:48:56,805 - FGO - INFO - Epoch  50 | Train Loss: 0.086 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:48:56,829 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:48:56,854 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:48:56,878 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:48:56,903 - FGO - INFO - Epoch  90 | Train Loss: 0.070 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:48:56,927 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:48:56,927 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.169 | Val Loss: 0.14 | Val F1: 0.98 
2023-09-02 20:48:56,927 - FGO - INFO - Setting model to best state.
2023-09-02 20:48:56,929 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:48:56,929 - CV - INFO - Begin OT Train
2023-09-02 20:48:56,929 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:48:57,028 - FGO - INFO - Epoch   0 | Train Loss: -0.593 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 20:48:58,077 - FGO - INFO - Epoch  10 | Train Loss: -0.629 | Val Loss: 0.13 | Val F1: 0.94 |
2023-09-02 20:48:59,121 - FGO - INFO - Epoch  20 | Train Loss: -0.707 | Val Loss: 0.09 | Val F1: 0.95 |
2023-09-02 20:49:00,004 - FGO - INFO - Epoch  30 | Train Loss: -0.731 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:49:00,907 - FGO - INFO - Epoch  40 | Train Loss: -0.757 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:49:01,631 - FGO - INFO - Best Epoch:  16 | Train Loss: -0.687 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 20:49:01,631 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:01,634 - CV - INFO - OT Train Complete, 16 epochs
2023-09-02 20:49:01,635 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:01,662 - FGO - INFO - Train CM:
[[378   9]
 [ 12 318]]
2023-09-02 20:49:01,663 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:49:01,663 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:49:01,668 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:49:01,669 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:49:01,670 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:49:01,670 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:49:01,670 - CV - INFO - fold time: 5.1057116985321045s (0.08509519497553507m)
2023-09-02 20:49:01,670 - CV - INFO - ----- BEGINNING FOLD SET (010:8)----------------------------------------------------------
2023-09-02 20:49:01,672 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/010/8
2023-09-02 20:49:01,672 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:01,672 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:01,672 - FGO - INFO - 	done: False
2023-09-02 20:49:01,672 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:01,672 - FGO - INFO - 	h1: 64
2023-09-02 20:49:01,672 - FGO - INFO - 	h2: 32
2023-09-02 20:49:01,672 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:01,672 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:01,672 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:01,672 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:01,672 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:01,672 - FGO - INFO - 	theta: 10
2023-09-02 20:49:01,672 - FGO - INFO - 	clip: 5
2023-09-02 20:49:01,672 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:01,672 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:01,672 - FGO - INFO - Source Total: 734
2023-09-02 20:49:01,672 - FGO - INFO - Target Total: 70
2023-09-02 20:49:01,672 - FGO - INFO - Train Total: 734
2023-09-02 20:49:01,672 - FGO - INFO - Val Total:   70
2023-09-02 20:49:01,672 - FGO - INFO - Test Total:  70
2023-09-02 20:49:01,672 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:01,672 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:01,672 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:01,672 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:01,672 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:01,673 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:01,673 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:01,673 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:01,673 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:01,673 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:01,674 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:01,675 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:01,763 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:01,764 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:01,764 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:01,764 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:01,764 - FGO - INFO - N: 804
2023-09-02 20:49:01,764 - FGO - INFO - N_s: 734
2023-09-02 20:49:01,764 - FGO - INFO - N_t: 70
2023-09-02 20:49:01,767 - CV - INFO - Begin Pretrain
2023-09-02 20:49:01,767 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:01,771 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:49:01,796 - FGO - INFO - Epoch  10 | Train Loss: 0.564 | Val Loss: 0.59 | Val F1: 0.75 |
2023-09-02 20:49:01,820 - FGO - INFO - Epoch  20 | Train Loss: 0.257 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:49:01,845 - FGO - INFO - Epoch  30 | Train Loss: 0.132 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:49:01,870 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.13 | Val F1: 0.94 |
2023-09-02 20:49:01,894 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:49:01,919 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:49:01,944 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:49:01,968 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:49:01,993 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.16 | Val F1: 0.93 |
2023-09-02 20:49:02,017 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:49:02,017 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.108 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:49:02,017 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:02,019 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:49:02,019 - CV - INFO - Begin OT Train
2023-09-02 20:49:02,019 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:02,105 - FGO - INFO - Epoch   0 | Train Loss: -0.500 | Val Loss: 0.11 | Val F1: 0.93 |
2023-09-02 20:49:03,133 - FGO - INFO - Epoch  10 | Train Loss: -0.604 | Val Loss: 0.31 | Val F1: 0.93 |
2023-09-02 20:49:03,992 - FGO - INFO - Epoch  20 | Train Loss: -0.712 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:49:04,961 - FGO - INFO - Epoch  30 | Train Loss: -0.748 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:49:05,776 - FGO - INFO - Epoch  40 | Train Loss: -0.771 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:49:06,498 - FGO - INFO - Best Epoch:  12 | Train Loss: -0.665 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:49:06,498 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:06,502 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:49:06,502 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:06,529 - FGO - INFO - Train CM:
[[392   8]
 [ 10 324]]
2023-09-02 20:49:06,530 - FGO - INFO - Val CM:
[[33  1]
 [ 3 33]]
2023-09-02 20:49:06,530 - FGO - INFO - Test CM:
[[33  1]
 [ 3 33]]
2023-09-02 20:49:06,535 - FGO - INFO - test statistical parity: 0.1241565452091768
2023-09-02 20:49:06,536 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:49:06,537 - FGO - INFO - test micro f1: 0.9428571428571428
2023-09-02 20:49:06,537 - FGO - INFO - test macro f1: 0.9428571428571428
2023-09-02 20:49:06,537 - CV - INFO - fold time: 4.867120742797852s (0.08111867904663086m)
2023-09-02 20:49:06,537 - CV - INFO - ----- BEGINNING FOLD SET (010:9)----------------------------------------------------------
2023-09-02 20:49:06,539 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/010/9
2023-09-02 20:49:06,539 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:06,539 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:06,539 - FGO - INFO - 	done: False
2023-09-02 20:49:06,539 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:06,539 - FGO - INFO - 	h1: 64
2023-09-02 20:49:06,539 - FGO - INFO - 	h2: 32
2023-09-02 20:49:06,539 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:06,539 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:06,539 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:06,539 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:06,539 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:06,539 - FGO - INFO - 	theta: 10
2023-09-02 20:49:06,539 - FGO - INFO - 	clip: 5
2023-09-02 20:49:06,539 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:06,539 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:06,539 - FGO - INFO - Source Total: 725
2023-09-02 20:49:06,539 - FGO - INFO - Target Total: 79
2023-09-02 20:49:06,540 - FGO - INFO - Train Total: 725
2023-09-02 20:49:06,540 - FGO - INFO - Val Total:   79
2023-09-02 20:49:06,540 - FGO - INFO - Test Total:  79
2023-09-02 20:49:06,540 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:06,540 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:06,540 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:06,540 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:06,540 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:06,540 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:06,540 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:06,540 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:06,540 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:06,540 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:06,541 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:06,542 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:06,641 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:06,641 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:06,641 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:06,641 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:06,641 - FGO - INFO - N: 804
2023-09-02 20:49:06,641 - FGO - INFO - N_s: 725
2023-09-02 20:49:06,641 - FGO - INFO - N_t: 79
2023-09-02 20:49:06,645 - CV - INFO - Begin Pretrain
2023-09-02 20:49:06,645 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:06,648 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:49:06,673 - FGO - INFO - Epoch  10 | Train Loss: 0.579 | Val Loss: 0.59 | Val F1: 0.74 |
2023-09-02 20:49:06,697 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.30 | Val F1: 0.91 |
2023-09-02 20:49:06,722 - FGO - INFO - Epoch  30 | Train Loss: 0.128 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:49:06,746 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:49:06,771 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:49:06,795 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:49:06,820 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:49:06,844 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:49:06,868 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:49:06,893 - FGO - INFO - Epoch 100 | Train Loss: 0.065 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:49:06,893 - FGO - INFO - Best Epoch:  51 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.99 
2023-09-02 20:49:06,893 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:06,894 - CV - INFO - Pretrain Complete, 51 epochs
2023-09-02 20:49:06,894 - CV - INFO - Begin OT Train
2023-09-02 20:49:06,894 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:07,013 - FGO - INFO - Epoch   0 | Train Loss: -0.521 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:49:07,933 - FGO - INFO - Epoch  10 | Train Loss: -0.591 | Val Loss: 0.33 | Val F1: 0.86 |
2023-09-02 20:49:08,905 - FGO - INFO - Epoch  20 | Train Loss: -0.690 | Val Loss: 0.06 | Val F1: 0.95 |
2023-09-02 20:49:09,786 - FGO - INFO - Epoch  30 | Train Loss: -0.731 | Val Loss: 0.03 | Val F1: 0.97 |
2023-09-02 20:49:10,623 - FGO - INFO - Epoch  40 | Train Loss: -0.759 | Val Loss: 0.07 | Val F1: 0.93 |
2023-09-02 20:49:11,372 - FGO - INFO - Best Epoch:  21 | Train Loss: -0.690 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:49:11,372 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:11,375 - CV - INFO - OT Train Complete, 21 epochs
2023-09-02 20:49:11,376 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:11,402 - FGO - INFO - Train CM:
[[378   7]
 [ 15 325]]
2023-09-02 20:49:11,402 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:49:11,402 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:49:11,407 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:49:11,408 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:49:11,409 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:49:11,410 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:49:11,410 - CV - INFO - fold time: 4.8721137046813965s (0.08120189507802328m)
2023-09-02 20:49:11,410 - CV - INFO - Mean Pretrain Epochs 45.5:
2023-09-02 20:49:11,410 - CV - INFO - Mean OT Train Epochs 17.4:
2023-09-02 20:49:11,410 - CV - INFO - Mean Val Macro F1 : 0.9589087702629799
2023-09-02 20:49:11,410 - CV - INFO - Mean Eval Stat : 0.9589087702629799 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:49:11,410 - CV - INFO - NEW BEST SET! (0.9589087702629799)
2023-09-02 20:49:11,410 - CV - INFO - set time: 49.41657853126526s (0.8236096421877543m)
2023-09-02 20:49:11,410 - CV - INFO - script time so far: 449.3608305454254s (7.48934717575709m) (0.12482245292928483h)
2023-09-02 20:49:11,410 - CV - INFO - ===== BEGINNING OPTION SET (011)==========================================================
2023-09-02 20:49:11,410 - CV - INFO - 	done: False
2023-09-02 20:49:11,410 - CV - INFO - 	learning_rate: 0.005
2023-09-02 20:49:11,410 - CV - INFO - 	h1: 64
2023-09-02 20:49:11,410 - CV - INFO - 	h2: 32
2023-09-02 20:49:11,410 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:11,410 - CV - INFO - 	dropout: 0.0
2023-09-02 20:49:11,410 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:11,410 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:11,410 - CV - INFO - 	lambda: 0.01
2023-09-02 20:49:11,410 - CV - INFO - 	theta: 30
2023-09-02 20:49:11,410 - CV - INFO - 	clip: 5
2023-09-02 20:49:11,410 - CV - INFO - ----- BEGINNING FOLD SET (011:0)----------------------------------------------------------
2023-09-02 20:49:11,411 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/011/0
2023-09-02 20:49:11,412 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:11,412 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:11,412 - FGO - INFO - 	done: False
2023-09-02 20:49:11,412 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:11,412 - FGO - INFO - 	h1: 64
2023-09-02 20:49:11,412 - FGO - INFO - 	h2: 32
2023-09-02 20:49:11,412 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:11,412 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:11,412 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:11,412 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:11,412 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:11,412 - FGO - INFO - 	theta: 30
2023-09-02 20:49:11,412 - FGO - INFO - 	clip: 5
2023-09-02 20:49:11,412 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:11,412 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:11,412 - FGO - INFO - Source Total: 708
2023-09-02 20:49:11,412 - FGO - INFO - Target Total: 96
2023-09-02 20:49:11,412 - FGO - INFO - Train Total: 708
2023-09-02 20:49:11,412 - FGO - INFO - Val Total:   96
2023-09-02 20:49:11,412 - FGO - INFO - Test Total:  96
2023-09-02 20:49:11,412 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:11,412 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:11,412 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:11,412 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:11,412 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:11,413 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:11,413 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:11,413 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:11,413 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:11,413 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:11,414 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:11,415 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:11,530 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:11,530 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:11,530 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:11,530 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:11,530 - FGO - INFO - N: 804
2023-09-02 20:49:11,530 - FGO - INFO - N_s: 708
2023-09-02 20:49:11,530 - FGO - INFO - N_t: 96
2023-09-02 20:49:11,533 - CV - INFO - Begin Pretrain
2023-09-02 20:49:11,533 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:11,536 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:49:11,561 - FGO - INFO - Epoch  10 | Train Loss: 0.572 | Val Loss: 0.59 | Val F1: 0.62 |
2023-09-02 20:49:11,585 - FGO - INFO - Epoch  20 | Train Loss: 0.245 | Val Loss: 0.25 | Val F1: 0.93 |
2023-09-02 20:49:11,610 - FGO - INFO - Epoch  30 | Train Loss: 0.127 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:49:11,634 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:49:11,658 - FGO - INFO - Epoch  50 | Train Loss: 0.083 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:49:11,682 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:49:11,706 - FGO - INFO - Epoch  70 | Train Loss: 0.067 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:49:11,730 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:49:11,754 - FGO - INFO - Epoch  90 | Train Loss: 0.060 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:49:11,779 - FGO - INFO - Epoch 100 | Train Loss: 0.058 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:49:11,779 - FGO - INFO - Best Epoch:  39 | Train Loss: 0.095 | Val Loss: 0.10 | Val F1: 0.98 
2023-09-02 20:49:11,779 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:11,780 - CV - INFO - Pretrain Complete, 39 epochs
2023-09-02 20:49:11,780 - CV - INFO - Begin OT Train
2023-09-02 20:49:11,780 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:11,893 - FGO - INFO - Epoch   0 | Train Loss: -1.878 | Val Loss: -0.15 | Val F1: 0.97 |
2023-09-02 20:49:12,823 - FGO - INFO - Epoch  10 | Train Loss: -2.145 | Val Loss: -0.19 | Val F1: 0.95 |
2023-09-02 20:49:13,713 - FGO - INFO - Epoch  20 | Train Loss: -2.380 | Val Loss: -0.21 | Val F1: 0.96 |
2023-09-02 20:49:14,500 - FGO - INFO - Epoch  30 | Train Loss: -2.469 | Val Loss: -0.22 | Val F1: 0.96 |
2023-09-02 20:49:15,326 - FGO - INFO - Epoch  40 | Train Loss: -2.528 | Val Loss: -0.27 | Val F1: 0.98 |
2023-09-02 20:49:16,040 - FGO - INFO - Best Epoch:  38 | Train Loss: -2.519 | Val Loss: -0.25 | Val F1: 0.98 |
2023-09-02 20:49:16,040 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:16,043 - CV - INFO - OT Train Complete, 38 epochs
2023-09-02 20:49:16,043 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:16,069 - FGO - INFO - Train CM:
[[373   9]
 [ 10 316]]
2023-09-02 20:49:16,070 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:49:16,070 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:49:16,075 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:49:16,076 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:49:16,077 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:49:16,078 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:49:16,078 - CV - INFO - fold time: 4.667994976043701s (0.07779991626739502m)
2023-09-02 20:49:16,078 - CV - INFO - ----- BEGINNING FOLD SET (011:1)----------------------------------------------------------
2023-09-02 20:49:16,079 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/011/1
2023-09-02 20:49:16,080 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:16,080 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:16,080 - FGO - INFO - 	done: False
2023-09-02 20:49:16,080 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:16,080 - FGO - INFO - 	h1: 64
2023-09-02 20:49:16,080 - FGO - INFO - 	h2: 32
2023-09-02 20:49:16,080 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:16,080 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:16,080 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:16,080 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:16,080 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:16,080 - FGO - INFO - 	theta: 30
2023-09-02 20:49:16,080 - FGO - INFO - 	clip: 5
2023-09-02 20:49:16,080 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:16,080 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:16,080 - FGO - INFO - Source Total: 727
2023-09-02 20:49:16,080 - FGO - INFO - Target Total: 77
2023-09-02 20:49:16,080 - FGO - INFO - Train Total: 727
2023-09-02 20:49:16,080 - FGO - INFO - Val Total:   77
2023-09-02 20:49:16,080 - FGO - INFO - Test Total:  77
2023-09-02 20:49:16,080 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:16,080 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:16,080 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:16,080 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:16,080 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:16,081 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:16,081 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:16,081 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:16,081 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:16,081 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:16,082 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:16,083 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:16,178 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:16,178 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:16,178 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:16,178 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:16,178 - FGO - INFO - N: 804
2023-09-02 20:49:16,178 - FGO - INFO - N_s: 727
2023-09-02 20:49:16,178 - FGO - INFO - N_t: 77
2023-09-02 20:49:16,182 - CV - INFO - Begin Pretrain
2023-09-02 20:49:16,182 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:16,185 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:49:16,210 - FGO - INFO - Epoch  10 | Train Loss: 0.577 | Val Loss: 0.61 | Val F1: 0.66 |
2023-09-02 20:49:16,235 - FGO - INFO - Epoch  20 | Train Loss: 0.255 | Val Loss: 0.38 | Val F1: 0.83 |
2023-09-02 20:49:16,260 - FGO - INFO - Epoch  30 | Train Loss: 0.122 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:49:16,284 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.20 | Val F1: 0.89 |
2023-09-02 20:49:16,309 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.87 |
2023-09-02 20:49:16,334 - FGO - INFO - Epoch  60 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.89 |
2023-09-02 20:49:16,358 - FGO - INFO - Epoch  70 | Train Loss: 0.063 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:49:16,383 - FGO - INFO - Epoch  80 | Train Loss: 0.060 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:49:16,407 - FGO - INFO - Epoch  90 | Train Loss: 0.057 | Val Loss: 0.21 | Val F1: 0.90 |
2023-09-02 20:49:16,432 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.20 | Val F1: 0.92 |
2023-09-02 20:49:16,432 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.097 | Val Loss: 0.18 | Val F1: 0.93 
2023-09-02 20:49:16,432 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:16,433 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:49:16,433 - CV - INFO - Begin OT Train
2023-09-02 20:49:16,433 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:16,544 - FGO - INFO - Epoch   0 | Train Loss: -1.686 | Val Loss: 0.04 | Val F1: 0.89 |
2023-09-02 20:49:17,482 - FGO - INFO - Epoch  10 | Train Loss: -2.057 | Val Loss: 0.20 | Val F1: 0.87 |
2023-09-02 20:49:18,375 - FGO - INFO - Epoch  20 | Train Loss: -2.356 | Val Loss: -0.06 | Val F1: 0.93 |
2023-09-02 20:49:19,164 - FGO - INFO - Epoch  30 | Train Loss: -2.478 | Val Loss: -0.01 | Val F1: 0.91 |
2023-09-02 20:49:19,954 - FGO - INFO - Epoch  40 | Train Loss: -2.544 | Val Loss: -0.03 | Val F1: 0.93 |
2023-09-02 20:49:20,670 - FGO - INFO - Best Epoch:  14 | Train Loss: -2.219 | Val Loss: -0.03 | Val F1: 0.93 |
2023-09-02 20:49:20,670 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:20,673 - CV - INFO - OT Train Complete, 14 epochs
2023-09-02 20:49:20,674 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:20,700 - FGO - INFO - Train CM:
[[381   9]
 [  9 328]]
2023-09-02 20:49:20,700 - FGO - INFO - Val CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:49:20,701 - FGO - INFO - Test CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:49:20,705 - FGO - INFO - test statistical parity: 0.36282051282051286
2023-09-02 20:49:20,707 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:49:20,708 - FGO - INFO - test micro f1: 0.935064935064935
2023-09-02 20:49:20,708 - FGO - INFO - test macro f1: 0.9328449328449329
2023-09-02 20:49:20,708 - CV - INFO - fold time: 4.630239725112915s (0.07717066208521525m)
2023-09-02 20:49:20,708 - CV - INFO - ----- BEGINNING FOLD SET (011:2)----------------------------------------------------------
2023-09-02 20:49:20,710 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/011/2
2023-09-02 20:49:20,710 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:20,710 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:20,710 - FGO - INFO - 	done: False
2023-09-02 20:49:20,710 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:20,710 - FGO - INFO - 	h1: 64
2023-09-02 20:49:20,710 - FGO - INFO - 	h2: 32
2023-09-02 20:49:20,710 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:20,710 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:20,710 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:20,710 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:20,710 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:20,710 - FGO - INFO - 	theta: 30
2023-09-02 20:49:20,710 - FGO - INFO - 	clip: 5
2023-09-02 20:49:20,710 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:20,710 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:20,710 - FGO - INFO - Source Total: 721
2023-09-02 20:49:20,710 - FGO - INFO - Target Total: 83
2023-09-02 20:49:20,710 - FGO - INFO - Train Total: 721
2023-09-02 20:49:20,710 - FGO - INFO - Val Total:   83
2023-09-02 20:49:20,710 - FGO - INFO - Test Total:  83
2023-09-02 20:49:20,710 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:20,710 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:20,710 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:20,710 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:20,710 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:20,711 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:20,711 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:20,711 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:20,711 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:20,711 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:20,712 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:20,713 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:20,815 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:20,815 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:20,815 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:20,815 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:20,815 - FGO - INFO - N: 804
2023-09-02 20:49:20,815 - FGO - INFO - N_s: 721
2023-09-02 20:49:20,815 - FGO - INFO - N_t: 83
2023-09-02 20:49:20,819 - CV - INFO - Begin Pretrain
2023-09-02 20:49:20,819 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:20,823 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:49:20,847 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.76 |
2023-09-02 20:49:20,872 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.33 | Val F1: 0.88 |
2023-09-02 20:49:20,896 - FGO - INFO - Epoch  30 | Train Loss: 0.120 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:49:20,921 - FGO - INFO - Epoch  40 | Train Loss: 0.083 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:49:20,945 - FGO - INFO - Epoch  50 | Train Loss: 0.071 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:49:20,970 - FGO - INFO - Epoch  60 | Train Loss: 0.062 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:49:20,994 - FGO - INFO - Epoch  70 | Train Loss: 0.059 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:49:21,019 - FGO - INFO - Epoch  80 | Train Loss: 0.055 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:49:21,043 - FGO - INFO - Epoch  90 | Train Loss: 0.053 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:49:21,067 - FGO - INFO - Epoch 100 | Train Loss: 0.051 | Val Loss: 0.26 | Val F1: 0.91 |
2023-09-02 20:49:21,067 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.063 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:49:21,067 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:21,069 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:49:21,069 - CV - INFO - Begin OT Train
2023-09-02 20:49:21,069 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:21,199 - FGO - INFO - Epoch   0 | Train Loss: -1.693 | Val Loss: 0.05 | Val F1: 0.90 |
2023-09-02 20:49:22,276 - FGO - INFO - Epoch  10 | Train Loss: -2.192 | Val Loss: 0.30 | Val F1: 0.89 |
2023-09-02 20:49:23,195 - FGO - INFO - Epoch  20 | Train Loss: -2.425 | Val Loss: -0.03 | Val F1: 0.90 |
2023-09-02 20:49:23,987 - FGO - INFO - Epoch  30 | Train Loss: -2.534 | Val Loss: 0.03 | Val F1: 0.90 |
2023-09-02 20:49:24,776 - FGO - INFO - Epoch  40 | Train Loss: -2.589 | Val Loss: 0.03 | Val F1: 0.90 |
2023-09-02 20:49:25,491 - FGO - INFO - Best Epoch:  15 | Train Loss: -2.373 | Val Loss: 0.02 | Val F1: 0.93 |
2023-09-02 20:49:25,491 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:25,495 - CV - INFO - OT Train Complete, 15 epochs
2023-09-02 20:49:25,495 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:25,520 - FGO - INFO - Train CM:
[[379   5]
 [  8 329]]
2023-09-02 20:49:25,521 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:49:25,521 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:49:25,526 - FGO - INFO - test statistical parity: 0.02230046948356812
2023-09-02 20:49:25,527 - FGO - INFO - test equal opportunity: 0.2592592592592593
2023-09-02 20:49:25,528 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:49:25,529 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:49:25,529 - CV - INFO - fold time: 4.820484399795532s (0.08034140666325887m)
2023-09-02 20:49:25,529 - CV - INFO - ----- BEGINNING FOLD SET (011:3)----------------------------------------------------------
2023-09-02 20:49:25,530 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/011/3
2023-09-02 20:49:25,530 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:25,530 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:25,530 - FGO - INFO - 	done: False
2023-09-02 20:49:25,530 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:25,530 - FGO - INFO - 	h1: 64
2023-09-02 20:49:25,530 - FGO - INFO - 	h2: 32
2023-09-02 20:49:25,530 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:25,530 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:25,531 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:25,531 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:25,531 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:25,531 - FGO - INFO - 	theta: 30
2023-09-02 20:49:25,531 - FGO - INFO - 	clip: 5
2023-09-02 20:49:25,531 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:25,531 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:25,531 - FGO - INFO - Source Total: 729
2023-09-02 20:49:25,531 - FGO - INFO - Target Total: 75
2023-09-02 20:49:25,531 - FGO - INFO - Train Total: 729
2023-09-02 20:49:25,531 - FGO - INFO - Val Total:   75
2023-09-02 20:49:25,531 - FGO - INFO - Test Total:  75
2023-09-02 20:49:25,531 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:25,531 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:25,531 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:25,531 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:25,531 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:25,531 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:25,531 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:25,531 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:25,531 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:25,531 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:25,532 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:25,534 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:25,628 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:25,628 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:25,628 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:25,628 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:25,628 - FGO - INFO - N: 804
2023-09-02 20:49:25,628 - FGO - INFO - N_s: 729
2023-09-02 20:49:25,628 - FGO - INFO - N_t: 75
2023-09-02 20:49:25,632 - CV - INFO - Begin Pretrain
2023-09-02 20:49:25,632 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:25,635 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:49:25,659 - FGO - INFO - Epoch  10 | Train Loss: 0.580 | Val Loss: 0.56 | Val F1: 0.75 |
2023-09-02 20:49:25,684 - FGO - INFO - Epoch  20 | Train Loss: 0.266 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:49:25,709 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.07 | Val F1: 0.99 |
2023-09-02 20:49:25,733 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:49:25,757 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:49:25,782 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:49:25,806 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:49:25,831 - FGO - INFO - Epoch  80 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:49:25,855 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:49:25,879 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:49:25,880 - FGO - INFO - Best Epoch:  24 | Train Loss: 0.189 | Val Loss: 0.10 | Val F1: 1.00 
2023-09-02 20:49:25,880 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:25,881 - CV - INFO - Pretrain Complete, 24 epochs
2023-09-02 20:49:25,881 - CV - INFO - Begin OT Train
2023-09-02 20:49:25,881 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:25,993 - FGO - INFO - Epoch   0 | Train Loss: -1.621 | Val Loss: -0.15 | Val F1: 0.99 |
2023-09-02 20:49:26,921 - FGO - INFO - Epoch  10 | Train Loss: -2.267 | Val Loss: -0.19 | Val F1: 0.97 |
2023-09-02 20:49:27,684 - FGO - INFO - Epoch  20 | Train Loss: -2.412 | Val Loss: -0.16 | Val F1: 0.97 |
2023-09-02 20:49:28,514 - FGO - INFO - Epoch  30 | Train Loss: -2.511 | Val Loss: -0.19 | Val F1: 0.96 |
2023-09-02 20:49:29,394 - FGO - INFO - Epoch  40 | Train Loss: -2.563 | Val Loss: -0.20 | Val F1: 0.97 |
2023-09-02 20:49:30,159 - FGO - INFO - Best Epoch:  11 | Train Loss: -2.277 | Val Loss: -0.20 | Val F1: 0.99 |
2023-09-02 20:49:30,159 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:30,162 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:49:30,162 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:30,191 - FGO - INFO - Train CM:
[[389   7]
 [ 12 321]]
2023-09-02 20:49:30,191 - FGO - INFO - Val CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:49:30,191 - FGO - INFO - Test CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:49:30,196 - FGO - INFO - test statistical parity: 0.046838407494145196
2023-09-02 20:49:30,198 - FGO - INFO - test equal opportunity: 0.10952380952380958
2023-09-02 20:49:30,199 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 20:49:30,199 - FGO - INFO - test macro f1: 0.9732905982905983
2023-09-02 20:49:30,199 - CV - INFO - fold time: 4.670355558395386s (0.07783925930658976m)
2023-09-02 20:49:30,199 - CV - INFO - ----- BEGINNING FOLD SET (011:4)----------------------------------------------------------
2023-09-02 20:49:30,201 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/011/4
2023-09-02 20:49:30,201 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:30,201 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:30,201 - FGO - INFO - 	done: False
2023-09-02 20:49:30,201 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:30,201 - FGO - INFO - 	h1: 64
2023-09-02 20:49:30,201 - FGO - INFO - 	h2: 32
2023-09-02 20:49:30,201 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:30,201 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:30,201 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:30,201 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:30,201 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:30,201 - FGO - INFO - 	theta: 30
2023-09-02 20:49:30,201 - FGO - INFO - 	clip: 5
2023-09-02 20:49:30,201 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:30,201 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:30,201 - FGO - INFO - Source Total: 732
2023-09-02 20:49:30,201 - FGO - INFO - Target Total: 72
2023-09-02 20:49:30,201 - FGO - INFO - Train Total: 732
2023-09-02 20:49:30,201 - FGO - INFO - Val Total:   72
2023-09-02 20:49:30,201 - FGO - INFO - Test Total:  72
2023-09-02 20:49:30,201 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:30,201 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:30,201 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:30,201 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:30,201 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:30,202 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:30,202 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:30,202 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:30,202 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:30,202 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:30,203 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:30,204 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:30,295 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:30,295 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:30,295 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:30,295 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:30,295 - FGO - INFO - N: 804
2023-09-02 20:49:30,295 - FGO - INFO - N_s: 732
2023-09-02 20:49:30,295 - FGO - INFO - N_t: 72
2023-09-02 20:49:30,299 - CV - INFO - Begin Pretrain
2023-09-02 20:49:30,299 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:30,302 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:49:30,327 - FGO - INFO - Epoch  10 | Train Loss: 0.578 | Val Loss: 0.58 | Val F1: 0.78 |
2023-09-02 20:49:30,351 - FGO - INFO - Epoch  20 | Train Loss: 0.258 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:49:30,376 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:49:30,401 - FGO - INFO - Epoch  40 | Train Loss: 0.095 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:49:30,425 - FGO - INFO - Epoch  50 | Train Loss: 0.084 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:49:30,450 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:49:30,474 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:49:30,499 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:49:30,523 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:49:30,548 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:49:30,548 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.99 
2023-09-02 20:49:30,548 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:30,549 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:49:30,549 - CV - INFO - Begin OT Train
2023-09-02 20:49:30,549 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:30,675 - FGO - INFO - Epoch   0 | Train Loss: -1.976 | Val Loss: -0.15 | Val F1: 0.99 |
2023-09-02 20:49:31,676 - FGO - INFO - Epoch  10 | Train Loss: -2.343 | Val Loss: -0.18 | Val F1: 0.99 |
2023-09-02 20:49:32,513 - FGO - INFO - Epoch  20 | Train Loss: -2.426 | Val Loss: -0.15 | Val F1: 0.99 |
2023-09-02 20:49:33,337 - FGO - INFO - Epoch  30 | Train Loss: -2.530 | Val Loss: -0.18 | Val F1: 0.99 |
2023-09-02 20:49:34,204 - FGO - INFO - Epoch  40 | Train Loss: -2.588 | Val Loss: -0.19 | Val F1: 0.99 |
2023-09-02 20:49:34,868 - FGO - INFO - Best Epoch:   9 | Train Loss: -2.323 | Val Loss: -0.16 | Val F1: 0.99 |
2023-09-02 20:49:34,868 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:34,872 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:49:34,872 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:34,898 - FGO - INFO - Train CM:
[[388   9]
 [ 12 323]]
2023-09-02 20:49:34,898 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:49:34,899 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:49:34,904 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:49:34,905 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:49:34,906 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:49:34,906 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:49:34,906 - CV - INFO - fold time: 4.707208871841431s (0.07845348119735718m)
2023-09-02 20:49:34,906 - CV - INFO - ----- BEGINNING FOLD SET (011:5)----------------------------------------------------------
2023-09-02 20:49:34,908 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/011/5
2023-09-02 20:49:34,908 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:34,908 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:34,908 - FGO - INFO - 	done: False
2023-09-02 20:49:34,908 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:34,908 - FGO - INFO - 	h1: 64
2023-09-02 20:49:34,908 - FGO - INFO - 	h2: 32
2023-09-02 20:49:34,908 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:34,908 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:34,908 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:34,908 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:34,908 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:34,908 - FGO - INFO - 	theta: 30
2023-09-02 20:49:34,908 - FGO - INFO - 	clip: 5
2023-09-02 20:49:34,908 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:34,908 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:34,908 - FGO - INFO - Source Total: 726
2023-09-02 20:49:34,908 - FGO - INFO - Target Total: 78
2023-09-02 20:49:34,908 - FGO - INFO - Train Total: 726
2023-09-02 20:49:34,908 - FGO - INFO - Val Total:   78
2023-09-02 20:49:34,908 - FGO - INFO - Test Total:  78
2023-09-02 20:49:34,908 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:34,908 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:34,908 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:34,908 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:34,908 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:34,909 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:34,909 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:34,909 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:34,909 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:34,909 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:34,910 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:34,911 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:35,009 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:35,009 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:35,009 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:35,009 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:35,009 - FGO - INFO - N: 804
2023-09-02 20:49:35,009 - FGO - INFO - N_s: 726
2023-09-02 20:49:35,009 - FGO - INFO - N_t: 78
2023-09-02 20:49:35,013 - CV - INFO - Begin Pretrain
2023-09-02 20:49:35,013 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:35,016 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:49:35,041 - FGO - INFO - Epoch  10 | Train Loss: 0.582 | Val Loss: 0.61 | Val F1: 0.72 |
2023-09-02 20:49:35,065 - FGO - INFO - Epoch  20 | Train Loss: 0.268 | Val Loss: 0.31 | Val F1: 0.87 |
2023-09-02 20:49:35,089 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.25 | Val F1: 0.92 |
2023-09-02 20:49:35,114 - FGO - INFO - Epoch  40 | Train Loss: 0.100 | Val Loss: 0.22 | Val F1: 0.92 |
2023-09-02 20:49:35,138 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:49:35,162 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:49:35,187 - FGO - INFO - Epoch  70 | Train Loss: 0.072 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:49:35,211 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.08 | Val F1: 0.96 |
2023-09-02 20:49:35,235 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:49:35,260 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:49:35,260 - FGO - INFO - Best Epoch:  77 | Train Loss: 0.070 | Val Loss: 0.10 | Val F1: 0.96 
2023-09-02 20:49:35,260 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:35,261 - CV - INFO - Pretrain Complete, 77 epochs
2023-09-02 20:49:35,261 - CV - INFO - Begin OT Train
2023-09-02 20:49:35,261 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:35,387 - FGO - INFO - Epoch   0 | Train Loss: -1.580 | Val Loss: -0.12 | Val F1: 0.96 |
2023-09-02 20:49:36,299 - FGO - INFO - Epoch  10 | Train Loss: -2.239 | Val Loss: 0.09 | Val F1: 0.88 |
2023-09-02 20:49:37,136 - FGO - INFO - Epoch  20 | Train Loss: -2.393 | Val Loss: -0.03 | Val F1: 0.91 |
2023-09-02 20:49:37,968 - FGO - INFO - Epoch  30 | Train Loss: -2.508 | Val Loss: -0.03 | Val F1: 0.91 |
2023-09-02 20:49:38,762 - FGO - INFO - Epoch  40 | Train Loss: -2.557 | Val Loss: -0.02 | Val F1: 0.91 |
2023-09-02 20:49:39,499 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.045 | Val Loss: -0.08 | Val F1: 0.95 |
2023-09-02 20:49:39,499 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:39,503 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:49:39,503 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:39,528 - FGO - INFO - Train CM:
[[392   8]
 [ 14 312]]
2023-09-02 20:49:39,528 - FGO - INFO - Val CM:
[[34  0]
 [ 7 37]]
2023-09-02 20:49:39,529 - FGO - INFO - Test CM:
[[34  0]
 [ 7 37]]
2023-09-02 20:49:39,534 - FGO - INFO - test statistical parity: 0.09178743961352659
2023-09-02 20:49:39,535 - FGO - INFO - test equal opportunity: 0.17948717948717952
2023-09-02 20:49:39,536 - FGO - INFO - test micro f1: 0.9102564102564102
2023-09-02 20:49:39,537 - FGO - INFO - test macro f1: 0.9101234567901235
2023-09-02 20:49:39,537 - CV - INFO - fold time: 4.630265474319458s (0.07717109123865763m)
2023-09-02 20:49:39,537 - CV - INFO - ----- BEGINNING FOLD SET (011:6)----------------------------------------------------------
2023-09-02 20:49:39,538 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/011/6
2023-09-02 20:49:39,538 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:39,538 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:39,538 - FGO - INFO - 	done: False
2023-09-02 20:49:39,538 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:39,538 - FGO - INFO - 	h1: 64
2023-09-02 20:49:39,538 - FGO - INFO - 	h2: 32
2023-09-02 20:49:39,538 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:39,538 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:39,538 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:39,538 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:39,538 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:39,538 - FGO - INFO - 	theta: 30
2023-09-02 20:49:39,538 - FGO - INFO - 	clip: 5
2023-09-02 20:49:39,538 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:39,539 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:39,539 - FGO - INFO - Source Total: 717
2023-09-02 20:49:39,539 - FGO - INFO - Target Total: 87
2023-09-02 20:49:39,539 - FGO - INFO - Train Total: 717
2023-09-02 20:49:39,539 - FGO - INFO - Val Total:   87
2023-09-02 20:49:39,539 - FGO - INFO - Test Total:  87
2023-09-02 20:49:39,539 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:39,539 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:39,539 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:39,539 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:39,539 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:39,539 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:39,539 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:39,539 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:39,539 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:39,539 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:39,540 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:39,542 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:39,647 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:39,647 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:39,647 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:39,647 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:39,647 - FGO - INFO - N: 804
2023-09-02 20:49:39,647 - FGO - INFO - N_s: 717
2023-09-02 20:49:39,647 - FGO - INFO - N_t: 87
2023-09-02 20:49:39,651 - CV - INFO - Begin Pretrain
2023-09-02 20:49:39,651 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:39,654 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:49:39,679 - FGO - INFO - Epoch  10 | Train Loss: 0.585 | Val Loss: 0.57 | Val F1: 0.75 |
2023-09-02 20:49:39,703 - FGO - INFO - Epoch  20 | Train Loss: 0.271 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:49:39,728 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:49:39,752 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:49:39,776 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:49:39,801 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:49:39,825 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:49:39,849 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:49:39,873 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:49:39,898 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:49:39,898 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.107 | Val Loss: 0.08 | Val F1: 0.99 
2023-09-02 20:49:39,898 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:39,899 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:49:39,899 - CV - INFO - Begin OT Train
2023-09-02 20:49:39,899 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:40,031 - FGO - INFO - Epoch   0 | Train Loss: -1.976 | Val Loss: -0.22 | Val F1: 0.99 |
2023-09-02 20:49:40,914 - FGO - INFO - Epoch  10 | Train Loss: -2.225 | Val Loss: -0.11 | Val F1: 0.90 |
2023-09-02 20:49:41,806 - FGO - INFO - Epoch  20 | Train Loss: -2.390 | Val Loss: -0.24 | Val F1: 0.99 |
2023-09-02 20:49:42,648 - FGO - INFO - Epoch  30 | Train Loss: -2.488 | Val Loss: -0.27 | Val F1: 0.96 |
2023-09-02 20:49:43,432 - FGO - INFO - Epoch  40 | Train Loss: -2.541 | Val Loss: -0.28 | Val F1: 0.99 |
2023-09-02 20:49:44,217 - FGO - INFO - Best Epoch:  16 | Train Loss: -2.372 | Val Loss: -0.23 | Val F1: 0.99 |
2023-09-02 20:49:44,217 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:44,220 - CV - INFO - OT Train Complete, 16 epochs
2023-09-02 20:49:44,221 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:44,249 - FGO - INFO - Train CM:
[[374  11]
 [ 11 321]]
2023-09-02 20:49:44,249 - FGO - INFO - Val CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:49:44,250 - FGO - INFO - Test CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:49:44,255 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 20:49:44,256 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:49:44,257 - FGO - INFO - test micro f1: 0.9885057471264368
2023-09-02 20:49:44,257 - FGO - INFO - test macro f1: 0.9883518543312357
2023-09-02 20:49:44,258 - CV - INFO - fold time: 4.720884799957275s (0.07868141333262126m)
2023-09-02 20:49:44,258 - CV - INFO - ----- BEGINNING FOLD SET (011:7)----------------------------------------------------------
2023-09-02 20:49:44,259 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/011/7
2023-09-02 20:49:44,259 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:44,259 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:44,259 - FGO - INFO - 	done: False
2023-09-02 20:49:44,259 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:44,259 - FGO - INFO - 	h1: 64
2023-09-02 20:49:44,259 - FGO - INFO - 	h2: 32
2023-09-02 20:49:44,259 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:44,259 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:44,259 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:44,259 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:44,259 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:44,259 - FGO - INFO - 	theta: 30
2023-09-02 20:49:44,259 - FGO - INFO - 	clip: 5
2023-09-02 20:49:44,259 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:44,259 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:44,259 - FGO - INFO - Source Total: 717
2023-09-02 20:49:44,259 - FGO - INFO - Target Total: 87
2023-09-02 20:49:44,259 - FGO - INFO - Train Total: 717
2023-09-02 20:49:44,260 - FGO - INFO - Val Total:   87
2023-09-02 20:49:44,260 - FGO - INFO - Test Total:  87
2023-09-02 20:49:44,260 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:44,260 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:44,260 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:44,260 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:44,260 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:44,260 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:44,260 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:44,260 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:44,260 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:44,260 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:44,261 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:44,262 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:44,368 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:44,368 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:44,368 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:44,368 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:44,368 - FGO - INFO - N: 804
2023-09-02 20:49:44,368 - FGO - INFO - N_s: 717
2023-09-02 20:49:44,368 - FGO - INFO - N_t: 87
2023-09-02 20:49:44,372 - CV - INFO - Begin Pretrain
2023-09-02 20:49:44,372 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:44,375 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:49:44,400 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.72 |
2023-09-02 20:49:44,424 - FGO - INFO - Epoch  20 | Train Loss: 0.265 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:49:44,449 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:49:44,473 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:49:44,498 - FGO - INFO - Epoch  50 | Train Loss: 0.086 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:49:44,522 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:49:44,547 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:49:44,571 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:49:44,595 - FGO - INFO - Epoch  90 | Train Loss: 0.070 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:49:44,620 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:49:44,620 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.169 | Val Loss: 0.14 | Val F1: 0.98 
2023-09-02 20:49:44,620 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:44,621 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:49:44,621 - CV - INFO - Begin OT Train
2023-09-02 20:49:44,621 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:44,720 - FGO - INFO - Epoch   0 | Train Loss: -1.943 | Val Loss: -0.09 | Val F1: 0.95 |
2023-09-02 20:49:45,690 - FGO - INFO - Epoch  10 | Train Loss: -2.305 | Val Loss: -0.11 | Val F1: 0.94 |
2023-09-02 20:49:46,583 - FGO - INFO - Epoch  20 | Train Loss: -2.391 | Val Loss: -0.15 | Val F1: 0.95 |
2023-09-02 20:49:47,408 - FGO - INFO - Epoch  30 | Train Loss: -2.495 | Val Loss: -0.15 | Val F1: 0.95 |
2023-09-02 20:49:48,157 - FGO - INFO - Epoch  40 | Train Loss: -2.558 | Val Loss: -0.19 | Val F1: 0.97 |
2023-09-02 20:49:48,856 - FGO - INFO - Best Epoch:  16 | Train Loss: -2.359 | Val Loss: -0.15 | Val F1: 0.97 |
2023-09-02 20:49:48,856 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:48,859 - CV - INFO - OT Train Complete, 16 epochs
2023-09-02 20:49:48,860 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:48,894 - FGO - INFO - Train CM:
[[378   9]
 [ 12 318]]
2023-09-02 20:49:48,894 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:49:48,894 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:49:48,899 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:49:48,900 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:49:48,901 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:49:48,901 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:49:48,901 - CV - INFO - fold time: 4.6439595222473145s (0.07739932537078857m)
2023-09-02 20:49:48,902 - CV - INFO - ----- BEGINNING FOLD SET (011:8)----------------------------------------------------------
2023-09-02 20:49:48,903 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/011/8
2023-09-02 20:49:48,903 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:48,903 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:48,903 - FGO - INFO - 	done: False
2023-09-02 20:49:48,903 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:48,903 - FGO - INFO - 	h1: 64
2023-09-02 20:49:48,903 - FGO - INFO - 	h2: 32
2023-09-02 20:49:48,903 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:48,903 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:48,903 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:48,903 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:48,903 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:48,903 - FGO - INFO - 	theta: 30
2023-09-02 20:49:48,903 - FGO - INFO - 	clip: 5
2023-09-02 20:49:48,903 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:48,903 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:48,904 - FGO - INFO - Source Total: 734
2023-09-02 20:49:48,904 - FGO - INFO - Target Total: 70
2023-09-02 20:49:48,904 - FGO - INFO - Train Total: 734
2023-09-02 20:49:48,904 - FGO - INFO - Val Total:   70
2023-09-02 20:49:48,904 - FGO - INFO - Test Total:  70
2023-09-02 20:49:48,904 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:48,904 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:48,904 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:48,904 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:48,904 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:48,904 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:48,904 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:48,904 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:48,904 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:48,904 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:48,905 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:48,906 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:48,994 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:48,994 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:48,994 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:48,994 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:48,994 - FGO - INFO - N: 804
2023-09-02 20:49:48,994 - FGO - INFO - N_s: 734
2023-09-02 20:49:48,994 - FGO - INFO - N_t: 70
2023-09-02 20:49:48,998 - CV - INFO - Begin Pretrain
2023-09-02 20:49:48,998 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:49,001 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:49:49,026 - FGO - INFO - Epoch  10 | Train Loss: 0.564 | Val Loss: 0.59 | Val F1: 0.75 |
2023-09-02 20:49:49,051 - FGO - INFO - Epoch  20 | Train Loss: 0.257 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:49:49,076 - FGO - INFO - Epoch  30 | Train Loss: 0.132 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:49:49,101 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.13 | Val F1: 0.94 |
2023-09-02 20:49:49,125 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:49:49,150 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:49:49,174 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:49:49,199 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:49:49,224 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.16 | Val F1: 0.93 |
2023-09-02 20:49:49,248 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:49:49,248 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.108 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:49:49,248 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:49,250 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:49:49,250 - CV - INFO - Begin OT Train
2023-09-02 20:49:49,250 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:49,336 - FGO - INFO - Epoch   0 | Train Loss: -1.832 | Val Loss: -0.02 | Val F1: 0.93 |
2023-09-02 20:49:50,296 - FGO - INFO - Epoch  10 | Train Loss: -2.254 | Val Loss: 0.08 | Val F1: 0.93 |
2023-09-02 20:49:51,167 - FGO - INFO - Epoch  20 | Train Loss: -2.423 | Val Loss: -0.02 | Val F1: 0.94 |
2023-09-02 20:49:51,958 - FGO - INFO - Epoch  30 | Train Loss: -2.512 | Val Loss: -0.05 | Val F1: 0.96 |
2023-09-02 20:49:52,810 - FGO - INFO - Epoch  40 | Train Loss: -2.566 | Val Loss: -0.05 | Val F1: 0.96 |
2023-09-02 20:49:53,568 - FGO - INFO - Best Epoch:  11 | Train Loss: -2.317 | Val Loss: 0.01 | Val F1: 0.96 |
2023-09-02 20:49:53,568 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:53,575 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:49:53,575 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:53,603 - FGO - INFO - Train CM:
[[391   9]
 [ 11 323]]
2023-09-02 20:49:53,604 - FGO - INFO - Val CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:49:53,604 - FGO - INFO - Test CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:49:53,609 - FGO - INFO - test statistical parity: 0.10661268556005393
2023-09-02 20:49:53,610 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:49:53,611 - FGO - INFO - test micro f1: 0.9571428571428572
2023-09-02 20:49:53,612 - FGO - INFO - test macro f1: 0.9571341090018372
2023-09-02 20:49:53,612 - CV - INFO - fold time: 4.710240364074707s (0.07850400606791179m)
2023-09-02 20:49:53,612 - CV - INFO - ----- BEGINNING FOLD SET (011:9)----------------------------------------------------------
2023-09-02 20:49:53,613 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/011/9
2023-09-02 20:49:53,614 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:53,614 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:53,614 - FGO - INFO - 	done: False
2023-09-02 20:49:53,614 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:53,614 - FGO - INFO - 	h1: 64
2023-09-02 20:49:53,614 - FGO - INFO - 	h2: 32
2023-09-02 20:49:53,614 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:53,614 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:53,614 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:53,614 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:53,614 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:53,614 - FGO - INFO - 	theta: 30
2023-09-02 20:49:53,614 - FGO - INFO - 	clip: 5
2023-09-02 20:49:53,614 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:53,614 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:53,614 - FGO - INFO - Source Total: 725
2023-09-02 20:49:53,614 - FGO - INFO - Target Total: 79
2023-09-02 20:49:53,614 - FGO - INFO - Train Total: 725
2023-09-02 20:49:53,614 - FGO - INFO - Val Total:   79
2023-09-02 20:49:53,614 - FGO - INFO - Test Total:  79
2023-09-02 20:49:53,614 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:53,614 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:53,614 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:53,614 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:53,614 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:53,614 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:53,614 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:53,615 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:53,615 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:53,615 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:53,616 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:53,617 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:53,716 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:53,716 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:53,716 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:53,716 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:53,716 - FGO - INFO - N: 804
2023-09-02 20:49:53,716 - FGO - INFO - N_s: 725
2023-09-02 20:49:53,716 - FGO - INFO - N_t: 79
2023-09-02 20:49:53,720 - CV - INFO - Begin Pretrain
2023-09-02 20:49:53,720 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:53,723 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:49:53,748 - FGO - INFO - Epoch  10 | Train Loss: 0.579 | Val Loss: 0.59 | Val F1: 0.74 |
2023-09-02 20:49:53,772 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.30 | Val F1: 0.91 |
2023-09-02 20:49:53,797 - FGO - INFO - Epoch  30 | Train Loss: 0.128 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:49:53,821 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:49:53,846 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:49:53,870 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:49:53,894 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:49:53,919 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:49:53,943 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:49:53,967 - FGO - INFO - Epoch 100 | Train Loss: 0.065 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:49:53,967 - FGO - INFO - Best Epoch:  51 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.99 
2023-09-02 20:49:53,967 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:53,969 - CV - INFO - Pretrain Complete, 51 epochs
2023-09-02 20:49:53,969 - CV - INFO - Begin OT Train
2023-09-02 20:49:53,969 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:54,083 - FGO - INFO - Epoch   0 | Train Loss: -1.848 | Val Loss: -0.08 | Val F1: 0.97 |
2023-09-02 20:49:54,971 - FGO - INFO - Epoch  10 | Train Loss: -2.219 | Val Loss: 0.07 | Val F1: 0.85 |
2023-09-02 20:49:55,842 - FGO - INFO - Epoch  20 | Train Loss: -2.376 | Val Loss: -0.13 | Val F1: 0.96 |
2023-09-02 20:49:56,676 - FGO - INFO - Epoch  30 | Train Loss: -2.491 | Val Loss: -0.17 | Val F1: 0.97 |
2023-09-02 20:49:57,497 - FGO - INFO - Epoch  40 | Train Loss: -2.554 | Val Loss: -0.18 | Val F1: 0.97 |
2023-09-02 20:49:58,251 - FGO - INFO - Best Epoch:  22 | Train Loss: -2.401 | Val Loss: -0.13 | Val F1: 0.97 |
2023-09-02 20:49:58,251 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:58,255 - CV - INFO - OT Train Complete, 22 epochs
2023-09-02 20:49:58,255 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:49:58,279 - FGO - INFO - Train CM:
[[378   7]
 [ 12 328]]
2023-09-02 20:49:58,280 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:49:58,280 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:49:58,284 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:49:58,286 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:49:58,287 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:49:58,287 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:49:58,287 - CV - INFO - fold time: 4.675335645675659s (0.07792226076126099m)
2023-09-02 20:49:58,287 - CV - INFO - Mean Pretrain Epochs 45.5:
2023-09-02 20:49:58,287 - CV - INFO - Mean OT Train Epochs 15.8:
2023-09-02 20:49:58,287 - CV - INFO - Mean Val Macro F1 : 0.9564841463552417
2023-09-02 20:49:58,287 - CV - INFO - Mean Eval Stat : 0.9564841463552417 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:49:58,287 - CV - INFO - set time: 46.8774950504303s (0.7812915841738383m)
2023-09-02 20:49:58,287 - CV - INFO - script time so far: 496.23836874961853s (8.270639479160309m) (0.13784399131933847h)
2023-09-02 20:49:58,287 - CV - INFO - ===== BEGINNING OPTION SET (012)==========================================================
2023-09-02 20:49:58,287 - CV - INFO - 	done: False
2023-09-02 20:49:58,287 - CV - INFO - 	learning_rate: 0.005
2023-09-02 20:49:58,287 - CV - INFO - 	h1: 64
2023-09-02 20:49:58,287 - CV - INFO - 	h2: 32
2023-09-02 20:49:58,287 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:58,287 - CV - INFO - 	dropout: 0.0
2023-09-02 20:49:58,287 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:58,287 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:58,287 - CV - INFO - 	lambda: 0.01
2023-09-02 20:49:58,287 - CV - INFO - 	theta: 50
2023-09-02 20:49:58,287 - CV - INFO - 	clip: 5
2023-09-02 20:49:58,287 - CV - INFO - ----- BEGINNING FOLD SET (012:0)----------------------------------------------------------
2023-09-02 20:49:58,289 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/012/0
2023-09-02 20:49:58,289 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:49:58,289 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:49:58,289 - FGO - INFO - 	done: False
2023-09-02 20:49:58,289 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:49:58,289 - FGO - INFO - 	h1: 64
2023-09-02 20:49:58,289 - FGO - INFO - 	h2: 32
2023-09-02 20:49:58,289 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:49:58,289 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:49:58,289 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:49:58,289 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:49:58,289 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:49:58,289 - FGO - INFO - 	theta: 50
2023-09-02 20:49:58,289 - FGO - INFO - 	clip: 5
2023-09-02 20:49:58,289 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:49:58,289 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:49:58,289 - FGO - INFO - Source Total: 708
2023-09-02 20:49:58,289 - FGO - INFO - Target Total: 96
2023-09-02 20:49:58,289 - FGO - INFO - Train Total: 708
2023-09-02 20:49:58,289 - FGO - INFO - Val Total:   96
2023-09-02 20:49:58,289 - FGO - INFO - Test Total:  96
2023-09-02 20:49:58,289 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:49:58,289 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:49:58,289 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:49:58,289 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:49:58,289 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:49:58,290 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:49:58,290 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:49:58,290 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:49:58,290 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:49:58,290 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:49:58,291 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:49:58,292 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:49:58,407 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:49:58,407 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:49:58,407 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:49:58,407 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:49:58,407 - FGO - INFO - N: 804
2023-09-02 20:49:58,407 - FGO - INFO - N_s: 708
2023-09-02 20:49:58,407 - FGO - INFO - N_t: 96
2023-09-02 20:49:58,411 - CV - INFO - Begin Pretrain
2023-09-02 20:49:58,411 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:49:58,414 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:49:58,439 - FGO - INFO - Epoch  10 | Train Loss: 0.572 | Val Loss: 0.59 | Val F1: 0.62 |
2023-09-02 20:49:58,463 - FGO - INFO - Epoch  20 | Train Loss: 0.245 | Val Loss: 0.25 | Val F1: 0.93 |
2023-09-02 20:49:58,487 - FGO - INFO - Epoch  30 | Train Loss: 0.127 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:49:58,511 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:49:58,536 - FGO - INFO - Epoch  50 | Train Loss: 0.083 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:49:58,560 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:49:58,584 - FGO - INFO - Epoch  70 | Train Loss: 0.067 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:49:58,608 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:49:58,632 - FGO - INFO - Epoch  90 | Train Loss: 0.060 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:49:58,656 - FGO - INFO - Epoch 100 | Train Loss: 0.058 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:49:58,656 - FGO - INFO - Best Epoch:  39 | Train Loss: 0.095 | Val Loss: 0.10 | Val F1: 0.98 
2023-09-02 20:49:58,656 - FGO - INFO - Setting model to best state.
2023-09-02 20:49:58,658 - CV - INFO - Pretrain Complete, 39 epochs
2023-09-02 20:49:58,658 - CV - INFO - Begin OT Train
2023-09-02 20:49:58,658 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:49:58,777 - FGO - INFO - Epoch   0 | Train Loss: -3.209 | Val Loss: -0.34 | Val F1: 0.97 |
2023-09-02 20:49:59,671 - FGO - INFO - Epoch  10 | Train Loss: -3.827 | Val Loss: -0.41 | Val F1: 0.95 |
2023-09-02 20:50:00,511 - FGO - INFO - Epoch  20 | Train Loss: -4.055 | Val Loss: -0.36 | Val F1: 0.93 |
2023-09-02 20:50:01,307 - FGO - INFO - Epoch  30 | Train Loss: -4.234 | Val Loss: -0.47 | Val F1: 0.95 |
2023-09-02 20:50:02,100 - FGO - INFO - Epoch  40 | Train Loss: -4.328 | Val Loss: -0.51 | Val F1: 0.98 |
2023-09-02 20:50:02,805 - FGO - INFO - Best Epoch:  12 | Train Loss: -3.978 | Val Loss: -0.46 | Val F1: 0.98 |
2023-09-02 20:50:02,806 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:02,809 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:50:02,809 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:02,835 - FGO - INFO - Train CM:
[[374   8]
 [ 10 316]]
2023-09-02 20:50:02,836 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:50:02,836 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:50:02,841 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:50:02,842 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:50:02,843 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:50:02,844 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:50:02,844 - CV - INFO - fold time: 4.556286334991455s (0.07593810558319092m)
2023-09-02 20:50:02,844 - CV - INFO - ----- BEGINNING FOLD SET (012:1)----------------------------------------------------------
2023-09-02 20:50:02,845 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/012/1
2023-09-02 20:50:02,845 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:02,845 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:02,846 - FGO - INFO - 	done: False
2023-09-02 20:50:02,846 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:02,846 - FGO - INFO - 	h1: 64
2023-09-02 20:50:02,846 - FGO - INFO - 	h2: 32
2023-09-02 20:50:02,846 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:02,846 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:02,846 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:02,846 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:02,846 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:50:02,846 - FGO - INFO - 	theta: 50
2023-09-02 20:50:02,846 - FGO - INFO - 	clip: 5
2023-09-02 20:50:02,846 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:02,846 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:02,846 - FGO - INFO - Source Total: 727
2023-09-02 20:50:02,846 - FGO - INFO - Target Total: 77
2023-09-02 20:50:02,846 - FGO - INFO - Train Total: 727
2023-09-02 20:50:02,846 - FGO - INFO - Val Total:   77
2023-09-02 20:50:02,846 - FGO - INFO - Test Total:  77
2023-09-02 20:50:02,846 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:02,846 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:02,846 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:02,846 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:02,846 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:02,846 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:02,846 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:02,846 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:02,846 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:02,846 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:02,847 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:02,849 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:02,945 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:02,945 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:02,945 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:02,945 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:02,945 - FGO - INFO - N: 804
2023-09-02 20:50:02,945 - FGO - INFO - N_s: 727
2023-09-02 20:50:02,945 - FGO - INFO - N_t: 77
2023-09-02 20:50:02,949 - CV - INFO - Begin Pretrain
2023-09-02 20:50:02,949 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:02,952 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:50:02,977 - FGO - INFO - Epoch  10 | Train Loss: 0.577 | Val Loss: 0.61 | Val F1: 0.66 |
2023-09-02 20:50:03,002 - FGO - INFO - Epoch  20 | Train Loss: 0.255 | Val Loss: 0.38 | Val F1: 0.83 |
2023-09-02 20:50:03,026 - FGO - INFO - Epoch  30 | Train Loss: 0.122 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:50:03,051 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.20 | Val F1: 0.89 |
2023-09-02 20:50:03,075 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.87 |
2023-09-02 20:50:03,100 - FGO - INFO - Epoch  60 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.89 |
2023-09-02 20:50:03,124 - FGO - INFO - Epoch  70 | Train Loss: 0.063 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:50:03,149 - FGO - INFO - Epoch  80 | Train Loss: 0.060 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:50:03,173 - FGO - INFO - Epoch  90 | Train Loss: 0.057 | Val Loss: 0.21 | Val F1: 0.90 |
2023-09-02 20:50:03,198 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.20 | Val F1: 0.92 |
2023-09-02 20:50:03,198 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.097 | Val Loss: 0.18 | Val F1: 0.93 
2023-09-02 20:50:03,198 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:03,199 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:50:03,199 - CV - INFO - Begin OT Train
2023-09-02 20:50:03,199 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:03,312 - FGO - INFO - Epoch   0 | Train Loss: -2.952 | Val Loss: -0.09 | Val F1: 0.89 |
2023-09-02 20:50:04,237 - FGO - INFO - Epoch  10 | Train Loss: -3.663 | Val Loss: 0.10 | Val F1: 0.87 |
2023-09-02 20:50:05,092 - FGO - INFO - Epoch  20 | Train Loss: -4.083 | Val Loss: -0.16 | Val F1: 0.89 |
2023-09-02 20:50:05,918 - FGO - INFO - Epoch  30 | Train Loss: -4.247 | Val Loss: -0.13 | Val F1: 0.91 |
2023-09-02 20:50:06,684 - FGO - INFO - Epoch  40 | Train Loss: -4.352 | Val Loss: -0.17 | Val F1: 0.91 |
2023-09-02 20:50:07,384 - FGO - INFO - Best Epoch:  12 | Train Loss: -3.862 | Val Loss: -0.14 | Val F1: 0.92 |
2023-09-02 20:50:07,384 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:07,387 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:50:07,387 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:07,413 - FGO - INFO - Train CM:
[[375  15]
 [  8 329]]
2023-09-02 20:50:07,413 - FGO - INFO - Val CM:
[[41  3]
 [ 4 29]]
2023-09-02 20:50:07,413 - FGO - INFO - Test CM:
[[41  3]
 [ 4 29]]
2023-09-02 20:50:07,418 - FGO - INFO - test statistical parity: 0.29487179487179493
2023-09-02 20:50:07,420 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:50:07,420 - FGO - INFO - test micro f1: 0.9090909090909091
2023-09-02 20:50:07,421 - FGO - INFO - test macro f1: 0.9068280034572169
2023-09-02 20:50:07,421 - CV - INFO - fold time: 4.577155590057373s (0.07628592650095621m)
2023-09-02 20:50:07,421 - CV - INFO - ----- BEGINNING FOLD SET (012:2)----------------------------------------------------------
2023-09-02 20:50:07,423 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/012/2
2023-09-02 20:50:07,423 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:07,423 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:07,423 - FGO - INFO - 	done: False
2023-09-02 20:50:07,423 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:07,423 - FGO - INFO - 	h1: 64
2023-09-02 20:50:07,423 - FGO - INFO - 	h2: 32
2023-09-02 20:50:07,423 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:07,423 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:07,423 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:07,423 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:07,423 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:50:07,423 - FGO - INFO - 	theta: 50
2023-09-02 20:50:07,423 - FGO - INFO - 	clip: 5
2023-09-02 20:50:07,423 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:07,423 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:07,423 - FGO - INFO - Source Total: 721
2023-09-02 20:50:07,423 - FGO - INFO - Target Total: 83
2023-09-02 20:50:07,423 - FGO - INFO - Train Total: 721
2023-09-02 20:50:07,423 - FGO - INFO - Val Total:   83
2023-09-02 20:50:07,423 - FGO - INFO - Test Total:  83
2023-09-02 20:50:07,423 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:07,423 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:07,423 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:07,423 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:07,423 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:07,424 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:07,424 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:07,424 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:07,424 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:07,424 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:07,425 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:07,426 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:07,528 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:07,528 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:07,528 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:07,528 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:07,528 - FGO - INFO - N: 804
2023-09-02 20:50:07,528 - FGO - INFO - N_s: 721
2023-09-02 20:50:07,528 - FGO - INFO - N_t: 83
2023-09-02 20:50:07,531 - CV - INFO - Begin Pretrain
2023-09-02 20:50:07,531 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:07,535 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:50:07,559 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.76 |
2023-09-02 20:50:07,584 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.33 | Val F1: 0.88 |
2023-09-02 20:50:07,608 - FGO - INFO - Epoch  30 | Train Loss: 0.120 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:50:07,633 - FGO - INFO - Epoch  40 | Train Loss: 0.083 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:50:07,657 - FGO - INFO - Epoch  50 | Train Loss: 0.071 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:50:07,681 - FGO - INFO - Epoch  60 | Train Loss: 0.062 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:50:07,706 - FGO - INFO - Epoch  70 | Train Loss: 0.059 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:50:07,730 - FGO - INFO - Epoch  80 | Train Loss: 0.055 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:50:07,754 - FGO - INFO - Epoch  90 | Train Loss: 0.053 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:50:07,779 - FGO - INFO - Epoch 100 | Train Loss: 0.051 | Val Loss: 0.26 | Val F1: 0.91 |
2023-09-02 20:50:07,779 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.063 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:50:07,779 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:07,780 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:50:07,780 - CV - INFO - Begin OT Train
2023-09-02 20:50:07,780 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:07,900 - FGO - INFO - Epoch   0 | Train Loss: -2.991 | Val Loss: -0.09 | Val F1: 0.90 |
2023-09-02 20:50:08,985 - FGO - INFO - Epoch  10 | Train Loss: -3.864 | Val Loss: 0.09 | Val F1: 0.88 |
2023-09-02 20:50:09,774 - FGO - INFO - Epoch  20 | Train Loss: -4.172 | Val Loss: -0.20 | Val F1: 0.90 |
2023-09-02 20:50:10,622 - FGO - INFO - Epoch  30 | Train Loss: -4.326 | Val Loss: -0.12 | Val F1: 0.91 |
2023-09-02 20:50:11,424 - FGO - INFO - Epoch  40 | Train Loss: -4.419 | Val Loss: -0.17 | Val F1: 0.90 |
2023-09-02 20:50:12,193 - FGO - INFO - Best Epoch:  30 | Train Loss: -4.326 | Val Loss: -0.12 | Val F1: 0.91 |
2023-09-02 20:50:12,193 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:12,197 - CV - INFO - OT Train Complete, 30 epochs
2023-09-02 20:50:12,197 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:12,224 - FGO - INFO - Train CM:
[[379   5]
 [  8 329]]
2023-09-02 20:50:12,225 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:50:12,225 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:50:12,230 - FGO - INFO - test statistical parity: 0.02230046948356812
2023-09-02 20:50:12,232 - FGO - INFO - test equal opportunity: 0.2592592592592593
2023-09-02 20:50:12,232 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:50:12,233 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:50:12,233 - CV - INFO - fold time: 4.8120317459106445s (0.08020052909851075m)
2023-09-02 20:50:12,233 - CV - INFO - ----- BEGINNING FOLD SET (012:3)----------------------------------------------------------
2023-09-02 20:50:12,235 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/012/3
2023-09-02 20:50:12,235 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:12,235 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:12,235 - FGO - INFO - 	done: False
2023-09-02 20:50:12,235 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:12,235 - FGO - INFO - 	h1: 64
2023-09-02 20:50:12,235 - FGO - INFO - 	h2: 32
2023-09-02 20:50:12,235 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:12,235 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:12,235 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:12,235 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:12,235 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:50:12,235 - FGO - INFO - 	theta: 50
2023-09-02 20:50:12,235 - FGO - INFO - 	clip: 5
2023-09-02 20:50:12,235 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:12,235 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:12,235 - FGO - INFO - Source Total: 729
2023-09-02 20:50:12,235 - FGO - INFO - Target Total: 75
2023-09-02 20:50:12,235 - FGO - INFO - Train Total: 729
2023-09-02 20:50:12,235 - FGO - INFO - Val Total:   75
2023-09-02 20:50:12,235 - FGO - INFO - Test Total:  75
2023-09-02 20:50:12,235 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:12,235 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:12,235 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:12,235 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:12,235 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:12,236 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:12,236 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:12,236 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:12,236 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:12,236 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:12,237 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:12,238 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:12,332 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:12,332 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:12,332 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:12,332 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:12,332 - FGO - INFO - N: 804
2023-09-02 20:50:12,332 - FGO - INFO - N_s: 729
2023-09-02 20:50:12,332 - FGO - INFO - N_t: 75
2023-09-02 20:50:12,336 - CV - INFO - Begin Pretrain
2023-09-02 20:50:12,336 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:12,339 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:50:12,364 - FGO - INFO - Epoch  10 | Train Loss: 0.580 | Val Loss: 0.56 | Val F1: 0.75 |
2023-09-02 20:50:12,388 - FGO - INFO - Epoch  20 | Train Loss: 0.266 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:50:12,413 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.07 | Val F1: 0.99 |
2023-09-02 20:50:12,438 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:50:12,462 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:50:12,486 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:50:12,511 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:50:12,535 - FGO - INFO - Epoch  80 | Train Loss: 0.076 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:50:12,560 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:50:12,584 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:50:12,584 - FGO - INFO - Best Epoch:  24 | Train Loss: 0.189 | Val Loss: 0.10 | Val F1: 1.00 
2023-09-02 20:50:12,584 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:12,586 - CV - INFO - Pretrain Complete, 24 epochs
2023-09-02 20:50:12,586 - CV - INFO - Begin OT Train
2023-09-02 20:50:12,586 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:12,696 - FGO - INFO - Epoch   0 | Train Loss: -2.862 | Val Loss: -0.28 | Val F1: 0.97 |
2023-09-02 20:50:13,603 - FGO - INFO - Epoch  10 | Train Loss: -3.996 | Val Loss: -0.36 | Val F1: 0.97 |
2023-09-02 20:50:14,445 - FGO - INFO - Epoch  20 | Train Loss: -4.164 | Val Loss: -0.30 | Val F1: 0.96 |
2023-09-02 20:50:15,297 - FGO - INFO - Epoch  30 | Train Loss: -4.312 | Val Loss: -0.36 | Val F1: 0.96 |
2023-09-02 20:50:16,046 - FGO - INFO - Epoch  40 | Train Loss: -4.394 | Val Loss: -0.37 | Val F1: 0.96 |
2023-09-02 20:50:16,776 - FGO - INFO - Best Epoch:  11 | Train Loss: -4.023 | Val Loss: -0.35 | Val F1: 0.99 |
2023-09-02 20:50:16,776 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:16,779 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:50:16,780 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:16,810 - FGO - INFO - Train CM:
[[389   7]
 [ 12 321]]
2023-09-02 20:50:16,810 - FGO - INFO - Val CM:
[[37  1]
 [ 1 36]]
2023-09-02 20:50:16,811 - FGO - INFO - Test CM:
[[37  1]
 [ 1 36]]
2023-09-02 20:50:16,815 - FGO - INFO - test statistical parity: 0.07962529274004687
2023-09-02 20:50:16,817 - FGO - INFO - test equal opportunity: 0.1428571428571429
2023-09-02 20:50:16,818 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 20:50:16,818 - FGO - INFO - test macro f1: 0.9733285917496444
2023-09-02 20:50:16,818 - CV - INFO - fold time: 4.5849831104278564s (0.0764163851737976m)
2023-09-02 20:50:16,818 - CV - INFO - ----- BEGINNING FOLD SET (012:4)----------------------------------------------------------
2023-09-02 20:50:16,820 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/012/4
2023-09-02 20:50:16,820 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:16,820 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:16,820 - FGO - INFO - 	done: False
2023-09-02 20:50:16,820 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:16,820 - FGO - INFO - 	h1: 64
2023-09-02 20:50:16,820 - FGO - INFO - 	h2: 32
2023-09-02 20:50:16,820 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:16,820 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:16,820 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:16,820 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:16,820 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:50:16,820 - FGO - INFO - 	theta: 50
2023-09-02 20:50:16,820 - FGO - INFO - 	clip: 5
2023-09-02 20:50:16,820 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:16,820 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:16,820 - FGO - INFO - Source Total: 732
2023-09-02 20:50:16,820 - FGO - INFO - Target Total: 72
2023-09-02 20:50:16,820 - FGO - INFO - Train Total: 732
2023-09-02 20:50:16,820 - FGO - INFO - Val Total:   72
2023-09-02 20:50:16,820 - FGO - INFO - Test Total:  72
2023-09-02 20:50:16,820 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:16,820 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:16,820 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:16,820 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:16,820 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:16,821 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:16,821 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:16,821 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:16,821 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:16,821 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:16,822 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:16,823 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:16,914 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:16,914 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:16,914 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:16,914 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:16,914 - FGO - INFO - N: 804
2023-09-02 20:50:16,914 - FGO - INFO - N_s: 732
2023-09-02 20:50:16,914 - FGO - INFO - N_t: 72
2023-09-02 20:50:16,917 - CV - INFO - Begin Pretrain
2023-09-02 20:50:16,917 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:16,920 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:50:16,945 - FGO - INFO - Epoch  10 | Train Loss: 0.578 | Val Loss: 0.58 | Val F1: 0.78 |
2023-09-02 20:50:16,970 - FGO - INFO - Epoch  20 | Train Loss: 0.258 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:50:16,995 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:50:17,019 - FGO - INFO - Epoch  40 | Train Loss: 0.095 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:50:17,044 - FGO - INFO - Epoch  50 | Train Loss: 0.084 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:50:17,068 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:50:17,093 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:50:17,118 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:50:17,142 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:50:17,167 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:50:17,167 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.99 
2023-09-02 20:50:17,167 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:17,168 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:50:17,168 - CV - INFO - Begin OT Train
2023-09-02 20:50:17,168 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:17,287 - FGO - INFO - Epoch   0 | Train Loss: -3.344 | Val Loss: -0.29 | Val F1: 0.99 |
2023-09-02 20:50:18,217 - FGO - INFO - Epoch  10 | Train Loss: -4.049 | Val Loss: -0.33 | Val F1: 0.99 |
2023-09-02 20:50:19,055 - FGO - INFO - Epoch  20 | Train Loss: -4.217 | Val Loss: -0.32 | Val F1: 0.99 |
2023-09-02 20:50:19,878 - FGO - INFO - Epoch  30 | Train Loss: -4.363 | Val Loss: -0.36 | Val F1: 0.99 |
2023-09-02 20:50:20,687 - FGO - INFO - Epoch  40 | Train Loss: -4.444 | Val Loss: -0.38 | Val F1: 0.99 |
2023-09-02 20:50:21,387 - FGO - INFO - Best Epoch:   6 | Train Loss: -3.933 | Val Loss: -0.33 | Val F1: 0.99 |
2023-09-02 20:50:21,387 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:21,391 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:50:21,391 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:21,424 - FGO - INFO - Train CM:
[[386  11]
 [ 11 324]]
2023-09-02 20:50:21,424 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:50:21,425 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:50:21,429 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:50:21,430 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:50:21,431 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:50:21,432 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:50:21,432 - CV - INFO - fold time: 4.613900661468506s (0.07689834435780843m)
2023-09-02 20:50:21,432 - CV - INFO - ----- BEGINNING FOLD SET (012:5)----------------------------------------------------------
2023-09-02 20:50:21,433 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/012/5
2023-09-02 20:50:21,434 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:21,434 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:21,434 - FGO - INFO - 	done: False
2023-09-02 20:50:21,434 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:21,434 - FGO - INFO - 	h1: 64
2023-09-02 20:50:21,434 - FGO - INFO - 	h2: 32
2023-09-02 20:50:21,434 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:21,434 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:21,434 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:21,434 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:21,434 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:50:21,434 - FGO - INFO - 	theta: 50
2023-09-02 20:50:21,434 - FGO - INFO - 	clip: 5
2023-09-02 20:50:21,434 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:21,434 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:21,434 - FGO - INFO - Source Total: 726
2023-09-02 20:50:21,434 - FGO - INFO - Target Total: 78
2023-09-02 20:50:21,434 - FGO - INFO - Train Total: 726
2023-09-02 20:50:21,434 - FGO - INFO - Val Total:   78
2023-09-02 20:50:21,434 - FGO - INFO - Test Total:  78
2023-09-02 20:50:21,434 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:21,434 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:21,434 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:21,434 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:21,434 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:21,435 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:21,435 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:21,435 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:21,435 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:21,435 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:21,436 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:21,437 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:21,534 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:21,534 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:21,534 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:21,534 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:21,534 - FGO - INFO - N: 804
2023-09-02 20:50:21,534 - FGO - INFO - N_s: 726
2023-09-02 20:50:21,534 - FGO - INFO - N_t: 78
2023-09-02 20:50:21,538 - CV - INFO - Begin Pretrain
2023-09-02 20:50:21,538 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:21,541 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:50:21,566 - FGO - INFO - Epoch  10 | Train Loss: 0.582 | Val Loss: 0.61 | Val F1: 0.72 |
2023-09-02 20:50:21,590 - FGO - INFO - Epoch  20 | Train Loss: 0.268 | Val Loss: 0.31 | Val F1: 0.87 |
2023-09-02 20:50:21,615 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.25 | Val F1: 0.92 |
2023-09-02 20:50:21,639 - FGO - INFO - Epoch  40 | Train Loss: 0.100 | Val Loss: 0.22 | Val F1: 0.92 |
2023-09-02 20:50:21,663 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:50:21,687 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:50:21,712 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:50:21,736 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 20:50:21,760 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:50:21,784 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:50:21,785 - FGO - INFO - Best Epoch:  77 | Train Loss: 0.070 | Val Loss: 0.10 | Val F1: 0.96 
2023-09-02 20:50:21,785 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:21,786 - CV - INFO - Pretrain Complete, 77 epochs
2023-09-02 20:50:21,786 - CV - INFO - Begin OT Train
2023-09-02 20:50:21,786 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:21,899 - FGO - INFO - Epoch   0 | Train Loss: -2.875 | Val Loss: -0.25 | Val F1: 0.96 |
2023-09-02 20:50:22,780 - FGO - INFO - Epoch  10 | Train Loss: -3.972 | Val Loss: -0.16 | Val F1: 0.88 |
2023-09-02 20:50:23,669 - FGO - INFO - Epoch  20 | Train Loss: -4.147 | Val Loss: -0.15 | Val F1: 0.88 |
2023-09-02 20:50:24,440 - FGO - INFO - Epoch  30 | Train Loss: -4.299 | Val Loss: -0.14 | Val F1: 0.88 |
2023-09-02 20:50:25,252 - FGO - INFO - Epoch  40 | Train Loss: -4.379 | Val Loss: -0.23 | Val F1: 0.92 |
2023-09-02 20:50:25,955 - FGO - INFO - Best Epoch:   6 | Train Loss: -3.690 | Val Loss: -0.20 | Val F1: 0.94 |
2023-09-02 20:50:25,955 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:25,959 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:50:25,959 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:25,989 - FGO - INFO - Train CM:
[[396   4]
 [ 23 303]]
2023-09-02 20:50:25,990 - FGO - INFO - Val CM:
[[34  0]
 [ 6 38]]
2023-09-02 20:50:25,990 - FGO - INFO - Test CM:
[[34  0]
 [ 6 38]]
2023-09-02 20:50:25,995 - FGO - INFO - test statistical parity: 0.07729468599033817
2023-09-02 20:50:25,996 - FGO - INFO - test equal opportunity: 0.15384615384615385
2023-09-02 20:50:25,997 - FGO - INFO - test micro f1: 0.9230769230769231
2023-09-02 20:50:25,997 - FGO - INFO - test macro f1: 0.9228740936058009
2023-09-02 20:50:25,997 - CV - INFO - fold time: 4.565256595611572s (0.07608760992685953m)
2023-09-02 20:50:25,997 - CV - INFO - ----- BEGINNING FOLD SET (012:6)----------------------------------------------------------
2023-09-02 20:50:25,999 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/012/6
2023-09-02 20:50:25,999 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:25,999 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:25,999 - FGO - INFO - 	done: False
2023-09-02 20:50:25,999 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:25,999 - FGO - INFO - 	h1: 64
2023-09-02 20:50:25,999 - FGO - INFO - 	h2: 32
2023-09-02 20:50:25,999 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:25,999 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:25,999 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:25,999 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:25,999 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:50:25,999 - FGO - INFO - 	theta: 50
2023-09-02 20:50:25,999 - FGO - INFO - 	clip: 5
2023-09-02 20:50:25,999 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:25,999 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:25,999 - FGO - INFO - Source Total: 717
2023-09-02 20:50:25,999 - FGO - INFO - Target Total: 87
2023-09-02 20:50:25,999 - FGO - INFO - Train Total: 717
2023-09-02 20:50:25,999 - FGO - INFO - Val Total:   87
2023-09-02 20:50:25,999 - FGO - INFO - Test Total:  87
2023-09-02 20:50:25,999 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:25,999 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:25,999 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:25,999 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:25,999 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:26,000 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:26,000 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:26,000 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:26,000 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:26,000 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:26,001 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:26,002 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:26,108 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:26,108 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:26,108 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:26,108 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:26,108 - FGO - INFO - N: 804
2023-09-02 20:50:26,108 - FGO - INFO - N_s: 717
2023-09-02 20:50:26,108 - FGO - INFO - N_t: 87
2023-09-02 20:50:26,112 - CV - INFO - Begin Pretrain
2023-09-02 20:50:26,112 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:26,115 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:50:26,140 - FGO - INFO - Epoch  10 | Train Loss: 0.585 | Val Loss: 0.57 | Val F1: 0.75 |
2023-09-02 20:50:26,164 - FGO - INFO - Epoch  20 | Train Loss: 0.271 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:50:26,188 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:50:26,213 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:50:26,237 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:50:26,261 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:50:26,285 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:50:26,310 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:50:26,334 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:50:26,358 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:50:26,358 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.107 | Val Loss: 0.08 | Val F1: 0.99 
2023-09-02 20:50:26,358 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:26,359 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:50:26,360 - CV - INFO - Begin OT Train
2023-09-02 20:50:26,360 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:26,458 - FGO - INFO - Epoch   0 | Train Loss: -3.355 | Val Loss: -0.39 | Val F1: 0.99 |
2023-09-02 20:50:27,412 - FGO - INFO - Epoch  10 | Train Loss: -4.000 | Val Loss: -0.45 | Val F1: 0.98 |
2023-09-02 20:50:28,275 - FGO - INFO - Epoch  20 | Train Loss: -4.139 | Val Loss: -0.43 | Val F1: 0.98 |
2023-09-02 20:50:29,113 - FGO - INFO - Epoch  30 | Train Loss: -4.300 | Val Loss: -0.48 | Val F1: 0.99 |
2023-09-02 20:50:29,887 - FGO - INFO - Epoch  40 | Train Loss: -4.374 | Val Loss: -0.50 | Val F1: 0.99 |
2023-09-02 20:50:30,565 - FGO - INFO - Best Epoch:  30 | Train Loss: -4.300 | Val Loss: -0.48 | Val F1: 0.99 |
2023-09-02 20:50:30,566 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:30,568 - CV - INFO - OT Train Complete, 30 epochs
2023-09-02 20:50:30,569 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:30,605 - FGO - INFO - Train CM:
[[376   9]
 [ 12 320]]
2023-09-02 20:50:30,606 - FGO - INFO - Val CM:
[[47  2]
 [ 0 38]]
2023-09-02 20:50:30,606 - FGO - INFO - Test CM:
[[47  2]
 [ 0 38]]
2023-09-02 20:50:30,610 - FGO - INFO - test statistical parity: 0.044303797468354444
2023-09-02 20:50:30,612 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:50:30,613 - FGO - INFO - test micro f1: 0.9770114942528736
2023-09-02 20:50:30,613 - FGO - INFO - test macro f1: 0.9767628205128205
2023-09-02 20:50:30,613 - CV - INFO - fold time: 4.615928649902344s (0.07693214416503906m)
2023-09-02 20:50:30,613 - CV - INFO - ----- BEGINNING FOLD SET (012:7)----------------------------------------------------------
2023-09-02 20:50:30,615 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/012/7
2023-09-02 20:50:30,615 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:30,615 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:30,615 - FGO - INFO - 	done: False
2023-09-02 20:50:30,615 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:30,615 - FGO - INFO - 	h1: 64
2023-09-02 20:50:30,615 - FGO - INFO - 	h2: 32
2023-09-02 20:50:30,615 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:30,615 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:30,615 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:30,615 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:30,615 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:50:30,615 - FGO - INFO - 	theta: 50
2023-09-02 20:50:30,615 - FGO - INFO - 	clip: 5
2023-09-02 20:50:30,615 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:30,615 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:30,615 - FGO - INFO - Source Total: 717
2023-09-02 20:50:30,615 - FGO - INFO - Target Total: 87
2023-09-02 20:50:30,615 - FGO - INFO - Train Total: 717
2023-09-02 20:50:30,615 - FGO - INFO - Val Total:   87
2023-09-02 20:50:30,615 - FGO - INFO - Test Total:  87
2023-09-02 20:50:30,615 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:30,615 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:30,615 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:30,615 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:30,615 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:30,616 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:30,616 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:30,616 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:30,616 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:30,616 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:30,617 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:30,618 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:30,724 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:30,724 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:30,724 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:30,724 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:30,724 - FGO - INFO - N: 804
2023-09-02 20:50:30,724 - FGO - INFO - N_s: 717
2023-09-02 20:50:30,724 - FGO - INFO - N_t: 87
2023-09-02 20:50:30,728 - CV - INFO - Begin Pretrain
2023-09-02 20:50:30,728 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:30,731 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:50:30,756 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.72 |
2023-09-02 20:50:30,780 - FGO - INFO - Epoch  20 | Train Loss: 0.265 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:50:30,805 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:50:30,829 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:50:30,853 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:50:30,878 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:50:30,902 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:50:30,927 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:50:30,951 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:50:30,976 - FGO - INFO - Epoch 100 | Train Loss: 0.077 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:50:30,976 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.169 | Val Loss: 0.14 | Val F1: 0.98 
2023-09-02 20:50:30,976 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:30,977 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:50:30,977 - CV - INFO - Begin OT Train
2023-09-02 20:50:30,977 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:31,134 - FGO - INFO - Epoch   0 | Train Loss: -3.295 | Val Loss: -0.26 | Val F1: 0.95 |
2023-09-02 20:50:32,130 - FGO - INFO - Epoch  10 | Train Loss: -3.994 | Val Loss: -0.33 | Val F1: 0.93 |
2023-09-02 20:50:33,038 - FGO - INFO - Epoch  20 | Train Loss: -4.167 | Val Loss: -0.32 | Val F1: 0.94 |
2023-09-02 20:50:33,915 - FGO - INFO - Epoch  30 | Train Loss: -4.328 | Val Loss: -0.39 | Val F1: 0.95 |
2023-09-02 20:50:34,698 - FGO - INFO - Epoch  40 | Train Loss: -4.416 | Val Loss: -0.41 | Val F1: 0.97 |
2023-09-02 20:50:35,391 - FGO - INFO - Best Epoch:   7 | Train Loss: -3.950 | Val Loss: -0.33 | Val F1: 0.97 |
2023-09-02 20:50:35,391 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:35,395 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:50:35,395 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:35,423 - FGO - INFO - Train CM:
[[378   9]
 [ 12 318]]
2023-09-02 20:50:35,424 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:50:35,424 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:50:35,429 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:50:35,431 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:50:35,432 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:50:35,432 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:50:35,432 - CV - INFO - fold time: 4.818853139877319s (0.08031421899795532m)
2023-09-02 20:50:35,432 - CV - INFO - ----- BEGINNING FOLD SET (012:8)----------------------------------------------------------
2023-09-02 20:50:35,434 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/012/8
2023-09-02 20:50:35,434 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:35,434 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:35,434 - FGO - INFO - 	done: False
2023-09-02 20:50:35,434 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:35,434 - FGO - INFO - 	h1: 64
2023-09-02 20:50:35,434 - FGO - INFO - 	h2: 32
2023-09-02 20:50:35,434 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:35,434 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:35,434 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:35,434 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:35,434 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:50:35,434 - FGO - INFO - 	theta: 50
2023-09-02 20:50:35,434 - FGO - INFO - 	clip: 5
2023-09-02 20:50:35,434 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:35,434 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:35,434 - FGO - INFO - Source Total: 734
2023-09-02 20:50:35,434 - FGO - INFO - Target Total: 70
2023-09-02 20:50:35,434 - FGO - INFO - Train Total: 734
2023-09-02 20:50:35,434 - FGO - INFO - Val Total:   70
2023-09-02 20:50:35,434 - FGO - INFO - Test Total:  70
2023-09-02 20:50:35,434 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:35,434 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:35,434 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:35,434 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:35,434 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:35,435 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:35,435 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:35,435 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:35,435 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:35,435 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:35,436 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:35,437 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:35,525 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:35,525 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:35,525 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:35,525 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:35,525 - FGO - INFO - N: 804
2023-09-02 20:50:35,525 - FGO - INFO - N_s: 734
2023-09-02 20:50:35,525 - FGO - INFO - N_t: 70
2023-09-02 20:50:35,529 - CV - INFO - Begin Pretrain
2023-09-02 20:50:35,529 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:35,532 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:50:35,557 - FGO - INFO - Epoch  10 | Train Loss: 0.564 | Val Loss: 0.59 | Val F1: 0.75 |
2023-09-02 20:50:35,582 - FGO - INFO - Epoch  20 | Train Loss: 0.257 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:50:35,607 - FGO - INFO - Epoch  30 | Train Loss: 0.132 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:50:35,631 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.13 | Val F1: 0.94 |
2023-09-02 20:50:35,656 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:50:35,681 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:50:35,706 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:50:35,730 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:50:35,755 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.16 | Val F1: 0.93 |
2023-09-02 20:50:35,780 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:50:35,780 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.108 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:50:35,780 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:35,781 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:50:35,781 - CV - INFO - Begin OT Train
2023-09-02 20:50:35,781 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:35,894 - FGO - INFO - Epoch   0 | Train Loss: -3.194 | Val Loss: -0.15 | Val F1: 0.94 |
2023-09-02 20:50:36,809 - FGO - INFO - Epoch  10 | Train Loss: -3.977 | Val Loss: -0.13 | Val F1: 0.94 |
2023-09-02 20:50:37,688 - FGO - INFO - Epoch  20 | Train Loss: -4.171 | Val Loss: -0.18 | Val F1: 0.94 |
2023-09-02 20:50:38,527 - FGO - INFO - Epoch  30 | Train Loss: -4.315 | Val Loss: -0.22 | Val F1: 0.96 |
2023-09-02 20:50:39,350 - FGO - INFO - Epoch  40 | Train Loss: -4.396 | Val Loss: -0.23 | Val F1: 0.96 |
2023-09-02 20:50:40,073 - FGO - INFO - Best Epoch:   7 | Train Loss: -3.825 | Val Loss: -0.15 | Val F1: 0.96 |
2023-09-02 20:50:40,073 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:40,077 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:50:40,077 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:40,106 - FGO - INFO - Train CM:
[[391   9]
 [ 11 323]]
2023-09-02 20:50:40,106 - FGO - INFO - Val CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:50:40,106 - FGO - INFO - Test CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:50:40,111 - FGO - INFO - test statistical parity: 0.10661268556005393
2023-09-02 20:50:40,112 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:50:40,113 - FGO - INFO - test micro f1: 0.9571428571428572
2023-09-02 20:50:40,114 - FGO - INFO - test macro f1: 0.9571341090018372
2023-09-02 20:50:40,114 - CV - INFO - fold time: 4.681832790374756s (0.07803054650624593m)
2023-09-02 20:50:40,114 - CV - INFO - ----- BEGINNING FOLD SET (012:9)----------------------------------------------------------
2023-09-02 20:50:40,115 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/012/9
2023-09-02 20:50:40,116 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:40,116 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:40,116 - FGO - INFO - 	done: False
2023-09-02 20:50:40,116 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:40,116 - FGO - INFO - 	h1: 64
2023-09-02 20:50:40,116 - FGO - INFO - 	h2: 32
2023-09-02 20:50:40,116 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:40,116 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:40,116 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:40,116 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:40,116 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:50:40,116 - FGO - INFO - 	theta: 50
2023-09-02 20:50:40,116 - FGO - INFO - 	clip: 5
2023-09-02 20:50:40,116 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:40,116 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:40,116 - FGO - INFO - Source Total: 725
2023-09-02 20:50:40,116 - FGO - INFO - Target Total: 79
2023-09-02 20:50:40,116 - FGO - INFO - Train Total: 725
2023-09-02 20:50:40,116 - FGO - INFO - Val Total:   79
2023-09-02 20:50:40,116 - FGO - INFO - Test Total:  79
2023-09-02 20:50:40,116 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:40,116 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:40,116 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:40,116 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:40,116 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:40,117 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:40,117 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:40,117 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:40,117 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:40,117 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:40,118 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:40,119 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:40,217 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:40,217 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:40,217 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:40,217 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:40,217 - FGO - INFO - N: 804
2023-09-02 20:50:40,217 - FGO - INFO - N_s: 725
2023-09-02 20:50:40,217 - FGO - INFO - N_t: 79
2023-09-02 20:50:40,221 - CV - INFO - Begin Pretrain
2023-09-02 20:50:40,221 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:40,224 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:50:40,253 - FGO - INFO - Epoch  10 | Train Loss: 0.579 | Val Loss: 0.59 | Val F1: 0.74 |
2023-09-02 20:50:40,279 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.30 | Val F1: 0.91 |
2023-09-02 20:50:40,303 - FGO - INFO - Epoch  30 | Train Loss: 0.128 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:50:40,328 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:50:40,352 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:50:40,377 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:50:40,401 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:50:40,426 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:50:40,450 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:50:40,474 - FGO - INFO - Epoch 100 | Train Loss: 0.065 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:50:40,474 - FGO - INFO - Best Epoch:  51 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.99 
2023-09-02 20:50:40,474 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:40,476 - CV - INFO - Pretrain Complete, 51 epochs
2023-09-02 20:50:40,476 - CV - INFO - Begin OT Train
2023-09-02 20:50:40,476 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:40,564 - FGO - INFO - Epoch   0 | Train Loss: -3.175 | Val Loss: -0.22 | Val F1: 0.97 |
2023-09-02 20:50:41,486 - FGO - INFO - Epoch  10 | Train Loss: -3.852 | Val Loss: 0.03 | Val F1: 0.83 |
2023-09-02 20:50:42,371 - FGO - INFO - Epoch  20 | Train Loss: -4.084 | Val Loss: -0.26 | Val F1: 0.91 |
2023-09-02 20:50:43,235 - FGO - INFO - Epoch  30 | Train Loss: -4.254 | Val Loss: -0.36 | Val F1: 0.97 |
2023-09-02 20:50:44,049 - FGO - INFO - Epoch  40 | Train Loss: -4.355 | Val Loss: -0.38 | Val F1: 0.97 |
2023-09-02 20:50:44,818 - FGO - INFO - Best Epoch:  31 | Train Loss: -4.267 | Val Loss: -0.35 | Val F1: 0.97 |
2023-09-02 20:50:44,818 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:44,821 - CV - INFO - OT Train Complete, 31 epochs
2023-09-02 20:50:44,821 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:44,845 - FGO - INFO - Train CM:
[[378   7]
 [ 13 327]]
2023-09-02 20:50:44,846 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:50:44,846 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:50:44,850 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:50:44,852 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:50:44,852 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:50:44,853 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:50:44,853 - CV - INFO - fold time: 4.73908257484436s (0.07898470958073935m)
2023-09-02 20:50:44,853 - CV - INFO - Mean Pretrain Epochs 45.5:
2023-09-02 20:50:44,853 - CV - INFO - Mean OT Train Epochs 15.2:
2023-09-02 20:50:44,853 - CV - INFO - Mean Val Macro F1 : 0.9540024130621008
2023-09-02 20:50:44,853 - CV - INFO - Mean Eval Stat : 0.9540024130621008 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:50:44,853 - CV - INFO - set time: 46.56584286689758s (0.7760973811149597m)
2023-09-02 20:50:44,853 - CV - INFO - script time so far: 542.8042531013489s (9.046737551689148m) (0.15077895919481912h)
2023-09-02 20:50:44,853 - CV - INFO - ===== BEGINNING OPTION SET (013)==========================================================
2023-09-02 20:50:44,853 - CV - INFO - 	done: False
2023-09-02 20:50:44,853 - CV - INFO - 	learning_rate: 0.005
2023-09-02 20:50:44,853 - CV - INFO - 	h1: 64
2023-09-02 20:50:44,853 - CV - INFO - 	h2: 32
2023-09-02 20:50:44,853 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:44,853 - CV - INFO - 	dropout: 0.0
2023-09-02 20:50:44,853 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:44,853 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:44,853 - CV - INFO - 	lambda: 0.03
2023-09-02 20:50:44,853 - CV - INFO - 	theta: 10
2023-09-02 20:50:44,853 - CV - INFO - 	clip: 5
2023-09-02 20:50:44,853 - CV - INFO - ----- BEGINNING FOLD SET (013:0)----------------------------------------------------------
2023-09-02 20:50:44,855 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/013/0
2023-09-02 20:50:44,855 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:44,855 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:44,855 - FGO - INFO - 	done: False
2023-09-02 20:50:44,855 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:44,855 - FGO - INFO - 	h1: 64
2023-09-02 20:50:44,855 - FGO - INFO - 	h2: 32
2023-09-02 20:50:44,855 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:44,855 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:44,855 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:44,855 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:44,855 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:50:44,855 - FGO - INFO - 	theta: 10
2023-09-02 20:50:44,855 - FGO - INFO - 	clip: 5
2023-09-02 20:50:44,855 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:44,855 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:44,855 - FGO - INFO - Source Total: 708
2023-09-02 20:50:44,855 - FGO - INFO - Target Total: 96
2023-09-02 20:50:44,855 - FGO - INFO - Train Total: 708
2023-09-02 20:50:44,855 - FGO - INFO - Val Total:   96
2023-09-02 20:50:44,855 - FGO - INFO - Test Total:  96
2023-09-02 20:50:44,855 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:44,855 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:44,855 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:44,855 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:44,855 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:44,856 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:44,856 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:44,856 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:44,856 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:44,856 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:44,857 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:44,858 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:44,974 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:44,974 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:44,974 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:44,974 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:44,974 - FGO - INFO - N: 804
2023-09-02 20:50:44,974 - FGO - INFO - N_s: 708
2023-09-02 20:50:44,974 - FGO - INFO - N_t: 96
2023-09-02 20:50:44,978 - CV - INFO - Begin Pretrain
2023-09-02 20:50:44,978 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:44,981 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:50:45,006 - FGO - INFO - Epoch  10 | Train Loss: 0.572 | Val Loss: 0.59 | Val F1: 0.62 |
2023-09-02 20:50:45,030 - FGO - INFO - Epoch  20 | Train Loss: 0.245 | Val Loss: 0.25 | Val F1: 0.93 |
2023-09-02 20:50:45,054 - FGO - INFO - Epoch  30 | Train Loss: 0.127 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:50:45,079 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:50:45,103 - FGO - INFO - Epoch  50 | Train Loss: 0.083 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:50:45,127 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:50:45,151 - FGO - INFO - Epoch  70 | Train Loss: 0.067 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:50:45,175 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:50:45,199 - FGO - INFO - Epoch  90 | Train Loss: 0.060 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:50:45,223 - FGO - INFO - Epoch 100 | Train Loss: 0.058 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:50:45,223 - FGO - INFO - Best Epoch:  39 | Train Loss: 0.095 | Val Loss: 0.10 | Val F1: 0.98 
2023-09-02 20:50:45,223 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:45,225 - CV - INFO - Pretrain Complete, 39 epochs
2023-09-02 20:50:45,225 - CV - INFO - Begin OT Train
2023-09-02 20:50:45,225 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:45,293 - FGO - INFO - Epoch   0 | Train Loss: -2.345 | Val Loss: -0.22 | Val F1: 0.97 |
2023-09-02 20:50:46,105 - FGO - INFO - Epoch  10 | Train Loss: -2.432 | Val Loss: -0.25 | Val F1: 0.96 |
2023-09-02 20:50:46,909 - FGO - INFO - Epoch  20 | Train Loss: -2.539 | Val Loss: -0.22 | Val F1: 0.97 |
2023-09-02 20:50:47,756 - FGO - INFO - Epoch  30 | Train Loss: -2.591 | Val Loss: -0.25 | Val F1: 0.97 |
2023-09-02 20:50:48,570 - FGO - INFO - Epoch  40 | Train Loss: -2.628 | Val Loss: -0.29 | Val F1: 0.97 |
2023-09-02 20:50:49,318 - FGO - INFO - Best Epoch:  25 | Train Loss: -2.560 | Val Loss: -0.27 | Val F1: 0.98 |
2023-09-02 20:50:49,318 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:49,321 - CV - INFO - OT Train Complete, 25 epochs
2023-09-02 20:50:49,321 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:49,345 - FGO - INFO - Train CM:
[[373   9]
 [  9 317]]
2023-09-02 20:50:49,346 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:50:49,346 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:50:49,351 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:50:49,352 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:50:49,353 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:50:49,354 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:50:49,354 - CV - INFO - fold time: 4.500558376312256s (0.07500930627187093m)
2023-09-02 20:50:49,354 - CV - INFO - ----- BEGINNING FOLD SET (013:1)----------------------------------------------------------
2023-09-02 20:50:49,355 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/013/1
2023-09-02 20:50:49,356 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:49,356 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:49,356 - FGO - INFO - 	done: False
2023-09-02 20:50:49,356 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:49,356 - FGO - INFO - 	h1: 64
2023-09-02 20:50:49,356 - FGO - INFO - 	h2: 32
2023-09-02 20:50:49,356 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:49,356 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:49,356 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:49,356 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:49,356 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:50:49,356 - FGO - INFO - 	theta: 10
2023-09-02 20:50:49,356 - FGO - INFO - 	clip: 5
2023-09-02 20:50:49,356 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:49,356 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:49,356 - FGO - INFO - Source Total: 727
2023-09-02 20:50:49,356 - FGO - INFO - Target Total: 77
2023-09-02 20:50:49,356 - FGO - INFO - Train Total: 727
2023-09-02 20:50:49,356 - FGO - INFO - Val Total:   77
2023-09-02 20:50:49,356 - FGO - INFO - Test Total:  77
2023-09-02 20:50:49,356 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:49,356 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:49,356 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:49,356 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:49,356 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:49,357 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:49,357 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:49,357 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:49,357 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:49,357 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:49,358 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:49,359 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:49,454 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:49,455 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:49,455 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:49,455 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:49,455 - FGO - INFO - N: 804
2023-09-02 20:50:49,455 - FGO - INFO - N_s: 727
2023-09-02 20:50:49,455 - FGO - INFO - N_t: 77
2023-09-02 20:50:49,458 - CV - INFO - Begin Pretrain
2023-09-02 20:50:49,458 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:49,461 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:50:49,486 - FGO - INFO - Epoch  10 | Train Loss: 0.577 | Val Loss: 0.61 | Val F1: 0.66 |
2023-09-02 20:50:49,511 - FGO - INFO - Epoch  20 | Train Loss: 0.255 | Val Loss: 0.38 | Val F1: 0.83 |
2023-09-02 20:50:49,536 - FGO - INFO - Epoch  30 | Train Loss: 0.122 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:50:49,561 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.20 | Val F1: 0.89 |
2023-09-02 20:50:49,585 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.87 |
2023-09-02 20:50:49,610 - FGO - INFO - Epoch  60 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.89 |
2023-09-02 20:50:49,634 - FGO - INFO - Epoch  70 | Train Loss: 0.063 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:50:49,659 - FGO - INFO - Epoch  80 | Train Loss: 0.060 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:50:49,683 - FGO - INFO - Epoch  90 | Train Loss: 0.057 | Val Loss: 0.20 | Val F1: 0.90 |
2023-09-02 20:50:49,708 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.20 | Val F1: 0.92 |
2023-09-02 20:50:49,708 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.097 | Val Loss: 0.18 | Val F1: 0.93 
2023-09-02 20:50:49,708 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:49,709 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:50:49,709 - CV - INFO - Begin OT Train
2023-09-02 20:50:49,709 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:49,815 - FGO - INFO - Epoch   0 | Train Loss: -2.267 | Val Loss: -0.02 | Val F1: 0.89 |
2023-09-02 20:50:50,567 - FGO - INFO - Epoch  10 | Train Loss: -2.370 | Val Loss: 0.22 | Val F1: 0.87 |
2023-09-02 20:50:51,344 - FGO - INFO - Epoch  20 | Train Loss: -2.541 | Val Loss: -0.07 | Val F1: 0.90 |
2023-09-02 20:50:52,192 - FGO - INFO - Epoch  30 | Train Loss: -2.615 | Val Loss: -0.07 | Val F1: 0.89 |
2023-09-02 20:50:52,996 - FGO - INFO - Epoch  40 | Train Loss: -2.662 | Val Loss: -0.05 | Val F1: 0.93 |
2023-09-02 20:50:53,720 - FGO - INFO - Best Epoch:   7 | Train Loss: -2.422 | Val Loss: -0.02 | Val F1: 0.93 |
2023-09-02 20:50:53,720 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:53,723 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:50:53,724 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:53,747 - FGO - INFO - Train CM:
[[380  10]
 [  7 330]]
2023-09-02 20:50:53,747 - FGO - INFO - Val CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:50:53,747 - FGO - INFO - Test CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:50:53,752 - FGO - INFO - test statistical parity: 0.36282051282051286
2023-09-02 20:50:53,753 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:50:53,754 - FGO - INFO - test micro f1: 0.935064935064935
2023-09-02 20:50:53,754 - FGO - INFO - test macro f1: 0.9328449328449329
2023-09-02 20:50:53,754 - CV - INFO - fold time: 4.400508642196655s (0.07334181070327758m)
2023-09-02 20:50:53,754 - CV - INFO - ----- BEGINNING FOLD SET (013:2)----------------------------------------------------------
2023-09-02 20:50:53,756 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/013/2
2023-09-02 20:50:53,756 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:53,756 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:53,756 - FGO - INFO - 	done: False
2023-09-02 20:50:53,756 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:53,756 - FGO - INFO - 	h1: 64
2023-09-02 20:50:53,756 - FGO - INFO - 	h2: 32
2023-09-02 20:50:53,756 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:53,756 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:53,756 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:53,756 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:53,756 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:50:53,756 - FGO - INFO - 	theta: 10
2023-09-02 20:50:53,756 - FGO - INFO - 	clip: 5
2023-09-02 20:50:53,756 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:53,756 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:53,756 - FGO - INFO - Source Total: 721
2023-09-02 20:50:53,756 - FGO - INFO - Target Total: 83
2023-09-02 20:50:53,756 - FGO - INFO - Train Total: 721
2023-09-02 20:50:53,756 - FGO - INFO - Val Total:   83
2023-09-02 20:50:53,756 - FGO - INFO - Test Total:  83
2023-09-02 20:50:53,756 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:53,756 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:53,756 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:53,756 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:53,756 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:53,757 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:53,757 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:53,757 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:53,757 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:53,757 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:53,758 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:53,759 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:53,862 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:53,862 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:53,862 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:53,862 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:53,862 - FGO - INFO - N: 804
2023-09-02 20:50:53,862 - FGO - INFO - N_s: 721
2023-09-02 20:50:53,862 - FGO - INFO - N_t: 83
2023-09-02 20:50:53,865 - CV - INFO - Begin Pretrain
2023-09-02 20:50:53,865 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:53,869 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:50:53,893 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.76 |
2023-09-02 20:50:53,918 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.33 | Val F1: 0.88 |
2023-09-02 20:50:53,942 - FGO - INFO - Epoch  30 | Train Loss: 0.120 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:50:53,967 - FGO - INFO - Epoch  40 | Train Loss: 0.083 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:50:53,991 - FGO - INFO - Epoch  50 | Train Loss: 0.071 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:50:54,015 - FGO - INFO - Epoch  60 | Train Loss: 0.062 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:50:54,040 - FGO - INFO - Epoch  70 | Train Loss: 0.059 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:50:54,064 - FGO - INFO - Epoch  80 | Train Loss: 0.055 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:50:54,089 - FGO - INFO - Epoch  90 | Train Loss: 0.053 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:50:54,113 - FGO - INFO - Epoch 100 | Train Loss: 0.051 | Val Loss: 0.26 | Val F1: 0.91 |
2023-09-02 20:50:54,113 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.063 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:50:54,113 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:54,114 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:50:54,114 - CV - INFO - Begin OT Train
2023-09-02 20:50:54,114 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:54,182 - FGO - INFO - Epoch   0 | Train Loss: -2.243 | Val Loss: -0.01 | Val F1: 0.90 |
2023-09-02 20:50:54,986 - FGO - INFO - Epoch  10 | Train Loss: -2.440 | Val Loss: 0.33 | Val F1: 0.84 |
2023-09-02 20:50:55,796 - FGO - INFO - Epoch  20 | Train Loss: -2.578 | Val Loss: -0.04 | Val F1: 0.90 |
2023-09-02 20:50:56,542 - FGO - INFO - Epoch  30 | Train Loss: -2.641 | Val Loss: 0.03 | Val F1: 0.91 |
2023-09-02 20:50:57,399 - FGO - INFO - Epoch  40 | Train Loss: -2.678 | Val Loss: 0.08 | Val F1: 0.91 |
2023-09-02 20:50:58,142 - FGO - INFO - Best Epoch:  15 | Train Loss: -2.545 | Val Loss: 0.01 | Val F1: 0.93 |
2023-09-02 20:50:58,142 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:58,150 - CV - INFO - OT Train Complete, 15 epochs
2023-09-02 20:50:58,150 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:50:58,178 - FGO - INFO - Train CM:
[[379   5]
 [  8 329]]
2023-09-02 20:50:58,178 - FGO - INFO - Val CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:50:58,178 - FGO - INFO - Test CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:50:58,184 - FGO - INFO - test statistical parity: 0.10563380281690143
2023-09-02 20:50:58,185 - FGO - INFO - test equal opportunity: 0.09259259259259256
2023-09-02 20:50:58,186 - FGO - INFO - test micro f1: 0.9156626506024096
2023-09-02 20:50:58,186 - FGO - INFO - test macro f1: 0.9124076586763153
2023-09-02 20:50:58,186 - CV - INFO - fold time: 4.431927919387817s (0.07386546532313029m)
2023-09-02 20:50:58,186 - CV - INFO - ----- BEGINNING FOLD SET (013:3)----------------------------------------------------------
2023-09-02 20:50:58,188 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/013/3
2023-09-02 20:50:58,188 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:50:58,188 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:50:58,188 - FGO - INFO - 	done: False
2023-09-02 20:50:58,188 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:50:58,188 - FGO - INFO - 	h1: 64
2023-09-02 20:50:58,188 - FGO - INFO - 	h2: 32
2023-09-02 20:50:58,188 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:50:58,188 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:50:58,188 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:50:58,188 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:50:58,188 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:50:58,188 - FGO - INFO - 	theta: 10
2023-09-02 20:50:58,188 - FGO - INFO - 	clip: 5
2023-09-02 20:50:58,188 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:50:58,188 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:50:58,188 - FGO - INFO - Source Total: 729
2023-09-02 20:50:58,188 - FGO - INFO - Target Total: 75
2023-09-02 20:50:58,188 - FGO - INFO - Train Total: 729
2023-09-02 20:50:58,188 - FGO - INFO - Val Total:   75
2023-09-02 20:50:58,188 - FGO - INFO - Test Total:  75
2023-09-02 20:50:58,188 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:50:58,188 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:50:58,188 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:50:58,188 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:50:58,188 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:50:58,189 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:50:58,189 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:50:58,189 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:50:58,189 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:50:58,189 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:50:58,190 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:50:58,191 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:50:58,285 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:50:58,285 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:50:58,285 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:50:58,285 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:50:58,285 - FGO - INFO - N: 804
2023-09-02 20:50:58,285 - FGO - INFO - N_s: 729
2023-09-02 20:50:58,285 - FGO - INFO - N_t: 75
2023-09-02 20:50:58,288 - CV - INFO - Begin Pretrain
2023-09-02 20:50:58,288 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:50:58,292 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:50:58,316 - FGO - INFO - Epoch  10 | Train Loss: 0.580 | Val Loss: 0.56 | Val F1: 0.75 |
2023-09-02 20:50:58,341 - FGO - INFO - Epoch  20 | Train Loss: 0.266 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:50:58,366 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.07 | Val F1: 0.99 |
2023-09-02 20:50:58,390 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:50:58,415 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:50:58,439 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:50:58,464 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:50:58,488 - FGO - INFO - Epoch  80 | Train Loss: 0.076 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:50:58,513 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:50:58,537 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:50:58,537 - FGO - INFO - Best Epoch:  24 | Train Loss: 0.189 | Val Loss: 0.10 | Val F1: 1.00 
2023-09-02 20:50:58,537 - FGO - INFO - Setting model to best state.
2023-09-02 20:50:58,539 - CV - INFO - Pretrain Complete, 24 epochs
2023-09-02 20:50:58,539 - CV - INFO - Begin OT Train
2023-09-02 20:50:58,539 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:50:58,626 - FGO - INFO - Epoch   0 | Train Loss: -2.244 | Val Loss: -0.21 | Val F1: 0.97 |
2023-09-02 20:50:59,448 - FGO - INFO - Epoch  10 | Train Loss: -2.473 | Val Loss: -0.16 | Val F1: 0.96 |
2023-09-02 20:51:00,304 - FGO - INFO - Epoch  20 | Train Loss: -2.594 | Val Loss: -0.24 | Val F1: 0.99 |
2023-09-02 20:51:01,131 - FGO - INFO - Epoch  30 | Train Loss: -2.635 | Val Loss: -0.25 | Val F1: 0.99 |
2023-09-02 20:51:01,897 - FGO - INFO - Epoch  40 | Train Loss: -2.660 | Val Loss: -0.26 | Val F1: 0.99 |
2023-09-02 20:51:02,630 - FGO - INFO - Best Epoch:  12 | Train Loss: -2.514 | Val Loss: -0.24 | Val F1: 0.99 |
2023-09-02 20:51:02,630 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:02,633 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:51:02,633 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:02,659 - FGO - INFO - Train CM:
[[388   8]
 [ 12 321]]
2023-09-02 20:51:02,659 - FGO - INFO - Val CM:
[[37  1]
 [ 0 37]]
2023-09-02 20:51:02,659 - FGO - INFO - Test CM:
[[37  1]
 [ 0 37]]
2023-09-02 20:51:02,664 - FGO - INFO - test statistical parity: 0.008196721311475419
2023-09-02 20:51:02,665 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:51:02,666 - FGO - INFO - test micro f1: 0.9866666666666668
2023-09-02 20:51:02,667 - FGO - INFO - test macro f1: 0.9866666666666666
2023-09-02 20:51:02,667 - CV - INFO - fold time: 4.48050856590271s (0.07467514276504517m)
2023-09-02 20:51:02,667 - CV - INFO - ----- BEGINNING FOLD SET (013:4)----------------------------------------------------------
2023-09-02 20:51:02,668 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/013/4
2023-09-02 20:51:02,669 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:02,669 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:02,669 - FGO - INFO - 	done: False
2023-09-02 20:51:02,669 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:02,669 - FGO - INFO - 	h1: 64
2023-09-02 20:51:02,669 - FGO - INFO - 	h2: 32
2023-09-02 20:51:02,669 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:02,669 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:02,669 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:02,669 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:02,669 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:02,669 - FGO - INFO - 	theta: 10
2023-09-02 20:51:02,669 - FGO - INFO - 	clip: 5
2023-09-02 20:51:02,669 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:02,669 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:02,669 - FGO - INFO - Source Total: 732
2023-09-02 20:51:02,669 - FGO - INFO - Target Total: 72
2023-09-02 20:51:02,669 - FGO - INFO - Train Total: 732
2023-09-02 20:51:02,669 - FGO - INFO - Val Total:   72
2023-09-02 20:51:02,669 - FGO - INFO - Test Total:  72
2023-09-02 20:51:02,669 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:02,669 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:02,669 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:02,669 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:02,669 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:02,670 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:02,670 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:02,670 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:02,670 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:02,670 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:02,671 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:02,672 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:02,762 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:02,762 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:02,762 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:02,762 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:02,762 - FGO - INFO - N: 804
2023-09-02 20:51:02,762 - FGO - INFO - N_s: 732
2023-09-02 20:51:02,762 - FGO - INFO - N_t: 72
2023-09-02 20:51:02,766 - CV - INFO - Begin Pretrain
2023-09-02 20:51:02,766 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:02,769 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:51:02,794 - FGO - INFO - Epoch  10 | Train Loss: 0.578 | Val Loss: 0.58 | Val F1: 0.78 |
2023-09-02 20:51:02,819 - FGO - INFO - Epoch  20 | Train Loss: 0.258 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:51:02,844 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:02,868 - FGO - INFO - Epoch  40 | Train Loss: 0.095 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:02,893 - FGO - INFO - Epoch  50 | Train Loss: 0.084 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:02,917 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:51:02,942 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:51:02,966 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:51:02,991 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:51:03,015 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:51:03,015 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.99 
2023-09-02 20:51:03,015 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:03,017 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:51:03,017 - CV - INFO - Begin OT Train
2023-09-02 20:51:03,017 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:03,149 - FGO - INFO - Epoch   0 | Train Loss: -2.423 | Val Loss: -0.20 | Val F1: 0.99 |
2023-09-02 20:51:03,969 - FGO - INFO - Epoch  10 | Train Loss: -2.570 | Val Loss: -0.19 | Val F1: 0.99 |
2023-09-02 20:51:04,753 - FGO - INFO - Epoch  20 | Train Loss: -2.632 | Val Loss: -0.20 | Val F1: 0.99 |
2023-09-02 20:51:05,537 - FGO - INFO - Epoch  30 | Train Loss: -2.665 | Val Loss: -0.20 | Val F1: 0.99 |
2023-09-02 20:51:06,275 - FGO - INFO - Epoch  40 | Train Loss: -2.691 | Val Loss: -0.20 | Val F1: 0.99 |
2023-09-02 20:51:07,019 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.537 | Val Loss: -0.21 | Val F1: 0.99 |
2023-09-02 20:51:07,019 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:07,022 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:51:07,022 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:07,048 - FGO - INFO - Train CM:
[[388   9]
 [ 11 324]]
2023-09-02 20:51:07,049 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:51:07,049 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:51:07,055 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:51:07,056 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:51:07,057 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:51:07,057 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:51:07,057 - CV - INFO - fold time: 4.390391826629639s (0.07317319711049398m)
2023-09-02 20:51:07,057 - CV - INFO - ----- BEGINNING FOLD SET (013:5)----------------------------------------------------------
2023-09-02 20:51:07,059 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/013/5
2023-09-02 20:51:07,059 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:07,059 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:07,059 - FGO - INFO - 	done: False
2023-09-02 20:51:07,059 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:07,059 - FGO - INFO - 	h1: 64
2023-09-02 20:51:07,059 - FGO - INFO - 	h2: 32
2023-09-02 20:51:07,059 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:07,059 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:07,059 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:07,059 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:07,059 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:07,059 - FGO - INFO - 	theta: 10
2023-09-02 20:51:07,059 - FGO - INFO - 	clip: 5
2023-09-02 20:51:07,059 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:07,059 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:07,059 - FGO - INFO - Source Total: 726
2023-09-02 20:51:07,059 - FGO - INFO - Target Total: 78
2023-09-02 20:51:07,059 - FGO - INFO - Train Total: 726
2023-09-02 20:51:07,059 - FGO - INFO - Val Total:   78
2023-09-02 20:51:07,059 - FGO - INFO - Test Total:  78
2023-09-02 20:51:07,059 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:07,059 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:07,059 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:07,059 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:07,059 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:07,060 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:07,060 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:07,060 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:07,060 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:07,060 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:07,061 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:07,062 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:07,159 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:07,159 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:07,160 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:07,160 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:07,160 - FGO - INFO - N: 804
2023-09-02 20:51:07,160 - FGO - INFO - N_s: 726
2023-09-02 20:51:07,160 - FGO - INFO - N_t: 78
2023-09-02 20:51:07,163 - CV - INFO - Begin Pretrain
2023-09-02 20:51:07,163 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:07,166 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:51:07,191 - FGO - INFO - Epoch  10 | Train Loss: 0.582 | Val Loss: 0.61 | Val F1: 0.72 |
2023-09-02 20:51:07,216 - FGO - INFO - Epoch  20 | Train Loss: 0.268 | Val Loss: 0.31 | Val F1: 0.87 |
2023-09-02 20:51:07,240 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.25 | Val F1: 0.92 |
2023-09-02 20:51:07,264 - FGO - INFO - Epoch  40 | Train Loss: 0.100 | Val Loss: 0.22 | Val F1: 0.92 |
2023-09-02 20:51:07,289 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:51:07,313 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:51:07,337 - FGO - INFO - Epoch  70 | Train Loss: 0.072 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:51:07,362 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:51:07,386 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:51:07,410 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:51:07,410 - FGO - INFO - Best Epoch:  77 | Train Loss: 0.071 | Val Loss: 0.10 | Val F1: 0.96 
2023-09-02 20:51:07,410 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:07,412 - CV - INFO - Pretrain Complete, 77 epochs
2023-09-02 20:51:07,412 - CV - INFO - Begin OT Train
2023-09-02 20:51:07,412 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:07,480 - FGO - INFO - Epoch   0 | Train Loss: -2.167 | Val Loss: -0.17 | Val F1: 0.96 |
2023-09-02 20:51:08,236 - FGO - INFO - Epoch  10 | Train Loss: -2.433 | Val Loss: 0.13 | Val F1: 0.90 |
2023-09-02 20:51:09,022 - FGO - INFO - Epoch  20 | Train Loss: -2.598 | Val Loss: -0.12 | Val F1: 0.92 |
2023-09-02 20:51:09,762 - FGO - INFO - Epoch  30 | Train Loss: -2.631 | Val Loss: -0.13 | Val F1: 0.92 |
2023-09-02 20:51:10,578 - FGO - INFO - Epoch  40 | Train Loss: -2.658 | Val Loss: -0.07 | Val F1: 0.91 |
2023-09-02 20:51:11,271 - FGO - INFO - Best Epoch:   7 | Train Loss: -2.464 | Val Loss: -0.15 | Val F1: 0.94 |
2023-09-02 20:51:11,271 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:11,274 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:51:11,274 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:11,300 - FGO - INFO - Train CM:
[[392   8]
 [ 12 314]]
2023-09-02 20:51:11,301 - FGO - INFO - Val CM:
[[31  3]
 [ 4 40]]
2023-09-02 20:51:11,301 - FGO - INFO - Test CM:
[[31  3]
 [ 4 40]]
2023-09-02 20:51:11,307 - FGO - INFO - test statistical parity: 0.13043478260869557
2023-09-02 20:51:11,308 - FGO - INFO - test equal opportunity: 0.10256410256410253
2023-09-02 20:51:11,309 - FGO - INFO - test micro f1: 0.9102564102564102
2023-09-02 20:51:11,310 - FGO - INFO - test macro f1: 0.9090454772613693
2023-09-02 20:51:11,310 - CV - INFO - fold time: 4.252224922180176s (0.07087041536966959m)
2023-09-02 20:51:11,310 - CV - INFO - ----- BEGINNING FOLD SET (013:6)----------------------------------------------------------
2023-09-02 20:51:11,311 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/013/6
2023-09-02 20:51:11,311 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:11,311 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:11,311 - FGO - INFO - 	done: False
2023-09-02 20:51:11,311 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:11,311 - FGO - INFO - 	h1: 64
2023-09-02 20:51:11,311 - FGO - INFO - 	h2: 32
2023-09-02 20:51:11,311 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:11,311 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:11,311 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:11,311 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:11,311 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:11,311 - FGO - INFO - 	theta: 10
2023-09-02 20:51:11,311 - FGO - INFO - 	clip: 5
2023-09-02 20:51:11,311 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:11,311 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:11,311 - FGO - INFO - Source Total: 717
2023-09-02 20:51:11,311 - FGO - INFO - Target Total: 87
2023-09-02 20:51:11,312 - FGO - INFO - Train Total: 717
2023-09-02 20:51:11,312 - FGO - INFO - Val Total:   87
2023-09-02 20:51:11,312 - FGO - INFO - Test Total:  87
2023-09-02 20:51:11,312 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:11,312 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:11,312 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:11,312 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:11,312 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:11,312 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:11,312 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:11,312 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:11,312 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:11,312 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:11,313 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:11,314 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:11,421 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:11,421 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:11,421 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:11,421 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:11,421 - FGO - INFO - N: 804
2023-09-02 20:51:11,421 - FGO - INFO - N_s: 717
2023-09-02 20:51:11,421 - FGO - INFO - N_t: 87
2023-09-02 20:51:11,425 - CV - INFO - Begin Pretrain
2023-09-02 20:51:11,425 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:11,428 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:51:11,453 - FGO - INFO - Epoch  10 | Train Loss: 0.585 | Val Loss: 0.57 | Val F1: 0.75 |
2023-09-02 20:51:11,477 - FGO - INFO - Epoch  20 | Train Loss: 0.271 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:51:11,502 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:51:11,526 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:51:11,550 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:51:11,575 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:51:11,599 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:51:11,623 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:51:11,648 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:51:11,672 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:51:11,672 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.107 | Val Loss: 0.08 | Val F1: 0.99 
2023-09-02 20:51:11,672 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:11,674 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:51:11,674 - CV - INFO - Begin OT Train
2023-09-02 20:51:11,674 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:11,770 - FGO - INFO - Epoch   0 | Train Loss: -2.403 | Val Loss: -0.27 | Val F1: 0.99 |
2023-09-02 20:51:12,623 - FGO - INFO - Epoch  10 | Train Loss: -2.476 | Val Loss: -0.26 | Val F1: 0.98 |
2023-09-02 20:51:13,390 - FGO - INFO - Epoch  20 | Train Loss: -2.575 | Val Loss: -0.29 | Val F1: 0.99 |
2023-09-02 20:51:14,202 - FGO - INFO - Epoch  30 | Train Loss: -2.614 | Val Loss: -0.29 | Val F1: 0.98 |
2023-09-02 20:51:14,968 - FGO - INFO - Epoch  40 | Train Loss: -2.638 | Val Loss: -0.32 | Val F1: 0.99 |
2023-09-02 20:51:15,669 - FGO - INFO - Best Epoch:  39 | Train Loss: -2.637 | Val Loss: -0.32 | Val F1: 1.00 |
2023-09-02 20:51:15,670 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:15,672 - CV - INFO - OT Train Complete, 39 epochs
2023-09-02 20:51:15,673 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:15,700 - FGO - INFO - Train CM:
[[376   9]
 [ 13 319]]
2023-09-02 20:51:15,700 - FGO - INFO - Val CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:51:15,701 - FGO - INFO - Test CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:51:15,706 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 20:51:15,707 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:51:15,708 - FGO - INFO - test micro f1: 0.9885057471264368
2023-09-02 20:51:15,709 - FGO - INFO - test macro f1: 0.9883518543312357
2023-09-02 20:51:15,709 - CV - INFO - fold time: 4.398939847946167s (0.07331566413243612m)
2023-09-02 20:51:15,709 - CV - INFO - ----- BEGINNING FOLD SET (013:7)----------------------------------------------------------
2023-09-02 20:51:15,710 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/013/7
2023-09-02 20:51:15,710 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:15,710 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:15,710 - FGO - INFO - 	done: False
2023-09-02 20:51:15,710 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:15,710 - FGO - INFO - 	h1: 64
2023-09-02 20:51:15,710 - FGO - INFO - 	h2: 32
2023-09-02 20:51:15,710 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:15,710 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:15,710 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:15,710 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:15,710 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:15,710 - FGO - INFO - 	theta: 10
2023-09-02 20:51:15,710 - FGO - INFO - 	clip: 5
2023-09-02 20:51:15,710 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:15,710 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:15,711 - FGO - INFO - Source Total: 717
2023-09-02 20:51:15,711 - FGO - INFO - Target Total: 87
2023-09-02 20:51:15,711 - FGO - INFO - Train Total: 717
2023-09-02 20:51:15,711 - FGO - INFO - Val Total:   87
2023-09-02 20:51:15,711 - FGO - INFO - Test Total:  87
2023-09-02 20:51:15,711 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:15,711 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:15,711 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:15,711 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:15,711 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:15,711 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:15,711 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:15,711 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:15,711 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:15,711 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:15,712 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:15,714 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:15,819 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:15,819 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:15,819 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:15,819 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:15,819 - FGO - INFO - N: 804
2023-09-02 20:51:15,819 - FGO - INFO - N_s: 717
2023-09-02 20:51:15,819 - FGO - INFO - N_t: 87
2023-09-02 20:51:15,823 - CV - INFO - Begin Pretrain
2023-09-02 20:51:15,823 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:15,826 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:51:15,851 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.72 |
2023-09-02 20:51:15,875 - FGO - INFO - Epoch  20 | Train Loss: 0.265 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:51:15,900 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:15,924 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:51:15,949 - FGO - INFO - Epoch  50 | Train Loss: 0.086 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:15,973 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:51:15,998 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:51:16,022 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:51:16,047 - FGO - INFO - Epoch  90 | Train Loss: 0.070 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:51:16,071 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:51:16,071 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.169 | Val Loss: 0.14 | Val F1: 0.98 
2023-09-02 20:51:16,071 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:16,073 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:51:16,073 - CV - INFO - Begin OT Train
2023-09-02 20:51:16,073 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:16,141 - FGO - INFO - Epoch   0 | Train Loss: -2.403 | Val Loss: -0.15 | Val F1: 0.95 |
2023-09-02 20:51:16,903 - FGO - INFO - Epoch  10 | Train Loss: -2.466 | Val Loss: -0.15 | Val F1: 0.94 |
2023-09-02 20:51:17,790 - FGO - INFO - Epoch  20 | Train Loss: -2.566 | Val Loss: -0.16 | Val F1: 0.95 |
2023-09-02 20:51:18,573 - FGO - INFO - Epoch  30 | Train Loss: -2.605 | Val Loss: -0.15 | Val F1: 0.97 |
2023-09-02 20:51:19,336 - FGO - INFO - Epoch  40 | Train Loss: -2.644 | Val Loss: -0.14 | Val F1: 0.95 |
2023-09-02 20:51:20,040 - FGO - INFO - Best Epoch:  42 | Train Loss: -2.647 | Val Loss: -0.15 | Val F1: 0.97 |
2023-09-02 20:51:20,040 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:20,043 - CV - INFO - OT Train Complete, 42 epochs
2023-09-02 20:51:20,043 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:20,068 - FGO - INFO - Train CM:
[[378   9]
 [ 12 318]]
2023-09-02 20:51:20,068 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:51:20,069 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:51:20,074 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:51:20,075 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:51:20,076 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:51:20,076 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:51:20,076 - CV - INFO - fold time: 4.367766857147217s (0.07279611428578694m)
2023-09-02 20:51:20,076 - CV - INFO - ----- BEGINNING FOLD SET (013:8)----------------------------------------------------------
2023-09-02 20:51:20,078 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/013/8
2023-09-02 20:51:20,078 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:20,078 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:20,078 - FGO - INFO - 	done: False
2023-09-02 20:51:20,078 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:20,078 - FGO - INFO - 	h1: 64
2023-09-02 20:51:20,078 - FGO - INFO - 	h2: 32
2023-09-02 20:51:20,078 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:20,078 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:20,078 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:20,078 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:20,078 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:20,078 - FGO - INFO - 	theta: 10
2023-09-02 20:51:20,078 - FGO - INFO - 	clip: 5
2023-09-02 20:51:20,078 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:20,078 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:20,078 - FGO - INFO - Source Total: 734
2023-09-02 20:51:20,078 - FGO - INFO - Target Total: 70
2023-09-02 20:51:20,078 - FGO - INFO - Train Total: 734
2023-09-02 20:51:20,078 - FGO - INFO - Val Total:   70
2023-09-02 20:51:20,078 - FGO - INFO - Test Total:  70
2023-09-02 20:51:20,078 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:20,078 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:20,078 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:20,078 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:20,078 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:20,079 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:20,079 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:20,079 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:20,079 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:20,079 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:20,080 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:20,081 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:20,169 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:20,169 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:20,169 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:20,169 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:20,169 - FGO - INFO - N: 804
2023-09-02 20:51:20,169 - FGO - INFO - N_s: 734
2023-09-02 20:51:20,169 - FGO - INFO - N_t: 70
2023-09-02 20:51:20,173 - CV - INFO - Begin Pretrain
2023-09-02 20:51:20,173 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:20,176 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:51:20,201 - FGO - INFO - Epoch  10 | Train Loss: 0.564 | Val Loss: 0.59 | Val F1: 0.75 |
2023-09-02 20:51:20,226 - FGO - INFO - Epoch  20 | Train Loss: 0.257 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:51:20,251 - FGO - INFO - Epoch  30 | Train Loss: 0.132 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:51:20,276 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.13 | Val F1: 0.94 |
2023-09-02 20:51:20,300 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:51:20,325 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:51:20,349 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:51:20,374 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:51:20,399 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.16 | Val F1: 0.93 |
2023-09-02 20:51:20,423 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:51:20,423 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.108 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:51:20,423 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:20,425 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:51:20,425 - CV - INFO - Begin OT Train
2023-09-02 20:51:20,425 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:20,520 - FGO - INFO - Epoch   0 | Train Loss: -2.324 | Val Loss: -0.06 | Val F1: 0.93 |
2023-09-02 20:51:21,348 - FGO - INFO - Epoch  10 | Train Loss: -2.434 | Val Loss: 0.08 | Val F1: 0.94 |
2023-09-02 20:51:22,184 - FGO - INFO - Epoch  20 | Train Loss: -2.591 | Val Loss: -0.01 | Val F1: 0.94 |
2023-09-02 20:51:22,956 - FGO - INFO - Epoch  30 | Train Loss: -2.625 | Val Loss: -0.01 | Val F1: 0.94 |
2023-09-02 20:51:23,771 - FGO - INFO - Epoch  40 | Train Loss: -2.661 | Val Loss: 0.03 | Val F1: 0.96 |
2023-09-02 20:51:24,495 - FGO - INFO - Best Epoch:  17 | Train Loss: -2.560 | Val Loss: 0.00 | Val F1: 0.96 |
2023-09-02 20:51:24,495 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:24,499 - CV - INFO - OT Train Complete, 17 epochs
2023-09-02 20:51:24,499 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:24,541 - FGO - INFO - Train CM:
[[391   9]
 [ 11 323]]
2023-09-02 20:51:24,541 - FGO - INFO - Val CM:
[[33  1]
 [ 3 33]]
2023-09-02 20:51:24,541 - FGO - INFO - Test CM:
[[33  1]
 [ 3 33]]
2023-09-02 20:51:24,546 - FGO - INFO - test statistical parity: 0.1241565452091768
2023-09-02 20:51:24,547 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:51:24,548 - FGO - INFO - test micro f1: 0.9428571428571428
2023-09-02 20:51:24,548 - FGO - INFO - test macro f1: 0.9428571428571428
2023-09-02 20:51:24,548 - CV - INFO - fold time: 4.471941232681274s (0.07453235387802123m)
2023-09-02 20:51:24,548 - CV - INFO - ----- BEGINNING FOLD SET (013:9)----------------------------------------------------------
2023-09-02 20:51:24,550 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/013/9
2023-09-02 20:51:24,550 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:24,550 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:24,550 - FGO - INFO - 	done: False
2023-09-02 20:51:24,550 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:24,550 - FGO - INFO - 	h1: 64
2023-09-02 20:51:24,550 - FGO - INFO - 	h2: 32
2023-09-02 20:51:24,550 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:24,550 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:24,550 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:24,550 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:24,550 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:24,550 - FGO - INFO - 	theta: 10
2023-09-02 20:51:24,550 - FGO - INFO - 	clip: 5
2023-09-02 20:51:24,550 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:24,550 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:24,550 - FGO - INFO - Source Total: 725
2023-09-02 20:51:24,550 - FGO - INFO - Target Total: 79
2023-09-02 20:51:24,550 - FGO - INFO - Train Total: 725
2023-09-02 20:51:24,550 - FGO - INFO - Val Total:   79
2023-09-02 20:51:24,550 - FGO - INFO - Test Total:  79
2023-09-02 20:51:24,550 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:24,550 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:24,550 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:24,550 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:24,550 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:24,551 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:24,551 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:24,551 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:24,551 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:24,551 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:24,552 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:24,553 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:24,651 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:24,651 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:24,651 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:24,651 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:24,651 - FGO - INFO - N: 804
2023-09-02 20:51:24,651 - FGO - INFO - N_s: 725
2023-09-02 20:51:24,651 - FGO - INFO - N_t: 79
2023-09-02 20:51:24,654 - CV - INFO - Begin Pretrain
2023-09-02 20:51:24,655 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:24,658 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:51:24,682 - FGO - INFO - Epoch  10 | Train Loss: 0.579 | Val Loss: 0.59 | Val F1: 0.74 |
2023-09-02 20:51:24,707 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.30 | Val F1: 0.91 |
2023-09-02 20:51:24,731 - FGO - INFO - Epoch  30 | Train Loss: 0.128 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:51:24,756 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:51:24,780 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:51:24,805 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:51:24,829 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:51:24,854 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:51:24,878 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:51:24,902 - FGO - INFO - Epoch 100 | Train Loss: 0.065 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:51:24,902 - FGO - INFO - Best Epoch:  51 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.99 
2023-09-02 20:51:24,903 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:24,904 - CV - INFO - Pretrain Complete, 51 epochs
2023-09-02 20:51:24,904 - CV - INFO - Begin OT Train
2023-09-02 20:51:24,904 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:24,972 - FGO - INFO - Epoch   0 | Train Loss: -2.378 | Val Loss: -0.13 | Val F1: 0.97 |
2023-09-02 20:51:25,814 - FGO - INFO - Epoch  10 | Train Loss: -2.437 | Val Loss: 0.06 | Val F1: 0.88 |
2023-09-02 20:51:26,603 - FGO - INFO - Epoch  20 | Train Loss: -2.557 | Val Loss: -0.22 | Val F1: 0.97 |
2023-09-02 20:51:27,433 - FGO - INFO - Epoch  30 | Train Loss: -2.617 | Val Loss: -0.22 | Val F1: 0.97 |
2023-09-02 20:51:28,208 - FGO - INFO - Epoch  40 | Train Loss: -2.649 | Val Loss: -0.20 | Val F1: 0.97 |
2023-09-02 20:51:28,877 - FGO - INFO - Best Epoch:  12 | Train Loss: -2.488 | Val Loss: -0.21 | Val F1: 0.97 |
2023-09-02 20:51:28,877 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:28,880 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:51:28,880 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:28,905 - FGO - INFO - Train CM:
[[377   8]
 [ 13 327]]
2023-09-02 20:51:28,905 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:51:28,905 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:51:28,910 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:51:28,912 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:51:28,913 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:51:28,913 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:51:28,913 - CV - INFO - fold time: 4.364718914031982s (0.07274531523386638m)
2023-09-02 20:51:28,913 - CV - INFO - Mean Pretrain Epochs 45.5:
2023-09-02 20:51:28,913 - CV - INFO - Mean OT Train Epochs 18.2:
2023-09-02 20:51:28,913 - CV - INFO - Mean Val Macro F1 : 0.9575876305537413
2023-09-02 20:51:28,913 - CV - INFO - Mean Eval Stat : 0.9575876305537413 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:51:28,913 - CV - INFO - set time: 44.06001949310303s (0.7343336582183838m)
2023-09-02 20:51:28,913 - CV - INFO - script time so far: 586.8643157482147s (9.781071929136912m) (0.1630178654856152h)
2023-09-02 20:51:28,913 - CV - INFO - ===== BEGINNING OPTION SET (014)==========================================================
2023-09-02 20:51:28,913 - CV - INFO - 	done: False
2023-09-02 20:51:28,913 - CV - INFO - 	learning_rate: 0.005
2023-09-02 20:51:28,913 - CV - INFO - 	h1: 64
2023-09-02 20:51:28,913 - CV - INFO - 	h2: 32
2023-09-02 20:51:28,913 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:28,913 - CV - INFO - 	dropout: 0.0
2023-09-02 20:51:28,913 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:28,913 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:28,913 - CV - INFO - 	lambda: 0.03
2023-09-02 20:51:28,913 - CV - INFO - 	theta: 30
2023-09-02 20:51:28,913 - CV - INFO - 	clip: 5
2023-09-02 20:51:28,913 - CV - INFO - ----- BEGINNING FOLD SET (014:0)----------------------------------------------------------
2023-09-02 20:51:28,915 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/014/0
2023-09-02 20:51:28,915 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:28,915 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:28,915 - FGO - INFO - 	done: False
2023-09-02 20:51:28,915 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:28,915 - FGO - INFO - 	h1: 64
2023-09-02 20:51:28,915 - FGO - INFO - 	h2: 32
2023-09-02 20:51:28,915 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:28,915 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:28,915 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:28,915 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:28,915 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:28,915 - FGO - INFO - 	theta: 30
2023-09-02 20:51:28,915 - FGO - INFO - 	clip: 5
2023-09-02 20:51:28,915 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:28,915 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:28,915 - FGO - INFO - Source Total: 708
2023-09-02 20:51:28,915 - FGO - INFO - Target Total: 96
2023-09-02 20:51:28,915 - FGO - INFO - Train Total: 708
2023-09-02 20:51:28,915 - FGO - INFO - Val Total:   96
2023-09-02 20:51:28,915 - FGO - INFO - Test Total:  96
2023-09-02 20:51:28,915 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:28,915 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:28,915 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:28,915 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:28,915 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:28,916 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:28,916 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:28,916 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:28,916 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:28,916 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:28,917 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:28,918 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:29,034 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:29,034 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:29,034 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:29,034 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:29,034 - FGO - INFO - N: 804
2023-09-02 20:51:29,034 - FGO - INFO - N_s: 708
2023-09-02 20:51:29,034 - FGO - INFO - N_t: 96
2023-09-02 20:51:29,038 - CV - INFO - Begin Pretrain
2023-09-02 20:51:29,038 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:29,041 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:51:29,065 - FGO - INFO - Epoch  10 | Train Loss: 0.572 | Val Loss: 0.59 | Val F1: 0.62 |
2023-09-02 20:51:29,090 - FGO - INFO - Epoch  20 | Train Loss: 0.245 | Val Loss: 0.25 | Val F1: 0.93 |
2023-09-02 20:51:29,114 - FGO - INFO - Epoch  30 | Train Loss: 0.127 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:51:29,138 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:51:29,162 - FGO - INFO - Epoch  50 | Train Loss: 0.083 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:51:29,186 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:51:29,211 - FGO - INFO - Epoch  70 | Train Loss: 0.067 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:51:29,235 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:29,259 - FGO - INFO - Epoch  90 | Train Loss: 0.060 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:51:29,283 - FGO - INFO - Epoch 100 | Train Loss: 0.058 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:51:29,283 - FGO - INFO - Best Epoch:  39 | Train Loss: 0.095 | Val Loss: 0.10 | Val F1: 0.98 
2023-09-02 20:51:29,283 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:29,285 - CV - INFO - Pretrain Complete, 39 epochs
2023-09-02 20:51:29,285 - CV - INFO - Begin OT Train
2023-09-02 20:51:29,285 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:29,351 - FGO - INFO - Epoch   0 | Train Loss: -7.296 | Val Loss: -0.91 | Val F1: 0.97 |
2023-09-02 20:51:30,204 - FGO - INFO - Epoch  10 | Train Loss: -7.749 | Val Loss: -0.94 | Val F1: 0.96 |
2023-09-02 20:51:30,945 - FGO - INFO - Epoch  20 | Train Loss: -7.980 | Val Loss: -0.95 | Val F1: 0.94 |
2023-09-02 20:51:31,721 - FGO - INFO - Epoch  30 | Train Loss: -8.100 | Val Loss: -1.05 | Val F1: 0.97 |
2023-09-02 20:51:32,476 - FGO - INFO - Epoch  40 | Train Loss: -8.173 | Val Loss: -1.06 | Val F1: 0.98 |
2023-09-02 20:51:33,198 - FGO - INFO - Best Epoch:  40 | Train Loss: -8.173 | Val Loss: -1.06 | Val F1: 0.98 |
2023-09-02 20:51:33,198 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:33,201 - CV - INFO - OT Train Complete, 40 epochs
2023-09-02 20:51:33,202 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:33,227 - FGO - INFO - Train CM:
[[373   9]
 [  9 317]]
2023-09-02 20:51:33,227 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:51:33,227 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:51:33,233 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:51:33,234 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:51:33,235 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:51:33,235 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:51:33,235 - CV - INFO - fold time: 4.321939706802368s (0.07203232844670614m)
2023-09-02 20:51:33,235 - CV - INFO - ----- BEGINNING FOLD SET (014:1)----------------------------------------------------------
2023-09-02 20:51:33,237 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/014/1
2023-09-02 20:51:33,237 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:33,237 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:33,237 - FGO - INFO - 	done: False
2023-09-02 20:51:33,237 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:33,237 - FGO - INFO - 	h1: 64
2023-09-02 20:51:33,237 - FGO - INFO - 	h2: 32
2023-09-02 20:51:33,237 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:33,237 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:33,237 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:33,237 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:33,237 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:33,237 - FGO - INFO - 	theta: 30
2023-09-02 20:51:33,237 - FGO - INFO - 	clip: 5
2023-09-02 20:51:33,237 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:33,237 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:33,237 - FGO - INFO - Source Total: 727
2023-09-02 20:51:33,237 - FGO - INFO - Target Total: 77
2023-09-02 20:51:33,237 - FGO - INFO - Train Total: 727
2023-09-02 20:51:33,237 - FGO - INFO - Val Total:   77
2023-09-02 20:51:33,237 - FGO - INFO - Test Total:  77
2023-09-02 20:51:33,237 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:33,237 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:33,237 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:33,237 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:33,237 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:33,238 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:33,238 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:33,238 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:33,238 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:33,238 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:33,239 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:33,240 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:33,336 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:33,336 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:33,337 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:33,337 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:33,337 - FGO - INFO - N: 804
2023-09-02 20:51:33,337 - FGO - INFO - N_s: 727
2023-09-02 20:51:33,337 - FGO - INFO - N_t: 77
2023-09-02 20:51:33,340 - CV - INFO - Begin Pretrain
2023-09-02 20:51:33,340 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:33,344 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:51:33,368 - FGO - INFO - Epoch  10 | Train Loss: 0.577 | Val Loss: 0.61 | Val F1: 0.66 |
2023-09-02 20:51:33,393 - FGO - INFO - Epoch  20 | Train Loss: 0.255 | Val Loss: 0.38 | Val F1: 0.83 |
2023-09-02 20:51:33,418 - FGO - INFO - Epoch  30 | Train Loss: 0.122 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:51:33,443 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.20 | Val F1: 0.89 |
2023-09-02 20:51:33,467 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.87 |
2023-09-02 20:51:33,492 - FGO - INFO - Epoch  60 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.89 |
2023-09-02 20:51:33,516 - FGO - INFO - Epoch  70 | Train Loss: 0.063 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:51:33,541 - FGO - INFO - Epoch  80 | Train Loss: 0.060 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:51:33,565 - FGO - INFO - Epoch  90 | Train Loss: 0.057 | Val Loss: 0.20 | Val F1: 0.90 |
2023-09-02 20:51:33,590 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.20 | Val F1: 0.92 |
2023-09-02 20:51:33,590 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.097 | Val Loss: 0.18 | Val F1: 0.93 
2023-09-02 20:51:33,590 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:33,591 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:51:33,592 - CV - INFO - Begin OT Train
2023-09-02 20:51:33,592 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:33,689 - FGO - INFO - Epoch   0 | Train Loss: -7.252 | Val Loss: -0.52 | Val F1: 0.89 |
2023-09-02 20:51:34,485 - FGO - INFO - Epoch  10 | Train Loss: -7.727 | Val Loss: -0.34 | Val F1: 0.87 |
2023-09-02 20:51:35,281 - FGO - INFO - Epoch  20 | Train Loss: -8.062 | Val Loss: -0.60 | Val F1: 0.90 |
2023-09-02 20:51:36,039 - FGO - INFO - Epoch  30 | Train Loss: -8.218 | Val Loss: -0.53 | Val F1: 0.91 |
2023-09-02 20:51:36,873 - FGO - INFO - Epoch  40 | Train Loss: -8.280 | Val Loss: -0.53 | Val F1: 0.91 |
2023-09-02 20:51:37,547 - FGO - INFO - Best Epoch:  12 | Train Loss: -7.899 | Val Loss: -0.60 | Val F1: 0.93 |
2023-09-02 20:51:37,547 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:37,550 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:51:37,550 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:37,575 - FGO - INFO - Train CM:
[[376  14]
 [  9 328]]
2023-09-02 20:51:37,575 - FGO - INFO - Val CM:
[[41  3]
 [ 4 29]]
2023-09-02 20:51:37,575 - FGO - INFO - Test CM:
[[41  3]
 [ 4 29]]
2023-09-02 20:51:37,580 - FGO - INFO - test statistical parity: 0.29487179487179493
2023-09-02 20:51:37,582 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:51:37,583 - FGO - INFO - test micro f1: 0.9090909090909091
2023-09-02 20:51:37,583 - FGO - INFO - test macro f1: 0.9068280034572169
2023-09-02 20:51:37,583 - CV - INFO - fold time: 4.347658634185791s (0.07246097723642984m)
2023-09-02 20:51:37,583 - CV - INFO - ----- BEGINNING FOLD SET (014:2)----------------------------------------------------------
2023-09-02 20:51:37,585 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/014/2
2023-09-02 20:51:37,585 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:37,585 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:37,585 - FGO - INFO - 	done: False
2023-09-02 20:51:37,585 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:37,585 - FGO - INFO - 	h1: 64
2023-09-02 20:51:37,585 - FGO - INFO - 	h2: 32
2023-09-02 20:51:37,585 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:37,585 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:37,585 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:37,585 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:37,585 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:37,585 - FGO - INFO - 	theta: 30
2023-09-02 20:51:37,585 - FGO - INFO - 	clip: 5
2023-09-02 20:51:37,585 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:37,585 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:37,585 - FGO - INFO - Source Total: 721
2023-09-02 20:51:37,585 - FGO - INFO - Target Total: 83
2023-09-02 20:51:37,585 - FGO - INFO - Train Total: 721
2023-09-02 20:51:37,585 - FGO - INFO - Val Total:   83
2023-09-02 20:51:37,585 - FGO - INFO - Test Total:  83
2023-09-02 20:51:37,585 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:37,585 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:37,585 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:37,585 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:37,585 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:37,586 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:37,586 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:37,586 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:37,586 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:37,586 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:37,587 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:37,588 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:37,690 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:37,690 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:37,690 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:37,690 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:37,690 - FGO - INFO - N: 804
2023-09-02 20:51:37,690 - FGO - INFO - N_s: 721
2023-09-02 20:51:37,690 - FGO - INFO - N_t: 83
2023-09-02 20:51:37,694 - CV - INFO - Begin Pretrain
2023-09-02 20:51:37,694 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:37,697 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:51:37,722 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.76 |
2023-09-02 20:51:37,746 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.33 | Val F1: 0.88 |
2023-09-02 20:51:37,771 - FGO - INFO - Epoch  30 | Train Loss: 0.120 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:51:37,795 - FGO - INFO - Epoch  40 | Train Loss: 0.083 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:51:37,819 - FGO - INFO - Epoch  50 | Train Loss: 0.071 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:51:37,844 - FGO - INFO - Epoch  60 | Train Loss: 0.062 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:51:37,868 - FGO - INFO - Epoch  70 | Train Loss: 0.059 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:51:37,892 - FGO - INFO - Epoch  80 | Train Loss: 0.055 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:51:37,917 - FGO - INFO - Epoch  90 | Train Loss: 0.053 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:51:37,941 - FGO - INFO - Epoch 100 | Train Loss: 0.051 | Val Loss: 0.26 | Val F1: 0.91 |
2023-09-02 20:51:37,941 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.063 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:51:37,941 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:37,943 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:51:37,943 - CV - INFO - Begin OT Train
2023-09-02 20:51:37,943 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:38,011 - FGO - INFO - Epoch   0 | Train Loss: -7.225 | Val Loss: -0.55 | Val F1: 0.90 |
2023-09-02 20:51:38,787 - FGO - INFO - Epoch  10 | Train Loss: -7.870 | Val Loss: -0.38 | Val F1: 0.87 |
2023-09-02 20:51:39,587 - FGO - INFO - Epoch  20 | Train Loss: -8.122 | Val Loss: -0.64 | Val F1: 0.89 |
2023-09-02 20:51:40,362 - FGO - INFO - Epoch  30 | Train Loss: -8.259 | Val Loss: -0.52 | Val F1: 0.90 |
2023-09-02 20:51:41,137 - FGO - INFO - Epoch  40 | Train Loss: -8.326 | Val Loss: -0.52 | Val F1: 0.90 |
2023-09-02 20:51:41,827 - FGO - INFO - Best Epoch:   7 | Train Loss: -7.732 | Val Loss: -0.51 | Val F1: 0.91 |
2023-09-02 20:51:41,827 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:41,830 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:51:41,830 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:41,854 - FGO - INFO - Train CM:
[[378   6]
 [  9 328]]
2023-09-02 20:51:41,855 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:51:41,855 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:51:41,860 - FGO - INFO - test statistical parity: 0.02230046948356812
2023-09-02 20:51:41,862 - FGO - INFO - test equal opportunity: 0.2592592592592593
2023-09-02 20:51:41,863 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:51:41,863 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:51:41,863 - CV - INFO - fold time: 4.2799530029296875s (0.07133255004882813m)
2023-09-02 20:51:41,863 - CV - INFO - ----- BEGINNING FOLD SET (014:3)----------------------------------------------------------
2023-09-02 20:51:41,865 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/014/3
2023-09-02 20:51:41,865 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:41,865 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:41,865 - FGO - INFO - 	done: False
2023-09-02 20:51:41,865 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:41,865 - FGO - INFO - 	h1: 64
2023-09-02 20:51:41,865 - FGO - INFO - 	h2: 32
2023-09-02 20:51:41,865 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:41,865 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:41,865 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:41,865 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:41,865 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:41,865 - FGO - INFO - 	theta: 30
2023-09-02 20:51:41,865 - FGO - INFO - 	clip: 5
2023-09-02 20:51:41,865 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:41,865 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:41,865 - FGO - INFO - Source Total: 729
2023-09-02 20:51:41,865 - FGO - INFO - Target Total: 75
2023-09-02 20:51:41,865 - FGO - INFO - Train Total: 729
2023-09-02 20:51:41,865 - FGO - INFO - Val Total:   75
2023-09-02 20:51:41,865 - FGO - INFO - Test Total:  75
2023-09-02 20:51:41,865 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:41,865 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:41,865 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:41,865 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:41,865 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:41,866 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:41,866 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:41,866 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:41,866 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:41,866 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:41,867 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:41,868 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:41,961 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:41,961 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:41,961 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:41,961 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:41,961 - FGO - INFO - N: 804
2023-09-02 20:51:41,961 - FGO - INFO - N_s: 729
2023-09-02 20:51:41,961 - FGO - INFO - N_t: 75
2023-09-02 20:51:41,965 - CV - INFO - Begin Pretrain
2023-09-02 20:51:41,965 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:41,968 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:51:41,993 - FGO - INFO - Epoch  10 | Train Loss: 0.580 | Val Loss: 0.56 | Val F1: 0.75 |
2023-09-02 20:51:42,018 - FGO - INFO - Epoch  20 | Train Loss: 0.266 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:51:42,042 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.07 | Val F1: 0.99 |
2023-09-02 20:51:42,067 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:51:42,091 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:51:42,116 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:51:42,141 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:51:42,165 - FGO - INFO - Epoch  80 | Train Loss: 0.076 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:51:42,190 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:51:42,214 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:51:42,214 - FGO - INFO - Best Epoch:  24 | Train Loss: 0.189 | Val Loss: 0.10 | Val F1: 1.00 
2023-09-02 20:51:42,214 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:42,216 - CV - INFO - Pretrain Complete, 24 epochs
2023-09-02 20:51:42,216 - CV - INFO - Begin OT Train
2023-09-02 20:51:42,216 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:42,313 - FGO - INFO - Epoch   0 | Train Loss: -7.184 | Val Loss: -0.72 | Val F1: 0.97 |
2023-09-02 20:51:43,129 - FGO - INFO - Epoch  10 | Train Loss: -7.974 | Val Loss: -0.74 | Val F1: 0.95 |
2023-09-02 20:51:43,985 - FGO - INFO - Epoch  20 | Train Loss: -8.134 | Val Loss: -0.80 | Val F1: 0.99 |
2023-09-02 20:51:44,758 - FGO - INFO - Epoch  30 | Train Loss: -8.222 | Val Loss: -0.83 | Val F1: 0.99 |
2023-09-02 20:51:45,530 - FGO - INFO - Epoch  40 | Train Loss: -8.279 | Val Loss: -0.85 | Val F1: 0.99 |
2023-09-02 20:51:46,188 - FGO - INFO - Best Epoch:  19 | Train Loss: -8.100 | Val Loss: -0.80 | Val F1: 0.99 |
2023-09-02 20:51:46,188 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:46,191 - CV - INFO - OT Train Complete, 19 epochs
2023-09-02 20:51:46,192 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:46,216 - FGO - INFO - Train CM:
[[388   8]
 [ 12 321]]
2023-09-02 20:51:46,216 - FGO - INFO - Val CM:
[[37  1]
 [ 1 36]]
2023-09-02 20:51:46,217 - FGO - INFO - Test CM:
[[37  1]
 [ 1 36]]
2023-09-02 20:51:46,222 - FGO - INFO - test statistical parity: 0.008196721311475419
2023-09-02 20:51:46,223 - FGO - INFO - test equal opportunity: 0.033333333333333326
2023-09-02 20:51:46,224 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 20:51:46,225 - FGO - INFO - test macro f1: 0.9733285917496444
2023-09-02 20:51:46,225 - CV - INFO - fold time: 4.361659288406372s (0.07269432147343953m)
2023-09-02 20:51:46,225 - CV - INFO - ----- BEGINNING FOLD SET (014:4)----------------------------------------------------------
2023-09-02 20:51:46,226 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/014/4
2023-09-02 20:51:46,226 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:46,226 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:46,226 - FGO - INFO - 	done: False
2023-09-02 20:51:46,226 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:46,226 - FGO - INFO - 	h1: 64
2023-09-02 20:51:46,227 - FGO - INFO - 	h2: 32
2023-09-02 20:51:46,227 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:46,227 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:46,227 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:46,227 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:46,227 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:46,227 - FGO - INFO - 	theta: 30
2023-09-02 20:51:46,227 - FGO - INFO - 	clip: 5
2023-09-02 20:51:46,227 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:46,227 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:46,227 - FGO - INFO - Source Total: 732
2023-09-02 20:51:46,227 - FGO - INFO - Target Total: 72
2023-09-02 20:51:46,227 - FGO - INFO - Train Total: 732
2023-09-02 20:51:46,227 - FGO - INFO - Val Total:   72
2023-09-02 20:51:46,227 - FGO - INFO - Test Total:  72
2023-09-02 20:51:46,227 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:46,227 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:46,227 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:46,227 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:46,227 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:46,227 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:46,227 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:46,227 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:46,227 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:46,227 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:46,228 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:46,230 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:46,320 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:46,320 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:46,320 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:46,320 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:46,320 - FGO - INFO - N: 804
2023-09-02 20:51:46,320 - FGO - INFO - N_s: 732
2023-09-02 20:51:46,320 - FGO - INFO - N_t: 72
2023-09-02 20:51:46,324 - CV - INFO - Begin Pretrain
2023-09-02 20:51:46,324 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:46,327 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:51:46,352 - FGO - INFO - Epoch  10 | Train Loss: 0.578 | Val Loss: 0.58 | Val F1: 0.78 |
2023-09-02 20:51:46,377 - FGO - INFO - Epoch  20 | Train Loss: 0.258 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:51:46,402 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:46,426 - FGO - INFO - Epoch  40 | Train Loss: 0.095 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:46,451 - FGO - INFO - Epoch  50 | Train Loss: 0.084 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:46,475 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:51:46,500 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:51:46,525 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:51:46,549 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:51:46,574 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:51:46,574 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.99 
2023-09-02 20:51:46,574 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:46,575 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:51:46,575 - CV - INFO - Begin OT Train
2023-09-02 20:51:46,575 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:46,669 - FGO - INFO - Epoch   0 | Train Loss: -7.398 | Val Loss: -0.71 | Val F1: 0.99 |
2023-09-02 20:51:47,509 - FGO - INFO - Epoch  10 | Train Loss: -7.980 | Val Loss: -0.76 | Val F1: 0.99 |
2023-09-02 20:51:48,286 - FGO - INFO - Epoch  20 | Train Loss: -8.124 | Val Loss: -0.74 | Val F1: 0.99 |
2023-09-02 20:51:49,106 - FGO - INFO - Epoch  30 | Train Loss: -8.227 | Val Loss: -0.76 | Val F1: 0.99 |
2023-09-02 20:51:49,850 - FGO - INFO - Epoch  40 | Train Loss: -8.294 | Val Loss: -0.78 | Val F1: 0.99 |
2023-09-02 20:51:50,655 - FGO - INFO - Best Epoch:   9 | Train Loss: -7.982 | Val Loss: -0.75 | Val F1: 0.99 |
2023-09-02 20:51:50,655 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:50,659 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:51:50,659 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:50,684 - FGO - INFO - Train CM:
[[388   9]
 [ 11 324]]
2023-09-02 20:51:50,684 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:51:50,684 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:51:50,689 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:51:50,691 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:51:50,691 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:51:50,692 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:51:50,692 - CV - INFO - fold time: 4.467238664627075s (0.07445397774378458m)
2023-09-02 20:51:50,692 - CV - INFO - ----- BEGINNING FOLD SET (014:5)----------------------------------------------------------
2023-09-02 20:51:50,694 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/014/5
2023-09-02 20:51:50,694 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:50,694 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:50,694 - FGO - INFO - 	done: False
2023-09-02 20:51:50,694 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:50,694 - FGO - INFO - 	h1: 64
2023-09-02 20:51:50,694 - FGO - INFO - 	h2: 32
2023-09-02 20:51:50,694 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:50,694 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:50,694 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:50,694 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:50,694 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:50,694 - FGO - INFO - 	theta: 30
2023-09-02 20:51:50,694 - FGO - INFO - 	clip: 5
2023-09-02 20:51:50,694 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:50,694 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:50,694 - FGO - INFO - Source Total: 726
2023-09-02 20:51:50,694 - FGO - INFO - Target Total: 78
2023-09-02 20:51:50,694 - FGO - INFO - Train Total: 726
2023-09-02 20:51:50,694 - FGO - INFO - Val Total:   78
2023-09-02 20:51:50,694 - FGO - INFO - Test Total:  78
2023-09-02 20:51:50,694 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:50,694 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:50,694 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:50,694 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:50,694 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:50,695 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:50,695 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:50,695 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:50,695 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:50,695 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:50,696 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:50,697 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:50,794 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:50,795 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:50,795 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:50,795 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:50,795 - FGO - INFO - N: 804
2023-09-02 20:51:50,795 - FGO - INFO - N_s: 726
2023-09-02 20:51:50,795 - FGO - INFO - N_t: 78
2023-09-02 20:51:50,798 - CV - INFO - Begin Pretrain
2023-09-02 20:51:50,798 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:50,801 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:51:50,826 - FGO - INFO - Epoch  10 | Train Loss: 0.582 | Val Loss: 0.61 | Val F1: 0.72 |
2023-09-02 20:51:50,851 - FGO - INFO - Epoch  20 | Train Loss: 0.268 | Val Loss: 0.31 | Val F1: 0.87 |
2023-09-02 20:51:50,875 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.25 | Val F1: 0.92 |
2023-09-02 20:51:50,900 - FGO - INFO - Epoch  40 | Train Loss: 0.100 | Val Loss: 0.22 | Val F1: 0.92 |
2023-09-02 20:51:50,924 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:51:50,948 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:51:50,973 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:51:50,997 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 20:51:51,021 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:51:51,046 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:51:51,046 - FGO - INFO - Best Epoch:  77 | Train Loss: 0.070 | Val Loss: 0.10 | Val F1: 0.96 
2023-09-02 20:51:51,046 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:51,047 - CV - INFO - Pretrain Complete, 77 epochs
2023-09-02 20:51:51,047 - CV - INFO - Begin OT Train
2023-09-02 20:51:51,047 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:51,147 - FGO - INFO - Epoch   0 | Train Loss: -7.149 | Val Loss: -0.69 | Val F1: 0.96 |
2023-09-02 20:51:51,990 - FGO - INFO - Epoch  10 | Train Loss: -7.963 | Val Loss: -0.57 | Val F1: 0.90 |
2023-09-02 20:51:52,720 - FGO - INFO - Epoch  20 | Train Loss: -8.104 | Val Loss: -0.68 | Val F1: 0.92 |
2023-09-02 20:51:53,496 - FGO - INFO - Epoch  30 | Train Loss: -8.211 | Val Loss: -0.54 | Val F1: 0.91 |
2023-09-02 20:51:54,359 - FGO - INFO - Epoch  40 | Train Loss: -8.279 | Val Loss: -0.59 | Val F1: 0.92 |
2023-09-02 20:51:55,037 - FGO - INFO - Best Epoch:   6 | Train Loss: -7.716 | Val Loss: -0.71 | Val F1: 0.95 |
2023-09-02 20:51:55,037 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:55,040 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:51:55,040 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:55,065 - FGO - INFO - Train CM:
[[394   6]
 [ 17 309]]
2023-09-02 20:51:55,065 - FGO - INFO - Val CM:
[[34  0]
 [ 6 38]]
2023-09-02 20:51:55,065 - FGO - INFO - Test CM:
[[34  0]
 [ 6 38]]
2023-09-02 20:51:55,070 - FGO - INFO - test statistical parity: 0.07729468599033817
2023-09-02 20:51:55,072 - FGO - INFO - test equal opportunity: 0.15384615384615385
2023-09-02 20:51:55,073 - FGO - INFO - test micro f1: 0.9230769230769231
2023-09-02 20:51:55,073 - FGO - INFO - test macro f1: 0.9228740936058009
2023-09-02 20:51:55,073 - CV - INFO - fold time: 4.381127119064331s (0.07301878531773885m)
2023-09-02 20:51:55,073 - CV - INFO - ----- BEGINNING FOLD SET (014:6)----------------------------------------------------------
2023-09-02 20:51:55,075 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/014/6
2023-09-02 20:51:55,075 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:55,075 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:55,075 - FGO - INFO - 	done: False
2023-09-02 20:51:55,075 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:55,075 - FGO - INFO - 	h1: 64
2023-09-02 20:51:55,075 - FGO - INFO - 	h2: 32
2023-09-02 20:51:55,075 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:55,075 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:55,075 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:55,075 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:55,075 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:55,075 - FGO - INFO - 	theta: 30
2023-09-02 20:51:55,075 - FGO - INFO - 	clip: 5
2023-09-02 20:51:55,075 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:55,075 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:55,075 - FGO - INFO - Source Total: 717
2023-09-02 20:51:55,075 - FGO - INFO - Target Total: 87
2023-09-02 20:51:55,075 - FGO - INFO - Train Total: 717
2023-09-02 20:51:55,075 - FGO - INFO - Val Total:   87
2023-09-02 20:51:55,075 - FGO - INFO - Test Total:  87
2023-09-02 20:51:55,075 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:55,075 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:55,075 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:55,075 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:55,075 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:55,076 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:55,076 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:55,076 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:55,076 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:55,076 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:55,077 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:55,078 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:55,184 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:55,184 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:55,184 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:55,184 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:55,185 - FGO - INFO - N: 804
2023-09-02 20:51:55,185 - FGO - INFO - N_s: 717
2023-09-02 20:51:55,185 - FGO - INFO - N_t: 87
2023-09-02 20:51:55,188 - CV - INFO - Begin Pretrain
2023-09-02 20:51:55,188 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:55,191 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:51:55,216 - FGO - INFO - Epoch  10 | Train Loss: 0.585 | Val Loss: 0.57 | Val F1: 0.75 |
2023-09-02 20:51:55,240 - FGO - INFO - Epoch  20 | Train Loss: 0.271 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:51:55,265 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:51:55,289 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:51:55,314 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:51:55,338 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:51:55,362 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:51:55,387 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:51:55,411 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:51:55,435 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:51:55,435 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.107 | Val Loss: 0.08 | Val F1: 0.99 
2023-09-02 20:51:55,435 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:55,437 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:51:55,437 - CV - INFO - Begin OT Train
2023-09-02 20:51:55,437 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:55,534 - FGO - INFO - Epoch   0 | Train Loss: -7.386 | Val Loss: -0.90 | Val F1: 0.99 |
2023-09-02 20:51:56,318 - FGO - INFO - Epoch  10 | Train Loss: -7.936 | Val Loss: -0.94 | Val F1: 0.95 |
2023-09-02 20:51:57,061 - FGO - INFO - Epoch  20 | Train Loss: -8.058 | Val Loss: -0.96 | Val F1: 0.96 |
2023-09-02 20:51:57,835 - FGO - INFO - Epoch  30 | Train Loss: -8.154 | Val Loss: -0.99 | Val F1: 0.96 |
2023-09-02 20:51:58,610 - FGO - INFO - Epoch  40 | Train Loss: -8.211 | Val Loss: -1.02 | Val F1: 0.99 |
2023-09-02 20:51:59,311 - FGO - INFO - Best Epoch:  34 | Train Loss: -8.179 | Val Loss: -1.01 | Val F1: 0.99 |
2023-09-02 20:51:59,311 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:59,315 - CV - INFO - OT Train Complete, 34 epochs
2023-09-02 20:51:59,315 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:51:59,340 - FGO - INFO - Train CM:
[[379   6]
 [ 14 318]]
2023-09-02 20:51:59,340 - FGO - INFO - Val CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:51:59,340 - FGO - INFO - Test CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:51:59,345 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 20:51:59,347 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:51:59,348 - FGO - INFO - test micro f1: 0.9885057471264368
2023-09-02 20:51:59,348 - FGO - INFO - test macro f1: 0.9883518543312357
2023-09-02 20:51:59,348 - CV - INFO - fold time: 4.27486515045166s (0.07124775250752767m)
2023-09-02 20:51:59,348 - CV - INFO - ----- BEGINNING FOLD SET (014:7)----------------------------------------------------------
2023-09-02 20:51:59,349 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/014/7
2023-09-02 20:51:59,350 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:51:59,350 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:51:59,350 - FGO - INFO - 	done: False
2023-09-02 20:51:59,350 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:51:59,350 - FGO - INFO - 	h1: 64
2023-09-02 20:51:59,350 - FGO - INFO - 	h2: 32
2023-09-02 20:51:59,350 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:51:59,350 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:51:59,350 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:51:59,350 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:51:59,350 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:51:59,350 - FGO - INFO - 	theta: 30
2023-09-02 20:51:59,350 - FGO - INFO - 	clip: 5
2023-09-02 20:51:59,350 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:51:59,350 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:51:59,350 - FGO - INFO - Source Total: 717
2023-09-02 20:51:59,350 - FGO - INFO - Target Total: 87
2023-09-02 20:51:59,350 - FGO - INFO - Train Total: 717
2023-09-02 20:51:59,350 - FGO - INFO - Val Total:   87
2023-09-02 20:51:59,350 - FGO - INFO - Test Total:  87
2023-09-02 20:51:59,350 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:51:59,350 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:51:59,350 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:51:59,350 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:51:59,350 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:51:59,351 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:51:59,351 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:51:59,351 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:51:59,351 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:51:59,351 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:51:59,352 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:51:59,353 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:51:59,459 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:51:59,459 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:51:59,459 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:51:59,459 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:51:59,459 - FGO - INFO - N: 804
2023-09-02 20:51:59,459 - FGO - INFO - N_s: 717
2023-09-02 20:51:59,459 - FGO - INFO - N_t: 87
2023-09-02 20:51:59,463 - CV - INFO - Begin Pretrain
2023-09-02 20:51:59,463 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:51:59,466 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:51:59,491 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.72 |
2023-09-02 20:51:59,515 - FGO - INFO - Epoch  20 | Train Loss: 0.265 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:51:59,540 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:59,564 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:51:59,589 - FGO - INFO - Epoch  50 | Train Loss: 0.086 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:51:59,613 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:51:59,638 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:51:59,662 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:51:59,687 - FGO - INFO - Epoch  90 | Train Loss: 0.070 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:51:59,711 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:51:59,711 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.169 | Val Loss: 0.14 | Val F1: 0.98 
2023-09-02 20:51:59,711 - FGO - INFO - Setting model to best state.
2023-09-02 20:51:59,713 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:51:59,713 - CV - INFO - Begin OT Train
2023-09-02 20:51:59,713 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:51:59,781 - FGO - INFO - Epoch   0 | Train Loss: -7.373 | Val Loss: -0.75 | Val F1: 0.95 |
2023-09-02 20:52:00,644 - FGO - INFO - Epoch  10 | Train Loss: -7.986 | Val Loss: -0.81 | Val F1: 0.94 |
2023-09-02 20:52:01,405 - FGO - INFO - Epoch  20 | Train Loss: -8.136 | Val Loss: -0.82 | Val F1: 0.94 |
2023-09-02 20:52:02,187 - FGO - INFO - Epoch  30 | Train Loss: -8.242 | Val Loss: -0.87 | Val F1: 0.97 |
2023-09-02 20:52:02,965 - FGO - INFO - Epoch  40 | Train Loss: -8.305 | Val Loss: -0.88 | Val F1: 0.97 |
2023-09-02 20:52:03,654 - FGO - INFO - Best Epoch:  22 | Train Loss: -8.173 | Val Loss: -0.84 | Val F1: 0.97 |
2023-09-02 20:52:03,654 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:03,657 - CV - INFO - OT Train Complete, 22 epochs
2023-09-02 20:52:03,658 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:03,683 - FGO - INFO - Train CM:
[[378   9]
 [ 12 318]]
2023-09-02 20:52:03,684 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:52:03,684 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:52:03,689 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:52:03,690 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:52:03,691 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:52:03,692 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:52:03,692 - CV - INFO - fold time: 4.3437581062316895s (0.07239596843719483m)
2023-09-02 20:52:03,692 - CV - INFO - ----- BEGINNING FOLD SET (014:8)----------------------------------------------------------
2023-09-02 20:52:03,693 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/014/8
2023-09-02 20:52:03,693 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:03,694 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:03,694 - FGO - INFO - 	done: False
2023-09-02 20:52:03,694 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:03,694 - FGO - INFO - 	h1: 64
2023-09-02 20:52:03,694 - FGO - INFO - 	h2: 32
2023-09-02 20:52:03,694 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:03,694 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:03,694 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:03,694 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:03,694 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:03,694 - FGO - INFO - 	theta: 30
2023-09-02 20:52:03,694 - FGO - INFO - 	clip: 5
2023-09-02 20:52:03,694 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:03,694 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:03,694 - FGO - INFO - Source Total: 734
2023-09-02 20:52:03,694 - FGO - INFO - Target Total: 70
2023-09-02 20:52:03,694 - FGO - INFO - Train Total: 734
2023-09-02 20:52:03,694 - FGO - INFO - Val Total:   70
2023-09-02 20:52:03,694 - FGO - INFO - Test Total:  70
2023-09-02 20:52:03,694 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:03,694 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:03,694 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:03,694 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:03,694 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:03,694 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:03,694 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:03,694 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:03,695 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:03,695 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:03,695 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:03,697 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:03,786 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:03,786 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:03,786 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:03,786 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:03,786 - FGO - INFO - N: 804
2023-09-02 20:52:03,786 - FGO - INFO - N_s: 734
2023-09-02 20:52:03,786 - FGO - INFO - N_t: 70
2023-09-02 20:52:03,789 - CV - INFO - Begin Pretrain
2023-09-02 20:52:03,790 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:03,793 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:52:03,818 - FGO - INFO - Epoch  10 | Train Loss: 0.564 | Val Loss: 0.59 | Val F1: 0.75 |
2023-09-02 20:52:03,843 - FGO - INFO - Epoch  20 | Train Loss: 0.257 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:52:03,868 - FGO - INFO - Epoch  30 | Train Loss: 0.132 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:52:03,892 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.13 | Val F1: 0.94 |
2023-09-02 20:52:03,917 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:52:03,942 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:52:03,966 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:52:03,991 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:52:04,016 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.16 | Val F1: 0.93 |
2023-09-02 20:52:04,041 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:52:04,041 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.108 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:52:04,041 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:04,042 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:52:04,042 - CV - INFO - Begin OT Train
2023-09-02 20:52:04,042 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:04,141 - FGO - INFO - Epoch   0 | Train Loss: -7.311 | Val Loss: -0.53 | Val F1: 0.93 |
2023-09-02 20:52:04,941 - FGO - INFO - Epoch  10 | Train Loss: -7.956 | Val Loss: -0.50 | Val F1: 0.93 |
2023-09-02 20:52:05,714 - FGO - INFO - Epoch  20 | Train Loss: -8.111 | Val Loss: -0.55 | Val F1: 0.96 |
2023-09-02 20:52:06,549 - FGO - INFO - Epoch  30 | Train Loss: -8.232 | Val Loss: -0.53 | Val F1: 0.94 |
2023-09-02 20:52:07,322 - FGO - INFO - Epoch  40 | Train Loss: -8.301 | Val Loss: -0.57 | Val F1: 0.94 |
2023-09-02 20:52:08,023 - FGO - INFO - Best Epoch:  11 | Train Loss: -8.011 | Val Loss: -0.54 | Val F1: 0.96 |
2023-09-02 20:52:08,023 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:08,026 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:52:08,026 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:08,049 - FGO - INFO - Train CM:
[[392   8]
 [ 12 322]]
2023-09-02 20:52:08,050 - FGO - INFO - Val CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:52:08,050 - FGO - INFO - Test CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:52:08,054 - FGO - INFO - test statistical parity: 0.10661268556005393
2023-09-02 20:52:08,056 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:52:08,057 - FGO - INFO - test micro f1: 0.9571428571428572
2023-09-02 20:52:08,057 - FGO - INFO - test macro f1: 0.9571341090018372
2023-09-02 20:52:08,057 - CV - INFO - fold time: 4.36522364616394s (0.07275372743606567m)
2023-09-02 20:52:08,057 - CV - INFO - ----- BEGINNING FOLD SET (014:9)----------------------------------------------------------
2023-09-02 20:52:08,059 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/014/9
2023-09-02 20:52:08,059 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:08,059 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:08,059 - FGO - INFO - 	done: False
2023-09-02 20:52:08,059 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:08,059 - FGO - INFO - 	h1: 64
2023-09-02 20:52:08,059 - FGO - INFO - 	h2: 32
2023-09-02 20:52:08,059 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:08,059 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:08,059 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:08,059 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:08,059 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:08,059 - FGO - INFO - 	theta: 30
2023-09-02 20:52:08,059 - FGO - INFO - 	clip: 5
2023-09-02 20:52:08,059 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:08,059 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:08,059 - FGO - INFO - Source Total: 725
2023-09-02 20:52:08,059 - FGO - INFO - Target Total: 79
2023-09-02 20:52:08,059 - FGO - INFO - Train Total: 725
2023-09-02 20:52:08,059 - FGO - INFO - Val Total:   79
2023-09-02 20:52:08,059 - FGO - INFO - Test Total:  79
2023-09-02 20:52:08,059 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:08,059 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:08,059 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:08,059 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:08,059 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:08,060 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:08,060 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:08,060 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:08,060 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:08,060 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:08,061 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:08,062 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:08,160 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:08,160 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:08,160 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:08,160 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:08,160 - FGO - INFO - N: 804
2023-09-02 20:52:08,160 - FGO - INFO - N_s: 725
2023-09-02 20:52:08,160 - FGO - INFO - N_t: 79
2023-09-02 20:52:08,164 - CV - INFO - Begin Pretrain
2023-09-02 20:52:08,164 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:08,167 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:52:08,192 - FGO - INFO - Epoch  10 | Train Loss: 0.579 | Val Loss: 0.59 | Val F1: 0.74 |
2023-09-02 20:52:08,216 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.30 | Val F1: 0.91 |
2023-09-02 20:52:08,241 - FGO - INFO - Epoch  30 | Train Loss: 0.128 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:52:08,265 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:52:08,290 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:52:08,314 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:52:08,338 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:52:08,363 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:52:08,387 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:52:08,411 - FGO - INFO - Epoch 100 | Train Loss: 0.065 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:52:08,411 - FGO - INFO - Best Epoch:  51 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.99 
2023-09-02 20:52:08,411 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:08,413 - CV - INFO - Pretrain Complete, 51 epochs
2023-09-02 20:52:08,413 - CV - INFO - Begin OT Train
2023-09-02 20:52:08,413 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:08,496 - FGO - INFO - Epoch   0 | Train Loss: -7.381 | Val Loss: -0.67 | Val F1: 0.97 |
2023-09-02 20:52:09,338 - FGO - INFO - Epoch  10 | Train Loss: -7.803 | Val Loss: -0.47 | Val F1: 0.88 |
2023-09-02 20:52:10,183 - FGO - INFO - Epoch  20 | Train Loss: -8.069 | Val Loss: -0.78 | Val F1: 0.97 |
2023-09-02 20:52:10,923 - FGO - INFO - Epoch  30 | Train Loss: -8.189 | Val Loss: -0.85 | Val F1: 0.97 |
2023-09-02 20:52:11,776 - FGO - INFO - Epoch  40 | Train Loss: -8.252 | Val Loss: -0.87 | Val F1: 0.99 |
2023-09-02 20:52:12,559 - FGO - INFO - Best Epoch:  26 | Train Loss: -8.152 | Val Loss: -0.83 | Val F1: 0.99 |
2023-09-02 20:52:12,559 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:12,562 - CV - INFO - OT Train Complete, 26 epochs
2023-09-02 20:52:12,562 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:12,587 - FGO - INFO - Train CM:
[[378   7]
 [ 14 326]]
2023-09-02 20:52:12,587 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:52:12,588 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:52:12,593 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:52:12,594 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:12,595 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:52:12,595 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:52:12,595 - CV - INFO - fold time: 4.538305759429932s (0.07563842932383219m)
2023-09-02 20:52:12,595 - CV - INFO - Mean Pretrain Epochs 45.5:
2023-09-02 20:52:12,595 - CV - INFO - Mean OT Train Epochs 18.6:
2023-09-02 20:52:12,595 - CV - INFO - Mean Val Macro F1 : 0.9551613164439423
2023-09-02 20:52:12,595 - CV - INFO - Mean Eval Stat : 0.9551613164439423 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:52:12,596 - CV - INFO - set time: 43.6822669506073s (0.7280377825101216m)
2023-09-02 20:52:12,596 - CV - INFO - script time so far: 630.5466287136078s (10.50911047856013m) (0.1751518413093355h)
2023-09-02 20:52:12,596 - CV - INFO - ===== BEGINNING OPTION SET (015)==========================================================
2023-09-02 20:52:12,596 - CV - INFO - 	done: False
2023-09-02 20:52:12,596 - CV - INFO - 	learning_rate: 0.005
2023-09-02 20:52:12,596 - CV - INFO - 	h1: 64
2023-09-02 20:52:12,596 - CV - INFO - 	h2: 32
2023-09-02 20:52:12,596 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:12,596 - CV - INFO - 	dropout: 0.0
2023-09-02 20:52:12,596 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:12,596 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:12,596 - CV - INFO - 	lambda: 0.03
2023-09-02 20:52:12,596 - CV - INFO - 	theta: 50
2023-09-02 20:52:12,596 - CV - INFO - 	clip: 5
2023-09-02 20:52:12,596 - CV - INFO - ----- BEGINNING FOLD SET (015:0)----------------------------------------------------------
2023-09-02 20:52:12,597 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/015/0
2023-09-02 20:52:12,597 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:12,597 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:12,597 - FGO - INFO - 	done: False
2023-09-02 20:52:12,597 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:12,597 - FGO - INFO - 	h1: 64
2023-09-02 20:52:12,597 - FGO - INFO - 	h2: 32
2023-09-02 20:52:12,597 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:12,597 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:12,598 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:12,598 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:12,598 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:12,598 - FGO - INFO - 	theta: 50
2023-09-02 20:52:12,598 - FGO - INFO - 	clip: 5
2023-09-02 20:52:12,598 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:12,598 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:12,598 - FGO - INFO - Source Total: 708
2023-09-02 20:52:12,598 - FGO - INFO - Target Total: 96
2023-09-02 20:52:12,598 - FGO - INFO - Train Total: 708
2023-09-02 20:52:12,598 - FGO - INFO - Val Total:   96
2023-09-02 20:52:12,598 - FGO - INFO - Test Total:  96
2023-09-02 20:52:12,598 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:12,598 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:12,598 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:12,598 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:12,598 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:12,598 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:12,598 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:12,598 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:12,598 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:12,598 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:12,599 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:12,601 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:12,716 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:12,716 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:12,716 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:12,716 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:12,716 - FGO - INFO - N: 804
2023-09-02 20:52:12,716 - FGO - INFO - N_s: 708
2023-09-02 20:52:12,716 - FGO - INFO - N_t: 96
2023-09-02 20:52:12,720 - CV - INFO - Begin Pretrain
2023-09-02 20:52:12,720 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:12,723 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:52:12,748 - FGO - INFO - Epoch  10 | Train Loss: 0.572 | Val Loss: 0.59 | Val F1: 0.62 |
2023-09-02 20:52:12,772 - FGO - INFO - Epoch  20 | Train Loss: 0.245 | Val Loss: 0.25 | Val F1: 0.93 |
2023-09-02 20:52:12,796 - FGO - INFO - Epoch  30 | Train Loss: 0.127 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:52:12,821 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:52:12,845 - FGO - INFO - Epoch  50 | Train Loss: 0.083 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:52:12,869 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:52:12,893 - FGO - INFO - Epoch  70 | Train Loss: 0.067 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:52:12,918 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:52:12,942 - FGO - INFO - Epoch  90 | Train Loss: 0.060 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:52:12,966 - FGO - INFO - Epoch 100 | Train Loss: 0.058 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:52:12,966 - FGO - INFO - Best Epoch:  39 | Train Loss: 0.095 | Val Loss: 0.10 | Val F1: 0.98 
2023-09-02 20:52:12,966 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:12,967 - CV - INFO - Pretrain Complete, 39 epochs
2023-09-02 20:52:12,967 - CV - INFO - Begin OT Train
2023-09-02 20:52:12,967 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:13,077 - FGO - INFO - Epoch   0 | Train Loss: -12.246 | Val Loss: -1.60 | Val F1: 0.97 |
2023-09-02 20:52:13,916 - FGO - INFO - Epoch  10 | Train Loss: -13.214 | Val Loss: -1.71 | Val F1: 0.95 |
2023-09-02 20:52:14,660 - FGO - INFO - Epoch  20 | Train Loss: -13.660 | Val Loss: -1.48 | Val F1: 0.81 |
2023-09-02 20:52:15,383 - FGO - INFO - Epoch  30 | Train Loss: -13.945 | Val Loss: -1.36 | Val F1: 0.35 |
2023-09-02 20:52:16,133 - FGO - INFO - Epoch  40 | Train Loss: -13.949 | Val Loss: -1.36 | Val F1: 0.35 |
2023-09-02 20:52:16,827 - FGO - INFO - Best Epoch:   9 | Train Loss: -13.178 | Val Loss: -1.70 | Val F1: 0.95 |
2023-09-02 20:52:16,827 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:16,831 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:52:16,831 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:16,854 - FGO - INFO - Train CM:
[[382   0]
 [326   0]]
2023-09-02 20:52:16,854 - FGO - INFO - Val CM:
[[52  0]
 [44  0]]
2023-09-02 20:52:16,854 - FGO - INFO - Test CM:
[[52  0]
 [44  0]]
2023-09-02 20:52:16,860 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:52:16,861 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:16,862 - FGO - INFO - test micro f1: 0.5416666666666666
2023-09-02 20:52:16,863 - FGO - INFO - test macro f1: 0.35135135135135137
2023-09-02 20:52:16,863 - CV - INFO - fold time: 4.267037630081177s (0.07111729383468628m)
2023-09-02 20:52:16,863 - CV - INFO - ----- BEGINNING FOLD SET (015:1)----------------------------------------------------------
2023-09-02 20:52:16,864 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/015/1
2023-09-02 20:52:16,864 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:16,864 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:16,864 - FGO - INFO - 	done: False
2023-09-02 20:52:16,864 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:16,864 - FGO - INFO - 	h1: 64
2023-09-02 20:52:16,864 - FGO - INFO - 	h2: 32
2023-09-02 20:52:16,864 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:16,865 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:16,865 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:16,865 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:16,865 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:16,865 - FGO - INFO - 	theta: 50
2023-09-02 20:52:16,865 - FGO - INFO - 	clip: 5
2023-09-02 20:52:16,865 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:16,865 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:16,865 - FGO - INFO - Source Total: 727
2023-09-02 20:52:16,865 - FGO - INFO - Target Total: 77
2023-09-02 20:52:16,865 - FGO - INFO - Train Total: 727
2023-09-02 20:52:16,865 - FGO - INFO - Val Total:   77
2023-09-02 20:52:16,865 - FGO - INFO - Test Total:  77
2023-09-02 20:52:16,865 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:16,865 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:16,865 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:16,865 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:16,865 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:16,865 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:16,865 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:16,865 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:16,865 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:16,865 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:16,866 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:16,868 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:16,963 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:16,963 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:16,963 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:16,963 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:16,963 - FGO - INFO - N: 804
2023-09-02 20:52:16,963 - FGO - INFO - N_s: 727
2023-09-02 20:52:16,963 - FGO - INFO - N_t: 77
2023-09-02 20:52:16,967 - CV - INFO - Begin Pretrain
2023-09-02 20:52:16,967 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:16,970 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:52:16,995 - FGO - INFO - Epoch  10 | Train Loss: 0.577 | Val Loss: 0.61 | Val F1: 0.66 |
2023-09-02 20:52:17,020 - FGO - INFO - Epoch  20 | Train Loss: 0.255 | Val Loss: 0.38 | Val F1: 0.83 |
2023-09-02 20:52:17,045 - FGO - INFO - Epoch  30 | Train Loss: 0.122 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:52:17,070 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.20 | Val F1: 0.89 |
2023-09-02 20:52:17,094 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.87 |
2023-09-02 20:52:17,119 - FGO - INFO - Epoch  60 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.89 |
2023-09-02 20:52:17,143 - FGO - INFO - Epoch  70 | Train Loss: 0.063 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:52:17,168 - FGO - INFO - Epoch  80 | Train Loss: 0.060 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:52:17,193 - FGO - INFO - Epoch  90 | Train Loss: 0.057 | Val Loss: 0.21 | Val F1: 0.90 |
2023-09-02 20:52:17,217 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.20 | Val F1: 0.92 |
2023-09-02 20:52:17,217 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.097 | Val Loss: 0.18 | Val F1: 0.93 
2023-09-02 20:52:17,217 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:17,219 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:52:17,219 - CV - INFO - Begin OT Train
2023-09-02 20:52:17,219 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:17,287 - FGO - INFO - Epoch   0 | Train Loss: -12.231 | Val Loss: -1.01 | Val F1: 0.89 |
2023-09-02 20:52:18,149 - FGO - INFO - Epoch  10 | Train Loss: -13.233 | Val Loss: -0.89 | Val F1: 0.86 |
2023-09-02 20:52:19,010 - FGO - INFO - Epoch  20 | Train Loss: -13.868 | Val Loss: -0.96 | Val F1: 0.75 |
2023-09-02 20:52:19,784 - FGO - INFO - Epoch  30 | Train Loss: -14.214 | Val Loss: -0.80 | Val F1: 0.36 |
2023-09-02 20:52:20,615 - FGO - INFO - Epoch  40 | Train Loss: -14.220 | Val Loss: -0.80 | Val F1: 0.36 |
2023-09-02 20:52:21,350 - FGO - INFO - Best Epoch:  13 | Train Loss: -13.517 | Val Loss: -1.14 | Val F1: 0.92 |
2023-09-02 20:52:21,350 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:21,353 - CV - INFO - OT Train Complete, 13 epochs
2023-09-02 20:52:21,354 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:21,377 - FGO - INFO - Train CM:
[[390   0]
 [337   0]]
2023-09-02 20:52:21,377 - FGO - INFO - Val CM:
[[44  0]
 [33  0]]
2023-09-02 20:52:21,378 - FGO - INFO - Test CM:
[[44  0]
 [33  0]]
2023-09-02 20:52:21,383 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:52:21,384 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:21,385 - FGO - INFO - test micro f1: 0.5714285714285714
2023-09-02 20:52:21,386 - FGO - INFO - test macro f1: 0.36363636363636365
2023-09-02 20:52:21,386 - CV - INFO - fold time: 4.522897720336914s (0.0753816286722819m)
2023-09-02 20:52:21,386 - CV - INFO - ----- BEGINNING FOLD SET (015:2)----------------------------------------------------------
2023-09-02 20:52:21,387 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/015/2
2023-09-02 20:52:21,387 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:21,387 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:21,387 - FGO - INFO - 	done: False
2023-09-02 20:52:21,387 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:21,387 - FGO - INFO - 	h1: 64
2023-09-02 20:52:21,387 - FGO - INFO - 	h2: 32
2023-09-02 20:52:21,387 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:21,387 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:21,387 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:21,387 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:21,387 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:21,387 - FGO - INFO - 	theta: 50
2023-09-02 20:52:21,388 - FGO - INFO - 	clip: 5
2023-09-02 20:52:21,388 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:21,388 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:21,388 - FGO - INFO - Source Total: 721
2023-09-02 20:52:21,388 - FGO - INFO - Target Total: 83
2023-09-02 20:52:21,388 - FGO - INFO - Train Total: 721
2023-09-02 20:52:21,388 - FGO - INFO - Val Total:   83
2023-09-02 20:52:21,388 - FGO - INFO - Test Total:  83
2023-09-02 20:52:21,388 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:21,388 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:21,388 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:21,388 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:21,388 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:21,388 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:21,388 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:21,388 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:21,388 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:21,388 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:21,389 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:21,391 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:21,493 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:21,493 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:21,493 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:21,493 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:21,493 - FGO - INFO - N: 804
2023-09-02 20:52:21,493 - FGO - INFO - N_s: 721
2023-09-02 20:52:21,493 - FGO - INFO - N_t: 83
2023-09-02 20:52:21,497 - CV - INFO - Begin Pretrain
2023-09-02 20:52:21,497 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:21,500 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:52:21,525 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.76 |
2023-09-02 20:52:21,549 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.33 | Val F1: 0.88 |
2023-09-02 20:52:21,574 - FGO - INFO - Epoch  30 | Train Loss: 0.120 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:52:21,598 - FGO - INFO - Epoch  40 | Train Loss: 0.083 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:52:21,622 - FGO - INFO - Epoch  50 | Train Loss: 0.071 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:52:21,647 - FGO - INFO - Epoch  60 | Train Loss: 0.062 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:52:21,671 - FGO - INFO - Epoch  70 | Train Loss: 0.059 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:52:21,696 - FGO - INFO - Epoch  80 | Train Loss: 0.055 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:52:21,720 - FGO - INFO - Epoch  90 | Train Loss: 0.053 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:52:21,744 - FGO - INFO - Epoch 100 | Train Loss: 0.051 | Val Loss: 0.26 | Val F1: 0.91 |
2023-09-02 20:52:21,744 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.063 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:52:21,744 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:21,746 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:52:21,746 - CV - INFO - Begin OT Train
2023-09-02 20:52:21,746 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:21,843 - FGO - INFO - Epoch   0 | Train Loss: -12.206 | Val Loss: -1.09 | Val F1: 0.90 |
2023-09-02 20:52:22,672 - FGO - INFO - Epoch  10 | Train Loss: -13.435 | Val Loss: -1.05 | Val F1: 0.88 |
2023-09-02 20:52:23,489 - FGO - INFO - Epoch  20 | Train Loss: -13.956 | Val Loss: -1.03 | Val F1: 0.72 |
2023-09-02 20:52:24,314 - FGO - INFO - Epoch  30 | Train Loss: -14.205 | Val Loss: -0.92 | Val F1: 0.38 |
2023-09-02 20:52:25,118 - FGO - INFO - Epoch  40 | Train Loss: -14.206 | Val Loss: -0.92 | Val F1: 0.38 |
2023-09-02 20:52:25,783 - FGO - INFO - Best Epoch:   7 | Train Loss: -13.142 | Val Loss: -1.15 | Val F1: 0.91 |
2023-09-02 20:52:25,783 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:25,786 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:52:25,786 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:25,809 - FGO - INFO - Train CM:
[[384   0]
 [337   0]]
2023-09-02 20:52:25,810 - FGO - INFO - Val CM:
[[50  0]
 [33  0]]
2023-09-02 20:52:25,810 - FGO - INFO - Test CM:
[[50  0]
 [33  0]]
2023-09-02 20:52:25,816 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:52:25,817 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:25,818 - FGO - INFO - test micro f1: 0.6024096385542169
2023-09-02 20:52:25,818 - FGO - INFO - test macro f1: 0.3759398496240602
2023-09-02 20:52:25,818 - CV - INFO - fold time: 4.4326090812683105s (0.0738768180211385m)
2023-09-02 20:52:25,818 - CV - INFO - ----- BEGINNING FOLD SET (015:3)----------------------------------------------------------
2023-09-02 20:52:25,820 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/015/3
2023-09-02 20:52:25,820 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:25,820 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:25,820 - FGO - INFO - 	done: False
2023-09-02 20:52:25,820 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:25,820 - FGO - INFO - 	h1: 64
2023-09-02 20:52:25,820 - FGO - INFO - 	h2: 32
2023-09-02 20:52:25,820 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:25,820 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:25,820 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:25,820 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:25,820 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:25,820 - FGO - INFO - 	theta: 50
2023-09-02 20:52:25,820 - FGO - INFO - 	clip: 5
2023-09-02 20:52:25,820 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:25,820 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:25,820 - FGO - INFO - Source Total: 729
2023-09-02 20:52:25,820 - FGO - INFO - Target Total: 75
2023-09-02 20:52:25,820 - FGO - INFO - Train Total: 729
2023-09-02 20:52:25,820 - FGO - INFO - Val Total:   75
2023-09-02 20:52:25,820 - FGO - INFO - Test Total:  75
2023-09-02 20:52:25,820 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:25,820 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:25,820 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:25,820 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:25,820 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:25,821 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:25,821 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:25,821 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:25,821 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:25,821 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:25,822 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:25,823 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:25,917 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:25,917 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:25,917 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:25,917 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:25,917 - FGO - INFO - N: 804
2023-09-02 20:52:25,917 - FGO - INFO - N_s: 729
2023-09-02 20:52:25,917 - FGO - INFO - N_t: 75
2023-09-02 20:52:25,921 - CV - INFO - Begin Pretrain
2023-09-02 20:52:25,921 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:25,924 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:52:25,949 - FGO - INFO - Epoch  10 | Train Loss: 0.580 | Val Loss: 0.56 | Val F1: 0.75 |
2023-09-02 20:52:25,973 - FGO - INFO - Epoch  20 | Train Loss: 0.266 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:52:25,998 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.07 | Val F1: 0.99 |
2023-09-02 20:52:26,022 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:52:26,047 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:52:26,071 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:52:26,096 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:52:26,120 - FGO - INFO - Epoch  80 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:52:26,145 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:52:26,169 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:52:26,169 - FGO - INFO - Best Epoch:  24 | Train Loss: 0.189 | Val Loss: 0.10 | Val F1: 1.00 
2023-09-02 20:52:26,169 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:26,171 - CV - INFO - Pretrain Complete, 24 epochs
2023-09-02 20:52:26,171 - CV - INFO - Begin OT Train
2023-09-02 20:52:26,171 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:26,257 - FGO - INFO - Epoch   0 | Train Loss: -12.148 | Val Loss: -1.24 | Val F1: 0.99 |
2023-09-02 20:52:27,057 - FGO - INFO - Epoch  10 | Train Loss: -13.520 | Val Loss: -1.25 | Val F1: 0.92 |
2023-09-02 20:52:27,822 - FGO - INFO - Epoch  20 | Train Loss: -13.925 | Val Loss: -0.94 | Val F1: 0.86 |
2023-09-02 20:52:28,573 - FGO - INFO - Epoch  30 | Train Loss: -14.119 | Val Loss: -0.86 | Val F1: 0.34 |
2023-09-02 20:52:29,360 - FGO - INFO - Epoch  40 | Train Loss: -14.124 | Val Loss: -0.86 | Val F1: 0.34 |
2023-09-02 20:52:30,051 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.102 | Val Loss: -1.31 | Val F1: 0.97 |
2023-09-02 20:52:30,051 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:30,054 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:52:30,054 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:30,078 - FGO - INFO - Train CM:
[[396   0]
 [333   0]]
2023-09-02 20:52:30,078 - FGO - INFO - Val CM:
[[38  0]
 [37  0]]
2023-09-02 20:52:30,078 - FGO - INFO - Test CM:
[[38  0]
 [37  0]]
2023-09-02 20:52:30,084 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:52:30,085 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:30,086 - FGO - INFO - test micro f1: 0.5066666666666667
2023-09-02 20:52:30,087 - FGO - INFO - test macro f1: 0.33628318584070793
2023-09-02 20:52:30,087 - CV - INFO - fold time: 4.26821494102478s (0.07113691568374633m)
2023-09-02 20:52:30,087 - CV - INFO - ----- BEGINNING FOLD SET (015:4)----------------------------------------------------------
2023-09-02 20:52:30,088 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/015/4
2023-09-02 20:52:30,088 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:30,088 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:30,088 - FGO - INFO - 	done: False
2023-09-02 20:52:30,088 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:30,088 - FGO - INFO - 	h1: 64
2023-09-02 20:52:30,088 - FGO - INFO - 	h2: 32
2023-09-02 20:52:30,088 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:30,088 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:30,088 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:30,088 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:30,088 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:30,088 - FGO - INFO - 	theta: 50
2023-09-02 20:52:30,088 - FGO - INFO - 	clip: 5
2023-09-02 20:52:30,088 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:30,088 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:30,088 - FGO - INFO - Source Total: 732
2023-09-02 20:52:30,088 - FGO - INFO - Target Total: 72
2023-09-02 20:52:30,089 - FGO - INFO - Train Total: 732
2023-09-02 20:52:30,089 - FGO - INFO - Val Total:   72
2023-09-02 20:52:30,089 - FGO - INFO - Test Total:  72
2023-09-02 20:52:30,089 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:30,089 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:30,089 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:30,089 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:30,089 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:30,089 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:30,089 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:30,089 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:30,089 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:30,089 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:30,090 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:30,091 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:30,182 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:30,182 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:30,182 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:30,182 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:30,182 - FGO - INFO - N: 804
2023-09-02 20:52:30,182 - FGO - INFO - N_s: 732
2023-09-02 20:52:30,182 - FGO - INFO - N_t: 72
2023-09-02 20:52:30,186 - CV - INFO - Begin Pretrain
2023-09-02 20:52:30,186 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:30,189 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:52:30,214 - FGO - INFO - Epoch  10 | Train Loss: 0.578 | Val Loss: 0.58 | Val F1: 0.78 |
2023-09-02 20:52:30,238 - FGO - INFO - Epoch  20 | Train Loss: 0.258 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:52:30,263 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:52:30,288 - FGO - INFO - Epoch  40 | Train Loss: 0.095 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:52:30,312 - FGO - INFO - Epoch  50 | Train Loss: 0.084 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:52:30,337 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:52:30,361 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:52:30,386 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:52:30,411 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:52:30,435 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:52:30,435 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.99 
2023-09-02 20:52:30,435 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:30,437 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:52:30,437 - CV - INFO - Begin OT Train
2023-09-02 20:52:30,437 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:30,505 - FGO - INFO - Epoch   0 | Train Loss: -12.383 | Val Loss: -1.22 | Val F1: 0.99 |
2023-09-02 20:52:31,270 - FGO - INFO - Epoch  10 | Train Loss: -13.531 | Val Loss: -1.25 | Val F1: 0.90 |
2023-09-02 20:52:32,059 - FGO - INFO - Epoch  20 | Train Loss: -14.041 | Val Loss: -0.85 | Val F1: 0.48 |
2023-09-02 20:52:32,830 - FGO - INFO - Epoch  30 | Train Loss: -14.102 | Val Loss: -0.82 | Val F1: 0.34 |
2023-09-02 20:52:33,586 - FGO - INFO - Epoch  40 | Train Loss: -14.104 | Val Loss: -0.82 | Val F1: 0.34 |
2023-09-02 20:52:34,275 - FGO - INFO - Best Epoch:   9 | Train Loss: -13.481 | Val Loss: -1.25 | Val F1: 0.92 |
2023-09-02 20:52:34,275 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:34,278 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:52:34,279 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:34,303 - FGO - INFO - Train CM:
[[397   0]
 [335   0]]
2023-09-02 20:52:34,303 - FGO - INFO - Val CM:
[[37  0]
 [35  0]]
2023-09-02 20:52:34,303 - FGO - INFO - Test CM:
[[37  0]
 [35  0]]
2023-09-02 20:52:34,308 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:52:34,310 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:34,311 - FGO - INFO - test micro f1: 0.5138888888888888
2023-09-02 20:52:34,311 - FGO - INFO - test macro f1: 0.33944954128440363
2023-09-02 20:52:34,311 - CV - INFO - fold time: 4.224459171295166s (0.07040765285491943m)
2023-09-02 20:52:34,311 - CV - INFO - ----- BEGINNING FOLD SET (015:5)----------------------------------------------------------
2023-09-02 20:52:34,313 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/015/5
2023-09-02 20:52:34,313 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:34,313 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:34,313 - FGO - INFO - 	done: False
2023-09-02 20:52:34,313 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:34,313 - FGO - INFO - 	h1: 64
2023-09-02 20:52:34,313 - FGO - INFO - 	h2: 32
2023-09-02 20:52:34,313 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:34,313 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:34,313 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:34,313 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:34,313 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:34,313 - FGO - INFO - 	theta: 50
2023-09-02 20:52:34,313 - FGO - INFO - 	clip: 5
2023-09-02 20:52:34,313 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:34,313 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:34,313 - FGO - INFO - Source Total: 726
2023-09-02 20:52:34,313 - FGO - INFO - Target Total: 78
2023-09-02 20:52:34,313 - FGO - INFO - Train Total: 726
2023-09-02 20:52:34,313 - FGO - INFO - Val Total:   78
2023-09-02 20:52:34,313 - FGO - INFO - Test Total:  78
2023-09-02 20:52:34,313 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:34,313 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:34,313 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:34,313 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:34,313 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:34,314 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:34,314 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:34,314 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:34,314 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:34,314 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:34,315 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:34,316 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:34,413 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:34,413 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:34,413 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:34,413 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:34,413 - FGO - INFO - N: 804
2023-09-02 20:52:34,413 - FGO - INFO - N_s: 726
2023-09-02 20:52:34,413 - FGO - INFO - N_t: 78
2023-09-02 20:52:34,417 - CV - INFO - Begin Pretrain
2023-09-02 20:52:34,417 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:34,420 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:52:34,463 - FGO - INFO - Epoch  10 | Train Loss: 0.582 | Val Loss: 0.61 | Val F1: 0.72 |
2023-09-02 20:52:34,493 - FGO - INFO - Epoch  20 | Train Loss: 0.268 | Val Loss: 0.31 | Val F1: 0.87 |
2023-09-02 20:52:34,518 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.25 | Val F1: 0.92 |
2023-09-02 20:52:34,543 - FGO - INFO - Epoch  40 | Train Loss: 0.100 | Val Loss: 0.22 | Val F1: 0.92 |
2023-09-02 20:52:34,567 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:52:34,591 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:52:34,616 - FGO - INFO - Epoch  70 | Train Loss: 0.072 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:52:34,640 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:52:34,665 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:52:34,689 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:52:34,689 - FGO - INFO - Best Epoch:  77 | Train Loss: 0.071 | Val Loss: 0.10 | Val F1: 0.96 
2023-09-02 20:52:34,689 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:34,690 - CV - INFO - Pretrain Complete, 77 epochs
2023-09-02 20:52:34,690 - CV - INFO - Begin OT Train
2023-09-02 20:52:34,690 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:34,757 - FGO - INFO - Epoch   0 | Train Loss: -12.111 | Val Loss: -1.21 | Val F1: 0.96 |
2023-09-02 20:52:35,573 - FGO - INFO - Epoch  10 | Train Loss: -13.540 | Val Loss: -1.15 | Val F1: 0.88 |
2023-09-02 20:52:36,393 - FGO - INFO - Epoch  20 | Train Loss: -13.931 | Val Loss: -0.97 | Val F1: 0.77 |
2023-09-02 20:52:37,121 - FGO - INFO - Epoch  30 | Train Loss: -14.163 | Val Loss: -0.86 | Val F1: 0.30 |
2023-09-02 20:52:37,872 - FGO - INFO - Epoch  40 | Train Loss: -14.167 | Val Loss: -0.86 | Val F1: 0.30 |
2023-09-02 20:52:38,547 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.143 | Val Loss: -1.25 | Val F1: 0.96 |
2023-09-02 20:52:38,548 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:38,551 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:52:38,551 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:38,574 - FGO - INFO - Train CM:
[[400   0]
 [326   0]]
2023-09-02 20:52:38,575 - FGO - INFO - Val CM:
[[34  0]
 [44  0]]
2023-09-02 20:52:38,575 - FGO - INFO - Test CM:
[[34  0]
 [44  0]]
2023-09-02 20:52:38,580 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:52:38,582 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:38,583 - FGO - INFO - test micro f1: 0.4358974358974359
2023-09-02 20:52:38,583 - FGO - INFO - test macro f1: 0.30357142857142855
2023-09-02 20:52:38,583 - CV - INFO - fold time: 4.271937608718872s (0.07119896014531453m)
2023-09-02 20:52:38,583 - CV - INFO - ----- BEGINNING FOLD SET (015:6)----------------------------------------------------------
2023-09-02 20:52:38,585 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/015/6
2023-09-02 20:52:38,585 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:38,585 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:38,585 - FGO - INFO - 	done: False
2023-09-02 20:52:38,585 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:38,585 - FGO - INFO - 	h1: 64
2023-09-02 20:52:38,585 - FGO - INFO - 	h2: 32
2023-09-02 20:52:38,585 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:38,585 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:38,585 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:38,585 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:38,585 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:38,585 - FGO - INFO - 	theta: 50
2023-09-02 20:52:38,585 - FGO - INFO - 	clip: 5
2023-09-02 20:52:38,585 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:38,585 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:38,585 - FGO - INFO - Source Total: 717
2023-09-02 20:52:38,585 - FGO - INFO - Target Total: 87
2023-09-02 20:52:38,585 - FGO - INFO - Train Total: 717
2023-09-02 20:52:38,585 - FGO - INFO - Val Total:   87
2023-09-02 20:52:38,585 - FGO - INFO - Test Total:  87
2023-09-02 20:52:38,585 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:38,585 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:38,585 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:38,585 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:38,585 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:38,586 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:38,586 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:38,586 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:38,586 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:38,586 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:38,587 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:38,588 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:38,693 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:38,693 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:38,693 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:38,693 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:38,693 - FGO - INFO - N: 804
2023-09-02 20:52:38,693 - FGO - INFO - N_s: 717
2023-09-02 20:52:38,694 - FGO - INFO - N_t: 87
2023-09-02 20:52:38,697 - CV - INFO - Begin Pretrain
2023-09-02 20:52:38,697 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:38,700 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:52:38,725 - FGO - INFO - Epoch  10 | Train Loss: 0.585 | Val Loss: 0.57 | Val F1: 0.75 |
2023-09-02 20:52:38,749 - FGO - INFO - Epoch  20 | Train Loss: 0.271 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:52:38,774 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:52:38,798 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:52:38,823 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:52:38,847 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:52:38,871 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:52:38,896 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:52:38,920 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:52:38,944 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:52:38,944 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.107 | Val Loss: 0.08 | Val F1: 0.99 
2023-09-02 20:52:38,944 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:38,946 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:52:38,946 - CV - INFO - Begin OT Train
2023-09-02 20:52:38,946 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:39,013 - FGO - INFO - Epoch   0 | Train Loss: -12.370 | Val Loss: -1.54 | Val F1: 0.99 |
2023-09-02 20:52:39,851 - FGO - INFO - Epoch  10 | Train Loss: -13.432 | Val Loss: -1.64 | Val F1: 0.96 |
2023-09-02 20:52:40,636 - FGO - INFO - Epoch  20 | Train Loss: -13.629 | Val Loss: -1.50 | Val F1: 0.81 |
2023-09-02 20:52:41,445 - FGO - INFO - Epoch  30 | Train Loss: -13.988 | Val Loss: -1.18 | Val F1: 0.39 |
2023-09-02 20:52:42,193 - FGO - INFO - Epoch  40 | Train Loss: -13.999 | Val Loss: -1.18 | Val F1: 0.36 |
2023-09-02 20:52:42,881 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.201 | Val Loss: -1.63 | Val F1: 0.99 |
2023-09-02 20:52:42,881 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:42,885 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:52:42,885 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:42,912 - FGO - INFO - Train CM:
[[385   0]
 [332   0]]
2023-09-02 20:52:42,912 - FGO - INFO - Val CM:
[[49  0]
 [38  0]]
2023-09-02 20:52:42,912 - FGO - INFO - Test CM:
[[49  0]
 [38  0]]
2023-09-02 20:52:42,918 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:52:42,919 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:42,920 - FGO - INFO - test micro f1: 0.5632183908045977
2023-09-02 20:52:42,920 - FGO - INFO - test macro f1: 0.3602941176470588
2023-09-02 20:52:42,920 - CV - INFO - fold time: 4.337286949157715s (0.07228811581929524m)
2023-09-02 20:52:42,920 - CV - INFO - ----- BEGINNING FOLD SET (015:7)----------------------------------------------------------
2023-09-02 20:52:42,922 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/015/7
2023-09-02 20:52:42,922 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:42,922 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:42,922 - FGO - INFO - 	done: False
2023-09-02 20:52:42,922 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:42,922 - FGO - INFO - 	h1: 64
2023-09-02 20:52:42,922 - FGO - INFO - 	h2: 32
2023-09-02 20:52:42,922 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:42,922 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:42,922 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:42,922 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:42,922 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:42,922 - FGO - INFO - 	theta: 50
2023-09-02 20:52:42,922 - FGO - INFO - 	clip: 5
2023-09-02 20:52:42,922 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:42,922 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:42,922 - FGO - INFO - Source Total: 717
2023-09-02 20:52:42,922 - FGO - INFO - Target Total: 87
2023-09-02 20:52:42,922 - FGO - INFO - Train Total: 717
2023-09-02 20:52:42,922 - FGO - INFO - Val Total:   87
2023-09-02 20:52:42,922 - FGO - INFO - Test Total:  87
2023-09-02 20:52:42,922 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:42,922 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:42,922 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:42,922 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:42,922 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:42,923 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:42,923 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:42,923 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:42,923 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:42,923 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:42,924 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:42,925 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:43,030 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:43,030 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:43,030 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:43,030 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:43,030 - FGO - INFO - N: 804
2023-09-02 20:52:43,030 - FGO - INFO - N_s: 717
2023-09-02 20:52:43,030 - FGO - INFO - N_t: 87
2023-09-02 20:52:43,034 - CV - INFO - Begin Pretrain
2023-09-02 20:52:43,034 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:43,037 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:52:43,062 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.72 |
2023-09-02 20:52:43,087 - FGO - INFO - Epoch  20 | Train Loss: 0.265 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:52:43,111 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:52:43,136 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:52:43,161 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:52:43,185 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:52:43,210 - FGO - INFO - Epoch  70 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:52:43,234 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:52:43,259 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:52:43,283 - FGO - INFO - Epoch 100 | Train Loss: 0.069 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:52:43,283 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.169 | Val Loss: 0.14 | Val F1: 0.98 
2023-09-02 20:52:43,283 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:43,285 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:52:43,285 - CV - INFO - Begin OT Train
2023-09-02 20:52:43,285 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:43,365 - FGO - INFO - Epoch   0 | Train Loss: -12.330 | Val Loss: -1.31 | Val F1: 0.95 |
2023-09-02 20:52:44,180 - FGO - INFO - Epoch  10 | Train Loss: -13.458 | Val Loss: -1.46 | Val F1: 0.94 |
2023-09-02 20:52:44,963 - FGO - INFO - Epoch  20 | Train Loss: -13.941 | Val Loss: -1.18 | Val F1: 0.63 |
2023-09-02 20:52:45,713 - FGO - INFO - Epoch  30 | Train Loss: -14.092 | Val Loss: -1.09 | Val F1: 0.35 |
2023-09-02 20:52:46,523 - FGO - INFO - Epoch  40 | Train Loss: -14.093 | Val Loss: -1.09 | Val F1: 0.35 |
2023-09-02 20:52:47,184 - FGO - INFO - Best Epoch:   8 | Train Loss: -13.300 | Val Loss: -1.50 | Val F1: 0.95 |
2023-09-02 20:52:47,184 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:47,186 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:52:47,187 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:47,210 - FGO - INFO - Train CM:
[[387   0]
 [330   0]]
2023-09-02 20:52:47,211 - FGO - INFO - Val CM:
[[47  0]
 [40  0]]
2023-09-02 20:52:47,211 - FGO - INFO - Test CM:
[[47  0]
 [40  0]]
2023-09-02 20:52:47,216 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:52:47,218 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:47,218 - FGO - INFO - test micro f1: 0.5402298850574713
2023-09-02 20:52:47,219 - FGO - INFO - test macro f1: 0.3507462686567164
2023-09-02 20:52:47,219 - CV - INFO - fold time: 4.2985968589782715s (0.0716432809829712m)
2023-09-02 20:52:47,219 - CV - INFO - ----- BEGINNING FOLD SET (015:8)----------------------------------------------------------
2023-09-02 20:52:47,220 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/015/8
2023-09-02 20:52:47,221 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:47,221 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:47,221 - FGO - INFO - 	done: False
2023-09-02 20:52:47,221 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:47,221 - FGO - INFO - 	h1: 64
2023-09-02 20:52:47,221 - FGO - INFO - 	h2: 32
2023-09-02 20:52:47,221 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:47,221 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:47,221 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:47,221 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:47,221 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:47,221 - FGO - INFO - 	theta: 50
2023-09-02 20:52:47,221 - FGO - INFO - 	clip: 5
2023-09-02 20:52:47,221 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:47,221 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:47,221 - FGO - INFO - Source Total: 734
2023-09-02 20:52:47,221 - FGO - INFO - Target Total: 70
2023-09-02 20:52:47,221 - FGO - INFO - Train Total: 734
2023-09-02 20:52:47,221 - FGO - INFO - Val Total:   70
2023-09-02 20:52:47,221 - FGO - INFO - Test Total:  70
2023-09-02 20:52:47,221 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:47,221 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:47,221 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:47,221 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:47,221 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:47,222 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:47,222 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:47,222 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:47,222 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:47,222 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:47,256 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:47,257 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:47,346 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:47,346 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:47,346 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:47,346 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:47,346 - FGO - INFO - N: 804
2023-09-02 20:52:47,346 - FGO - INFO - N_s: 734
2023-09-02 20:52:47,346 - FGO - INFO - N_t: 70
2023-09-02 20:52:47,350 - CV - INFO - Begin Pretrain
2023-09-02 20:52:47,350 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:47,353 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:52:47,378 - FGO - INFO - Epoch  10 | Train Loss: 0.564 | Val Loss: 0.59 | Val F1: 0.75 |
2023-09-02 20:52:47,403 - FGO - INFO - Epoch  20 | Train Loss: 0.257 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:52:47,428 - FGO - INFO - Epoch  30 | Train Loss: 0.132 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:52:47,452 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.13 | Val F1: 0.94 |
2023-09-02 20:52:47,477 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:52:47,502 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:52:47,527 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:52:47,551 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:52:47,576 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.16 | Val F1: 0.93 |
2023-09-02 20:52:47,601 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:52:47,601 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.108 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:52:47,601 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:47,602 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:52:47,602 - CV - INFO - Begin OT Train
2023-09-02 20:52:47,602 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:47,671 - FGO - INFO - Epoch   0 | Train Loss: -12.297 | Val Loss: -1.00 | Val F1: 0.93 |
2023-09-02 20:52:48,467 - FGO - INFO - Epoch  10 | Train Loss: -13.497 | Val Loss: -0.94 | Val F1: 0.86 |
2023-09-02 20:52:49,280 - FGO - INFO - Epoch  20 | Train Loss: -13.967 | Val Loss: -0.80 | Val F1: 0.66 |
2023-09-02 20:52:50,111 - FGO - INFO - Epoch  30 | Train Loss: -14.179 | Val Loss: -0.70 | Val F1: 0.33 |
2023-09-02 20:52:50,865 - FGO - INFO - Epoch  40 | Train Loss: -14.184 | Val Loss: -0.70 | Val F1: 0.33 |
2023-09-02 20:52:51,549 - FGO - INFO - Best Epoch:   7 | Train Loss: -13.272 | Val Loss: -1.05 | Val F1: 0.94 |
2023-09-02 20:52:51,549 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:51,553 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:52:51,553 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:51,576 - FGO - INFO - Train CM:
[[400   0]
 [334   0]]
2023-09-02 20:52:51,577 - FGO - INFO - Val CM:
[[34  0]
 [36  0]]
2023-09-02 20:52:51,577 - FGO - INFO - Test CM:
[[34  0]
 [36  0]]
2023-09-02 20:52:51,582 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:52:51,584 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:51,584 - FGO - INFO - test micro f1: 0.4857142857142857
2023-09-02 20:52:51,585 - FGO - INFO - test macro f1: 0.3269230769230769
2023-09-02 20:52:51,585 - CV - INFO - fold time: 4.365987539291382s (0.0727664589881897m)
2023-09-02 20:52:51,585 - CV - INFO - ----- BEGINNING FOLD SET (015:9)----------------------------------------------------------
2023-09-02 20:52:51,586 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/015/9
2023-09-02 20:52:51,587 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:51,587 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:51,587 - FGO - INFO - 	done: False
2023-09-02 20:52:51,587 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:51,587 - FGO - INFO - 	h1: 64
2023-09-02 20:52:51,587 - FGO - INFO - 	h2: 32
2023-09-02 20:52:51,587 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:51,587 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:51,587 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:51,587 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:51,587 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:52:51,587 - FGO - INFO - 	theta: 50
2023-09-02 20:52:51,587 - FGO - INFO - 	clip: 5
2023-09-02 20:52:51,587 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:51,587 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:51,587 - FGO - INFO - Source Total: 725
2023-09-02 20:52:51,587 - FGO - INFO - Target Total: 79
2023-09-02 20:52:51,587 - FGO - INFO - Train Total: 725
2023-09-02 20:52:51,587 - FGO - INFO - Val Total:   79
2023-09-02 20:52:51,587 - FGO - INFO - Test Total:  79
2023-09-02 20:52:51,587 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:51,587 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:51,587 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:51,587 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:51,587 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:51,588 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:51,588 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:51,588 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:51,588 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:51,588 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:51,589 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:51,590 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:51,688 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:51,688 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:51,688 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:51,688 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:51,688 - FGO - INFO - N: 804
2023-09-02 20:52:51,688 - FGO - INFO - N_s: 725
2023-09-02 20:52:51,688 - FGO - INFO - N_t: 79
2023-09-02 20:52:51,692 - CV - INFO - Begin Pretrain
2023-09-02 20:52:51,692 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:51,695 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:52:51,720 - FGO - INFO - Epoch  10 | Train Loss: 0.579 | Val Loss: 0.59 | Val F1: 0.74 |
2023-09-02 20:52:51,745 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.30 | Val F1: 0.91 |
2023-09-02 20:52:51,769 - FGO - INFO - Epoch  30 | Train Loss: 0.128 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:52:51,794 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:52:51,818 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:52:51,843 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:52:51,867 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:52:51,892 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:52:51,916 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:52:51,940 - FGO - INFO - Epoch 100 | Train Loss: 0.065 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:52:51,940 - FGO - INFO - Best Epoch:  51 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.99 
2023-09-02 20:52:51,940 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:51,942 - CV - INFO - Pretrain Complete, 51 epochs
2023-09-02 20:52:51,942 - CV - INFO - Begin OT Train
2023-09-02 20:52:51,942 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:52,041 - FGO - INFO - Epoch   0 | Train Loss: -12.383 | Val Loss: -1.22 | Val F1: 0.97 |
2023-09-02 20:52:52,841 - FGO - INFO - Epoch  10 | Train Loss: -13.368 | Val Loss: -1.22 | Val F1: 0.90 |
2023-09-02 20:52:53,688 - FGO - INFO - Epoch  20 | Train Loss: -13.776 | Val Loss: -1.13 | Val F1: 0.92 |
2023-09-02 20:52:54,455 - FGO - INFO - Epoch  30 | Train Loss: -14.117 | Val Loss: -0.93 | Val F1: 0.45 |
2023-09-02 20:52:55,191 - FGO - INFO - Epoch  40 | Train Loss: -14.133 | Val Loss: -0.93 | Val F1: 0.38 |
2023-09-02 20:52:55,868 - FGO - INFO - Best Epoch:  12 | Train Loss: -13.562 | Val Loss: -1.35 | Val F1: 0.96 |
2023-09-02 20:52:55,868 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:55,871 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:52:55,872 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:52:55,896 - FGO - INFO - Train CM:
[[385   0]
 [340   0]]
2023-09-02 20:52:55,896 - FGO - INFO - Val CM:
[[49  0]
 [30  0]]
2023-09-02 20:52:55,896 - FGO - INFO - Test CM:
[[49  0]
 [30  0]]
2023-09-02 20:52:55,901 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:52:55,903 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:52:55,904 - FGO - INFO - test micro f1: 0.620253164556962
2023-09-02 20:52:55,904 - FGO - INFO - test macro f1: 0.3828125
2023-09-02 20:52:55,904 - CV - INFO - fold time: 4.319036483764648s (0.07198394139607747m)
2023-09-02 20:52:55,904 - CV - INFO - Mean Pretrain Epochs 45.5:
2023-09-02 20:52:55,904 - CV - INFO - Mean OT Train Epochs 8.3:
2023-09-02 20:52:55,904 - CV - INFO - Mean Val Macro F1 : 0.3491007683535168
2023-09-02 20:52:55,904 - CV - INFO - Mean Eval Stat : 0.3491007683535168 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:52:55,904 - CV - INFO - set time: 43.308610677719116s (0.7218101779619853m)
2023-09-02 20:52:55,904 - CV - INFO - script time so far: 673.8552873134613s (11.230921455224355m) (0.18718202425373925h)
2023-09-02 20:52:55,904 - CV - INFO - ===== BEGINNING OPTION SET (016)==========================================================
2023-09-02 20:52:55,904 - CV - INFO - 	done: False
2023-09-02 20:52:55,904 - CV - INFO - 	learning_rate: 0.005
2023-09-02 20:52:55,904 - CV - INFO - 	h1: 64
2023-09-02 20:52:55,904 - CV - INFO - 	h2: 32
2023-09-02 20:52:55,904 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:55,904 - CV - INFO - 	dropout: 0.0
2023-09-02 20:52:55,904 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:55,904 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:55,904 - CV - INFO - 	lambda: 0.05
2023-09-02 20:52:55,904 - CV - INFO - 	theta: 10
2023-09-02 20:52:55,904 - CV - INFO - 	clip: 5
2023-09-02 20:52:55,904 - CV - INFO - ----- BEGINNING FOLD SET (016:0)----------------------------------------------------------
2023-09-02 20:52:55,906 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/016/0
2023-09-02 20:52:55,906 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:52:55,906 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:52:55,906 - FGO - INFO - 	done: False
2023-09-02 20:52:55,906 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:52:55,906 - FGO - INFO - 	h1: 64
2023-09-02 20:52:55,906 - FGO - INFO - 	h2: 32
2023-09-02 20:52:55,906 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:52:55,906 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:52:55,906 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:52:55,906 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:52:55,906 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:52:55,906 - FGO - INFO - 	theta: 10
2023-09-02 20:52:55,906 - FGO - INFO - 	clip: 5
2023-09-02 20:52:55,906 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:52:55,906 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:52:55,906 - FGO - INFO - Source Total: 708
2023-09-02 20:52:55,906 - FGO - INFO - Target Total: 96
2023-09-02 20:52:55,906 - FGO - INFO - Train Total: 708
2023-09-02 20:52:55,906 - FGO - INFO - Val Total:   96
2023-09-02 20:52:55,906 - FGO - INFO - Test Total:  96
2023-09-02 20:52:55,906 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:52:55,906 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:52:55,906 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:52:55,906 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:52:55,906 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:52:55,907 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:52:55,907 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:52:55,907 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:52:55,907 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:52:55,907 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:52:55,908 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:52:55,909 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:52:56,024 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:52:56,024 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:52:56,024 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:52:56,024 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:52:56,024 - FGO - INFO - N: 804
2023-09-02 20:52:56,024 - FGO - INFO - N_s: 708
2023-09-02 20:52:56,024 - FGO - INFO - N_t: 96
2023-09-02 20:52:56,028 - CV - INFO - Begin Pretrain
2023-09-02 20:52:56,028 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:52:56,031 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:52:56,056 - FGO - INFO - Epoch  10 | Train Loss: 0.572 | Val Loss: 0.59 | Val F1: 0.62 |
2023-09-02 20:52:56,080 - FGO - INFO - Epoch  20 | Train Loss: 0.245 | Val Loss: 0.25 | Val F1: 0.93 |
2023-09-02 20:52:56,104 - FGO - INFO - Epoch  30 | Train Loss: 0.127 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:52:56,128 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:52:56,152 - FGO - INFO - Epoch  50 | Train Loss: 0.083 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:52:56,176 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:52:56,200 - FGO - INFO - Epoch  70 | Train Loss: 0.067 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:52:56,224 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:52:56,248 - FGO - INFO - Epoch  90 | Train Loss: 0.060 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:52:56,272 - FGO - INFO - Epoch 100 | Train Loss: 0.058 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:52:56,272 - FGO - INFO - Best Epoch:  39 | Train Loss: 0.095 | Val Loss: 0.10 | Val F1: 0.98 
2023-09-02 20:52:56,272 - FGO - INFO - Setting model to best state.
2023-09-02 20:52:56,274 - CV - INFO - Pretrain Complete, 39 epochs
2023-09-02 20:52:56,274 - CV - INFO - Begin OT Train
2023-09-02 20:52:56,274 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:52:56,368 - FGO - INFO - Epoch   0 | Train Loss: -4.251 | Val Loss: -0.48 | Val F1: 0.97 |
2023-09-02 20:52:57,182 - FGO - INFO - Epoch  10 | Train Loss: -4.312 | Val Loss: -0.49 | Val F1: 0.96 |
2023-09-02 20:52:57,933 - FGO - INFO - Epoch  20 | Train Loss: -4.414 | Val Loss: -0.47 | Val F1: 0.96 |
2023-09-02 20:52:58,693 - FGO - INFO - Epoch  30 | Train Loss: -4.477 | Val Loss: -0.52 | Val F1: 0.97 |
2023-09-02 20:52:59,486 - FGO - INFO - Epoch  40 | Train Loss: -4.511 | Val Loss: -0.52 | Val F1: 0.97 |
2023-09-02 20:53:00,138 - FGO - INFO - Best Epoch:  15 | Train Loss: -4.404 | Val Loss: -0.49 | Val F1: 0.97 |
2023-09-02 20:53:00,138 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:00,141 - CV - INFO - OT Train Complete, 15 epochs
2023-09-02 20:53:00,142 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:00,165 - FGO - INFO - Train CM:
[[373   9]
 [  9 317]]
2023-09-02 20:53:00,166 - FGO - INFO - Val CM:
[[52  0]
 [ 3 41]]
2023-09-02 20:53:00,166 - FGO - INFO - Test CM:
[[52  0]
 [ 3 41]]
2023-09-02 20:53:00,172 - FGO - INFO - test statistical parity: 0.3390374331550802
2023-09-02 20:53:00,173 - FGO - INFO - test equal opportunity: 0.08333333333333337
2023-09-02 20:53:00,174 - FGO - INFO - test micro f1: 0.96875
2023-09-02 20:53:00,174 - FGO - INFO - test macro f1: 0.9683342495876855
2023-09-02 20:53:00,174 - CV - INFO - fold time: 4.26986026763916s (0.071164337793986m)
2023-09-02 20:53:00,174 - CV - INFO - ----- BEGINNING FOLD SET (016:1)----------------------------------------------------------
2023-09-02 20:53:00,176 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/016/1
2023-09-02 20:53:00,176 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:00,176 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:00,176 - FGO - INFO - 	done: False
2023-09-02 20:53:00,176 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:00,176 - FGO - INFO - 	h1: 64
2023-09-02 20:53:00,176 - FGO - INFO - 	h2: 32
2023-09-02 20:53:00,176 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:00,176 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:00,176 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:00,176 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:00,176 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:00,176 - FGO - INFO - 	theta: 10
2023-09-02 20:53:00,176 - FGO - INFO - 	clip: 5
2023-09-02 20:53:00,176 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:00,176 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:00,176 - FGO - INFO - Source Total: 727
2023-09-02 20:53:00,176 - FGO - INFO - Target Total: 77
2023-09-02 20:53:00,176 - FGO - INFO - Train Total: 727
2023-09-02 20:53:00,176 - FGO - INFO - Val Total:   77
2023-09-02 20:53:00,176 - FGO - INFO - Test Total:  77
2023-09-02 20:53:00,176 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:00,176 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:00,176 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:00,176 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:00,176 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:00,177 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:00,177 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:00,177 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:00,177 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:00,177 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:00,178 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:00,179 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:00,275 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:00,275 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:00,275 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:00,275 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:00,275 - FGO - INFO - N: 804
2023-09-02 20:53:00,275 - FGO - INFO - N_s: 727
2023-09-02 20:53:00,275 - FGO - INFO - N_t: 77
2023-09-02 20:53:00,279 - CV - INFO - Begin Pretrain
2023-09-02 20:53:00,279 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:00,282 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:53:00,307 - FGO - INFO - Epoch  10 | Train Loss: 0.577 | Val Loss: 0.61 | Val F1: 0.66 |
2023-09-02 20:53:00,332 - FGO - INFO - Epoch  20 | Train Loss: 0.255 | Val Loss: 0.38 | Val F1: 0.83 |
2023-09-02 20:53:00,356 - FGO - INFO - Epoch  30 | Train Loss: 0.122 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:53:00,381 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.20 | Val F1: 0.89 |
2023-09-02 20:53:00,406 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.87 |
2023-09-02 20:53:00,430 - FGO - INFO - Epoch  60 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.89 |
2023-09-02 20:53:00,455 - FGO - INFO - Epoch  70 | Train Loss: 0.063 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:53:00,479 - FGO - INFO - Epoch  80 | Train Loss: 0.060 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:53:00,504 - FGO - INFO - Epoch  90 | Train Loss: 0.057 | Val Loss: 0.21 | Val F1: 0.90 |
2023-09-02 20:53:00,528 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.20 | Val F1: 0.92 |
2023-09-02 20:53:00,528 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.097 | Val Loss: 0.18 | Val F1: 0.93 
2023-09-02 20:53:00,528 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:00,530 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:53:00,530 - CV - INFO - Begin OT Train
2023-09-02 20:53:00,530 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:00,627 - FGO - INFO - Epoch   0 | Train Loss: -4.213 | Val Loss: -0.21 | Val F1: 0.89 |
2023-09-02 20:53:01,495 - FGO - INFO - Epoch  10 | Train Loss: -4.324 | Val Loss: -0.06 | Val F1: 0.87 |
2023-09-02 20:53:02,265 - FGO - INFO - Epoch  20 | Train Loss: -4.458 | Val Loss: -0.24 | Val F1: 0.90 |
2023-09-02 20:53:03,056 - FGO - INFO - Epoch  30 | Train Loss: -4.535 | Val Loss: -0.25 | Val F1: 0.89 |
2023-09-02 20:53:03,813 - FGO - INFO - Epoch  40 | Train Loss: -4.585 | Val Loss: -0.22 | Val F1: 0.93 |
2023-09-02 20:53:04,546 - FGO - INFO - Best Epoch:   7 | Train Loss: -4.357 | Val Loss: -0.22 | Val F1: 0.93 |
2023-09-02 20:53:04,547 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:04,550 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:53:04,550 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:04,576 - FGO - INFO - Train CM:
[[382   8]
 [ 10 327]]
2023-09-02 20:53:04,576 - FGO - INFO - Val CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:53:04,577 - FGO - INFO - Test CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:53:04,582 - FGO - INFO - test statistical parity: 0.36282051282051286
2023-09-02 20:53:04,584 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:53:04,585 - FGO - INFO - test micro f1: 0.935064935064935
2023-09-02 20:53:04,585 - FGO - INFO - test macro f1: 0.9328449328449329
2023-09-02 20:53:04,585 - CV - INFO - fold time: 4.410797834396362s (0.07351329723993937m)
2023-09-02 20:53:04,585 - CV - INFO - ----- BEGINNING FOLD SET (016:2)----------------------------------------------------------
2023-09-02 20:53:04,587 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/016/2
2023-09-02 20:53:04,587 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:04,587 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:04,587 - FGO - INFO - 	done: False
2023-09-02 20:53:04,587 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:04,587 - FGO - INFO - 	h1: 64
2023-09-02 20:53:04,587 - FGO - INFO - 	h2: 32
2023-09-02 20:53:04,587 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:04,587 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:04,587 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:04,587 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:04,587 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:04,587 - FGO - INFO - 	theta: 10
2023-09-02 20:53:04,587 - FGO - INFO - 	clip: 5
2023-09-02 20:53:04,587 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:04,587 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:04,587 - FGO - INFO - Source Total: 721
2023-09-02 20:53:04,587 - FGO - INFO - Target Total: 83
2023-09-02 20:53:04,587 - FGO - INFO - Train Total: 721
2023-09-02 20:53:04,587 - FGO - INFO - Val Total:   83
2023-09-02 20:53:04,587 - FGO - INFO - Test Total:  83
2023-09-02 20:53:04,587 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:04,587 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:04,587 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:04,587 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:04,587 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:04,588 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:04,588 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:04,588 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:04,588 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:04,588 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:04,589 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:04,590 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:04,693 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:04,693 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:04,693 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:04,693 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:04,693 - FGO - INFO - N: 804
2023-09-02 20:53:04,693 - FGO - INFO - N_s: 721
2023-09-02 20:53:04,693 - FGO - INFO - N_t: 83
2023-09-02 20:53:04,696 - CV - INFO - Begin Pretrain
2023-09-02 20:53:04,696 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:04,699 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:53:04,724 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.76 |
2023-09-02 20:53:04,749 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.33 | Val F1: 0.88 |
2023-09-02 20:53:04,773 - FGO - INFO - Epoch  30 | Train Loss: 0.120 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:53:04,798 - FGO - INFO - Epoch  40 | Train Loss: 0.083 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:53:04,822 - FGO - INFO - Epoch  50 | Train Loss: 0.071 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:53:04,847 - FGO - INFO - Epoch  60 | Train Loss: 0.062 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:53:04,871 - FGO - INFO - Epoch  70 | Train Loss: 0.059 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:53:04,896 - FGO - INFO - Epoch  80 | Train Loss: 0.055 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:53:04,920 - FGO - INFO - Epoch  90 | Train Loss: 0.053 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:53:04,944 - FGO - INFO - Epoch 100 | Train Loss: 0.051 | Val Loss: 0.26 | Val F1: 0.91 |
2023-09-02 20:53:04,944 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.063 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:53:04,944 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:04,946 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:53:04,946 - CV - INFO - Begin OT Train
2023-09-02 20:53:04,946 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:05,041 - FGO - INFO - Epoch   0 | Train Loss: -4.239 | Val Loss: -0.21 | Val F1: 0.90 |
2023-09-02 20:53:05,807 - FGO - INFO - Epoch  10 | Train Loss: -4.417 | Val Loss: -0.06 | Val F1: 0.88 |
2023-09-02 20:53:06,643 - FGO - INFO - Epoch  20 | Train Loss: -4.506 | Val Loss: -0.23 | Val F1: 0.90 |
2023-09-02 20:53:07,357 - FGO - INFO - Epoch  30 | Train Loss: -4.564 | Val Loss: -0.11 | Val F1: 0.91 |
2023-09-02 20:53:08,126 - FGO - INFO - Epoch  40 | Train Loss: -4.604 | Val Loss: -0.09 | Val F1: 0.91 |
2023-09-02 20:53:08,814 - FGO - INFO - Best Epoch:  11 | Train Loss: -4.431 | Val Loss: -0.18 | Val F1: 0.91 |
2023-09-02 20:53:08,814 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:08,817 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:53:08,817 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:08,845 - FGO - INFO - Train CM:
[[379   5]
 [  9 328]]
2023-09-02 20:53:08,845 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:53:08,845 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:53:08,851 - FGO - INFO - test statistical parity: 0.02230046948356812
2023-09-02 20:53:08,852 - FGO - INFO - test equal opportunity: 0.2592592592592593
2023-09-02 20:53:08,853 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:53:08,854 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:53:08,854 - CV - INFO - fold time: 4.2685465812683105s (0.07114244302113851m)
2023-09-02 20:53:08,854 - CV - INFO - ----- BEGINNING FOLD SET (016:3)----------------------------------------------------------
2023-09-02 20:53:08,855 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/016/3
2023-09-02 20:53:08,855 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:08,855 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:08,855 - FGO - INFO - 	done: False
2023-09-02 20:53:08,855 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:08,855 - FGO - INFO - 	h1: 64
2023-09-02 20:53:08,855 - FGO - INFO - 	h2: 32
2023-09-02 20:53:08,855 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:08,855 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:08,855 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:08,855 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:08,855 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:08,855 - FGO - INFO - 	theta: 10
2023-09-02 20:53:08,855 - FGO - INFO - 	clip: 5
2023-09-02 20:53:08,855 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:08,856 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:08,856 - FGO - INFO - Source Total: 729
2023-09-02 20:53:08,856 - FGO - INFO - Target Total: 75
2023-09-02 20:53:08,856 - FGO - INFO - Train Total: 729
2023-09-02 20:53:08,856 - FGO - INFO - Val Total:   75
2023-09-02 20:53:08,856 - FGO - INFO - Test Total:  75
2023-09-02 20:53:08,856 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:08,856 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:08,856 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:08,856 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:08,856 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:08,856 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:08,856 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:08,856 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:08,856 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:08,856 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:08,857 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:08,858 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:08,952 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:08,952 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:08,952 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:08,952 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:08,952 - FGO - INFO - N: 804
2023-09-02 20:53:08,952 - FGO - INFO - N_s: 729
2023-09-02 20:53:08,952 - FGO - INFO - N_t: 75
2023-09-02 20:53:08,956 - CV - INFO - Begin Pretrain
2023-09-02 20:53:08,956 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:08,959 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:53:08,984 - FGO - INFO - Epoch  10 | Train Loss: 0.580 | Val Loss: 0.56 | Val F1: 0.75 |
2023-09-02 20:53:09,009 - FGO - INFO - Epoch  20 | Train Loss: 0.266 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:53:09,033 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.07 | Val F1: 0.99 |
2023-09-02 20:53:09,058 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:53:09,082 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:53:09,107 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:53:09,131 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:53:09,156 - FGO - INFO - Epoch  80 | Train Loss: 0.076 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:53:09,180 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:53:09,204 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:53:09,204 - FGO - INFO - Best Epoch:  24 | Train Loss: 0.189 | Val Loss: 0.10 | Val F1: 1.00 
2023-09-02 20:53:09,204 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:09,206 - CV - INFO - Pretrain Complete, 24 epochs
2023-09-02 20:53:09,206 - CV - INFO - Begin OT Train
2023-09-02 20:53:09,206 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:09,301 - FGO - INFO - Epoch   0 | Train Loss: -4.009 | Val Loss: -0.41 | Val F1: 0.97 |
2023-09-02 20:53:10,179 - FGO - INFO - Epoch  10 | Train Loss: -4.383 | Val Loss: -0.36 | Val F1: 0.96 |
2023-09-02 20:53:10,938 - FGO - INFO - Epoch  20 | Train Loss: -4.479 | Val Loss: -0.45 | Val F1: 0.99 |
2023-09-02 20:53:11,768 - FGO - INFO - Epoch  30 | Train Loss: -4.543 | Val Loss: -0.45 | Val F1: 0.99 |
2023-09-02 20:53:12,548 - FGO - INFO - Epoch  40 | Train Loss: -4.570 | Val Loss: -0.46 | Val F1: 0.99 |
2023-09-02 20:53:13,368 - FGO - INFO - Best Epoch:  13 | Train Loss: -4.402 | Val Loss: -0.44 | Val F1: 0.99 |
2023-09-02 20:53:13,368 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:13,371 - CV - INFO - OT Train Complete, 13 epochs
2023-09-02 20:53:13,372 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:13,396 - FGO - INFO - Train CM:
[[388   8]
 [ 13 320]]
2023-09-02 20:53:13,396 - FGO - INFO - Val CM:
[[37  1]
 [ 1 36]]
2023-09-02 20:53:13,397 - FGO - INFO - Test CM:
[[37  1]
 [ 1 36]]
2023-09-02 20:53:13,402 - FGO - INFO - test statistical parity: 0.008196721311475419
2023-09-02 20:53:13,403 - FGO - INFO - test equal opportunity: 0.033333333333333326
2023-09-02 20:53:13,404 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 20:53:13,405 - FGO - INFO - test macro f1: 0.9733285917496444
2023-09-02 20:53:13,405 - CV - INFO - fold time: 4.551128387451172s (0.07585213979085287m)
2023-09-02 20:53:13,405 - CV - INFO - ----- BEGINNING FOLD SET (016:4)----------------------------------------------------------
2023-09-02 20:53:13,406 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/016/4
2023-09-02 20:53:13,406 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:13,407 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:13,407 - FGO - INFO - 	done: False
2023-09-02 20:53:13,407 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:13,407 - FGO - INFO - 	h1: 64
2023-09-02 20:53:13,407 - FGO - INFO - 	h2: 32
2023-09-02 20:53:13,407 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:13,407 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:13,407 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:13,407 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:13,407 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:13,407 - FGO - INFO - 	theta: 10
2023-09-02 20:53:13,407 - FGO - INFO - 	clip: 5
2023-09-02 20:53:13,407 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:13,407 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:13,407 - FGO - INFO - Source Total: 732
2023-09-02 20:53:13,407 - FGO - INFO - Target Total: 72
2023-09-02 20:53:13,407 - FGO - INFO - Train Total: 732
2023-09-02 20:53:13,407 - FGO - INFO - Val Total:   72
2023-09-02 20:53:13,407 - FGO - INFO - Test Total:  72
2023-09-02 20:53:13,407 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:13,407 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:13,407 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:13,407 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:13,407 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:13,407 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:13,407 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:13,407 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:13,407 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:13,408 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:13,408 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:13,410 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:13,500 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:13,500 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:13,500 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:13,500 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:13,500 - FGO - INFO - N: 804
2023-09-02 20:53:13,500 - FGO - INFO - N_s: 732
2023-09-02 20:53:13,501 - FGO - INFO - N_t: 72
2023-09-02 20:53:13,504 - CV - INFO - Begin Pretrain
2023-09-02 20:53:13,504 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:13,507 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:53:13,532 - FGO - INFO - Epoch  10 | Train Loss: 0.578 | Val Loss: 0.58 | Val F1: 0.78 |
2023-09-02 20:53:13,557 - FGO - INFO - Epoch  20 | Train Loss: 0.258 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:53:13,582 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:53:13,607 - FGO - INFO - Epoch  40 | Train Loss: 0.095 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:53:13,631 - FGO - INFO - Epoch  50 | Train Loss: 0.084 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:53:13,656 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:53:13,681 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:53:13,705 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:53:13,730 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:53:13,754 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:53:13,754 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.99 
2023-09-02 20:53:13,754 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:13,756 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:53:13,756 - CV - INFO - Begin OT Train
2023-09-02 20:53:13,756 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:13,822 - FGO - INFO - Epoch   0 | Train Loss: -4.286 | Val Loss: -0.39 | Val F1: 0.99 |
2023-09-02 20:53:14,621 - FGO - INFO - Epoch  10 | Train Loss: -4.285 | Val Loss: -0.28 | Val F1: 0.94 |
2023-09-02 20:53:15,422 - FGO - INFO - Epoch  20 | Train Loss: -4.438 | Val Loss: -0.34 | Val F1: 0.97 |
2023-09-02 20:53:16,188 - FGO - INFO - Epoch  30 | Train Loss: -4.522 | Val Loss: -0.39 | Val F1: 0.97 |
2023-09-02 20:53:16,977 - FGO - INFO - Epoch  40 | Train Loss: -4.556 | Val Loss: -0.40 | Val F1: 0.99 |
2023-09-02 20:53:17,749 - FGO - INFO - Best Epoch:  14 | Train Loss: -4.388 | Val Loss: -0.41 | Val F1: 0.99 |
2023-09-02 20:53:17,749 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:17,752 - CV - INFO - OT Train Complete, 14 epochs
2023-09-02 20:53:17,752 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:17,779 - FGO - INFO - Train CM:
[[391   6]
 [ 13 322]]
2023-09-02 20:53:17,779 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:53:17,779 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:53:17,784 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:53:17,785 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:53:17,786 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:53:17,787 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:53:17,787 - CV - INFO - fold time: 4.381894111633301s (0.07303156852722167m)
2023-09-02 20:53:17,787 - CV - INFO - ----- BEGINNING FOLD SET (016:5)----------------------------------------------------------
2023-09-02 20:53:17,788 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/016/5
2023-09-02 20:53:17,788 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:17,789 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:17,789 - FGO - INFO - 	done: False
2023-09-02 20:53:17,789 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:17,789 - FGO - INFO - 	h1: 64
2023-09-02 20:53:17,789 - FGO - INFO - 	h2: 32
2023-09-02 20:53:17,789 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:17,789 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:17,789 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:17,789 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:17,789 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:17,789 - FGO - INFO - 	theta: 10
2023-09-02 20:53:17,789 - FGO - INFO - 	clip: 5
2023-09-02 20:53:17,789 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:17,789 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:17,789 - FGO - INFO - Source Total: 726
2023-09-02 20:53:17,789 - FGO - INFO - Target Total: 78
2023-09-02 20:53:17,789 - FGO - INFO - Train Total: 726
2023-09-02 20:53:17,789 - FGO - INFO - Val Total:   78
2023-09-02 20:53:17,789 - FGO - INFO - Test Total:  78
2023-09-02 20:53:17,789 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:17,789 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:17,789 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:17,789 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:17,789 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:17,789 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:17,789 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:17,789 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:17,789 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:17,790 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:17,791 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:17,792 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:17,889 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:17,889 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:17,889 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:17,889 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:17,889 - FGO - INFO - N: 804
2023-09-02 20:53:17,889 - FGO - INFO - N_s: 726
2023-09-02 20:53:17,889 - FGO - INFO - N_t: 78
2023-09-02 20:53:17,893 - CV - INFO - Begin Pretrain
2023-09-02 20:53:17,893 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:17,896 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:53:17,921 - FGO - INFO - Epoch  10 | Train Loss: 0.582 | Val Loss: 0.61 | Val F1: 0.72 |
2023-09-02 20:53:17,945 - FGO - INFO - Epoch  20 | Train Loss: 0.268 | Val Loss: 0.31 | Val F1: 0.87 |
2023-09-02 20:53:17,970 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.25 | Val F1: 0.92 |
2023-09-02 20:53:17,994 - FGO - INFO - Epoch  40 | Train Loss: 0.100 | Val Loss: 0.22 | Val F1: 0.92 |
2023-09-02 20:53:18,018 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:53:18,042 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:53:18,067 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:53:18,091 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 20:53:18,115 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:53:18,140 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:53:18,140 - FGO - INFO - Best Epoch:  77 | Train Loss: 0.070 | Val Loss: 0.10 | Val F1: 0.96 
2023-09-02 20:53:18,140 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:18,141 - CV - INFO - Pretrain Complete, 77 epochs
2023-09-02 20:53:18,141 - CV - INFO - Begin OT Train
2023-09-02 20:53:18,141 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:18,237 - FGO - INFO - Epoch   0 | Train Loss: -3.911 | Val Loss: -0.37 | Val F1: 0.96 |
2023-09-02 20:53:19,005 - FGO - INFO - Epoch  10 | Train Loss: -4.383 | Val Loss: -0.12 | Val F1: 0.90 |
2023-09-02 20:53:19,782 - FGO - INFO - Epoch  20 | Train Loss: -4.473 | Val Loss: -0.34 | Val F1: 0.91 |
2023-09-02 20:53:20,601 - FGO - INFO - Epoch  30 | Train Loss: -4.531 | Val Loss: -0.23 | Val F1: 0.91 |
2023-09-02 20:53:21,334 - FGO - INFO - Epoch  40 | Train Loss: -4.568 | Val Loss: -0.29 | Val F1: 0.91 |
2023-09-02 20:53:22,029 - FGO - INFO - Best Epoch:   6 | Train Loss: -4.272 | Val Loss: -0.38 | Val F1: 0.95 |
2023-09-02 20:53:22,029 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:22,032 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:53:22,032 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:22,058 - FGO - INFO - Train CM:
[[394   6]
 [ 14 312]]
2023-09-02 20:53:22,059 - FGO - INFO - Val CM:
[[34  0]
 [ 7 37]]
2023-09-02 20:53:22,059 - FGO - INFO - Test CM:
[[34  0]
 [ 7 37]]
2023-09-02 20:53:22,064 - FGO - INFO - test statistical parity: 0.09178743961352659
2023-09-02 20:53:22,066 - FGO - INFO - test equal opportunity: 0.17948717948717952
2023-09-02 20:53:22,067 - FGO - INFO - test micro f1: 0.9102564102564102
2023-09-02 20:53:22,067 - FGO - INFO - test macro f1: 0.9101234567901235
2023-09-02 20:53:22,067 - CV - INFO - fold time: 4.280489921569824s (0.07134149869283041m)
2023-09-02 20:53:22,067 - CV - INFO - ----- BEGINNING FOLD SET (016:6)----------------------------------------------------------
2023-09-02 20:53:22,069 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/016/6
2023-09-02 20:53:22,069 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:22,069 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:22,069 - FGO - INFO - 	done: False
2023-09-02 20:53:22,069 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:22,069 - FGO - INFO - 	h1: 64
2023-09-02 20:53:22,069 - FGO - INFO - 	h2: 32
2023-09-02 20:53:22,069 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:22,069 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:22,069 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:22,069 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:22,069 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:22,069 - FGO - INFO - 	theta: 10
2023-09-02 20:53:22,069 - FGO - INFO - 	clip: 5
2023-09-02 20:53:22,069 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:22,069 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:22,069 - FGO - INFO - Source Total: 717
2023-09-02 20:53:22,069 - FGO - INFO - Target Total: 87
2023-09-02 20:53:22,069 - FGO - INFO - Train Total: 717
2023-09-02 20:53:22,069 - FGO - INFO - Val Total:   87
2023-09-02 20:53:22,069 - FGO - INFO - Test Total:  87
2023-09-02 20:53:22,069 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:22,069 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:22,069 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:22,069 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:22,069 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:22,070 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:22,070 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:22,070 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:22,070 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:22,070 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:22,071 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:22,072 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:22,179 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:22,179 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:22,179 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:22,179 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:22,179 - FGO - INFO - N: 804
2023-09-02 20:53:22,179 - FGO - INFO - N_s: 717
2023-09-02 20:53:22,179 - FGO - INFO - N_t: 87
2023-09-02 20:53:22,182 - CV - INFO - Begin Pretrain
2023-09-02 20:53:22,182 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:22,185 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:53:22,210 - FGO - INFO - Epoch  10 | Train Loss: 0.585 | Val Loss: 0.57 | Val F1: 0.75 |
2023-09-02 20:53:22,235 - FGO - INFO - Epoch  20 | Train Loss: 0.271 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:53:22,259 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:53:22,284 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:53:22,308 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:53:22,332 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:53:22,357 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:53:22,381 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:53:22,405 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:53:22,429 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:53:22,429 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.107 | Val Loss: 0.08 | Val F1: 0.99 
2023-09-02 20:53:22,429 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:22,431 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:53:22,431 - CV - INFO - Begin OT Train
2023-09-02 20:53:22,431 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:22,528 - FGO - INFO - Epoch   0 | Train Loss: -4.280 | Val Loss: -0.51 | Val F1: 0.99 |
2023-09-02 20:53:23,303 - FGO - INFO - Epoch  10 | Train Loss: -4.378 | Val Loss: -0.49 | Val F1: 0.97 |
2023-09-02 20:53:24,096 - FGO - INFO - Epoch  20 | Train Loss: -4.459 | Val Loss: -0.52 | Val F1: 0.98 |
2023-09-02 20:53:24,841 - FGO - INFO - Epoch  30 | Train Loss: -4.501 | Val Loss: -0.54 | Val F1: 0.99 |
2023-09-02 20:53:25,641 - FGO - INFO - Epoch  40 | Train Loss: -4.531 | Val Loss: -0.56 | Val F1: 0.99 |
2023-09-02 20:53:26,332 - FGO - INFO - Best Epoch:  43 | Train Loss: -4.537 | Val Loss: -0.57 | Val F1: 1.00 |
2023-09-02 20:53:26,332 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:26,335 - CV - INFO - OT Train Complete, 43 epochs
2023-09-02 20:53:26,336 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:26,360 - FGO - INFO - Train CM:
[[376   9]
 [ 11 321]]
2023-09-02 20:53:26,360 - FGO - INFO - Val CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:53:26,360 - FGO - INFO - Test CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:53:26,366 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 20:53:26,367 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:53:26,368 - FGO - INFO - test micro f1: 0.9885057471264368
2023-09-02 20:53:26,368 - FGO - INFO - test macro f1: 0.9883518543312357
2023-09-02 20:53:26,368 - CV - INFO - fold time: 4.301025629043579s (0.07168376048405965m)
2023-09-02 20:53:26,368 - CV - INFO - ----- BEGINNING FOLD SET (016:7)----------------------------------------------------------
2023-09-02 20:53:26,370 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/016/7
2023-09-02 20:53:26,370 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:26,370 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:26,370 - FGO - INFO - 	done: False
2023-09-02 20:53:26,370 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:26,370 - FGO - INFO - 	h1: 64
2023-09-02 20:53:26,370 - FGO - INFO - 	h2: 32
2023-09-02 20:53:26,370 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:26,370 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:26,370 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:26,370 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:26,370 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:26,370 - FGO - INFO - 	theta: 10
2023-09-02 20:53:26,370 - FGO - INFO - 	clip: 5
2023-09-02 20:53:26,370 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:26,370 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:26,370 - FGO - INFO - Source Total: 717
2023-09-02 20:53:26,370 - FGO - INFO - Target Total: 87
2023-09-02 20:53:26,370 - FGO - INFO - Train Total: 717
2023-09-02 20:53:26,370 - FGO - INFO - Val Total:   87
2023-09-02 20:53:26,370 - FGO - INFO - Test Total:  87
2023-09-02 20:53:26,370 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:26,370 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:26,370 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:26,370 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:26,370 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:26,371 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:26,371 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:26,371 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:26,371 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:26,371 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:26,372 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:26,373 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:26,479 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:26,479 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:26,479 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:26,479 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:26,479 - FGO - INFO - N: 804
2023-09-02 20:53:26,479 - FGO - INFO - N_s: 717
2023-09-02 20:53:26,479 - FGO - INFO - N_t: 87
2023-09-02 20:53:26,483 - CV - INFO - Begin Pretrain
2023-09-02 20:53:26,483 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:26,486 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:53:26,511 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.72 |
2023-09-02 20:53:26,536 - FGO - INFO - Epoch  20 | Train Loss: 0.265 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:53:26,560 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:53:26,585 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:53:26,609 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:53:26,633 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:53:26,658 - FGO - INFO - Epoch  70 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:53:26,682 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:53:26,707 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:53:26,731 - FGO - INFO - Epoch 100 | Train Loss: 0.069 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:53:26,731 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.169 | Val Loss: 0.14 | Val F1: 0.98 
2023-09-02 20:53:26,731 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:26,733 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:53:26,733 - CV - INFO - Begin OT Train
2023-09-02 20:53:26,733 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:26,796 - FGO - INFO - Epoch   0 | Train Loss: -4.288 | Val Loss: -0.34 | Val F1: 0.95 |
2023-09-02 20:53:27,574 - FGO - INFO - Epoch  10 | Train Loss: -4.443 | Val Loss: -0.34 | Val F1: 0.97 |
2023-09-02 20:53:28,377 - FGO - INFO - Epoch  20 | Train Loss: -4.499 | Val Loss: -0.38 | Val F1: 0.97 |
2023-09-02 20:53:29,108 - FGO - INFO - Epoch  30 | Train Loss: -4.540 | Val Loss: -0.37 | Val F1: 0.97 |
2023-09-02 20:53:29,880 - FGO - INFO - Epoch  40 | Train Loss: -4.576 | Val Loss: -0.37 | Val F1: 0.97 |
2023-09-02 20:53:30,572 - FGO - INFO - Best Epoch:  30 | Train Loss: -4.540 | Val Loss: -0.37 | Val F1: 0.97 |
2023-09-02 20:53:30,572 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:30,576 - CV - INFO - OT Train Complete, 30 epochs
2023-09-02 20:53:30,576 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:30,601 - FGO - INFO - Train CM:
[[378   9]
 [ 12 318]]
2023-09-02 20:53:30,601 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:53:30,601 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:53:30,606 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:53:30,608 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:53:30,609 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:53:30,609 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:53:30,609 - CV - INFO - fold time: 4.240764617919922s (0.07067941029866537m)
2023-09-02 20:53:30,609 - CV - INFO - ----- BEGINNING FOLD SET (016:8)----------------------------------------------------------
2023-09-02 20:53:30,611 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/016/8
2023-09-02 20:53:30,611 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:30,611 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:30,611 - FGO - INFO - 	done: False
2023-09-02 20:53:30,611 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:30,611 - FGO - INFO - 	h1: 64
2023-09-02 20:53:30,611 - FGO - INFO - 	h2: 32
2023-09-02 20:53:30,611 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:30,611 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:30,611 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:30,611 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:30,611 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:30,611 - FGO - INFO - 	theta: 10
2023-09-02 20:53:30,611 - FGO - INFO - 	clip: 5
2023-09-02 20:53:30,611 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:30,611 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:30,611 - FGO - INFO - Source Total: 734
2023-09-02 20:53:30,611 - FGO - INFO - Target Total: 70
2023-09-02 20:53:30,611 - FGO - INFO - Train Total: 734
2023-09-02 20:53:30,611 - FGO - INFO - Val Total:   70
2023-09-02 20:53:30,611 - FGO - INFO - Test Total:  70
2023-09-02 20:53:30,611 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:30,611 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:30,611 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:30,611 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:30,611 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:30,612 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:30,612 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:30,612 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:30,612 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:30,612 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:30,613 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:30,614 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:30,703 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:30,703 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:30,703 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:30,703 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:30,703 - FGO - INFO - N: 804
2023-09-02 20:53:30,703 - FGO - INFO - N_s: 734
2023-09-02 20:53:30,703 - FGO - INFO - N_t: 70
2023-09-02 20:53:30,707 - CV - INFO - Begin Pretrain
2023-09-02 20:53:30,707 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:30,710 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:53:30,735 - FGO - INFO - Epoch  10 | Train Loss: 0.564 | Val Loss: 0.59 | Val F1: 0.75 |
2023-09-02 20:53:30,760 - FGO - INFO - Epoch  20 | Train Loss: 0.257 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:53:30,785 - FGO - INFO - Epoch  30 | Train Loss: 0.132 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:53:30,809 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.13 | Val F1: 0.94 |
2023-09-02 20:53:30,834 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:53:30,859 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:53:30,884 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:53:30,908 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:53:30,933 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.16 | Val F1: 0.93 |
2023-09-02 20:53:30,957 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:53:30,958 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.108 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:53:30,958 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:30,959 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:53:30,959 - CV - INFO - Begin OT Train
2023-09-02 20:53:30,959 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:31,046 - FGO - INFO - Epoch   0 | Train Loss: -4.099 | Val Loss: -0.24 | Val F1: 0.93 |
2023-09-02 20:53:31,850 - FGO - INFO - Epoch  10 | Train Loss: -4.353 | Val Loss: -0.07 | Val F1: 0.93 |
2023-09-02 20:53:32,679 - FGO - INFO - Epoch  20 | Train Loss: -4.496 | Val Loss: -0.19 | Val F1: 0.94 |
2023-09-02 20:53:33,448 - FGO - INFO - Epoch  30 | Train Loss: -4.544 | Val Loss: -0.16 | Val F1: 0.96 |
2023-09-02 20:53:34,259 - FGO - INFO - Epoch  40 | Train Loss: -4.576 | Val Loss: -0.11 | Val F1: 0.96 |
2023-09-02 20:53:34,991 - FGO - INFO - Best Epoch:  24 | Train Loss: -4.512 | Val Loss: -0.16 | Val F1: 0.96 |
2023-09-02 20:53:34,991 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:34,994 - CV - INFO - OT Train Complete, 24 epochs
2023-09-02 20:53:34,995 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:35,020 - FGO - INFO - Train CM:
[[391   9]
 [ 11 323]]
2023-09-02 20:53:35,020 - FGO - INFO - Val CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:53:35,021 - FGO - INFO - Test CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:53:35,026 - FGO - INFO - test statistical parity: 0.10661268556005393
2023-09-02 20:53:35,027 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:53:35,028 - FGO - INFO - test micro f1: 0.9571428571428572
2023-09-02 20:53:35,028 - FGO - INFO - test macro f1: 0.9571341090018372
2023-09-02 20:53:35,028 - CV - INFO - fold time: 4.419266223907471s (0.0736544370651245m)
2023-09-02 20:53:35,028 - CV - INFO - ----- BEGINNING FOLD SET (016:9)----------------------------------------------------------
2023-09-02 20:53:35,030 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/016/9
2023-09-02 20:53:35,030 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:35,030 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:35,030 - FGO - INFO - 	done: False
2023-09-02 20:53:35,030 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:35,030 - FGO - INFO - 	h1: 64
2023-09-02 20:53:35,030 - FGO - INFO - 	h2: 32
2023-09-02 20:53:35,030 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:35,030 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:35,030 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:35,030 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:35,030 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:35,030 - FGO - INFO - 	theta: 10
2023-09-02 20:53:35,030 - FGO - INFO - 	clip: 5
2023-09-02 20:53:35,030 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:35,030 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:35,030 - FGO - INFO - Source Total: 725
2023-09-02 20:53:35,030 - FGO - INFO - Target Total: 79
2023-09-02 20:53:35,030 - FGO - INFO - Train Total: 725
2023-09-02 20:53:35,030 - FGO - INFO - Val Total:   79
2023-09-02 20:53:35,030 - FGO - INFO - Test Total:  79
2023-09-02 20:53:35,030 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:35,030 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:35,030 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:35,030 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:35,030 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:35,031 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:35,031 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:35,031 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:35,031 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:35,031 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:35,032 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:35,033 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:35,132 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:35,132 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:35,132 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:35,132 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:35,132 - FGO - INFO - N: 804
2023-09-02 20:53:35,132 - FGO - INFO - N_s: 725
2023-09-02 20:53:35,132 - FGO - INFO - N_t: 79
2023-09-02 20:53:35,135 - CV - INFO - Begin Pretrain
2023-09-02 20:53:35,135 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:35,138 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:53:35,163 - FGO - INFO - Epoch  10 | Train Loss: 0.579 | Val Loss: 0.59 | Val F1: 0.74 |
2023-09-02 20:53:35,188 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.30 | Val F1: 0.91 |
2023-09-02 20:53:35,212 - FGO - INFO - Epoch  30 | Train Loss: 0.128 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:53:35,237 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:53:35,261 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:53:35,285 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:53:35,310 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:53:35,334 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:53:35,358 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:53:35,383 - FGO - INFO - Epoch 100 | Train Loss: 0.065 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:53:35,383 - FGO - INFO - Best Epoch:  51 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.99 
2023-09-02 20:53:35,383 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:35,384 - CV - INFO - Pretrain Complete, 51 epochs
2023-09-02 20:53:35,384 - CV - INFO - Begin OT Train
2023-09-02 20:53:35,384 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:35,473 - FGO - INFO - Epoch   0 | Train Loss: -4.309 | Val Loss: -0.34 | Val F1: 0.97 |
2023-09-02 20:53:36,274 - FGO - INFO - Epoch  10 | Train Loss: -4.402 | Val Loss: -0.42 | Val F1: 0.97 |
2023-09-02 20:53:37,130 - FGO - INFO - Epoch  20 | Train Loss: -4.491 | Val Loss: -0.45 | Val F1: 0.99 |
2023-09-02 20:53:37,892 - FGO - INFO - Epoch  30 | Train Loss: -4.536 | Val Loss: -0.46 | Val F1: 0.99 |
2023-09-02 20:53:38,634 - FGO - INFO - Epoch  40 | Train Loss: -4.564 | Val Loss: -0.46 | Val F1: 0.99 |
2023-09-02 20:53:39,401 - FGO - INFO - Best Epoch:  16 | Train Loss: -4.475 | Val Loss: -0.45 | Val F1: 0.99 |
2023-09-02 20:53:39,401 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:39,404 - CV - INFO - OT Train Complete, 16 epochs
2023-09-02 20:53:39,404 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:39,429 - FGO - INFO - Train CM:
[[377   8]
 [ 12 328]]
2023-09-02 20:53:39,429 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:53:39,430 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:53:39,435 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:53:39,436 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:53:39,437 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:53:39,437 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:53:39,437 - CV - INFO - fold time: 4.408995866775513s (0.07348326444625855m)
2023-09-02 20:53:39,437 - CV - INFO - Mean Pretrain Epochs 45.5:
2023-09-02 20:53:39,437 - CV - INFO - Mean OT Train Epochs 17.9:
2023-09-02 20:53:39,437 - CV - INFO - Mean Val Macro F1 : 0.9554275575840043
2023-09-02 20:53:39,437 - CV - INFO - Mean Eval Stat : 0.9554275575840043 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:53:39,438 - CV - INFO - set time: 43.53330445289612s (0.7255550742149353m)
2023-09-02 20:53:39,438 - CV - INFO - script time so far: 717.3886342048645s (11.956477236747741m) (0.19927462061246234h)
2023-09-02 20:53:39,438 - CV - INFO - ===== BEGINNING OPTION SET (017)==========================================================
2023-09-02 20:53:39,438 - CV - INFO - 	done: False
2023-09-02 20:53:39,438 - CV - INFO - 	learning_rate: 0.005
2023-09-02 20:53:39,438 - CV - INFO - 	h1: 64
2023-09-02 20:53:39,438 - CV - INFO - 	h2: 32
2023-09-02 20:53:39,438 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:39,438 - CV - INFO - 	dropout: 0.0
2023-09-02 20:53:39,438 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:39,438 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:39,438 - CV - INFO - 	lambda: 0.05
2023-09-02 20:53:39,438 - CV - INFO - 	theta: 30
2023-09-02 20:53:39,438 - CV - INFO - 	clip: 5
2023-09-02 20:53:39,438 - CV - INFO - ----- BEGINNING FOLD SET (017:0)----------------------------------------------------------
2023-09-02 20:53:39,439 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/017/0
2023-09-02 20:53:39,439 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:39,439 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:39,439 - FGO - INFO - 	done: False
2023-09-02 20:53:39,439 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:39,440 - FGO - INFO - 	h1: 64
2023-09-02 20:53:39,440 - FGO - INFO - 	h2: 32
2023-09-02 20:53:39,440 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:39,440 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:39,440 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:39,440 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:39,440 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:39,440 - FGO - INFO - 	theta: 30
2023-09-02 20:53:39,440 - FGO - INFO - 	clip: 5
2023-09-02 20:53:39,440 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:39,440 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:39,440 - FGO - INFO - Source Total: 708
2023-09-02 20:53:39,440 - FGO - INFO - Target Total: 96
2023-09-02 20:53:39,440 - FGO - INFO - Train Total: 708
2023-09-02 20:53:39,440 - FGO - INFO - Val Total:   96
2023-09-02 20:53:39,440 - FGO - INFO - Test Total:  96
2023-09-02 20:53:39,440 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:39,440 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:39,440 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:39,440 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:39,440 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:39,440 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:39,440 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:39,440 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:39,440 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:39,440 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:39,441 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:39,443 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:39,558 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:39,558 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:39,558 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:39,558 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:39,558 - FGO - INFO - N: 804
2023-09-02 20:53:39,558 - FGO - INFO - N_s: 708
2023-09-02 20:53:39,558 - FGO - INFO - N_t: 96
2023-09-02 20:53:39,562 - CV - INFO - Begin Pretrain
2023-09-02 20:53:39,562 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:39,565 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:53:39,590 - FGO - INFO - Epoch  10 | Train Loss: 0.572 | Val Loss: 0.59 | Val F1: 0.62 |
2023-09-02 20:53:39,614 - FGO - INFO - Epoch  20 | Train Loss: 0.245 | Val Loss: 0.25 | Val F1: 0.93 |
2023-09-02 20:53:39,638 - FGO - INFO - Epoch  30 | Train Loss: 0.127 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:53:39,662 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:53:39,687 - FGO - INFO - Epoch  50 | Train Loss: 0.083 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:53:39,711 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:53:39,735 - FGO - INFO - Epoch  70 | Train Loss: 0.067 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:53:39,759 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:53:39,784 - FGO - INFO - Epoch  90 | Train Loss: 0.060 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:53:39,808 - FGO - INFO - Epoch 100 | Train Loss: 0.058 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:53:39,808 - FGO - INFO - Best Epoch:  39 | Train Loss: 0.095 | Val Loss: 0.10 | Val F1: 0.98 
2023-09-02 20:53:39,808 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:39,809 - CV - INFO - Pretrain Complete, 39 epochs
2023-09-02 20:53:39,809 - CV - INFO - Begin OT Train
2023-09-02 20:53:39,809 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:39,874 - FGO - INFO - Epoch   0 | Train Loss: -12.976 | Val Loss: -1.70 | Val F1: 0.97 |
2023-09-02 20:53:40,690 - FGO - INFO - Epoch  10 | Train Loss: -13.432 | Val Loss: -1.74 | Val F1: 0.96 |
2023-09-02 20:53:41,488 - FGO - INFO - Epoch  20 | Train Loss: -13.712 | Val Loss: -1.77 | Val F1: 0.93 |
2023-09-02 20:53:42,292 - FGO - INFO - Epoch  30 | Train Loss: -13.806 | Val Loss: -1.77 | Val F1: 0.93 |
2023-09-02 20:53:43,124 - FGO - INFO - Epoch  40 | Train Loss: -13.865 | Val Loss: -1.82 | Val F1: 0.95 |
2023-09-02 20:53:43,789 - FGO - INFO - Best Epoch:  46 | Train Loss: -13.902 | Val Loss: -1.85 | Val F1: 0.97 |
2023-09-02 20:53:43,789 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:43,793 - CV - INFO - OT Train Complete, 46 epochs
2023-09-02 20:53:43,793 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:43,816 - FGO - INFO - Train CM:
[[378   4]
 [ 22 304]]
2023-09-02 20:53:43,817 - FGO - INFO - Val CM:
[[52  0]
 [ 4 40]]
2023-09-02 20:53:43,817 - FGO - INFO - Test CM:
[[52  0]
 [ 4 40]]
2023-09-02 20:53:43,822 - FGO - INFO - test statistical parity: 0.3508021390374332
2023-09-02 20:53:43,824 - FGO - INFO - test equal opportunity: 0.11111111111111116
2023-09-02 20:53:43,825 - FGO - INFO - test micro f1: 0.9583333333333334
2023-09-02 20:53:43,825 - FGO - INFO - test macro f1: 0.9576719576719577
2023-09-02 20:53:43,825 - CV - INFO - fold time: 4.387476682662964s (0.07312461137771606m)
2023-09-02 20:53:43,825 - CV - INFO - ----- BEGINNING FOLD SET (017:1)----------------------------------------------------------
2023-09-02 20:53:43,827 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/017/1
2023-09-02 20:53:43,827 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:43,827 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:43,827 - FGO - INFO - 	done: False
2023-09-02 20:53:43,827 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:43,827 - FGO - INFO - 	h1: 64
2023-09-02 20:53:43,827 - FGO - INFO - 	h2: 32
2023-09-02 20:53:43,827 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:43,827 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:43,827 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:43,827 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:43,827 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:43,827 - FGO - INFO - 	theta: 30
2023-09-02 20:53:43,827 - FGO - INFO - 	clip: 5
2023-09-02 20:53:43,827 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:43,827 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:43,827 - FGO - INFO - Source Total: 727
2023-09-02 20:53:43,827 - FGO - INFO - Target Total: 77
2023-09-02 20:53:43,827 - FGO - INFO - Train Total: 727
2023-09-02 20:53:43,827 - FGO - INFO - Val Total:   77
2023-09-02 20:53:43,827 - FGO - INFO - Test Total:  77
2023-09-02 20:53:43,827 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:43,827 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:43,827 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:43,827 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:43,827 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:43,828 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:43,828 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:43,828 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:43,828 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:43,828 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:43,829 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:43,830 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:43,926 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:43,926 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:43,926 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:43,926 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:43,926 - FGO - INFO - N: 804
2023-09-02 20:53:43,926 - FGO - INFO - N_s: 727
2023-09-02 20:53:43,926 - FGO - INFO - N_t: 77
2023-09-02 20:53:43,930 - CV - INFO - Begin Pretrain
2023-09-02 20:53:43,930 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:43,933 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:53:43,958 - FGO - INFO - Epoch  10 | Train Loss: 0.577 | Val Loss: 0.61 | Val F1: 0.66 |
2023-09-02 20:53:43,983 - FGO - INFO - Epoch  20 | Train Loss: 0.255 | Val Loss: 0.38 | Val F1: 0.83 |
2023-09-02 20:53:44,008 - FGO - INFO - Epoch  30 | Train Loss: 0.122 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:53:44,032 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.20 | Val F1: 0.89 |
2023-09-02 20:53:44,057 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.87 |
2023-09-02 20:53:44,081 - FGO - INFO - Epoch  60 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.89 |
2023-09-02 20:53:44,106 - FGO - INFO - Epoch  70 | Train Loss: 0.063 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:53:44,131 - FGO - INFO - Epoch  80 | Train Loss: 0.060 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:53:44,155 - FGO - INFO - Epoch  90 | Train Loss: 0.057 | Val Loss: 0.21 | Val F1: 0.90 |
2023-09-02 20:53:44,180 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:53:44,180 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.097 | Val Loss: 0.18 | Val F1: 0.93 
2023-09-02 20:53:44,180 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:44,181 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:53:44,181 - CV - INFO - Begin OT Train
2023-09-02 20:53:44,181 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:44,247 - FGO - INFO - Epoch   0 | Train Loss: -13.054 | Val Loss: -1.09 | Val F1: 0.89 |
2023-09-02 20:53:45,166 - FGO - INFO - Epoch  10 | Train Loss: -13.572 | Val Loss: -0.98 | Val F1: 0.87 |
2023-09-02 20:53:46,006 - FGO - INFO - Epoch  20 | Train Loss: -13.891 | Val Loss: -1.18 | Val F1: 0.92 |
2023-09-02 20:53:46,796 - FGO - INFO - Epoch  30 | Train Loss: -14.016 | Val Loss: -1.12 | Val F1: 0.88 |
2023-09-02 20:53:47,533 - FGO - INFO - Epoch  40 | Train Loss: -14.080 | Val Loss: -1.04 | Val F1: 0.89 |
2023-09-02 20:53:48,212 - FGO - INFO - Best Epoch:  20 | Train Loss: -13.891 | Val Loss: -1.18 | Val F1: 0.92 |
2023-09-02 20:53:48,212 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:48,215 - CV - INFO - OT Train Complete, 20 epochs
2023-09-02 20:53:48,216 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:48,241 - FGO - INFO - Train CM:
[[371  19]
 [  8 329]]
2023-09-02 20:53:48,242 - FGO - INFO - Val CM:
[[40  4]
 [ 4 29]]
2023-09-02 20:53:48,242 - FGO - INFO - Test CM:
[[40  4]
 [ 4 29]]
2023-09-02 20:53:48,247 - FGO - INFO - test statistical parity: 0.31025641025641026
2023-09-02 20:53:48,248 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:53:48,249 - FGO - INFO - test micro f1: 0.8961038961038962
2023-09-02 20:53:48,250 - FGO - INFO - test macro f1: 0.8939393939393939
2023-09-02 20:53:48,250 - CV - INFO - fold time: 4.424581527709961s (0.07374302546183269m)
2023-09-02 20:53:48,250 - CV - INFO - ----- BEGINNING FOLD SET (017:2)----------------------------------------------------------
2023-09-02 20:53:48,251 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/017/2
2023-09-02 20:53:48,252 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:48,252 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:48,252 - FGO - INFO - 	done: False
2023-09-02 20:53:48,252 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:48,252 - FGO - INFO - 	h1: 64
2023-09-02 20:53:48,252 - FGO - INFO - 	h2: 32
2023-09-02 20:53:48,252 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:48,252 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:48,252 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:48,252 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:48,252 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:48,252 - FGO - INFO - 	theta: 30
2023-09-02 20:53:48,252 - FGO - INFO - 	clip: 5
2023-09-02 20:53:48,252 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:48,252 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:48,252 - FGO - INFO - Source Total: 721
2023-09-02 20:53:48,252 - FGO - INFO - Target Total: 83
2023-09-02 20:53:48,252 - FGO - INFO - Train Total: 721
2023-09-02 20:53:48,252 - FGO - INFO - Val Total:   83
2023-09-02 20:53:48,252 - FGO - INFO - Test Total:  83
2023-09-02 20:53:48,252 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:48,252 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:48,252 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:48,252 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:48,252 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:48,252 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:48,253 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:48,253 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:48,253 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:48,253 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:48,254 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:48,255 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:48,357 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:48,357 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:48,357 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:48,357 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:48,357 - FGO - INFO - N: 804
2023-09-02 20:53:48,357 - FGO - INFO - N_s: 721
2023-09-02 20:53:48,357 - FGO - INFO - N_t: 83
2023-09-02 20:53:48,361 - CV - INFO - Begin Pretrain
2023-09-02 20:53:48,361 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:48,364 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:53:48,389 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.76 |
2023-09-02 20:53:48,414 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.33 | Val F1: 0.88 |
2023-09-02 20:53:48,438 - FGO - INFO - Epoch  30 | Train Loss: 0.120 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:53:48,462 - FGO - INFO - Epoch  40 | Train Loss: 0.083 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:53:48,487 - FGO - INFO - Epoch  50 | Train Loss: 0.071 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:53:48,511 - FGO - INFO - Epoch  60 | Train Loss: 0.062 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:53:48,536 - FGO - INFO - Epoch  70 | Train Loss: 0.059 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:53:48,560 - FGO - INFO - Epoch  80 | Train Loss: 0.055 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:53:48,584 - FGO - INFO - Epoch  90 | Train Loss: 0.053 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:53:48,609 - FGO - INFO - Epoch 100 | Train Loss: 0.051 | Val Loss: 0.26 | Val F1: 0.91 |
2023-09-02 20:53:48,609 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.063 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:53:48,609 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:48,610 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:53:48,610 - CV - INFO - Begin OT Train
2023-09-02 20:53:48,610 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:48,676 - FGO - INFO - Epoch   0 | Train Loss: -13.060 | Val Loss: -1.17 | Val F1: 0.90 |
2023-09-02 20:53:49,507 - FGO - INFO - Epoch  10 | Train Loss: -13.712 | Val Loss: -1.02 | Val F1: 0.88 |
2023-09-02 20:53:50,290 - FGO - INFO - Epoch  20 | Train Loss: -13.938 | Val Loss: -1.27 | Val F1: 0.86 |
2023-09-02 20:53:51,065 - FGO - INFO - Epoch  30 | Train Loss: -14.060 | Val Loss: -1.18 | Val F1: 0.87 |
2023-09-02 20:53:51,851 - FGO - INFO - Epoch  40 | Train Loss: -14.118 | Val Loss: -1.13 | Val F1: 0.91 |
2023-09-02 20:53:52,568 - FGO - INFO - Best Epoch:  38 | Train Loss: -14.103 | Val Loss: -1.11 | Val F1: 0.91 |
2023-09-02 20:53:52,568 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:52,577 - CV - INFO - OT Train Complete, 38 epochs
2023-09-02 20:53:52,577 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:52,605 - FGO - INFO - Train CM:
[[379   5]
 [ 15 322]]
2023-09-02 20:53:52,605 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:53:52,606 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:53:52,611 - FGO - INFO - test statistical parity: 0.02230046948356812
2023-09-02 20:53:52,612 - FGO - INFO - test equal opportunity: 0.2592592592592593
2023-09-02 20:53:52,613 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:53:52,614 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:53:52,614 - CV - INFO - fold time: 4.363719701766968s (0.07272866169611612m)
2023-09-02 20:53:52,614 - CV - INFO - ----- BEGINNING FOLD SET (017:3)----------------------------------------------------------
2023-09-02 20:53:52,615 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/017/3
2023-09-02 20:53:52,615 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:52,615 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:52,615 - FGO - INFO - 	done: False
2023-09-02 20:53:52,615 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:52,615 - FGO - INFO - 	h1: 64
2023-09-02 20:53:52,615 - FGO - INFO - 	h2: 32
2023-09-02 20:53:52,615 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:52,615 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:52,615 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:52,615 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:52,615 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:52,615 - FGO - INFO - 	theta: 30
2023-09-02 20:53:52,615 - FGO - INFO - 	clip: 5
2023-09-02 20:53:52,615 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:52,615 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:52,615 - FGO - INFO - Source Total: 729
2023-09-02 20:53:52,615 - FGO - INFO - Target Total: 75
2023-09-02 20:53:52,615 - FGO - INFO - Train Total: 729
2023-09-02 20:53:52,615 - FGO - INFO - Val Total:   75
2023-09-02 20:53:52,615 - FGO - INFO - Test Total:  75
2023-09-02 20:53:52,616 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:52,616 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:52,616 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:52,616 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:52,616 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:52,616 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:52,616 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:52,616 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:52,616 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:52,616 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:52,617 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:52,618 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:52,712 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:52,712 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:52,712 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:52,712 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:52,712 - FGO - INFO - N: 804
2023-09-02 20:53:52,712 - FGO - INFO - N_s: 729
2023-09-02 20:53:52,712 - FGO - INFO - N_t: 75
2023-09-02 20:53:52,716 - CV - INFO - Begin Pretrain
2023-09-02 20:53:52,716 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:52,719 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:53:52,744 - FGO - INFO - Epoch  10 | Train Loss: 0.580 | Val Loss: 0.56 | Val F1: 0.75 |
2023-09-02 20:53:52,768 - FGO - INFO - Epoch  20 | Train Loss: 0.266 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:53:52,793 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.07 | Val F1: 0.99 |
2023-09-02 20:53:52,817 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:53:52,841 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:53:52,866 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:53:52,890 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:53:52,915 - FGO - INFO - Epoch  80 | Train Loss: 0.076 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:53:52,939 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:53:52,963 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:53:52,963 - FGO - INFO - Best Epoch:  24 | Train Loss: 0.189 | Val Loss: 0.10 | Val F1: 1.00 
2023-09-02 20:53:52,964 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:52,965 - CV - INFO - Pretrain Complete, 24 epochs
2023-09-02 20:53:52,965 - CV - INFO - Begin OT Train
2023-09-02 20:53:52,965 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:53,056 - FGO - INFO - Epoch   0 | Train Loss: -12.760 | Val Loss: -1.32 | Val F1: 0.97 |
2023-09-02 20:53:53,850 - FGO - INFO - Epoch  10 | Train Loss: -13.767 | Val Loss: -1.32 | Val F1: 0.92 |
2023-09-02 20:53:54,624 - FGO - INFO - Epoch  20 | Train Loss: -13.895 | Val Loss: -1.36 | Val F1: 0.93 |
2023-09-02 20:53:55,391 - FGO - INFO - Epoch  30 | Train Loss: -13.986 | Val Loss: -1.43 | Val F1: 0.97 |
2023-09-02 20:53:56,157 - FGO - INFO - Epoch  40 | Train Loss: -14.044 | Val Loss: -1.45 | Val F1: 0.99 |
2023-09-02 20:53:56,872 - FGO - INFO - Best Epoch:  40 | Train Loss: -14.044 | Val Loss: -1.45 | Val F1: 0.99 |
2023-09-02 20:53:56,872 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:56,875 - CV - INFO - OT Train Complete, 40 epochs
2023-09-02 20:53:56,875 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:53:56,915 - FGO - INFO - Train CM:
[[394   2]
 [ 23 310]]
2023-09-02 20:53:56,915 - FGO - INFO - Val CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:53:56,915 - FGO - INFO - Test CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:53:56,920 - FGO - INFO - test statistical parity: 0.024590163934426257
2023-09-02 20:53:56,921 - FGO - INFO - test equal opportunity: 0.033333333333333326
2023-09-02 20:53:56,922 - FGO - INFO - test micro f1: 0.9866666666666668
2023-09-02 20:53:56,923 - FGO - INFO - test macro f1: 0.9866571784380003
2023-09-02 20:53:56,923 - CV - INFO - fold time: 4.309033632278442s (0.0718172272046407m)
2023-09-02 20:53:56,923 - CV - INFO - ----- BEGINNING FOLD SET (017:4)----------------------------------------------------------
2023-09-02 20:53:56,924 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/017/4
2023-09-02 20:53:56,924 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:53:56,924 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:53:56,924 - FGO - INFO - 	done: False
2023-09-02 20:53:56,924 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:53:56,924 - FGO - INFO - 	h1: 64
2023-09-02 20:53:56,924 - FGO - INFO - 	h2: 32
2023-09-02 20:53:56,924 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:53:56,924 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:53:56,924 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:53:56,924 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:53:56,924 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:53:56,924 - FGO - INFO - 	theta: 30
2023-09-02 20:53:56,924 - FGO - INFO - 	clip: 5
2023-09-02 20:53:56,924 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:53:56,925 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:53:56,925 - FGO - INFO - Source Total: 732
2023-09-02 20:53:56,925 - FGO - INFO - Target Total: 72
2023-09-02 20:53:56,925 - FGO - INFO - Train Total: 732
2023-09-02 20:53:56,925 - FGO - INFO - Val Total:   72
2023-09-02 20:53:56,925 - FGO - INFO - Test Total:  72
2023-09-02 20:53:56,925 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:53:56,925 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:53:56,925 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:53:56,925 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:53:56,925 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:53:56,925 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:53:56,925 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:53:56,925 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:53:56,925 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:53:56,925 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:53:56,926 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:53:56,927 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:53:57,019 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:53:57,019 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:53:57,019 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:53:57,019 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:53:57,019 - FGO - INFO - N: 804
2023-09-02 20:53:57,019 - FGO - INFO - N_s: 732
2023-09-02 20:53:57,019 - FGO - INFO - N_t: 72
2023-09-02 20:53:57,022 - CV - INFO - Begin Pretrain
2023-09-02 20:53:57,022 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:53:57,026 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:53:57,050 - FGO - INFO - Epoch  10 | Train Loss: 0.578 | Val Loss: 0.58 | Val F1: 0.78 |
2023-09-02 20:53:57,075 - FGO - INFO - Epoch  20 | Train Loss: 0.258 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:53:57,100 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:53:57,125 - FGO - INFO - Epoch  40 | Train Loss: 0.095 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:53:57,149 - FGO - INFO - Epoch  50 | Train Loss: 0.084 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:53:57,174 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:53:57,198 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:53:57,223 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:53:57,247 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:53:57,272 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:53:57,272 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.99 
2023-09-02 20:53:57,272 - FGO - INFO - Setting model to best state.
2023-09-02 20:53:57,273 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:53:57,274 - CV - INFO - Begin OT Train
2023-09-02 20:53:57,274 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:53:57,369 - FGO - INFO - Epoch   0 | Train Loss: -13.033 | Val Loss: -1.30 | Val F1: 0.99 |
2023-09-02 20:53:58,179 - FGO - INFO - Epoch  10 | Train Loss: -13.722 | Val Loss: -1.28 | Val F1: 0.93 |
2023-09-02 20:53:58,985 - FGO - INFO - Epoch  20 | Train Loss: -13.865 | Val Loss: -1.31 | Val F1: 0.96 |
2023-09-02 20:53:59,754 - FGO - INFO - Epoch  30 | Train Loss: -13.968 | Val Loss: -1.37 | Val F1: 0.99 |
2023-09-02 20:54:00,550 - FGO - INFO - Epoch  40 | Train Loss: -14.040 | Val Loss: -1.36 | Val F1: 0.99 |
2023-09-02 20:54:01,247 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.470 | Val Loss: -1.35 | Val F1: 0.99 |
2023-09-02 20:54:01,247 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:01,251 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:54:01,251 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:01,275 - FGO - INFO - Train CM:
[[395   2]
 [ 24 311]]
2023-09-02 20:54:01,276 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:54:01,276 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:54:01,281 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:54:01,283 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:54:01,284 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:54:01,284 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:54:01,284 - CV - INFO - fold time: 4.361415863037109s (0.07269026438395182m)
2023-09-02 20:54:01,284 - CV - INFO - ----- BEGINNING FOLD SET (017:5)----------------------------------------------------------
2023-09-02 20:54:01,286 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/017/5
2023-09-02 20:54:01,286 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:01,286 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:01,286 - FGO - INFO - 	done: False
2023-09-02 20:54:01,286 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:01,286 - FGO - INFO - 	h1: 64
2023-09-02 20:54:01,286 - FGO - INFO - 	h2: 32
2023-09-02 20:54:01,286 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:01,286 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:01,286 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:01,286 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:01,286 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:01,286 - FGO - INFO - 	theta: 30
2023-09-02 20:54:01,286 - FGO - INFO - 	clip: 5
2023-09-02 20:54:01,286 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:01,286 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:01,286 - FGO - INFO - Source Total: 726
2023-09-02 20:54:01,286 - FGO - INFO - Target Total: 78
2023-09-02 20:54:01,286 - FGO - INFO - Train Total: 726
2023-09-02 20:54:01,286 - FGO - INFO - Val Total:   78
2023-09-02 20:54:01,286 - FGO - INFO - Test Total:  78
2023-09-02 20:54:01,286 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:01,286 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:01,286 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:01,286 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:01,286 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:01,287 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:01,287 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:01,287 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:01,287 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:01,287 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:01,288 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:01,289 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:01,387 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:01,387 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:01,387 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:01,387 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:01,387 - FGO - INFO - N: 804
2023-09-02 20:54:01,387 - FGO - INFO - N_s: 726
2023-09-02 20:54:01,387 - FGO - INFO - N_t: 78
2023-09-02 20:54:01,390 - CV - INFO - Begin Pretrain
2023-09-02 20:54:01,390 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:01,393 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:54:01,418 - FGO - INFO - Epoch  10 | Train Loss: 0.582 | Val Loss: 0.61 | Val F1: 0.72 |
2023-09-02 20:54:01,443 - FGO - INFO - Epoch  20 | Train Loss: 0.268 | Val Loss: 0.31 | Val F1: 0.87 |
2023-09-02 20:54:01,467 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.25 | Val F1: 0.92 |
2023-09-02 20:54:01,491 - FGO - INFO - Epoch  40 | Train Loss: 0.100 | Val Loss: 0.22 | Val F1: 0.92 |
2023-09-02 20:54:01,516 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:54:01,540 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:54:01,564 - FGO - INFO - Epoch  70 | Train Loss: 0.072 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:54:01,589 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.08 | Val F1: 0.96 |
2023-09-02 20:54:01,613 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:54:01,638 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.08 | Val F1: 0.96 |
2023-09-02 20:54:01,638 - FGO - INFO - Best Epoch:  77 | Train Loss: 0.070 | Val Loss: 0.10 | Val F1: 0.96 
2023-09-02 20:54:01,638 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:01,639 - CV - INFO - Pretrain Complete, 77 epochs
2023-09-02 20:54:01,639 - CV - INFO - Begin OT Train
2023-09-02 20:54:01,639 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:01,704 - FGO - INFO - Epoch   0 | Train Loss: -12.722 | Val Loss: -1.30 | Val F1: 0.96 |
2023-09-02 20:54:02,441 - FGO - INFO - Epoch  10 | Train Loss: -13.726 | Val Loss: -1.09 | Val F1: 0.88 |
2023-09-02 20:54:03,225 - FGO - INFO - Epoch  20 | Train Loss: -13.907 | Val Loss: -1.31 | Val F1: 0.92 |
2023-09-02 20:54:03,986 - FGO - INFO - Epoch  30 | Train Loss: -14.005 | Val Loss: -1.22 | Val F1: 0.92 |
2023-09-02 20:54:04,847 - FGO - INFO - Epoch  40 | Train Loss: -14.067 | Val Loss: -1.16 | Val F1: 0.92 |
2023-09-02 20:54:05,508 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.444 | Val Loss: -1.32 | Val F1: 0.95 |
2023-09-02 20:54:05,509 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:05,512 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:54:05,512 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:05,536 - FGO - INFO - Train CM:
[[398   2]
 [ 29 297]]
2023-09-02 20:54:05,536 - FGO - INFO - Val CM:
[[34  0]
 [ 6 38]]
2023-09-02 20:54:05,537 - FGO - INFO - Test CM:
[[34  0]
 [ 6 38]]
2023-09-02 20:54:05,542 - FGO - INFO - test statistical parity: 0.07729468599033817
2023-09-02 20:54:05,543 - FGO - INFO - test equal opportunity: 0.15384615384615385
2023-09-02 20:54:05,544 - FGO - INFO - test micro f1: 0.9230769230769231
2023-09-02 20:54:05,544 - FGO - INFO - test macro f1: 0.9228740936058009
2023-09-02 20:54:05,544 - CV - INFO - fold time: 4.260406970977783s (0.07100678284962972m)
2023-09-02 20:54:05,545 - CV - INFO - ----- BEGINNING FOLD SET (017:6)----------------------------------------------------------
2023-09-02 20:54:05,546 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/017/6
2023-09-02 20:54:05,546 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:05,546 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:05,546 - FGO - INFO - 	done: False
2023-09-02 20:54:05,546 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:05,546 - FGO - INFO - 	h1: 64
2023-09-02 20:54:05,546 - FGO - INFO - 	h2: 32
2023-09-02 20:54:05,546 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:05,546 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:05,546 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:05,546 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:05,546 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:05,546 - FGO - INFO - 	theta: 30
2023-09-02 20:54:05,546 - FGO - INFO - 	clip: 5
2023-09-02 20:54:05,546 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:05,546 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:05,546 - FGO - INFO - Source Total: 717
2023-09-02 20:54:05,546 - FGO - INFO - Target Total: 87
2023-09-02 20:54:05,546 - FGO - INFO - Train Total: 717
2023-09-02 20:54:05,546 - FGO - INFO - Val Total:   87
2023-09-02 20:54:05,547 - FGO - INFO - Test Total:  87
2023-09-02 20:54:05,547 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:05,547 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:05,547 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:05,547 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:05,547 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:05,547 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:05,547 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:05,547 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:05,547 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:05,547 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:05,548 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:05,549 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:05,656 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:05,656 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:05,656 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:05,656 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:05,656 - FGO - INFO - N: 804
2023-09-02 20:54:05,656 - FGO - INFO - N_s: 717
2023-09-02 20:54:05,656 - FGO - INFO - N_t: 87
2023-09-02 20:54:05,660 - CV - INFO - Begin Pretrain
2023-09-02 20:54:05,660 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:05,663 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:54:05,687 - FGO - INFO - Epoch  10 | Train Loss: 0.585 | Val Loss: 0.57 | Val F1: 0.75 |
2023-09-02 20:54:05,712 - FGO - INFO - Epoch  20 | Train Loss: 0.271 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:54:05,736 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:54:05,761 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:54:05,785 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:54:05,809 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:54:05,834 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:54:05,858 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:54:05,882 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:54:05,907 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:54:05,907 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.107 | Val Loss: 0.08 | Val F1: 0.99 
2023-09-02 20:54:05,907 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:05,908 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:54:05,908 - CV - INFO - Begin OT Train
2023-09-02 20:54:05,908 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:05,973 - FGO - INFO - Epoch   0 | Train Loss: -13.037 | Val Loss: -1.62 | Val F1: 0.99 |
2023-09-02 20:54:06,776 - FGO - INFO - Epoch  10 | Train Loss: -13.683 | Val Loss: -1.69 | Val F1: 0.98 |
2023-09-02 20:54:07,588 - FGO - INFO - Epoch  20 | Train Loss: -13.792 | Val Loss: -1.68 | Val F1: 0.93 |
2023-09-02 20:54:08,350 - FGO - INFO - Epoch  30 | Train Loss: -13.878 | Val Loss: -1.69 | Val F1: 0.95 |
2023-09-02 20:54:09,136 - FGO - INFO - Epoch  40 | Train Loss: -13.938 | Val Loss: -1.74 | Val F1: 0.95 |
2023-09-02 20:54:09,793 - FGO - INFO - Best Epoch:  41 | Train Loss: -13.939 | Val Loss: -1.74 | Val F1: 0.98 |
2023-09-02 20:54:09,793 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:09,796 - CV - INFO - OT Train Complete, 41 epochs
2023-09-02 20:54:09,797 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:09,821 - FGO - INFO - Train CM:
[[380   5]
 [ 23 309]]
2023-09-02 20:54:09,821 - FGO - INFO - Val CM:
[[47  2]
 [ 1 37]]
2023-09-02 20:54:09,821 - FGO - INFO - Test CM:
[[47  2]
 [ 1 37]]
2023-09-02 20:54:09,826 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 20:54:09,828 - FGO - INFO - test equal opportunity: 0.02941176470588236
2023-09-02 20:54:09,829 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:54:09,829 - FGO - INFO - test macro f1: 0.9650555629937074
2023-09-02 20:54:09,829 - CV - INFO - fold time: 4.284731388092041s (0.07141218980153402m)
2023-09-02 20:54:09,829 - CV - INFO - ----- BEGINNING FOLD SET (017:7)----------------------------------------------------------
2023-09-02 20:54:09,831 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/017/7
2023-09-02 20:54:09,831 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:09,831 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:09,831 - FGO - INFO - 	done: False
2023-09-02 20:54:09,831 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:09,831 - FGO - INFO - 	h1: 64
2023-09-02 20:54:09,831 - FGO - INFO - 	h2: 32
2023-09-02 20:54:09,831 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:09,831 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:09,831 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:09,831 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:09,831 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:09,831 - FGO - INFO - 	theta: 30
2023-09-02 20:54:09,831 - FGO - INFO - 	clip: 5
2023-09-02 20:54:09,831 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:09,831 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:09,831 - FGO - INFO - Source Total: 717
2023-09-02 20:54:09,831 - FGO - INFO - Target Total: 87
2023-09-02 20:54:09,831 - FGO - INFO - Train Total: 717
2023-09-02 20:54:09,831 - FGO - INFO - Val Total:   87
2023-09-02 20:54:09,831 - FGO - INFO - Test Total:  87
2023-09-02 20:54:09,831 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:09,831 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:09,831 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:09,831 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:09,831 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:09,832 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:09,832 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:09,832 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:09,832 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:09,832 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:09,833 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:09,834 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:09,940 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:09,940 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:09,940 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:09,940 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:09,940 - FGO - INFO - N: 804
2023-09-02 20:54:09,940 - FGO - INFO - N_s: 717
2023-09-02 20:54:09,940 - FGO - INFO - N_t: 87
2023-09-02 20:54:09,944 - CV - INFO - Begin Pretrain
2023-09-02 20:54:09,944 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:09,947 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:54:09,972 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.72 |
2023-09-02 20:54:09,997 - FGO - INFO - Epoch  20 | Train Loss: 0.265 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:54:10,021 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:54:10,046 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:54:10,071 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:54:10,095 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:54:10,120 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.94 |
2023-09-02 20:54:10,144 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:54:10,169 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:54:10,193 - FGO - INFO - Epoch 100 | Train Loss: 0.076 | Val Loss: 0.19 | Val F1: 0.94 |
2023-09-02 20:54:10,193 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.169 | Val Loss: 0.14 | Val F1: 0.98 
2023-09-02 20:54:10,193 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:10,195 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:54:10,195 - CV - INFO - Begin OT Train
2023-09-02 20:54:10,195 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:10,289 - FGO - INFO - Epoch   0 | Train Loss: -13.020 | Val Loss: -1.43 | Val F1: 0.95 |
2023-09-02 20:54:11,123 - FGO - INFO - Epoch  10 | Train Loss: -13.670 | Val Loss: -1.43 | Val F1: 0.93 |
2023-09-02 20:54:11,893 - FGO - INFO - Epoch  20 | Train Loss: -13.822 | Val Loss: -1.51 | Val F1: 0.94 |
2023-09-02 20:54:12,651 - FGO - INFO - Epoch  30 | Train Loss: -13.913 | Val Loss: -1.49 | Val F1: 0.93 |
2023-09-02 20:54:13,373 - FGO - INFO - Epoch  40 | Train Loss: -14.007 | Val Loss: -1.57 | Val F1: 0.95 |
2023-09-02 20:54:14,088 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.388 | Val Loss: -1.49 | Val F1: 0.95 |
2023-09-02 20:54:14,088 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:14,092 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:54:14,092 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:14,118 - FGO - INFO - Train CM:
[[385   2]
 [ 26 304]]
2023-09-02 20:54:14,118 - FGO - INFO - Val CM:
[[46  1]
 [ 3 37]]
2023-09-02 20:54:14,118 - FGO - INFO - Test CM:
[[46  1]
 [ 3 37]]
2023-09-02 20:54:14,124 - FGO - INFO - test statistical parity: 0.36333333333333334
2023-09-02 20:54:14,125 - FGO - INFO - test equal opportunity: 0.09677419354838712
2023-09-02 20:54:14,126 - FGO - INFO - test micro f1: 0.9540229885057472
2023-09-02 20:54:14,127 - FGO - INFO - test macro f1: 0.9535256410256411
2023-09-02 20:54:14,127 - CV - INFO - fold time: 4.29748797416687s (0.07162479956944784m)
2023-09-02 20:54:14,127 - CV - INFO - ----- BEGINNING FOLD SET (017:8)----------------------------------------------------------
2023-09-02 20:54:14,128 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/017/8
2023-09-02 20:54:14,128 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:14,128 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:14,129 - FGO - INFO - 	done: False
2023-09-02 20:54:14,129 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:14,129 - FGO - INFO - 	h1: 64
2023-09-02 20:54:14,129 - FGO - INFO - 	h2: 32
2023-09-02 20:54:14,129 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:14,129 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:14,129 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:14,129 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:14,129 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:14,129 - FGO - INFO - 	theta: 30
2023-09-02 20:54:14,129 - FGO - INFO - 	clip: 5
2023-09-02 20:54:14,129 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:14,129 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:14,129 - FGO - INFO - Source Total: 734
2023-09-02 20:54:14,129 - FGO - INFO - Target Total: 70
2023-09-02 20:54:14,129 - FGO - INFO - Train Total: 734
2023-09-02 20:54:14,129 - FGO - INFO - Val Total:   70
2023-09-02 20:54:14,129 - FGO - INFO - Test Total:  70
2023-09-02 20:54:14,129 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:14,129 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:14,129 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:14,129 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:14,129 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:14,129 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:14,129 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:14,129 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:14,129 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:14,130 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:14,130 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:14,132 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:14,220 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:14,220 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:14,220 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:14,220 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:14,220 - FGO - INFO - N: 804
2023-09-02 20:54:14,220 - FGO - INFO - N_s: 734
2023-09-02 20:54:14,220 - FGO - INFO - N_t: 70
2023-09-02 20:54:14,224 - CV - INFO - Begin Pretrain
2023-09-02 20:54:14,224 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:14,227 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:54:14,252 - FGO - INFO - Epoch  10 | Train Loss: 0.564 | Val Loss: 0.59 | Val F1: 0.75 |
2023-09-02 20:54:14,277 - FGO - INFO - Epoch  20 | Train Loss: 0.257 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:54:14,302 - FGO - INFO - Epoch  30 | Train Loss: 0.132 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:54:14,327 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.13 | Val F1: 0.94 |
2023-09-02 20:54:14,352 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:54:14,376 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:54:14,401 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:54:14,425 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:54:14,450 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.16 | Val F1: 0.93 |
2023-09-02 20:54:14,475 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:54:14,475 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.108 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:54:14,475 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:14,476 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:54:14,476 - CV - INFO - Begin OT Train
2023-09-02 20:54:14,476 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:14,542 - FGO - INFO - Epoch   0 | Train Loss: -12.955 | Val Loss: -1.07 | Val F1: 0.94 |
2023-09-02 20:54:15,350 - FGO - INFO - Epoch  10 | Train Loss: -13.776 | Val Loss: -1.01 | Val F1: 0.91 |
2023-09-02 20:54:16,170 - FGO - INFO - Epoch  20 | Train Loss: -13.916 | Val Loss: -1.07 | Val F1: 0.93 |
2023-09-02 20:54:16,908 - FGO - INFO - Epoch  30 | Train Loss: -14.017 | Val Loss: -1.10 | Val F1: 0.93 |
2023-09-02 20:54:17,741 - FGO - INFO - Epoch  40 | Train Loss: -14.083 | Val Loss: -1.09 | Val F1: 0.94 |
2023-09-02 20:54:18,489 - FGO - INFO - Best Epoch:  12 | Train Loss: -13.830 | Val Loss: -1.11 | Val F1: 0.96 |
2023-09-02 20:54:18,489 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:18,492 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:54:18,493 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:18,536 - FGO - INFO - Train CM:
[[399   1]
 [ 27 307]]
2023-09-02 20:54:18,537 - FGO - INFO - Val CM:
[[34  0]
 [ 4 32]]
2023-09-02 20:54:18,537 - FGO - INFO - Test CM:
[[34  0]
 [ 4 32]]
2023-09-02 20:54:18,541 - FGO - INFO - test statistical parity: 0.08906882591093113
2023-09-02 20:54:18,543 - FGO - INFO - test equal opportunity: 0.06666666666666665
2023-09-02 20:54:18,544 - FGO - INFO - test micro f1: 0.9428571428571428
2023-09-02 20:54:18,544 - FGO - INFO - test macro f1: 0.9428104575163399
2023-09-02 20:54:18,544 - CV - INFO - fold time: 4.417254447937012s (0.07362090746561686m)
2023-09-02 20:54:18,544 - CV - INFO - ----- BEGINNING FOLD SET (017:9)----------------------------------------------------------
2023-09-02 20:54:18,546 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/017/9
2023-09-02 20:54:18,546 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:18,546 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:18,546 - FGO - INFO - 	done: False
2023-09-02 20:54:18,546 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:18,546 - FGO - INFO - 	h1: 64
2023-09-02 20:54:18,546 - FGO - INFO - 	h2: 32
2023-09-02 20:54:18,546 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:18,546 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:18,546 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:18,546 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:18,546 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:18,546 - FGO - INFO - 	theta: 30
2023-09-02 20:54:18,546 - FGO - INFO - 	clip: 5
2023-09-02 20:54:18,546 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:18,546 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:18,546 - FGO - INFO - Source Total: 725
2023-09-02 20:54:18,546 - FGO - INFO - Target Total: 79
2023-09-02 20:54:18,546 - FGO - INFO - Train Total: 725
2023-09-02 20:54:18,546 - FGO - INFO - Val Total:   79
2023-09-02 20:54:18,546 - FGO - INFO - Test Total:  79
2023-09-02 20:54:18,546 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:18,546 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:18,546 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:18,546 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:18,546 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:18,547 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:18,547 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:18,547 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:18,547 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:18,547 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:18,548 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:18,549 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:18,648 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:18,648 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:18,648 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:18,648 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:18,648 - FGO - INFO - N: 804
2023-09-02 20:54:18,648 - FGO - INFO - N_s: 725
2023-09-02 20:54:18,648 - FGO - INFO - N_t: 79
2023-09-02 20:54:18,652 - CV - INFO - Begin Pretrain
2023-09-02 20:54:18,652 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:18,655 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:54:18,680 - FGO - INFO - Epoch  10 | Train Loss: 0.579 | Val Loss: 0.59 | Val F1: 0.74 |
2023-09-02 20:54:18,704 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.30 | Val F1: 0.91 |
2023-09-02 20:54:18,729 - FGO - INFO - Epoch  30 | Train Loss: 0.128 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:54:18,753 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:54:18,777 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:54:18,802 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:54:18,826 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:54:18,851 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:54:18,875 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:54:18,900 - FGO - INFO - Epoch 100 | Train Loss: 0.065 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:54:18,900 - FGO - INFO - Best Epoch:  51 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.99 
2023-09-02 20:54:18,900 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:18,901 - CV - INFO - Pretrain Complete, 51 epochs
2023-09-02 20:54:18,901 - CV - INFO - Begin OT Train
2023-09-02 20:54:18,901 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:18,995 - FGO - INFO - Epoch   0 | Train Loss: -13.141 | Val Loss: -1.30 | Val F1: 0.97 |
2023-09-02 20:54:19,742 - FGO - INFO - Epoch  10 | Train Loss: -13.764 | Val Loss: -1.40 | Val F1: 0.93 |
2023-09-02 20:54:20,557 - FGO - INFO - Epoch  20 | Train Loss: -13.866 | Val Loss: -1.42 | Val F1: 0.94 |
2023-09-02 20:54:21,299 - FGO - INFO - Epoch  30 | Train Loss: -13.981 | Val Loss: -1.47 | Val F1: 0.97 |
2023-09-02 20:54:22,110 - FGO - INFO - Epoch  40 | Train Loss: -14.045 | Val Loss: -1.49 | Val F1: 0.96 |
2023-09-02 20:54:22,802 - FGO - INFO - Best Epoch:  30 | Train Loss: -13.981 | Val Loss: -1.47 | Val F1: 0.97 |
2023-09-02 20:54:22,802 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:22,806 - CV - INFO - OT Train Complete, 30 epochs
2023-09-02 20:54:22,806 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:22,831 - FGO - INFO - Train CM:
[[383   2]
 [ 28 312]]
2023-09-02 20:54:22,831 - FGO - INFO - Val CM:
[[49  0]
 [ 2 28]]
2023-09-02 20:54:22,831 - FGO - INFO - Test CM:
[[49  0]
 [ 2 28]]
2023-09-02 20:54:22,836 - FGO - INFO - test statistical parity: 0.05217391304347829
2023-09-02 20:54:22,838 - FGO - INFO - test equal opportunity: 0.07692307692307687
2023-09-02 20:54:22,839 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:54:22,839 - FGO - INFO - test macro f1: 0.9727586206896552
2023-09-02 20:54:22,839 - CV - INFO - fold time: 4.295041084289551s (0.07158401807149252m)
2023-09-02 20:54:22,839 - CV - INFO - Mean Pretrain Epochs 45.5:
2023-09-02 20:54:22,839 - CV - INFO - Mean OT Train Epochs 24.5:
2023-09-02 20:54:22,839 - CV - INFO - Mean Val Macro F1 : 0.9480773801796175
2023-09-02 20:54:22,839 - CV - INFO - Mean Eval Stat : 0.9480773801796175 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:54:22,839 - CV - INFO - set time: 43.401689529418945s (0.7233614921569824m)
2023-09-02 20:54:22,839 - CV - INFO - script time so far: 760.7903711795807s (12.679839519659678m) (0.21133065866099462h)
2023-09-02 20:54:22,839 - CV - INFO - ===== BEGINNING OPTION SET (018)==========================================================
2023-09-02 20:54:22,839 - CV - INFO - 	done: False
2023-09-02 20:54:22,839 - CV - INFO - 	learning_rate: 0.005
2023-09-02 20:54:22,839 - CV - INFO - 	h1: 64
2023-09-02 20:54:22,839 - CV - INFO - 	h2: 32
2023-09-02 20:54:22,839 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:22,839 - CV - INFO - 	dropout: 0.0
2023-09-02 20:54:22,839 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:22,839 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:22,839 - CV - INFO - 	lambda: 0.05
2023-09-02 20:54:22,839 - CV - INFO - 	theta: 50
2023-09-02 20:54:22,839 - CV - INFO - 	clip: 5
2023-09-02 20:54:22,839 - CV - INFO - ----- BEGINNING FOLD SET (018:0)----------------------------------------------------------
2023-09-02 20:54:22,841 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/018/0
2023-09-02 20:54:22,841 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:22,841 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:22,841 - FGO - INFO - 	done: False
2023-09-02 20:54:22,841 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:22,841 - FGO - INFO - 	h1: 64
2023-09-02 20:54:22,841 - FGO - INFO - 	h2: 32
2023-09-02 20:54:22,841 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:22,841 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:22,841 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:22,841 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:22,841 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:22,841 - FGO - INFO - 	theta: 50
2023-09-02 20:54:22,841 - FGO - INFO - 	clip: 5
2023-09-02 20:54:22,841 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:22,841 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:22,841 - FGO - INFO - Source Total: 708
2023-09-02 20:54:22,841 - FGO - INFO - Target Total: 96
2023-09-02 20:54:22,841 - FGO - INFO - Train Total: 708
2023-09-02 20:54:22,841 - FGO - INFO - Val Total:   96
2023-09-02 20:54:22,841 - FGO - INFO - Test Total:  96
2023-09-02 20:54:22,841 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:22,841 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:22,841 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:22,841 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:22,841 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:22,842 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:22,842 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:22,842 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:22,842 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:22,842 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:22,843 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:22,844 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:22,960 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:22,960 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:22,960 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:22,960 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:22,960 - FGO - INFO - N: 804
2023-09-02 20:54:22,960 - FGO - INFO - N_s: 708
2023-09-02 20:54:22,960 - FGO - INFO - N_t: 96
2023-09-02 20:54:22,964 - CV - INFO - Begin Pretrain
2023-09-02 20:54:22,964 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:22,967 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:54:22,992 - FGO - INFO - Epoch  10 | Train Loss: 0.572 | Val Loss: 0.59 | Val F1: 0.62 |
2023-09-02 20:54:23,016 - FGO - INFO - Epoch  20 | Train Loss: 0.245 | Val Loss: 0.25 | Val F1: 0.93 |
2023-09-02 20:54:23,040 - FGO - INFO - Epoch  30 | Train Loss: 0.127 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:54:23,065 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:54:23,089 - FGO - INFO - Epoch  50 | Train Loss: 0.083 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:54:23,113 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:54:23,138 - FGO - INFO - Epoch  70 | Train Loss: 0.067 | Val Loss: 0.17 | Val F1: 0.96 |
2023-09-02 20:54:23,162 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:54:23,186 - FGO - INFO - Epoch  90 | Train Loss: 0.060 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:54:23,210 - FGO - INFO - Epoch 100 | Train Loss: 0.058 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:54:23,210 - FGO - INFO - Best Epoch:  39 | Train Loss: 0.095 | Val Loss: 0.10 | Val F1: 0.98 
2023-09-02 20:54:23,210 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:23,212 - CV - INFO - Pretrain Complete, 39 epochs
2023-09-02 20:54:23,212 - CV - INFO - Begin OT Train
2023-09-02 20:54:23,212 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:23,276 - FGO - INFO - Epoch   0 | Train Loss: -21.701 | Val Loss: -2.92 | Val F1: 0.97 |
2023-09-02 20:54:24,041 - FGO - INFO - Epoch  10 | Train Loss: -22.823 | Val Loss: -3.07 | Val F1: 0.95 |
2023-09-02 20:54:24,760 - FGO - INFO - Epoch  20 | Train Loss: -23.496 | Val Loss: -2.78 | Val F1: 0.65 |
2023-09-02 20:54:25,595 - FGO - INFO - Epoch  30 | Train Loss: -23.707 | Val Loss: -2.73 | Val F1: 0.35 |
2023-09-02 20:54:26,325 - FGO - INFO - Epoch  40 | Train Loss: -23.708 | Val Loss: -2.73 | Val F1: 0.35 |
2023-09-02 20:54:26,983 - FGO - INFO - Best Epoch:   9 | Train Loss: -22.754 | Val Loss: -3.06 | Val F1: 0.95 |
2023-09-02 20:54:26,983 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:26,987 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:54:26,987 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:27,010 - FGO - INFO - Train CM:
[[382   0]
 [326   0]]
2023-09-02 20:54:27,011 - FGO - INFO - Val CM:
[[52  0]
 [44  0]]
2023-09-02 20:54:27,011 - FGO - INFO - Test CM:
[[52  0]
 [44  0]]
2023-09-02 20:54:27,016 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:54:27,018 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:54:27,019 - FGO - INFO - test micro f1: 0.5416666666666666
2023-09-02 20:54:27,019 - FGO - INFO - test macro f1: 0.35135135135135137
2023-09-02 20:54:27,019 - CV - INFO - fold time: 4.179683446884155s (0.06966139078140259m)
2023-09-02 20:54:27,019 - CV - INFO - ----- BEGINNING FOLD SET (018:1)----------------------------------------------------------
2023-09-02 20:54:27,021 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/018/1
2023-09-02 20:54:27,021 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:27,021 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:27,021 - FGO - INFO - 	done: False
2023-09-02 20:54:27,021 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:27,021 - FGO - INFO - 	h1: 64
2023-09-02 20:54:27,021 - FGO - INFO - 	h2: 32
2023-09-02 20:54:27,021 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:27,021 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:27,021 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:27,021 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:27,021 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:27,021 - FGO - INFO - 	theta: 50
2023-09-02 20:54:27,021 - FGO - INFO - 	clip: 5
2023-09-02 20:54:27,021 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:27,021 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:27,021 - FGO - INFO - Source Total: 727
2023-09-02 20:54:27,021 - FGO - INFO - Target Total: 77
2023-09-02 20:54:27,021 - FGO - INFO - Train Total: 727
2023-09-02 20:54:27,021 - FGO - INFO - Val Total:   77
2023-09-02 20:54:27,021 - FGO - INFO - Test Total:  77
2023-09-02 20:54:27,021 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:27,021 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:27,021 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:27,021 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:27,021 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:27,022 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:27,022 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:27,022 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:27,022 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:27,022 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:27,023 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:27,024 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:27,121 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:27,121 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:27,121 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:27,121 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:27,121 - FGO - INFO - N: 804
2023-09-02 20:54:27,121 - FGO - INFO - N_s: 727
2023-09-02 20:54:27,121 - FGO - INFO - N_t: 77
2023-09-02 20:54:27,124 - CV - INFO - Begin Pretrain
2023-09-02 20:54:27,124 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:27,128 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:54:27,152 - FGO - INFO - Epoch  10 | Train Loss: 0.577 | Val Loss: 0.61 | Val F1: 0.66 |
2023-09-02 20:54:27,177 - FGO - INFO - Epoch  20 | Train Loss: 0.255 | Val Loss: 0.38 | Val F1: 0.83 |
2023-09-02 20:54:27,202 - FGO - INFO - Epoch  30 | Train Loss: 0.122 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:54:27,227 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.20 | Val F1: 0.89 |
2023-09-02 20:54:27,252 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.87 |
2023-09-02 20:54:27,276 - FGO - INFO - Epoch  60 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.89 |
2023-09-02 20:54:27,301 - FGO - INFO - Epoch  70 | Train Loss: 0.063 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:54:27,325 - FGO - INFO - Epoch  80 | Train Loss: 0.060 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:54:27,350 - FGO - INFO - Epoch  90 | Train Loss: 0.057 | Val Loss: 0.21 | Val F1: 0.90 |
2023-09-02 20:54:27,375 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.19 | Val F1: 0.92 |
2023-09-02 20:54:27,375 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.097 | Val Loss: 0.18 | Val F1: 0.93 
2023-09-02 20:54:27,375 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:27,376 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:54:27,376 - CV - INFO - Begin OT Train
2023-09-02 20:54:27,376 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:27,471 - FGO - INFO - Epoch   0 | Train Loss: -21.896 | Val Loss: -1.97 | Val F1: 0.89 |
2023-09-02 20:54:28,232 - FGO - INFO - Epoch  10 | Train Loss: -22.930 | Val Loss: -1.90 | Val F1: 0.86 |
2023-09-02 20:54:28,987 - FGO - INFO - Epoch  20 | Train Loss: -23.758 | Val Loss: -1.91 | Val F1: 0.83 |
2023-09-02 20:54:29,772 - FGO - INFO - Epoch  30 | Train Loss: -24.155 | Val Loss: -1.79 | Val F1: 0.36 |
2023-09-02 20:54:30,538 - FGO - INFO - Epoch  40 | Train Loss: -24.160 | Val Loss: -1.80 | Val F1: 0.36 |
2023-09-02 20:54:31,230 - FGO - INFO - Best Epoch:  13 | Train Loss: -23.294 | Val Loss: -2.13 | Val F1: 0.92 |
2023-09-02 20:54:31,230 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:31,232 - CV - INFO - OT Train Complete, 13 epochs
2023-09-02 20:54:31,233 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:31,257 - FGO - INFO - Train CM:
[[390   0]
 [337   0]]
2023-09-02 20:54:31,257 - FGO - INFO - Val CM:
[[44  0]
 [33  0]]
2023-09-02 20:54:31,258 - FGO - INFO - Test CM:
[[44  0]
 [33  0]]
2023-09-02 20:54:31,263 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:54:31,264 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:54:31,265 - FGO - INFO - test micro f1: 0.5714285714285714
2023-09-02 20:54:31,265 - FGO - INFO - test macro f1: 0.36363636363636365
2023-09-02 20:54:31,265 - CV - INFO - fold time: 4.246109962463379s (0.07076849937438964m)
2023-09-02 20:54:31,265 - CV - INFO - ----- BEGINNING FOLD SET (018:2)----------------------------------------------------------
2023-09-02 20:54:31,267 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/018/2
2023-09-02 20:54:31,267 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:31,267 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:31,267 - FGO - INFO - 	done: False
2023-09-02 20:54:31,267 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:31,267 - FGO - INFO - 	h1: 64
2023-09-02 20:54:31,267 - FGO - INFO - 	h2: 32
2023-09-02 20:54:31,267 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:31,267 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:31,267 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:31,267 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:31,267 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:31,267 - FGO - INFO - 	theta: 50
2023-09-02 20:54:31,267 - FGO - INFO - 	clip: 5
2023-09-02 20:54:31,267 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:31,267 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:31,267 - FGO - INFO - Source Total: 721
2023-09-02 20:54:31,267 - FGO - INFO - Target Total: 83
2023-09-02 20:54:31,267 - FGO - INFO - Train Total: 721
2023-09-02 20:54:31,267 - FGO - INFO - Val Total:   83
2023-09-02 20:54:31,267 - FGO - INFO - Test Total:  83
2023-09-02 20:54:31,267 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:31,267 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:31,267 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:31,267 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:31,267 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:31,268 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:31,268 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:31,268 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:31,268 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:31,268 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:31,269 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:31,270 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:31,373 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:31,373 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:31,373 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:31,373 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:31,373 - FGO - INFO - N: 804
2023-09-02 20:54:31,373 - FGO - INFO - N_s: 721
2023-09-02 20:54:31,373 - FGO - INFO - N_t: 83
2023-09-02 20:54:31,376 - CV - INFO - Begin Pretrain
2023-09-02 20:54:31,376 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:31,380 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:54:31,404 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.76 |
2023-09-02 20:54:31,429 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.33 | Val F1: 0.88 |
2023-09-02 20:54:31,453 - FGO - INFO - Epoch  30 | Train Loss: 0.120 | Val Loss: 0.24 | Val F1: 0.88 |
2023-09-02 20:54:31,478 - FGO - INFO - Epoch  40 | Train Loss: 0.083 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:54:31,502 - FGO - INFO - Epoch  50 | Train Loss: 0.071 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:54:31,527 - FGO - INFO - Epoch  60 | Train Loss: 0.062 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:54:31,551 - FGO - INFO - Epoch  70 | Train Loss: 0.059 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:54:31,575 - FGO - INFO - Epoch  80 | Train Loss: 0.055 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:54:31,600 - FGO - INFO - Epoch  90 | Train Loss: 0.053 | Val Loss: 0.27 | Val F1: 0.90 |
2023-09-02 20:54:31,624 - FGO - INFO - Epoch 100 | Train Loss: 0.051 | Val Loss: 0.26 | Val F1: 0.91 |
2023-09-02 20:54:31,624 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.063 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:54:31,624 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:31,625 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:54:31,625 - CV - INFO - Begin OT Train
2023-09-02 20:54:31,625 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:31,695 - FGO - INFO - Epoch   0 | Train Loss: -21.881 | Val Loss: -2.12 | Val F1: 0.90 |
2023-09-02 20:54:32,428 - FGO - INFO - Epoch  10 | Train Loss: -23.186 | Val Loss: -2.13 | Val F1: 0.88 |
2023-09-02 20:54:33,235 - FGO - INFO - Epoch  20 | Train Loss: -23.915 | Val Loss: -2.06 | Val F1: 0.74 |
2023-09-02 20:54:33,995 - FGO - INFO - Epoch  30 | Train Loss: -24.137 | Val Loss: -1.98 | Val F1: 0.38 |
2023-09-02 20:54:34,779 - FGO - INFO - Epoch  40 | Train Loss: -24.138 | Val Loss: -1.99 | Val F1: 0.38 |
2023-09-02 20:54:35,466 - FGO - INFO - Best Epoch:   7 | Train Loss: -22.885 | Val Loss: -2.21 | Val F1: 0.92 |
2023-09-02 20:54:35,466 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:35,470 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:54:35,470 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:35,493 - FGO - INFO - Train CM:
[[384   0]
 [337   0]]
2023-09-02 20:54:35,493 - FGO - INFO - Val CM:
[[50  0]
 [33  0]]
2023-09-02 20:54:35,494 - FGO - INFO - Test CM:
[[50  0]
 [33  0]]
2023-09-02 20:54:35,499 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:54:35,500 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:54:35,501 - FGO - INFO - test micro f1: 0.6024096385542169
2023-09-02 20:54:35,502 - FGO - INFO - test macro f1: 0.3759398496240602
2023-09-02 20:54:35,502 - CV - INFO - fold time: 4.236545085906982s (0.07060908476511638m)
2023-09-02 20:54:35,502 - CV - INFO - ----- BEGINNING FOLD SET (018:3)----------------------------------------------------------
2023-09-02 20:54:35,503 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/018/3
2023-09-02 20:54:35,504 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:35,504 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:35,504 - FGO - INFO - 	done: False
2023-09-02 20:54:35,504 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:35,504 - FGO - INFO - 	h1: 64
2023-09-02 20:54:35,504 - FGO - INFO - 	h2: 32
2023-09-02 20:54:35,504 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:35,504 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:35,504 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:35,504 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:35,504 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:35,504 - FGO - INFO - 	theta: 50
2023-09-02 20:54:35,504 - FGO - INFO - 	clip: 5
2023-09-02 20:54:35,504 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:35,504 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:35,504 - FGO - INFO - Source Total: 729
2023-09-02 20:54:35,504 - FGO - INFO - Target Total: 75
2023-09-02 20:54:35,504 - FGO - INFO - Train Total: 729
2023-09-02 20:54:35,504 - FGO - INFO - Val Total:   75
2023-09-02 20:54:35,504 - FGO - INFO - Test Total:  75
2023-09-02 20:54:35,504 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:35,504 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:35,504 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:35,504 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:35,504 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:35,504 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:35,504 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:35,505 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:35,505 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:35,505 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:35,506 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:35,507 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:35,600 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:35,600 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:35,600 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:35,600 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:35,600 - FGO - INFO - N: 804
2023-09-02 20:54:35,600 - FGO - INFO - N_s: 729
2023-09-02 20:54:35,600 - FGO - INFO - N_t: 75
2023-09-02 20:54:35,604 - CV - INFO - Begin Pretrain
2023-09-02 20:54:35,604 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:35,607 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:54:35,632 - FGO - INFO - Epoch  10 | Train Loss: 0.580 | Val Loss: 0.56 | Val F1: 0.75 |
2023-09-02 20:54:35,656 - FGO - INFO - Epoch  20 | Train Loss: 0.266 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:54:35,681 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.07 | Val F1: 0.99 |
2023-09-02 20:54:35,705 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:54:35,730 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:54:35,754 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:54:35,779 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:54:35,803 - FGO - INFO - Epoch  80 | Train Loss: 0.076 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:54:35,828 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:54:35,852 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:54:35,852 - FGO - INFO - Best Epoch:  24 | Train Loss: 0.189 | Val Loss: 0.10 | Val F1: 1.00 
2023-09-02 20:54:35,852 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:35,853 - CV - INFO - Pretrain Complete, 24 epochs
2023-09-02 20:54:35,853 - CV - INFO - Begin OT Train
2023-09-02 20:54:35,854 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:35,919 - FGO - INFO - Epoch   0 | Train Loss: -21.509 | Val Loss: -2.23 | Val F1: 0.97 |
2023-09-02 20:54:36,707 - FGO - INFO - Epoch  10 | Train Loss: -23.232 | Val Loss: -2.26 | Val F1: 0.92 |
2023-09-02 20:54:37,502 - FGO - INFO - Epoch  20 | Train Loss: -23.853 | Val Loss: -1.94 | Val F1: 0.58 |
2023-09-02 20:54:38,232 - FGO - INFO - Epoch  30 | Train Loss: -23.997 | Val Loss: -1.89 | Val F1: 0.34 |
2023-09-02 20:54:38,985 - FGO - INFO - Epoch  40 | Train Loss: -24.001 | Val Loss: -1.89 | Val F1: 0.34 |
2023-09-02 20:54:39,662 - FGO - INFO - Best Epoch:   6 | Train Loss: -22.748 | Val Loss: -2.32 | Val F1: 0.96 |
2023-09-02 20:54:39,662 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:39,665 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:54:39,666 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:39,689 - FGO - INFO - Train CM:
[[396   0]
 [333   0]]
2023-09-02 20:54:39,690 - FGO - INFO - Val CM:
[[38  0]
 [37  0]]
2023-09-02 20:54:39,690 - FGO - INFO - Test CM:
[[38  0]
 [37  0]]
2023-09-02 20:54:39,695 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:54:39,696 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:54:39,697 - FGO - INFO - test micro f1: 0.5066666666666667
2023-09-02 20:54:39,698 - FGO - INFO - test macro f1: 0.33628318584070793
2023-09-02 20:54:39,698 - CV - INFO - fold time: 4.196012258529663s (0.06993353764216105m)
2023-09-02 20:54:39,698 - CV - INFO - ----- BEGINNING FOLD SET (018:4)----------------------------------------------------------
2023-09-02 20:54:39,699 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/018/4
2023-09-02 20:54:39,700 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:39,700 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:39,700 - FGO - INFO - 	done: False
2023-09-02 20:54:39,700 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:39,700 - FGO - INFO - 	h1: 64
2023-09-02 20:54:39,700 - FGO - INFO - 	h2: 32
2023-09-02 20:54:39,700 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:39,700 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:39,700 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:39,700 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:39,700 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:39,700 - FGO - INFO - 	theta: 50
2023-09-02 20:54:39,700 - FGO - INFO - 	clip: 5
2023-09-02 20:54:39,700 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:39,700 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:39,700 - FGO - INFO - Source Total: 732
2023-09-02 20:54:39,700 - FGO - INFO - Target Total: 72
2023-09-02 20:54:39,700 - FGO - INFO - Train Total: 732
2023-09-02 20:54:39,700 - FGO - INFO - Val Total:   72
2023-09-02 20:54:39,700 - FGO - INFO - Test Total:  72
2023-09-02 20:54:39,700 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:39,700 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:39,700 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:39,700 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:39,700 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:39,701 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:39,701 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:39,701 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:39,701 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:39,701 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:39,702 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:39,703 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:39,793 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:39,793 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:39,793 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:39,793 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:39,794 - FGO - INFO - N: 804
2023-09-02 20:54:39,794 - FGO - INFO - N_s: 732
2023-09-02 20:54:39,794 - FGO - INFO - N_t: 72
2023-09-02 20:54:39,797 - CV - INFO - Begin Pretrain
2023-09-02 20:54:39,797 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:39,800 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:54:39,825 - FGO - INFO - Epoch  10 | Train Loss: 0.578 | Val Loss: 0.58 | Val F1: 0.78 |
2023-09-02 20:54:39,850 - FGO - INFO - Epoch  20 | Train Loss: 0.258 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:54:39,875 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:54:39,900 - FGO - INFO - Epoch  40 | Train Loss: 0.095 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:54:39,924 - FGO - INFO - Epoch  50 | Train Loss: 0.084 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:54:39,949 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:54:39,973 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:54:39,998 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:54:40,022 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:54:40,047 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:54:40,047 - FGO - INFO - Best Epoch:  72 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.99 
2023-09-02 20:54:40,047 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:40,049 - CV - INFO - Pretrain Complete, 72 epochs
2023-09-02 20:54:40,049 - CV - INFO - Begin OT Train
2023-09-02 20:54:40,049 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:40,143 - FGO - INFO - Epoch   0 | Train Loss: -21.813 | Val Loss: -2.20 | Val F1: 0.99 |
2023-09-02 20:54:40,979 - FGO - INFO - Epoch  10 | Train Loss: -23.251 | Val Loss: -2.19 | Val F1: 0.89 |
2023-09-02 20:54:41,739 - FGO - INFO - Epoch  20 | Train Loss: -23.896 | Val Loss: -1.86 | Val F1: 0.48 |
2023-09-02 20:54:42,624 - FGO - INFO - Epoch  30 | Train Loss: -23.963 | Val Loss: -1.83 | Val F1: 0.34 |
2023-09-02 20:54:43,376 - FGO - INFO - Epoch  40 | Train Loss: -23.966 | Val Loss: -1.83 | Val F1: 0.34 |
2023-09-02 20:54:44,068 - FGO - INFO - Best Epoch:   6 | Train Loss: -22.894 | Val Loss: -2.29 | Val F1: 0.97 |
2023-09-02 20:54:44,068 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:44,072 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:54:44,072 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:44,095 - FGO - INFO - Train CM:
[[397   0]
 [335   0]]
2023-09-02 20:54:44,096 - FGO - INFO - Val CM:
[[37  0]
 [35  0]]
2023-09-02 20:54:44,096 - FGO - INFO - Test CM:
[[37  0]
 [35  0]]
2023-09-02 20:54:44,101 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:54:44,103 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:54:44,103 - FGO - INFO - test micro f1: 0.5138888888888888
2023-09-02 20:54:44,104 - FGO - INFO - test macro f1: 0.33944954128440363
2023-09-02 20:54:44,104 - CV - INFO - fold time: 4.406026840209961s (0.07343378067016601m)
2023-09-02 20:54:44,104 - CV - INFO - ----- BEGINNING FOLD SET (018:5)----------------------------------------------------------
2023-09-02 20:54:44,105 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/018/5
2023-09-02 20:54:44,106 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:44,106 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:44,106 - FGO - INFO - 	done: False
2023-09-02 20:54:44,106 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:44,106 - FGO - INFO - 	h1: 64
2023-09-02 20:54:44,106 - FGO - INFO - 	h2: 32
2023-09-02 20:54:44,106 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:44,106 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:44,106 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:44,106 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:44,106 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:44,106 - FGO - INFO - 	theta: 50
2023-09-02 20:54:44,106 - FGO - INFO - 	clip: 5
2023-09-02 20:54:44,106 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:44,106 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:44,106 - FGO - INFO - Source Total: 726
2023-09-02 20:54:44,106 - FGO - INFO - Target Total: 78
2023-09-02 20:54:44,106 - FGO - INFO - Train Total: 726
2023-09-02 20:54:44,106 - FGO - INFO - Val Total:   78
2023-09-02 20:54:44,106 - FGO - INFO - Test Total:  78
2023-09-02 20:54:44,106 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:44,106 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:44,106 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:44,106 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:44,106 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:44,107 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:44,107 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:44,107 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:44,107 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:44,107 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:44,108 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:44,109 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:44,206 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:44,206 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:44,206 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:44,206 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:44,206 - FGO - INFO - N: 804
2023-09-02 20:54:44,206 - FGO - INFO - N_s: 726
2023-09-02 20:54:44,206 - FGO - INFO - N_t: 78
2023-09-02 20:54:44,210 - CV - INFO - Begin Pretrain
2023-09-02 20:54:44,210 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:44,213 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:54:44,238 - FGO - INFO - Epoch  10 | Train Loss: 0.582 | Val Loss: 0.61 | Val F1: 0.72 |
2023-09-02 20:54:44,262 - FGO - INFO - Epoch  20 | Train Loss: 0.268 | Val Loss: 0.31 | Val F1: 0.87 |
2023-09-02 20:54:44,287 - FGO - INFO - Epoch  30 | Train Loss: 0.130 | Val Loss: 0.25 | Val F1: 0.92 |
2023-09-02 20:54:44,311 - FGO - INFO - Epoch  40 | Train Loss: 0.100 | Val Loss: 0.22 | Val F1: 0.92 |
2023-09-02 20:54:44,335 - FGO - INFO - Epoch  50 | Train Loss: 0.087 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:54:44,359 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:54:44,384 - FGO - INFO - Epoch  70 | Train Loss: 0.072 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:54:44,408 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:54:44,432 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:54:44,457 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:54:44,457 - FGO - INFO - Best Epoch:  77 | Train Loss: 0.071 | Val Loss: 0.10 | Val F1: 0.96 
2023-09-02 20:54:44,457 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:44,458 - CV - INFO - Pretrain Complete, 77 epochs
2023-09-02 20:54:44,458 - CV - INFO - Begin OT Train
2023-09-02 20:54:44,458 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:44,553 - FGO - INFO - Epoch   0 | Train Loss: -21.480 | Val Loss: -2.21 | Val F1: 0.96 |
2023-09-02 20:54:45,296 - FGO - INFO - Epoch  10 | Train Loss: -23.284 | Val Loss: -2.18 | Val F1: 0.88 |
2023-09-02 20:54:46,114 - FGO - INFO - Epoch  20 | Train Loss: -23.940 | Val Loss: -1.95 | Val F1: 0.50 |
2023-09-02 20:54:46,883 - FGO - INFO - Epoch  30 | Train Loss: -24.069 | Val Loss: -1.90 | Val F1: 0.30 |
2023-09-02 20:54:47,645 - FGO - INFO - Epoch  40 | Train Loss: -24.071 | Val Loss: -1.90 | Val F1: 0.30 |
2023-09-02 20:54:48,269 - FGO - INFO - Best Epoch:   6 | Train Loss: -22.819 | Val Loss: -2.23 | Val F1: 0.91 |
2023-09-02 20:54:48,269 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:48,272 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:54:48,272 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:48,296 - FGO - INFO - Train CM:
[[400   0]
 [326   0]]
2023-09-02 20:54:48,296 - FGO - INFO - Val CM:
[[34  0]
 [44  0]]
2023-09-02 20:54:48,296 - FGO - INFO - Test CM:
[[34  0]
 [44  0]]
2023-09-02 20:54:48,302 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:54:48,303 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:54:48,304 - FGO - INFO - test micro f1: 0.4358974358974359
2023-09-02 20:54:48,304 - FGO - INFO - test macro f1: 0.30357142857142855
2023-09-02 20:54:48,304 - CV - INFO - fold time: 4.200272560119629s (0.07000454266866048m)
2023-09-02 20:54:48,304 - CV - INFO - ----- BEGINNING FOLD SET (018:6)----------------------------------------------------------
2023-09-02 20:54:48,306 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/018/6
2023-09-02 20:54:48,306 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:48,306 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:48,306 - FGO - INFO - 	done: False
2023-09-02 20:54:48,306 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:48,306 - FGO - INFO - 	h1: 64
2023-09-02 20:54:48,306 - FGO - INFO - 	h2: 32
2023-09-02 20:54:48,306 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:48,306 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:48,306 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:48,306 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:48,306 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:48,306 - FGO - INFO - 	theta: 50
2023-09-02 20:54:48,306 - FGO - INFO - 	clip: 5
2023-09-02 20:54:48,306 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:48,306 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:48,306 - FGO - INFO - Source Total: 717
2023-09-02 20:54:48,306 - FGO - INFO - Target Total: 87
2023-09-02 20:54:48,306 - FGO - INFO - Train Total: 717
2023-09-02 20:54:48,306 - FGO - INFO - Val Total:   87
2023-09-02 20:54:48,306 - FGO - INFO - Test Total:  87
2023-09-02 20:54:48,306 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:48,306 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:48,306 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:48,306 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:48,306 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:48,307 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:48,307 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:48,307 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:48,307 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:48,307 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:48,308 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:48,309 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:48,415 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:48,415 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:48,415 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:48,420 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:48,420 - FGO - INFO - N: 804
2023-09-02 20:54:48,420 - FGO - INFO - N_s: 717
2023-09-02 20:54:48,420 - FGO - INFO - N_t: 87
2023-09-02 20:54:48,423 - CV - INFO - Begin Pretrain
2023-09-02 20:54:48,423 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:48,427 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:54:48,451 - FGO - INFO - Epoch  10 | Train Loss: 0.585 | Val Loss: 0.57 | Val F1: 0.75 |
2023-09-02 20:54:48,476 - FGO - INFO - Epoch  20 | Train Loss: 0.271 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:54:48,500 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.95 |
2023-09-02 20:54:48,525 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:54:48,549 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.08 | Val F1: 0.98 |
2023-09-02 20:54:48,573 - FGO - INFO - Epoch  60 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:54:48,598 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:54:48,622 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:54:48,646 - FGO - INFO - Epoch  90 | Train Loss: 0.071 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:54:48,671 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:54:48,671 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.107 | Val Loss: 0.08 | Val F1: 0.99 
2023-09-02 20:54:48,671 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:48,672 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:54:48,672 - CV - INFO - Begin OT Train
2023-09-02 20:54:48,672 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:48,763 - FGO - INFO - Epoch   0 | Train Loss: -21.794 | Val Loss: -2.74 | Val F1: 0.99 |
2023-09-02 20:54:49,544 - FGO - INFO - Epoch  10 | Train Loss: -23.113 | Val Loss: -2.84 | Val F1: 0.94 |
2023-09-02 20:54:50,342 - FGO - INFO - Epoch  20 | Train Loss: -23.691 | Val Loss: -2.45 | Val F1: 0.54 |
2023-09-02 20:54:51,110 - FGO - INFO - Epoch  30 | Train Loss: -23.791 | Val Loss: -2.43 | Val F1: 0.39 |
2023-09-02 20:54:51,864 - FGO - INFO - Epoch  40 | Train Loss: -23.794 | Val Loss: -2.43 | Val F1: 0.36 |
2023-09-02 20:54:52,551 - FGO - INFO - Best Epoch:   9 | Train Loss: -23.057 | Val Loss: -2.85 | Val F1: 0.94 |
2023-09-02 20:54:52,551 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:52,554 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:54:52,555 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:52,578 - FGO - INFO - Train CM:
[[385   0]
 [332   0]]
2023-09-02 20:54:52,579 - FGO - INFO - Val CM:
[[49  0]
 [38  0]]
2023-09-02 20:54:52,579 - FGO - INFO - Test CM:
[[49  0]
 [38  0]]
2023-09-02 20:54:52,584 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:54:52,586 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:54:52,587 - FGO - INFO - test micro f1: 0.5632183908045977
2023-09-02 20:54:52,587 - FGO - INFO - test macro f1: 0.3602941176470588
2023-09-02 20:54:52,587 - CV - INFO - fold time: 4.282782077789307s (0.07137970129648845m)
2023-09-02 20:54:52,587 - CV - INFO - ----- BEGINNING FOLD SET (018:7)----------------------------------------------------------
2023-09-02 20:54:52,589 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/018/7
2023-09-02 20:54:52,589 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:52,589 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:52,589 - FGO - INFO - 	done: False
2023-09-02 20:54:52,589 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:52,589 - FGO - INFO - 	h1: 64
2023-09-02 20:54:52,589 - FGO - INFO - 	h2: 32
2023-09-02 20:54:52,589 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:52,589 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:52,589 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:52,589 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:52,589 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:52,589 - FGO - INFO - 	theta: 50
2023-09-02 20:54:52,589 - FGO - INFO - 	clip: 5
2023-09-02 20:54:52,589 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:52,589 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:52,589 - FGO - INFO - Source Total: 717
2023-09-02 20:54:52,589 - FGO - INFO - Target Total: 87
2023-09-02 20:54:52,589 - FGO - INFO - Train Total: 717
2023-09-02 20:54:52,589 - FGO - INFO - Val Total:   87
2023-09-02 20:54:52,589 - FGO - INFO - Test Total:  87
2023-09-02 20:54:52,589 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:52,589 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:52,589 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:52,589 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:52,589 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:52,590 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:52,590 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:52,590 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:52,590 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:52,590 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:52,591 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:52,592 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:52,698 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:52,698 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:52,698 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:52,698 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:52,698 - FGO - INFO - N: 804
2023-09-02 20:54:52,698 - FGO - INFO - N_s: 717
2023-09-02 20:54:52,698 - FGO - INFO - N_t: 87
2023-09-02 20:54:52,702 - CV - INFO - Begin Pretrain
2023-09-02 20:54:52,702 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:52,705 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:54:52,730 - FGO - INFO - Epoch  10 | Train Loss: 0.583 | Val Loss: 0.59 | Val F1: 0.72 |
2023-09-02 20:54:52,755 - FGO - INFO - Epoch  20 | Train Loss: 0.265 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:54:52,779 - FGO - INFO - Epoch  30 | Train Loss: 0.135 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:54:52,804 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:54:52,828 - FGO - INFO - Epoch  50 | Train Loss: 0.086 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:54:52,853 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:54:52,877 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:54:52,901 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:54:52,926 - FGO - INFO - Epoch  90 | Train Loss: 0.070 | Val Loss: 0.15 | Val F1: 0.95 |
2023-09-02 20:54:52,951 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:54:52,951 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.169 | Val Loss: 0.14 | Val F1: 0.98 
2023-09-02 20:54:52,951 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:52,952 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:54:52,952 - CV - INFO - Begin OT Train
2023-09-02 20:54:52,952 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:53,038 - FGO - INFO - Epoch   0 | Train Loss: -21.806 | Val Loss: -2.48 | Val F1: 0.95 |
2023-09-02 20:54:53,879 - FGO - INFO - Epoch  10 | Train Loss: -23.219 | Val Loss: -2.64 | Val F1: 0.89 |
2023-09-02 20:54:54,619 - FGO - INFO - Epoch  20 | Train Loss: -23.893 | Val Loss: -2.30 | Val F1: 0.56 |
2023-09-02 20:54:55,490 - FGO - INFO - Epoch  30 | Train Loss: -23.947 | Val Loss: -2.27 | Val F1: 0.35 |
2023-09-02 20:54:56,241 - FGO - INFO - Epoch  40 | Train Loss: -23.948 | Val Loss: -2.27 | Val F1: 0.35 |
2023-09-02 20:54:56,903 - FGO - INFO - Best Epoch:   9 | Train Loss: -23.146 | Val Loss: -2.64 | Val F1: 0.93 |
2023-09-02 20:54:56,903 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:56,906 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:54:56,906 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:54:56,940 - FGO - INFO - Train CM:
[[387   0]
 [330   0]]
2023-09-02 20:54:56,940 - FGO - INFO - Val CM:
[[47  0]
 [40  0]]
2023-09-02 20:54:56,941 - FGO - INFO - Test CM:
[[47  0]
 [40  0]]
2023-09-02 20:54:56,945 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:54:56,946 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:54:56,947 - FGO - INFO - test micro f1: 0.5402298850574713
2023-09-02 20:54:56,948 - FGO - INFO - test macro f1: 0.3507462686567164
2023-09-02 20:54:56,948 - CV - INFO - fold time: 4.360764980316162s (0.0726794163386027m)
2023-09-02 20:54:56,948 - CV - INFO - ----- BEGINNING FOLD SET (018:8)----------------------------------------------------------
2023-09-02 20:54:56,949 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/018/8
2023-09-02 20:54:56,949 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:54:56,950 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:54:56,950 - FGO - INFO - 	done: False
2023-09-02 20:54:56,950 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:54:56,950 - FGO - INFO - 	h1: 64
2023-09-02 20:54:56,950 - FGO - INFO - 	h2: 32
2023-09-02 20:54:56,950 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:54:56,950 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:54:56,950 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:54:56,950 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:54:56,950 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:54:56,950 - FGO - INFO - 	theta: 50
2023-09-02 20:54:56,950 - FGO - INFO - 	clip: 5
2023-09-02 20:54:56,950 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:54:56,950 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:54:56,950 - FGO - INFO - Source Total: 734
2023-09-02 20:54:56,950 - FGO - INFO - Target Total: 70
2023-09-02 20:54:56,950 - FGO - INFO - Train Total: 734
2023-09-02 20:54:56,950 - FGO - INFO - Val Total:   70
2023-09-02 20:54:56,950 - FGO - INFO - Test Total:  70
2023-09-02 20:54:56,950 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:54:56,950 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:54:56,950 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:54:56,950 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:54:56,950 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:54:56,950 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:54:56,950 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:54:56,950 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:54:56,950 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:54:56,951 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:54:56,951 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:54:56,953 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:54:57,041 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:54:57,041 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:54:57,041 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:54:57,041 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:54:57,041 - FGO - INFO - N: 804
2023-09-02 20:54:57,041 - FGO - INFO - N_s: 734
2023-09-02 20:54:57,041 - FGO - INFO - N_t: 70
2023-09-02 20:54:57,044 - CV - INFO - Begin Pretrain
2023-09-02 20:54:57,044 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:54:57,048 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:54:57,073 - FGO - INFO - Epoch  10 | Train Loss: 0.564 | Val Loss: 0.59 | Val F1: 0.75 |
2023-09-02 20:54:57,097 - FGO - INFO - Epoch  20 | Train Loss: 0.257 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:54:57,122 - FGO - INFO - Epoch  30 | Train Loss: 0.132 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:54:57,147 - FGO - INFO - Epoch  40 | Train Loss: 0.097 | Val Loss: 0.13 | Val F1: 0.94 |
2023-09-02 20:54:57,172 - FGO - INFO - Epoch  50 | Train Loss: 0.088 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:54:57,196 - FGO - INFO - Epoch  60 | Train Loss: 0.077 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:54:57,221 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.94 |
2023-09-02 20:54:57,246 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:54:57,270 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.16 | Val F1: 0.93 |
2023-09-02 20:54:57,295 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:54:57,295 - FGO - INFO - Best Epoch:  36 | Train Loss: 0.108 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:54:57,295 - FGO - INFO - Setting model to best state.
2023-09-02 20:54:57,297 - CV - INFO - Pretrain Complete, 36 epochs
2023-09-02 20:54:57,297 - CV - INFO - Begin OT Train
2023-09-02 20:54:57,297 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:54:57,366 - FGO - INFO - Epoch   0 | Train Loss: -21.760 | Val Loss: -1.89 | Val F1: 0.94 |
2023-09-02 20:54:58,173 - FGO - INFO - Epoch  10 | Train Loss: -23.230 | Val Loss: -1.82 | Val F1: 0.84 |
2023-09-02 20:54:58,952 - FGO - INFO - Epoch  20 | Train Loss: -23.902 | Val Loss: -1.72 | Val F1: 0.58 |
2023-09-02 20:54:59,769 - FGO - INFO - Epoch  30 | Train Loss: -24.096 | Val Loss: -1.63 | Val F1: 0.33 |
2023-09-02 20:55:00,539 - FGO - INFO - Epoch  40 | Train Loss: -24.100 | Val Loss: -1.63 | Val F1: 0.33 |
2023-09-02 20:55:01,231 - FGO - INFO - Best Epoch:   7 | Train Loss: -22.963 | Val Loss: -1.97 | Val F1: 0.96 |
2023-09-02 20:55:01,231 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:01,235 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:55:01,235 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:01,259 - FGO - INFO - Train CM:
[[400   0]
 [334   0]]
2023-09-02 20:55:01,260 - FGO - INFO - Val CM:
[[34  0]
 [36  0]]
2023-09-02 20:55:01,260 - FGO - INFO - Test CM:
[[34  0]
 [36  0]]
2023-09-02 20:55:01,265 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:55:01,266 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:55:01,267 - FGO - INFO - test micro f1: 0.4857142857142857
2023-09-02 20:55:01,268 - FGO - INFO - test macro f1: 0.3269230769230769
2023-09-02 20:55:01,268 - CV - INFO - fold time: 4.31995153427124s (0.071999192237854m)
2023-09-02 20:55:01,268 - CV - INFO - ----- BEGINNING FOLD SET (018:9)----------------------------------------------------------
2023-09-02 20:55:01,269 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/018/9
2023-09-02 20:55:01,270 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:01,270 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:01,270 - FGO - INFO - 	done: False
2023-09-02 20:55:01,270 - FGO - INFO - 	learning_rate: 0.005
2023-09-02 20:55:01,270 - FGO - INFO - 	h1: 64
2023-09-02 20:55:01,270 - FGO - INFO - 	h2: 32
2023-09-02 20:55:01,270 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:01,270 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:01,270 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:01,270 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:01,270 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:55:01,270 - FGO - INFO - 	theta: 50
2023-09-02 20:55:01,270 - FGO - INFO - 	clip: 5
2023-09-02 20:55:01,270 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:01,270 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:01,270 - FGO - INFO - Source Total: 725
2023-09-02 20:55:01,270 - FGO - INFO - Target Total: 79
2023-09-02 20:55:01,270 - FGO - INFO - Train Total: 725
2023-09-02 20:55:01,270 - FGO - INFO - Val Total:   79
2023-09-02 20:55:01,270 - FGO - INFO - Test Total:  79
2023-09-02 20:55:01,270 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:01,270 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:01,270 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:01,270 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:01,270 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:01,270 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:01,271 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:01,271 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:01,271 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:01,271 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:01,272 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:01,273 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:01,371 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:01,371 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:01,371 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:01,371 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:01,371 - FGO - INFO - N: 804
2023-09-02 20:55:01,371 - FGO - INFO - N_s: 725
2023-09-02 20:55:01,371 - FGO - INFO - N_t: 79
2023-09-02 20:55:01,374 - CV - INFO - Begin Pretrain
2023-09-02 20:55:01,375 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:01,378 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:55:01,402 - FGO - INFO - Epoch  10 | Train Loss: 0.579 | Val Loss: 0.59 | Val F1: 0.74 |
2023-09-02 20:55:01,427 - FGO - INFO - Epoch  20 | Train Loss: 0.262 | Val Loss: 0.30 | Val F1: 0.91 |
2023-09-02 20:55:01,451 - FGO - INFO - Epoch  30 | Train Loss: 0.128 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:55:01,476 - FGO - INFO - Epoch  40 | Train Loss: 0.098 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:55:01,500 - FGO - INFO - Epoch  50 | Train Loss: 0.085 | Val Loss: 0.20 | Val F1: 0.97 |
2023-09-02 20:55:01,525 - FGO - INFO - Epoch  60 | Train Loss: 0.076 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:55:01,549 - FGO - INFO - Epoch  70 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:55:01,573 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.17 | Val F1: 0.97 |
2023-09-02 20:55:01,598 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:55:01,622 - FGO - INFO - Epoch 100 | Train Loss: 0.065 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:55:01,622 - FGO - INFO - Best Epoch:  51 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.99 
2023-09-02 20:55:01,622 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:01,624 - CV - INFO - Pretrain Complete, 51 epochs
2023-09-02 20:55:01,624 - CV - INFO - Begin OT Train
2023-09-02 20:55:01,624 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:01,715 - FGO - INFO - Epoch   0 | Train Loss: -21.972 | Val Loss: -2.26 | Val F1: 0.97 |
2023-09-02 20:55:02,581 - FGO - INFO - Epoch  10 | Train Loss: -23.279 | Val Loss: -2.43 | Val F1: 0.94 |
2023-09-02 20:55:03,341 - FGO - INFO - Epoch  20 | Train Loss: -23.795 | Val Loss: -2.12 | Val F1: 0.69 |
2023-09-02 20:55:04,038 - FGO - INFO - Epoch  30 | Train Loss: -24.011 | Val Loss: -2.00 | Val F1: 0.42 |
2023-09-02 20:55:04,794 - FGO - INFO - Epoch  40 | Train Loss: -24.016 | Val Loss: -2.00 | Val F1: 0.38 |
2023-09-02 20:55:05,501 - FGO - INFO - Best Epoch:   6 | Train Loss: -22.989 | Val Loss: -2.41 | Val F1: 0.96 |
2023-09-02 20:55:05,501 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:05,504 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:55:05,504 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:05,528 - FGO - INFO - Train CM:
[[385   0]
 [340   0]]
2023-09-02 20:55:05,528 - FGO - INFO - Val CM:
[[49  0]
 [30  0]]
2023-09-02 20:55:05,528 - FGO - INFO - Test CM:
[[49  0]
 [30  0]]
2023-09-02 20:55:05,534 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:55:05,535 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:55:05,536 - FGO - INFO - test micro f1: 0.620253164556962
2023-09-02 20:55:05,536 - FGO - INFO - test macro f1: 0.3828125
2023-09-02 20:55:05,536 - CV - INFO - fold time: 4.268646955490112s (0.0711441159248352m)
2023-09-02 20:55:05,537 - CV - INFO - Mean Pretrain Epochs 45.5:
2023-09-02 20:55:05,537 - CV - INFO - Mean OT Train Epochs 7.8:
2023-09-02 20:55:05,537 - CV - INFO - Mean Val Macro F1 : 0.3491007683535168
2023-09-02 20:55:05,537 - CV - INFO - Mean Eval Stat : 0.3491007683535168 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:55:05,537 - CV - INFO - set time: 42.69733953475952s (0.7116223255793254m)
2023-09-02 20:55:05,537 - CV - INFO - script time so far: 803.4877519607544s (13.39146253267924m) (0.22319104221132066h)
2023-09-02 20:55:05,537 - CV - INFO - ===== BEGINNING OPTION SET (019)==========================================================
2023-09-02 20:55:05,537 - CV - INFO - 	done: False
2023-09-02 20:55:05,537 - CV - INFO - 	learning_rate: 0.01
2023-09-02 20:55:05,537 - CV - INFO - 	h1: 64
2023-09-02 20:55:05,537 - CV - INFO - 	h2: 32
2023-09-02 20:55:05,537 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:05,537 - CV - INFO - 	dropout: 0.0
2023-09-02 20:55:05,537 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:05,537 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:05,537 - CV - INFO - 	lambda: 0.01
2023-09-02 20:55:05,537 - CV - INFO - 	theta: 10
2023-09-02 20:55:05,537 - CV - INFO - 	clip: 5
2023-09-02 20:55:05,537 - CV - INFO - ----- BEGINNING FOLD SET (019:0)----------------------------------------------------------
2023-09-02 20:55:05,538 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/019/0
2023-09-02 20:55:05,539 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:05,539 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:05,539 - FGO - INFO - 	done: False
2023-09-02 20:55:05,539 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:05,539 - FGO - INFO - 	h1: 64
2023-09-02 20:55:05,539 - FGO - INFO - 	h2: 32
2023-09-02 20:55:05,539 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:05,539 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:05,539 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:05,539 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:05,539 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:05,539 - FGO - INFO - 	theta: 10
2023-09-02 20:55:05,539 - FGO - INFO - 	clip: 5
2023-09-02 20:55:05,539 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:05,539 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:05,539 - FGO - INFO - Source Total: 708
2023-09-02 20:55:05,539 - FGO - INFO - Target Total: 96
2023-09-02 20:55:05,539 - FGO - INFO - Train Total: 708
2023-09-02 20:55:05,539 - FGO - INFO - Val Total:   96
2023-09-02 20:55:05,539 - FGO - INFO - Test Total:  96
2023-09-02 20:55:05,539 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:05,539 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:05,539 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:05,539 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:05,539 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:05,540 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:05,540 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:05,540 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:05,540 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:05,540 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:05,541 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:05,542 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:05,657 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:05,657 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:05,657 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:05,657 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:05,657 - FGO - INFO - N: 804
2023-09-02 20:55:05,657 - FGO - INFO - N_s: 708
2023-09-02 20:55:05,657 - FGO - INFO - N_t: 96
2023-09-02 20:55:05,661 - CV - INFO - Begin Pretrain
2023-09-02 20:55:05,661 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:05,664 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:55:05,689 - FGO - INFO - Epoch  10 | Train Loss: 0.421 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:55:05,713 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:55:05,737 - FGO - INFO - Epoch  30 | Train Loss: 0.103 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:55:05,761 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:55:05,785 - FGO - INFO - Epoch  50 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:55:05,810 - FGO - INFO - Epoch  60 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:55:05,834 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:55:05,858 - FGO - INFO - Epoch  80 | Train Loss: 0.058 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:55:05,882 - FGO - INFO - Epoch  90 | Train Loss: 0.058 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:55:05,906 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:55:05,906 - FGO - INFO - Best Epoch:  28 | Train Loss: 0.112 | Val Loss: 0.09 | Val F1: 0.99 
2023-09-02 20:55:05,906 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:05,908 - CV - INFO - Pretrain Complete, 28 epochs
2023-09-02 20:55:05,908 - CV - INFO - Begin OT Train
2023-09-02 20:55:05,908 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:05,997 - FGO - INFO - Epoch   0 | Train Loss: -0.514 | Val Loss: 0.07 | Val F1: 0.94 |
2023-09-02 20:55:06,984 - FGO - INFO - Epoch  10 | Train Loss: -0.656 | Val Loss: 0.01 | Val F1: 0.94 |
2023-09-02 20:55:07,900 - FGO - INFO - Epoch  20 | Train Loss: -0.701 | Val Loss: -0.03 | Val F1: 0.98 |
2023-09-02 20:55:08,699 - FGO - INFO - Epoch  30 | Train Loss: -0.735 | Val Loss: -0.04 | Val F1: 0.98 |
2023-09-02 20:55:09,569 - FGO - INFO - Epoch  40 | Train Loss: -0.774 | Val Loss: -0.03 | Val F1: 0.98 |
2023-09-02 20:55:10,321 - FGO - INFO - Best Epoch:  18 | Train Loss: -0.685 | Val Loss: -0.02 | Val F1: 0.98 |
2023-09-02 20:55:10,321 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:10,324 - CV - INFO - OT Train Complete, 18 epochs
2023-09-02 20:55:10,325 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:10,351 - FGO - INFO - Train CM:
[[373   9]
 [ 10 316]]
2023-09-02 20:55:10,352 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:55:10,352 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:55:10,357 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:55:10,358 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:55:10,359 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:55:10,360 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:55:10,360 - CV - INFO - fold time: 4.8227763175964355s (0.08037960529327393m)
2023-09-02 20:55:10,360 - CV - INFO - ----- BEGINNING FOLD SET (019:1)----------------------------------------------------------
2023-09-02 20:55:10,361 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/019/1
2023-09-02 20:55:10,361 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:10,361 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:10,361 - FGO - INFO - 	done: False
2023-09-02 20:55:10,361 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:10,361 - FGO - INFO - 	h1: 64
2023-09-02 20:55:10,361 - FGO - INFO - 	h2: 32
2023-09-02 20:55:10,361 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:10,362 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:10,362 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:10,362 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:10,362 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:10,362 - FGO - INFO - 	theta: 10
2023-09-02 20:55:10,362 - FGO - INFO - 	clip: 5
2023-09-02 20:55:10,362 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:10,362 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:10,362 - FGO - INFO - Source Total: 727
2023-09-02 20:55:10,362 - FGO - INFO - Target Total: 77
2023-09-02 20:55:10,362 - FGO - INFO - Train Total: 727
2023-09-02 20:55:10,362 - FGO - INFO - Val Total:   77
2023-09-02 20:55:10,362 - FGO - INFO - Test Total:  77
2023-09-02 20:55:10,362 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:10,362 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:10,362 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:10,362 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:10,362 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:10,362 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:10,362 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:10,362 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:10,362 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:10,362 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:10,363 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:10,365 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:10,461 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:10,462 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:10,462 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:10,462 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:10,462 - FGO - INFO - N: 804
2023-09-02 20:55:10,462 - FGO - INFO - N_s: 727
2023-09-02 20:55:10,462 - FGO - INFO - N_t: 77
2023-09-02 20:55:10,465 - CV - INFO - Begin Pretrain
2023-09-02 20:55:10,465 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:10,468 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:55:10,493 - FGO - INFO - Epoch  10 | Train Loss: 0.472 | Val Loss: 0.55 | Val F1: 0.71 |
2023-09-02 20:55:10,518 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.27 | Val F1: 0.84 |
2023-09-02 20:55:10,543 - FGO - INFO - Epoch  30 | Train Loss: 0.091 | Val Loss: 0.17 | Val F1: 0.93 |
2023-09-02 20:55:10,568 - FGO - INFO - Epoch  40 | Train Loss: 0.080 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:55:10,592 - FGO - INFO - Epoch  50 | Train Loss: 0.067 | Val Loss: 0.20 | Val F1: 0.87 |
2023-09-02 20:55:10,617 - FGO - INFO - Epoch  60 | Train Loss: 0.061 | Val Loss: 0.22 | Val F1: 0.89 |
2023-09-02 20:55:10,641 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:55:10,666 - FGO - INFO - Epoch  80 | Train Loss: 0.054 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 20:55:10,691 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.21 | Val F1: 0.92 |
2023-09-02 20:55:10,715 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:55:10,715 - FGO - INFO - Best Epoch:  34 | Train Loss: 0.088 | Val Loss: 0.17 | Val F1: 0.95 
2023-09-02 20:55:10,715 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:10,717 - CV - INFO - Pretrain Complete, 34 epochs
2023-09-02 20:55:10,717 - CV - INFO - Begin OT Train
2023-09-02 20:55:10,717 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:10,800 - FGO - INFO - Epoch   0 | Train Loss: -0.483 | Val Loss: 0.13 | Val F1: 0.90 |
2023-09-02 20:55:11,769 - FGO - INFO - Epoch  10 | Train Loss: -0.592 | Val Loss: 0.27 | Val F1: 0.88 |
2023-09-02 20:55:12,677 - FGO - INFO - Epoch  20 | Train Loss: -0.674 | Val Loss: 0.12 | Val F1: 0.93 |
2023-09-02 20:55:13,537 - FGO - INFO - Epoch  30 | Train Loss: -0.725 | Val Loss: 0.12 | Val F1: 0.92 |
2023-09-02 20:55:14,319 - FGO - INFO - Epoch  40 | Train Loss: -0.766 | Val Loss: 0.12 | Val F1: 0.92 |
2023-09-02 20:55:15,039 - FGO - INFO - Best Epoch:  18 | Train Loss: -0.665 | Val Loss: 0.12 | Val F1: 0.93 |
2023-09-02 20:55:15,039 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:15,043 - CV - INFO - OT Train Complete, 18 epochs
2023-09-02 20:55:15,043 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:15,070 - FGO - INFO - Train CM:
[[387   3]
 [ 12 325]]
2023-09-02 20:55:15,070 - FGO - INFO - Val CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:55:15,070 - FGO - INFO - Test CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:55:15,075 - FGO - INFO - test statistical parity: 0.36282051282051286
2023-09-02 20:55:15,076 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:55:15,077 - FGO - INFO - test micro f1: 0.935064935064935
2023-09-02 20:55:15,078 - FGO - INFO - test macro f1: 0.9328449328449329
2023-09-02 20:55:15,078 - CV - INFO - fold time: 4.718142032623291s (0.07863570054372152m)
2023-09-02 20:55:15,078 - CV - INFO - ----- BEGINNING FOLD SET (019:2)----------------------------------------------------------
2023-09-02 20:55:15,079 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/019/2
2023-09-02 20:55:15,080 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:15,080 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:15,080 - FGO - INFO - 	done: False
2023-09-02 20:55:15,080 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:15,080 - FGO - INFO - 	h1: 64
2023-09-02 20:55:15,080 - FGO - INFO - 	h2: 32
2023-09-02 20:55:15,080 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:15,080 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:15,080 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:15,080 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:15,080 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:15,080 - FGO - INFO - 	theta: 10
2023-09-02 20:55:15,080 - FGO - INFO - 	clip: 5
2023-09-02 20:55:15,080 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:15,080 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:15,080 - FGO - INFO - Source Total: 721
2023-09-02 20:55:15,080 - FGO - INFO - Target Total: 83
2023-09-02 20:55:15,080 - FGO - INFO - Train Total: 721
2023-09-02 20:55:15,080 - FGO - INFO - Val Total:   83
2023-09-02 20:55:15,080 - FGO - INFO - Test Total:  83
2023-09-02 20:55:15,080 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:15,080 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:15,080 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:15,080 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:15,080 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:15,081 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:15,081 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:15,081 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:15,081 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:15,081 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:15,082 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:15,083 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:15,185 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:15,185 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:15,185 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:15,185 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:15,185 - FGO - INFO - N: 804
2023-09-02 20:55:15,185 - FGO - INFO - N_s: 721
2023-09-02 20:55:15,185 - FGO - INFO - N_t: 83
2023-09-02 20:55:15,189 - CV - INFO - Begin Pretrain
2023-09-02 20:55:15,189 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:15,192 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:55:15,216 - FGO - INFO - Epoch  10 | Train Loss: 0.478 | Val Loss: 0.49 | Val F1: 0.84 |
2023-09-02 20:55:15,241 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.24 | Val F1: 0.87 |
2023-09-02 20:55:15,266 - FGO - INFO - Epoch  30 | Train Loss: 0.087 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:55:15,290 - FGO - INFO - Epoch  40 | Train Loss: 0.073 | Val Loss: 0.25 | Val F1: 0.90 |
2023-09-02 20:55:15,314 - FGO - INFO - Epoch  50 | Train Loss: 0.063 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:55:15,339 - FGO - INFO - Epoch  60 | Train Loss: 0.058 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:55:15,363 - FGO - INFO - Epoch  70 | Train Loss: 0.056 | Val Loss: 0.28 | Val F1: 0.91 |
2023-09-02 20:55:15,387 - FGO - INFO - Epoch  80 | Train Loss: 0.052 | Val Loss: 0.28 | Val F1: 0.88 |
2023-09-02 20:55:15,412 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.28 | Val F1: 0.89 |
2023-09-02 20:55:15,436 - FGO - INFO - Epoch 100 | Train Loss: 0.046 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:55:15,436 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.058 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:55:15,436 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:15,438 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:55:15,438 - CV - INFO - Begin OT Train
2023-09-02 20:55:15,438 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:15,570 - FGO - INFO - Epoch   0 | Train Loss: -0.343 | Val Loss: 0.23 | Val F1: 0.90 |
2023-09-02 20:55:16,657 - FGO - INFO - Epoch  10 | Train Loss: -0.646 | Val Loss: 0.42 | Val F1: 0.88 |
2023-09-02 20:55:17,774 - FGO - INFO - Epoch  20 | Train Loss: -0.707 | Val Loss: 0.30 | Val F1: 0.89 |
2023-09-02 20:55:18,760 - FGO - INFO - Epoch  30 | Train Loss: -0.755 | Val Loss: 0.23 | Val F1: 0.91 |
2023-09-02 20:55:19,609 - FGO - INFO - Epoch  40 | Train Loss: -0.796 | Val Loss: 0.22 | Val F1: 0.91 |
2023-09-02 20:55:20,399 - FGO - INFO - Best Epoch:  16 | Train Loss: -0.673 | Val Loss: 0.23 | Val F1: 0.93 |
2023-09-02 20:55:20,399 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:20,403 - CV - INFO - OT Train Complete, 16 epochs
2023-09-02 20:55:20,404 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:20,429 - FGO - INFO - Train CM:
[[377   7]
 [  8 329]]
2023-09-02 20:55:20,429 - FGO - INFO - Val CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:55:20,430 - FGO - INFO - Test CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:55:20,434 - FGO - INFO - test statistical parity: 0.10563380281690143
2023-09-02 20:55:20,435 - FGO - INFO - test equal opportunity: 0.09259259259259256
2023-09-02 20:55:20,436 - FGO - INFO - test micro f1: 0.9156626506024096
2023-09-02 20:55:20,437 - FGO - INFO - test macro f1: 0.9124076586763153
2023-09-02 20:55:20,437 - CV - INFO - fold time: 5.358954668045044s (0.08931591113408406m)
2023-09-02 20:55:20,437 - CV - INFO - ----- BEGINNING FOLD SET (019:3)----------------------------------------------------------
2023-09-02 20:55:20,438 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/019/3
2023-09-02 20:55:20,439 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:20,439 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:20,439 - FGO - INFO - 	done: False
2023-09-02 20:55:20,439 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:20,439 - FGO - INFO - 	h1: 64
2023-09-02 20:55:20,439 - FGO - INFO - 	h2: 32
2023-09-02 20:55:20,439 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:20,439 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:20,439 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:20,439 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:20,439 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:20,439 - FGO - INFO - 	theta: 10
2023-09-02 20:55:20,439 - FGO - INFO - 	clip: 5
2023-09-02 20:55:20,439 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:20,439 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:20,439 - FGO - INFO - Source Total: 729
2023-09-02 20:55:20,439 - FGO - INFO - Target Total: 75
2023-09-02 20:55:20,439 - FGO - INFO - Train Total: 729
2023-09-02 20:55:20,439 - FGO - INFO - Val Total:   75
2023-09-02 20:55:20,439 - FGO - INFO - Test Total:  75
2023-09-02 20:55:20,439 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:20,439 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:20,439 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:20,439 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:20,439 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:20,440 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:20,440 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:20,440 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:20,440 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:20,440 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:20,441 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:20,442 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:20,535 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:20,535 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:20,535 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:20,535 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:20,535 - FGO - INFO - N: 804
2023-09-02 20:55:20,535 - FGO - INFO - N_s: 729
2023-09-02 20:55:20,535 - FGO - INFO - N_t: 75
2023-09-02 20:55:20,539 - CV - INFO - Begin Pretrain
2023-09-02 20:55:20,539 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:20,542 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:55:20,567 - FGO - INFO - Epoch  10 | Train Loss: 0.431 | Val Loss: 0.36 | Val F1: 0.93 |
2023-09-02 20:55:20,592 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:55:20,616 - FGO - INFO - Epoch  30 | Train Loss: 0.109 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:55:20,641 - FGO - INFO - Epoch  40 | Train Loss: 0.093 | Val Loss: 0.03 | Val F1: 0.99 |
2023-09-02 20:55:20,665 - FGO - INFO - Epoch  50 | Train Loss: 0.080 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:55:20,690 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:55:20,714 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:55:20,738 - FGO - INFO - Epoch  80 | Train Loss: 0.065 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:55:20,763 - FGO - INFO - Epoch  90 | Train Loss: 0.064 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:55:20,787 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:55:20,787 - FGO - INFO - Best Epoch:  27 | Train Loss: 0.114 | Val Loss: 0.03 | Val F1: 1.00 
2023-09-02 20:55:20,787 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:20,788 - CV - INFO - Pretrain Complete, 27 epochs
2023-09-02 20:55:20,789 - CV - INFO - Begin OT Train
2023-09-02 20:55:20,789 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:20,872 - FGO - INFO - Epoch   0 | Train Loss: -0.405 | Val Loss: -0.03 | Val F1: 0.97 |
2023-09-02 20:55:21,748 - FGO - INFO - Epoch  10 | Train Loss: -0.587 | Val Loss: 0.11 | Val F1: 0.92 |
2023-09-02 20:55:22,692 - FGO - INFO - Epoch  20 | Train Loss: -0.711 | Val Loss: 0.00 | Val F1: 0.97 |
2023-09-02 20:55:23,541 - FGO - INFO - Epoch  30 | Train Loss: -0.757 | Val Loss: -0.03 | Val F1: 0.97 |
2023-09-02 20:55:24,391 - FGO - INFO - Epoch  40 | Train Loss: -0.779 | Val Loss: -0.03 | Val F1: 0.97 |
2023-09-02 20:55:25,186 - FGO - INFO - Best Epoch:  13 | Train Loss: -0.628 | Val Loss: -0.02 | Val F1: 0.99 |
2023-09-02 20:55:25,186 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:25,190 - CV - INFO - OT Train Complete, 13 epochs
2023-09-02 20:55:25,190 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:25,240 - FGO - INFO - Train CM:
[[388   8]
 [ 13 320]]
2023-09-02 20:55:25,240 - FGO - INFO - Val CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:55:25,240 - FGO - INFO - Test CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:55:25,245 - FGO - INFO - test statistical parity: 0.046838407494145196
2023-09-02 20:55:25,246 - FGO - INFO - test equal opportunity: 0.10952380952380958
2023-09-02 20:55:25,247 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 20:55:25,248 - FGO - INFO - test macro f1: 0.9732905982905983
2023-09-02 20:55:25,248 - CV - INFO - fold time: 4.810904026031494s (0.08018173376719157m)
2023-09-02 20:55:25,248 - CV - INFO - ----- BEGINNING FOLD SET (019:4)----------------------------------------------------------
2023-09-02 20:55:25,249 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/019/4
2023-09-02 20:55:25,250 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:25,250 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:25,250 - FGO - INFO - 	done: False
2023-09-02 20:55:25,250 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:25,250 - FGO - INFO - 	h1: 64
2023-09-02 20:55:25,250 - FGO - INFO - 	h2: 32
2023-09-02 20:55:25,250 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:25,250 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:25,250 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:25,250 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:25,250 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:25,250 - FGO - INFO - 	theta: 10
2023-09-02 20:55:25,250 - FGO - INFO - 	clip: 5
2023-09-02 20:55:25,250 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:25,250 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:25,250 - FGO - INFO - Source Total: 732
2023-09-02 20:55:25,250 - FGO - INFO - Target Total: 72
2023-09-02 20:55:25,250 - FGO - INFO - Train Total: 732
2023-09-02 20:55:25,250 - FGO - INFO - Val Total:   72
2023-09-02 20:55:25,250 - FGO - INFO - Test Total:  72
2023-09-02 20:55:25,250 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:25,250 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:25,250 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:25,250 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:25,250 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:25,250 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:25,251 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:25,251 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:25,251 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:25,251 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:25,252 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:25,253 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:25,343 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:25,343 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:25,343 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:25,343 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:25,343 - FGO - INFO - N: 804
2023-09-02 20:55:25,343 - FGO - INFO - N_s: 732
2023-09-02 20:55:25,343 - FGO - INFO - N_t: 72
2023-09-02 20:55:25,347 - CV - INFO - Begin Pretrain
2023-09-02 20:55:25,347 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:25,350 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:55:25,375 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.46 | Val F1: 0.81 |
2023-09-02 20:55:25,400 - FGO - INFO - Epoch  20 | Train Loss: 0.141 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:55:25,425 - FGO - INFO - Epoch  30 | Train Loss: 0.100 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:55:25,449 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:55:25,474 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:55:25,498 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 20:55:25,523 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:55:25,547 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:55:25,572 - FGO - INFO - Epoch  90 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:55:25,597 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:55:25,597 - FGO - INFO - Best Epoch:  64 | Train Loss: 0.069 | Val Loss: 0.06 | Val F1: 0.99 
2023-09-02 20:55:25,597 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:25,598 - CV - INFO - Pretrain Complete, 64 epochs
2023-09-02 20:55:25,598 - CV - INFO - Begin OT Train
2023-09-02 20:55:25,598 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:25,722 - FGO - INFO - Epoch   0 | Train Loss: -0.622 | Val Loss: -0.01 | Val F1: 0.99 |
2023-09-02 20:55:26,613 - FGO - INFO - Epoch  10 | Train Loss: -0.736 | Val Loss: -0.00 | Val F1: 0.99 |
2023-09-02 20:55:27,457 - FGO - INFO - Epoch  20 | Train Loss: -0.783 | Val Loss: -0.02 | Val F1: 0.99 |
2023-09-02 20:55:28,294 - FGO - INFO - Epoch  30 | Train Loss: -0.804 | Val Loss: -0.02 | Val F1: 0.99 |
2023-09-02 20:55:29,164 - FGO - INFO - Epoch  40 | Train Loss: -0.819 | Val Loss: -0.03 | Val F1: 0.99 |
2023-09-02 20:55:29,876 - FGO - INFO - Best Epoch:   7 | Train Loss: -0.729 | Val Loss: -0.02 | Val F1: 0.99 |
2023-09-02 20:55:29,876 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:29,880 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:55:29,880 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:29,906 - FGO - INFO - Train CM:
[[388   9]
 [ 10 325]]
2023-09-02 20:55:29,906 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:55:29,907 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:55:29,912 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:55:29,913 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:55:29,914 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:55:29,914 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:55:29,914 - CV - INFO - fold time: 4.666528224945068s (0.07777547041575114m)
2023-09-02 20:55:29,914 - CV - INFO - ----- BEGINNING FOLD SET (019:5)----------------------------------------------------------
2023-09-02 20:55:29,916 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/019/5
2023-09-02 20:55:29,916 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:29,916 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:29,916 - FGO - INFO - 	done: False
2023-09-02 20:55:29,916 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:29,916 - FGO - INFO - 	h1: 64
2023-09-02 20:55:29,916 - FGO - INFO - 	h2: 32
2023-09-02 20:55:29,916 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:29,916 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:29,916 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:29,916 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:29,916 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:29,916 - FGO - INFO - 	theta: 10
2023-09-02 20:55:29,916 - FGO - INFO - 	clip: 5
2023-09-02 20:55:29,916 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:29,916 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:29,916 - FGO - INFO - Source Total: 726
2023-09-02 20:55:29,916 - FGO - INFO - Target Total: 78
2023-09-02 20:55:29,916 - FGO - INFO - Train Total: 726
2023-09-02 20:55:29,916 - FGO - INFO - Val Total:   78
2023-09-02 20:55:29,916 - FGO - INFO - Test Total:  78
2023-09-02 20:55:29,916 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:29,916 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:29,916 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:29,916 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:29,916 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:29,917 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:29,917 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:29,917 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:29,917 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:29,917 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:29,918 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:29,919 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:30,017 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:30,017 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:30,017 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:30,017 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:30,017 - FGO - INFO - N: 804
2023-09-02 20:55:30,017 - FGO - INFO - N_s: 726
2023-09-02 20:55:30,017 - FGO - INFO - N_t: 78
2023-09-02 20:55:30,020 - CV - INFO - Begin Pretrain
2023-09-02 20:55:30,020 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:30,023 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:55:30,048 - FGO - INFO - Epoch  10 | Train Loss: 0.515 | Val Loss: 0.52 | Val F1: 0.82 |
2023-09-02 20:55:30,073 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:55:30,097 - FGO - INFO - Epoch  30 | Train Loss: 0.106 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:55:30,122 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.13 | Val F1: 0.95 |
2023-09-02 20:55:30,146 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:55:30,170 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.09 | Val F1: 0.95 |
2023-09-02 20:55:30,195 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:55:30,219 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 20:55:30,243 - FGO - INFO - Epoch  90 | Train Loss: 0.064 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:55:30,268 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:55:30,268 - FGO - INFO - Best Epoch:  55 | Train Loss: 0.077 | Val Loss: 0.09 | Val F1: 0.97 
2023-09-02 20:55:30,268 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:30,269 - CV - INFO - Pretrain Complete, 55 epochs
2023-09-02 20:55:30,269 - CV - INFO - Begin OT Train
2023-09-02 20:55:30,269 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:30,379 - FGO - WARNING - long running sinkhorn (1000), u_diff: 1.213397382571202e-07
2023-09-02 20:55:30,502 - FGO - WARNING - long running sinkhorn (2000), u_diff: 1.200242962795528e-07
2023-09-02 20:55:30,592 - FGO - WARNING - long running sinkhorn (3000), u_diff: 1.183958246997463e-07
2023-09-02 20:55:30,682 - FGO - WARNING - long running sinkhorn (4000), u_diff: 1.2275827998564637e-07
2023-09-02 20:55:30,773 - FGO - WARNING - long running sinkhorn (5000), u_diff: 1.2483523903483729e-07
2023-09-02 20:55:30,863 - FGO - WARNING - long running sinkhorn (6000), u_diff: 1.160879463668607e-07
2023-09-02 20:55:30,953 - FGO - WARNING - long running sinkhorn (7000), u_diff: 1.268193727810285e-07
2023-09-02 20:55:31,044 - FGO - WARNING - long running sinkhorn (8000), u_diff: 1.1934939436741843e-07
2023-09-02 20:55:31,134 - FGO - WARNING - long running sinkhorn (9000), u_diff: 1.2759794287831028e-07
2023-09-02 20:55:31,225 - FGO - WARNING - long running sinkhorn (10000), u_diff: 1.220867460460795e-07
2023-09-02 20:55:31,225 - FGO - WARNING - large sinkhorn itter (10000)
2023-09-02 20:55:31,733 - FGO - INFO - Epoch   0 | Train Loss: -0.302 | Val Loss: 0.02 | Val F1: 0.95 |
2023-09-02 20:55:32,752 - FGO - INFO - Epoch  10 | Train Loss: -0.604 | Val Loss: 0.36 | Val F1: 0.88 |
2023-09-02 20:55:33,656 - FGO - INFO - Epoch  20 | Train Loss: -0.677 | Val Loss: 0.23 | Val F1: 0.91 |
2023-09-02 20:55:34,539 - FGO - INFO - Epoch  30 | Train Loss: -0.731 | Val Loss: 0.23 | Val F1: 0.91 |
2023-09-02 20:55:35,408 - FGO - INFO - Epoch  40 | Train Loss: -0.764 | Val Loss: 0.21 | Val F1: 0.91 |
2023-09-02 20:55:36,134 - FGO - INFO - Best Epoch:   6 | Train Loss: -0.559 | Val Loss: 0.06 | Val F1: 0.92 |
2023-09-02 20:55:36,134 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:36,138 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:55:36,138 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:36,165 - FGO - INFO - Train CM:
[[393   7]
 [ 12 314]]
2023-09-02 20:55:36,166 - FGO - INFO - Val CM:
[[34  0]
 [ 7 37]]
2023-09-02 20:55:36,166 - FGO - INFO - Test CM:
[[34  0]
 [ 7 37]]
2023-09-02 20:55:36,171 - FGO - INFO - test statistical parity: 0.09178743961352659
2023-09-02 20:55:36,172 - FGO - INFO - test equal opportunity: 0.17948717948717952
2023-09-02 20:55:36,173 - FGO - INFO - test micro f1: 0.9102564102564102
2023-09-02 20:55:36,174 - FGO - INFO - test macro f1: 0.9101234567901235
2023-09-02 20:55:36,174 - CV - INFO - fold time: 6.259302616119385s (0.10432171026865641m)
2023-09-02 20:55:36,174 - CV - INFO - ----- BEGINNING FOLD SET (019:6)----------------------------------------------------------
2023-09-02 20:55:36,175 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/019/6
2023-09-02 20:55:36,175 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:36,175 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:36,176 - FGO - INFO - 	done: False
2023-09-02 20:55:36,176 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:36,176 - FGO - INFO - 	h1: 64
2023-09-02 20:55:36,176 - FGO - INFO - 	h2: 32
2023-09-02 20:55:36,176 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:36,176 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:36,176 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:36,176 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:36,176 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:36,176 - FGO - INFO - 	theta: 10
2023-09-02 20:55:36,176 - FGO - INFO - 	clip: 5
2023-09-02 20:55:36,176 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:36,176 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:36,176 - FGO - INFO - Source Total: 717
2023-09-02 20:55:36,176 - FGO - INFO - Target Total: 87
2023-09-02 20:55:36,176 - FGO - INFO - Train Total: 717
2023-09-02 20:55:36,176 - FGO - INFO - Val Total:   87
2023-09-02 20:55:36,176 - FGO - INFO - Test Total:  87
2023-09-02 20:55:36,176 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:36,176 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:36,176 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:36,176 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:36,176 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:36,176 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:36,176 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:36,176 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:36,176 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:36,176 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:36,177 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:36,179 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:36,285 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:36,285 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:36,285 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:36,285 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:36,285 - FGO - INFO - N: 804
2023-09-02 20:55:36,285 - FGO - INFO - N_s: 717
2023-09-02 20:55:36,285 - FGO - INFO - N_t: 87
2023-09-02 20:55:36,289 - CV - INFO - Begin Pretrain
2023-09-02 20:55:36,289 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:36,293 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:55:36,321 - FGO - INFO - Epoch  10 | Train Loss: 0.496 | Val Loss: 0.48 | Val F1: 0.80 |
2023-09-02 20:55:36,349 - FGO - INFO - Epoch  20 | Train Loss: 0.161 | Val Loss: 0.13 | Val F1: 0.93 |
2023-09-02 20:55:36,377 - FGO - INFO - Epoch  30 | Train Loss: 0.108 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:55:36,413 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.09 | Val F1: 0.98 |
2023-09-02 20:55:36,438 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:55:36,462 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:55:36,487 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:55:36,511 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:55:36,535 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:55:36,559 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:55:36,560 - FGO - INFO - Best Epoch:  73 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 1.00 
2023-09-02 20:55:36,560 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:36,561 - CV - INFO - Pretrain Complete, 73 epochs
2023-09-02 20:55:36,561 - CV - INFO - Begin OT Train
2023-09-02 20:55:36,561 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:36,685 - FGO - INFO - Epoch   0 | Train Loss: -0.614 | Val Loss: -0.05 | Val F1: 1.00 |
2023-09-02 20:55:37,820 - FGO - INFO - Epoch  10 | Train Loss: -0.479 | Val Loss: 0.28 | Val F1: 0.90 |
2023-09-02 20:55:38,816 - FGO - INFO - Epoch  20 | Train Loss: -0.652 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:55:39,694 - FGO - INFO - Epoch  30 | Train Loss: -0.715 | Val Loss: -0.03 | Val F1: 0.98 |
2023-09-02 20:55:40,609 - FGO - INFO - Epoch  40 | Train Loss: -0.755 | Val Loss: -0.05 | Val F1: 0.99 |
2023-09-02 20:55:41,334 - FGO - INFO - Best Epoch:  28 | Train Loss: -0.707 | Val Loss: -0.05 | Val F1: 0.99 |
2023-09-02 20:55:41,334 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:41,338 - CV - INFO - OT Train Complete, 28 epochs
2023-09-02 20:55:41,338 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:41,377 - FGO - INFO - Train CM:
[[375  10]
 [ 11 321]]
2023-09-02 20:55:41,377 - FGO - INFO - Val CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:55:41,377 - FGO - INFO - Test CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:55:41,382 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 20:55:41,383 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:55:41,384 - FGO - INFO - test micro f1: 0.9885057471264368
2023-09-02 20:55:41,385 - FGO - INFO - test macro f1: 0.9883518543312357
2023-09-02 20:55:41,385 - CV - INFO - fold time: 5.211030960083008s (0.08685051600138347m)
2023-09-02 20:55:41,385 - CV - INFO - ----- BEGINNING FOLD SET (019:7)----------------------------------------------------------
2023-09-02 20:55:41,386 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/019/7
2023-09-02 20:55:41,386 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:41,386 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:41,387 - FGO - INFO - 	done: False
2023-09-02 20:55:41,387 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:41,387 - FGO - INFO - 	h1: 64
2023-09-02 20:55:41,387 - FGO - INFO - 	h2: 32
2023-09-02 20:55:41,387 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:41,387 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:41,387 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:41,387 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:41,387 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:41,387 - FGO - INFO - 	theta: 10
2023-09-02 20:55:41,387 - FGO - INFO - 	clip: 5
2023-09-02 20:55:41,387 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:41,387 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:41,387 - FGO - INFO - Source Total: 717
2023-09-02 20:55:41,387 - FGO - INFO - Target Total: 87
2023-09-02 20:55:41,387 - FGO - INFO - Train Total: 717
2023-09-02 20:55:41,387 - FGO - INFO - Val Total:   87
2023-09-02 20:55:41,387 - FGO - INFO - Test Total:  87
2023-09-02 20:55:41,387 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:41,387 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:41,387 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:41,387 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:41,387 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:41,387 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:41,387 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:41,387 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:41,387 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:41,387 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:41,388 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:41,390 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:41,495 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:41,495 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:41,495 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:41,495 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:41,495 - FGO - INFO - N: 804
2023-09-02 20:55:41,495 - FGO - INFO - N_s: 717
2023-09-02 20:55:41,495 - FGO - INFO - N_t: 87
2023-09-02 20:55:41,499 - CV - INFO - Begin Pretrain
2023-09-02 20:55:41,499 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:41,502 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:55:41,527 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.49 | Val F1: 0.86 |
2023-09-02 20:55:41,552 - FGO - INFO - Epoch  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 |
2023-09-02 20:55:41,576 - FGO - INFO - Epoch  30 | Train Loss: 0.097 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:55:41,601 - FGO - INFO - Epoch  40 | Train Loss: 0.081 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:55:41,625 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:55:41,650 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:55:41,674 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:55:41,699 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:55:41,723 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:55:41,748 - FGO - INFO - Epoch 100 | Train Loss: 0.074 | Val Loss: 0.20 | Val F1: 0.95 |
2023-09-02 20:55:41,748 - FGO - INFO - Best Epoch:  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 
2023-09-02 20:55:41,748 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:41,749 - CV - INFO - Pretrain Complete, 20 epochs
2023-09-02 20:55:41,749 - CV - INFO - Begin OT Train
2023-09-02 20:55:41,749 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:41,872 - FGO - INFO - Epoch   0 | Train Loss: -0.595 | Val Loss: 0.08 | Val F1: 0.95 |
2023-09-02 20:55:42,827 - FGO - INFO - Epoch  10 | Train Loss: -0.621 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:55:43,806 - FGO - INFO - Epoch  20 | Train Loss: -0.684 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:55:44,776 - FGO - INFO - Epoch  30 | Train Loss: -0.729 | Val Loss: 0.08 | Val F1: 0.95 |
2023-09-02 20:55:45,622 - FGO - INFO - Epoch  40 | Train Loss: -0.766 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:55:46,463 - FGO - INFO - Best Epoch:  17 | Train Loss: -0.696 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:55:46,463 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:46,466 - CV - INFO - OT Train Complete, 17 epochs
2023-09-02 20:55:46,467 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:46,494 - FGO - INFO - Train CM:
[[378   9]
 [ 12 318]]
2023-09-02 20:55:46,495 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:55:46,495 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:55:46,499 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:55:46,501 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:55:46,502 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:55:46,502 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:55:46,502 - CV - INFO - fold time: 5.117414951324463s (0.08529024918874105m)
2023-09-02 20:55:46,502 - CV - INFO - ----- BEGINNING FOLD SET (019:8)----------------------------------------------------------
2023-09-02 20:55:46,504 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/019/8
2023-09-02 20:55:46,504 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:46,504 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:46,504 - FGO - INFO - 	done: False
2023-09-02 20:55:46,504 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:46,504 - FGO - INFO - 	h1: 64
2023-09-02 20:55:46,504 - FGO - INFO - 	h2: 32
2023-09-02 20:55:46,504 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:46,504 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:46,504 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:46,504 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:46,504 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:46,504 - FGO - INFO - 	theta: 10
2023-09-02 20:55:46,504 - FGO - INFO - 	clip: 5
2023-09-02 20:55:46,504 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:46,504 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:46,504 - FGO - INFO - Source Total: 734
2023-09-02 20:55:46,504 - FGO - INFO - Target Total: 70
2023-09-02 20:55:46,504 - FGO - INFO - Train Total: 734
2023-09-02 20:55:46,504 - FGO - INFO - Val Total:   70
2023-09-02 20:55:46,504 - FGO - INFO - Test Total:  70
2023-09-02 20:55:46,504 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:46,504 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:46,504 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:46,504 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:46,504 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:46,505 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:46,505 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:46,505 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:46,505 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:46,505 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:46,506 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:46,507 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:46,595 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:46,595 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:46,595 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:46,595 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:46,595 - FGO - INFO - N: 804
2023-09-02 20:55:46,595 - FGO - INFO - N_s: 734
2023-09-02 20:55:46,595 - FGO - INFO - N_t: 70
2023-09-02 20:55:46,599 - CV - INFO - Begin Pretrain
2023-09-02 20:55:46,599 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:46,602 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:55:46,627 - FGO - INFO - Epoch  10 | Train Loss: 0.450 | Val Loss: 0.48 | Val F1: 0.81 |
2023-09-02 20:55:46,652 - FGO - INFO - Epoch  20 | Train Loss: 0.149 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:55:46,677 - FGO - INFO - Epoch  30 | Train Loss: 0.104 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:55:46,702 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:55:46,726 - FGO - INFO - Epoch  50 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:55:46,751 - FGO - INFO - Epoch  60 | Train Loss: 0.067 | Val Loss: 0.11 | Val F1: 0.96 |
2023-09-02 20:55:46,776 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.96 |
2023-09-02 20:55:46,800 - FGO - INFO - Epoch  80 | Train Loss: 0.072 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:55:46,825 - FGO - INFO - Epoch  90 | Train Loss: 0.061 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:55:46,850 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:55:46,850 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.117 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:55:46,850 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:46,851 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:55:46,851 - CV - INFO - Begin OT Train
2023-09-02 20:55:46,851 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:46,970 - FGO - INFO - Epoch   0 | Train Loss: -0.520 | Val Loss: 0.09 | Val F1: 0.93 |
2023-09-02 20:55:47,877 - FGO - INFO - Epoch  10 | Train Loss: -0.627 | Val Loss: 0.24 | Val F1: 0.93 |
2023-09-02 20:55:48,815 - FGO - INFO - Epoch  20 | Train Loss: -0.707 | Val Loss: 0.17 | Val F1: 0.94 |
2023-09-02 20:55:49,615 - FGO - INFO - Epoch  30 | Train Loss: -0.760 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:55:50,500 - FGO - INFO - Epoch  40 | Train Loss: -0.787 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:55:51,296 - FGO - INFO - Best Epoch:  28 | Train Loss: -0.754 | Val Loss: 0.14 | Val F1: 0.96 |
2023-09-02 20:55:51,296 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:51,299 - CV - INFO - OT Train Complete, 28 epochs
2023-09-02 20:55:51,300 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:51,333 - FGO - INFO - Train CM:
[[392   8]
 [ 11 323]]
2023-09-02 20:55:51,334 - FGO - INFO - Val CM:
[[33  1]
 [ 3 33]]
2023-09-02 20:55:51,334 - FGO - INFO - Test CM:
[[33  1]
 [ 3 33]]
2023-09-02 20:55:51,338 - FGO - INFO - test statistical parity: 0.1241565452091768
2023-09-02 20:55:51,340 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:55:51,341 - FGO - INFO - test micro f1: 0.9428571428571428
2023-09-02 20:55:51,341 - FGO - INFO - test macro f1: 0.9428571428571428
2023-09-02 20:55:51,341 - CV - INFO - fold time: 4.83907151222229s (0.0806511918703715m)
2023-09-02 20:55:51,341 - CV - INFO - ----- BEGINNING FOLD SET (019:9)----------------------------------------------------------
2023-09-02 20:55:51,343 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/019/9
2023-09-02 20:55:51,343 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:51,343 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:51,343 - FGO - INFO - 	done: False
2023-09-02 20:55:51,343 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:51,343 - FGO - INFO - 	h1: 64
2023-09-02 20:55:51,343 - FGO - INFO - 	h2: 32
2023-09-02 20:55:51,343 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:51,343 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:51,343 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:51,343 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:51,343 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:51,343 - FGO - INFO - 	theta: 10
2023-09-02 20:55:51,343 - FGO - INFO - 	clip: 5
2023-09-02 20:55:51,343 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:51,343 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:51,343 - FGO - INFO - Source Total: 725
2023-09-02 20:55:51,343 - FGO - INFO - Target Total: 79
2023-09-02 20:55:51,343 - FGO - INFO - Train Total: 725
2023-09-02 20:55:51,343 - FGO - INFO - Val Total:   79
2023-09-02 20:55:51,343 - FGO - INFO - Test Total:  79
2023-09-02 20:55:51,343 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:51,343 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:51,343 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:51,343 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:51,343 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:51,344 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:51,344 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:51,344 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:51,344 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:51,344 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:51,345 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:51,346 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:51,445 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:51,445 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:51,445 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:51,445 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:51,445 - FGO - INFO - N: 804
2023-09-02 20:55:51,445 - FGO - INFO - N_s: 725
2023-09-02 20:55:51,445 - FGO - INFO - N_t: 79
2023-09-02 20:55:51,449 - CV - INFO - Begin Pretrain
2023-09-02 20:55:51,449 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:51,452 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:55:51,477 - FGO - INFO - Epoch  10 | Train Loss: 0.471 | Val Loss: 0.48 | Val F1: 0.87 |
2023-09-02 20:55:51,502 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:55:51,526 - FGO - INFO - Epoch  30 | Train Loss: 0.102 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:55:51,551 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.21 | Val F1: 0.97 |
2023-09-02 20:55:51,575 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:55:51,599 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:55:51,624 - FGO - INFO - Epoch  70 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:55:51,648 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:55:51,673 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:55:51,697 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:55:51,697 - FGO - INFO - Best Epoch:  25 | Train Loss: 0.119 | Val Loss: 0.24 | Val F1: 0.97 
2023-09-02 20:55:51,697 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:51,699 - CV - INFO - Pretrain Complete, 25 epochs
2023-09-02 20:55:51,699 - CV - INFO - Begin OT Train
2023-09-02 20:55:51,699 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:51,824 - FGO - INFO - Epoch   0 | Train Loss: -0.557 | Val Loss: 0.03 | Val F1: 0.97 |
2023-09-02 20:55:52,837 - FGO - INFO - Epoch  10 | Train Loss: -0.309 | Val Loss: 0.81 | Val F1: 0.77 |
2023-09-02 20:55:53,782 - FGO - INFO - Epoch  20 | Train Loss: -0.619 | Val Loss: 0.05 | Val F1: 0.96 |
2023-09-02 20:55:54,662 - FGO - INFO - Epoch  30 | Train Loss: -0.675 | Val Loss: 0.06 | Val F1: 0.93 |
2023-09-02 20:55:55,549 - FGO - INFO - Epoch  40 | Train Loss: -0.730 | Val Loss: 0.06 | Val F1: 0.93 |
2023-09-02 20:55:56,280 - FGO - INFO - Best Epoch:  44 | Train Loss: -0.751 | Val Loss: 0.02 | Val F1: 0.96 |
2023-09-02 20:55:56,280 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:56,283 - CV - INFO - OT Train Complete, 44 epochs
2023-09-02 20:55:56,284 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:55:56,311 - FGO - INFO - Train CM:
[[375  10]
 [ 11 329]]
2023-09-02 20:55:56,311 - FGO - INFO - Val CM:
[[46  3]
 [ 0 30]]
2023-09-02 20:55:56,311 - FGO - INFO - Test CM:
[[46  3]
 [ 0 30]]
2023-09-02 20:55:56,316 - FGO - INFO - test statistical parity: 0.09420289855072461
2023-09-02 20:55:56,317 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:55:56,318 - FGO - INFO - test micro f1: 0.9620253164556962
2023-09-02 20:55:56,319 - FGO - INFO - test macro f1: 0.9604010025062657
2023-09-02 20:55:56,319 - CV - INFO - fold time: 4.977602005004883s (0.08296003341674804m)
2023-09-02 20:55:56,319 - CV - INFO - Mean Pretrain Epochs 41.0:
2023-09-02 20:55:56,319 - CV - INFO - Mean OT Train Epochs 19.5:
2023-09-02 20:55:56,319 - CV - INFO - Mean Val Macro F1 : 0.9550524918121097
2023-09-02 20:55:56,319 - CV - INFO - Mean Eval Stat : 0.9550524918121097 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:55:56,319 - CV - INFO - set time: 50.78227663040161s (0.8463712771733601m)
2023-09-02 20:55:56,319 - CV - INFO - script time so far: 854.2700724601746s (14.23783454100291m) (0.23729724235004848h)
2023-09-02 20:55:56,319 - CV - INFO - ===== BEGINNING OPTION SET (020)==========================================================
2023-09-02 20:55:56,319 - CV - INFO - 	done: False
2023-09-02 20:55:56,319 - CV - INFO - 	learning_rate: 0.01
2023-09-02 20:55:56,319 - CV - INFO - 	h1: 64
2023-09-02 20:55:56,319 - CV - INFO - 	h2: 32
2023-09-02 20:55:56,319 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:56,319 - CV - INFO - 	dropout: 0.0
2023-09-02 20:55:56,319 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:56,319 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:56,319 - CV - INFO - 	lambda: 0.01
2023-09-02 20:55:56,319 - CV - INFO - 	theta: 30
2023-09-02 20:55:56,319 - CV - INFO - 	clip: 5
2023-09-02 20:55:56,319 - CV - INFO - ----- BEGINNING FOLD SET (020:0)----------------------------------------------------------
2023-09-02 20:55:56,321 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/020/0
2023-09-02 20:55:56,321 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:55:56,321 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:55:56,321 - FGO - INFO - 	done: False
2023-09-02 20:55:56,321 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:55:56,321 - FGO - INFO - 	h1: 64
2023-09-02 20:55:56,321 - FGO - INFO - 	h2: 32
2023-09-02 20:55:56,321 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:55:56,321 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:55:56,321 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:55:56,321 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:55:56,321 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:55:56,321 - FGO - INFO - 	theta: 30
2023-09-02 20:55:56,321 - FGO - INFO - 	clip: 5
2023-09-02 20:55:56,321 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:55:56,321 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:55:56,321 - FGO - INFO - Source Total: 708
2023-09-02 20:55:56,321 - FGO - INFO - Target Total: 96
2023-09-02 20:55:56,321 - FGO - INFO - Train Total: 708
2023-09-02 20:55:56,321 - FGO - INFO - Val Total:   96
2023-09-02 20:55:56,321 - FGO - INFO - Test Total:  96
2023-09-02 20:55:56,321 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:55:56,321 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:55:56,321 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:55:56,321 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:55:56,321 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:55:56,322 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:55:56,322 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:55:56,322 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:55:56,322 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:55:56,322 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:55:56,323 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:55:56,324 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:55:56,440 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:55:56,440 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:55:56,440 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:55:56,440 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:55:56,440 - FGO - INFO - N: 804
2023-09-02 20:55:56,440 - FGO - INFO - N_s: 708
2023-09-02 20:55:56,440 - FGO - INFO - N_t: 96
2023-09-02 20:55:56,443 - CV - INFO - Begin Pretrain
2023-09-02 20:55:56,443 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:55:56,447 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:55:56,471 - FGO - INFO - Epoch  10 | Train Loss: 0.421 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:55:56,496 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:55:56,520 - FGO - INFO - Epoch  30 | Train Loss: 0.103 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:55:56,544 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:55:56,569 - FGO - INFO - Epoch  50 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:55:56,593 - FGO - INFO - Epoch  60 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:55:56,617 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:55:56,641 - FGO - INFO - Epoch  80 | Train Loss: 0.058 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:55:56,665 - FGO - INFO - Epoch  90 | Train Loss: 0.058 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:55:56,690 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:55:56,690 - FGO - INFO - Best Epoch:  28 | Train Loss: 0.112 | Val Loss: 0.09 | Val F1: 0.99 
2023-09-02 20:55:56,690 - FGO - INFO - Setting model to best state.
2023-09-02 20:55:56,691 - CV - INFO - Pretrain Complete, 28 epochs
2023-09-02 20:55:56,691 - CV - INFO - Begin OT Train
2023-09-02 20:55:56,691 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:55:56,811 - FGO - INFO - Epoch   0 | Train Loss: -1.862 | Val Loss: -0.12 | Val F1: 0.94 |
2023-09-02 20:55:57,710 - FGO - INFO - Epoch  10 | Train Loss: -2.238 | Val Loss: -0.22 | Val F1: 0.97 |
2023-09-02 20:55:58,589 - FGO - INFO - Epoch  20 | Train Loss: -2.405 | Val Loss: -0.16 | Val F1: 0.93 |
2023-09-02 20:55:59,426 - FGO - INFO - Epoch  30 | Train Loss: -2.520 | Val Loss: -0.26 | Val F1: 0.97 |
2023-09-02 20:56:00,214 - FGO - INFO - Epoch  40 | Train Loss: -2.572 | Val Loss: -0.28 | Val F1: 0.98 |
2023-09-02 20:56:00,943 - FGO - INFO - Best Epoch:  32 | Train Loss: -2.534 | Val Loss: -0.27 | Val F1: 0.98 |
2023-09-02 20:56:00,943 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:00,946 - CV - INFO - OT Train Complete, 32 epochs
2023-09-02 20:56:00,946 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:00,983 - FGO - INFO - Train CM:
[[372  10]
 [ 10 316]]
2023-09-02 20:56:00,983 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:56:00,983 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:56:00,988 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:56:00,989 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:56:00,990 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:56:00,990 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:56:00,990 - CV - INFO - fold time: 4.671162843704224s (0.07785271406173706m)
2023-09-02 20:56:00,990 - CV - INFO - ----- BEGINNING FOLD SET (020:1)----------------------------------------------------------
2023-09-02 20:56:00,992 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/020/1
2023-09-02 20:56:00,992 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:00,992 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:00,992 - FGO - INFO - 	done: False
2023-09-02 20:56:00,992 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:00,992 - FGO - INFO - 	h1: 64
2023-09-02 20:56:00,992 - FGO - INFO - 	h2: 32
2023-09-02 20:56:00,992 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:00,992 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:00,992 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:00,992 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:00,992 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:00,992 - FGO - INFO - 	theta: 30
2023-09-02 20:56:00,992 - FGO - INFO - 	clip: 5
2023-09-02 20:56:00,992 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:00,992 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:00,992 - FGO - INFO - Source Total: 727
2023-09-02 20:56:00,992 - FGO - INFO - Target Total: 77
2023-09-02 20:56:00,992 - FGO - INFO - Train Total: 727
2023-09-02 20:56:00,992 - FGO - INFO - Val Total:   77
2023-09-02 20:56:00,992 - FGO - INFO - Test Total:  77
2023-09-02 20:56:00,992 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:00,992 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:00,992 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:00,992 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:00,992 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:00,993 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:00,993 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:00,993 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:00,993 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:00,993 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:00,994 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:00,995 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:01,091 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:01,091 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:01,091 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:01,091 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:01,091 - FGO - INFO - N: 804
2023-09-02 20:56:01,091 - FGO - INFO - N_s: 727
2023-09-02 20:56:01,091 - FGO - INFO - N_t: 77
2023-09-02 20:56:01,095 - CV - INFO - Begin Pretrain
2023-09-02 20:56:01,095 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:01,099 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:56:01,127 - FGO - INFO - Epoch  10 | Train Loss: 0.472 | Val Loss: 0.55 | Val F1: 0.71 |
2023-09-02 20:56:01,156 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.27 | Val F1: 0.84 |
2023-09-02 20:56:01,184 - FGO - INFO - Epoch  30 | Train Loss: 0.091 | Val Loss: 0.17 | Val F1: 0.93 |
2023-09-02 20:56:01,212 - FGO - INFO - Epoch  40 | Train Loss: 0.080 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:56:01,240 - FGO - INFO - Epoch  50 | Train Loss: 0.067 | Val Loss: 0.20 | Val F1: 0.87 |
2023-09-02 20:56:01,277 - FGO - INFO - Epoch  60 | Train Loss: 0.061 | Val Loss: 0.22 | Val F1: 0.89 |
2023-09-02 20:56:01,305 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:56:01,329 - FGO - INFO - Epoch  80 | Train Loss: 0.054 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 20:56:01,354 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.21 | Val F1: 0.92 |
2023-09-02 20:56:01,378 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:56:01,378 - FGO - INFO - Best Epoch:  34 | Train Loss: 0.088 | Val Loss: 0.17 | Val F1: 0.95 
2023-09-02 20:56:01,378 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:01,380 - CV - INFO - Pretrain Complete, 34 epochs
2023-09-02 20:56:01,380 - CV - INFO - Begin OT Train
2023-09-02 20:56:01,380 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:01,464 - FGO - INFO - Epoch   0 | Train Loss: -1.752 | Val Loss: 0.00 | Val F1: 0.90 |
2023-09-02 20:56:02,409 - FGO - INFO - Epoch  10 | Train Loss: -2.220 | Val Loss: 0.05 | Val F1: 0.91 |
2023-09-02 20:56:03,210 - FGO - INFO - Epoch  20 | Train Loss: -2.409 | Val Loss: -0.03 | Val F1: 0.89 |
2023-09-02 20:56:03,941 - FGO - INFO - Epoch  30 | Train Loss: -2.525 | Val Loss: 0.01 | Val F1: 0.89 |
2023-09-02 20:56:04,752 - FGO - INFO - Epoch  40 | Train Loss: -2.589 | Val Loss: -0.04 | Val F1: 0.93 |
2023-09-02 20:56:05,523 - FGO - INFO - Best Epoch:  34 | Train Loss: -2.556 | Val Loss: -0.03 | Val F1: 0.93 |
2023-09-02 20:56:05,523 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:05,526 - CV - INFO - OT Train Complete, 34 epochs
2023-09-02 20:56:05,527 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:05,556 - FGO - INFO - Train CM:
[[382   8]
 [  8 329]]
2023-09-02 20:56:05,556 - FGO - INFO - Val CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:56:05,557 - FGO - INFO - Test CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:56:05,562 - FGO - INFO - test statistical parity: 0.36282051282051286
2023-09-02 20:56:05,563 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:56:05,564 - FGO - INFO - test micro f1: 0.935064935064935
2023-09-02 20:56:05,564 - FGO - INFO - test macro f1: 0.9328449328449329
2023-09-02 20:56:05,564 - CV - INFO - fold time: 4.5740978717803955s (0.07623496452967325m)
2023-09-02 20:56:05,564 - CV - INFO - ----- BEGINNING FOLD SET (020:2)----------------------------------------------------------
2023-09-02 20:56:05,566 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/020/2
2023-09-02 20:56:05,566 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:05,566 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:05,566 - FGO - INFO - 	done: False
2023-09-02 20:56:05,566 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:05,566 - FGO - INFO - 	h1: 64
2023-09-02 20:56:05,566 - FGO - INFO - 	h2: 32
2023-09-02 20:56:05,566 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:05,566 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:05,566 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:05,566 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:05,566 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:05,566 - FGO - INFO - 	theta: 30
2023-09-02 20:56:05,566 - FGO - INFO - 	clip: 5
2023-09-02 20:56:05,566 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:05,567 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:05,567 - FGO - INFO - Source Total: 721
2023-09-02 20:56:05,567 - FGO - INFO - Target Total: 83
2023-09-02 20:56:05,567 - FGO - INFO - Train Total: 721
2023-09-02 20:56:05,567 - FGO - INFO - Val Total:   83
2023-09-02 20:56:05,567 - FGO - INFO - Test Total:  83
2023-09-02 20:56:05,567 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:05,567 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:05,567 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:05,567 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:05,567 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:05,567 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:05,567 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:05,567 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:05,567 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:05,567 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:05,568 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:05,570 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:05,671 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:05,672 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:05,672 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:05,672 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:05,672 - FGO - INFO - N: 804
2023-09-02 20:56:05,672 - FGO - INFO - N_s: 721
2023-09-02 20:56:05,672 - FGO - INFO - N_t: 83
2023-09-02 20:56:05,675 - CV - INFO - Begin Pretrain
2023-09-02 20:56:05,675 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:05,679 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:56:05,704 - FGO - INFO - Epoch  10 | Train Loss: 0.478 | Val Loss: 0.49 | Val F1: 0.84 |
2023-09-02 20:56:05,728 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.24 | Val F1: 0.87 |
2023-09-02 20:56:05,753 - FGO - INFO - Epoch  30 | Train Loss: 0.087 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:56:05,777 - FGO - INFO - Epoch  40 | Train Loss: 0.073 | Val Loss: 0.25 | Val F1: 0.90 |
2023-09-02 20:56:05,808 - FGO - INFO - Epoch  50 | Train Loss: 0.063 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:56:05,838 - FGO - INFO - Epoch  60 | Train Loss: 0.058 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:56:05,863 - FGO - INFO - Epoch  70 | Train Loss: 0.056 | Val Loss: 0.28 | Val F1: 0.91 |
2023-09-02 20:56:05,887 - FGO - INFO - Epoch  80 | Train Loss: 0.052 | Val Loss: 0.28 | Val F1: 0.88 |
2023-09-02 20:56:05,912 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.28 | Val F1: 0.89 |
2023-09-02 20:56:05,936 - FGO - INFO - Epoch 100 | Train Loss: 0.046 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:56:05,936 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.058 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:56:05,936 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:05,938 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:56:05,938 - CV - INFO - Begin OT Train
2023-09-02 20:56:05,938 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:06,071 - FGO - INFO - Epoch   0 | Train Loss: -1.633 | Val Loss: 0.09 | Val F1: 0.90 |
2023-09-02 20:56:07,130 - FGO - INFO - Epoch  10 | Train Loss: -2.250 | Val Loss: 0.16 | Val F1: 0.89 |
2023-09-02 20:56:07,986 - FGO - INFO - Epoch  20 | Train Loss: -2.472 | Val Loss: -0.00 | Val F1: 0.90 |
2023-09-02 20:56:08,871 - FGO - INFO - Epoch  30 | Train Loss: -2.592 | Val Loss: 0.02 | Val F1: 0.91 |
2023-09-02 20:56:09,693 - FGO - INFO - Epoch  40 | Train Loss: -2.639 | Val Loss: 0.06 | Val F1: 0.90 |
2023-09-02 20:56:10,406 - FGO - INFO - Best Epoch:  11 | Train Loss: -2.272 | Val Loss: 0.02 | Val F1: 0.91 |
2023-09-02 20:56:10,406 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:10,409 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:56:10,410 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:10,442 - FGO - INFO - Train CM:
[[378   6]
 [  8 329]]
2023-09-02 20:56:10,442 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:56:10,442 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:56:10,447 - FGO - INFO - test statistical parity: 0.02230046948356812
2023-09-02 20:56:10,448 - FGO - INFO - test equal opportunity: 0.2592592592592593
2023-09-02 20:56:10,449 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:56:10,450 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:56:10,450 - CV - INFO - fold time: 4.885075092315674s (0.08141791820526123m)
2023-09-02 20:56:10,450 - CV - INFO - ----- BEGINNING FOLD SET (020:3)----------------------------------------------------------
2023-09-02 20:56:10,451 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/020/3
2023-09-02 20:56:10,451 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:10,451 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:10,451 - FGO - INFO - 	done: False
2023-09-02 20:56:10,451 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:10,452 - FGO - INFO - 	h1: 64
2023-09-02 20:56:10,452 - FGO - INFO - 	h2: 32
2023-09-02 20:56:10,452 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:10,452 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:10,452 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:10,452 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:10,452 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:10,452 - FGO - INFO - 	theta: 30
2023-09-02 20:56:10,452 - FGO - INFO - 	clip: 5
2023-09-02 20:56:10,452 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:10,452 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:10,452 - FGO - INFO - Source Total: 729
2023-09-02 20:56:10,452 - FGO - INFO - Target Total: 75
2023-09-02 20:56:10,452 - FGO - INFO - Train Total: 729
2023-09-02 20:56:10,452 - FGO - INFO - Val Total:   75
2023-09-02 20:56:10,452 - FGO - INFO - Test Total:  75
2023-09-02 20:56:10,452 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:10,452 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:10,452 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:10,452 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:10,452 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:10,452 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:10,452 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:10,452 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:10,452 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:10,452 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:10,453 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:10,455 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:10,549 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:10,549 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:10,549 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:10,549 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:10,549 - FGO - INFO - N: 804
2023-09-02 20:56:10,549 - FGO - INFO - N_s: 729
2023-09-02 20:56:10,549 - FGO - INFO - N_t: 75
2023-09-02 20:56:10,553 - CV - INFO - Begin Pretrain
2023-09-02 20:56:10,553 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:10,556 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:56:10,581 - FGO - INFO - Epoch  10 | Train Loss: 0.431 | Val Loss: 0.36 | Val F1: 0.93 |
2023-09-02 20:56:10,606 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:56:10,631 - FGO - INFO - Epoch  30 | Train Loss: 0.109 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:56:10,655 - FGO - INFO - Epoch  40 | Train Loss: 0.093 | Val Loss: 0.03 | Val F1: 0.99 |
2023-09-02 20:56:10,680 - FGO - INFO - Epoch  50 | Train Loss: 0.080 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:56:10,704 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:56:10,729 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:56:10,754 - FGO - INFO - Epoch  80 | Train Loss: 0.065 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:56:10,778 - FGO - INFO - Epoch  90 | Train Loss: 0.064 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:56:10,803 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:56:10,803 - FGO - INFO - Best Epoch:  27 | Train Loss: 0.114 | Val Loss: 0.03 | Val F1: 1.00 
2023-09-02 20:56:10,803 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:10,804 - CV - INFO - Pretrain Complete, 27 epochs
2023-09-02 20:56:10,804 - CV - INFO - Begin OT Train
2023-09-02 20:56:10,804 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:10,888 - FGO - INFO - Epoch   0 | Train Loss: -1.679 | Val Loss: -0.16 | Val F1: 0.97 |
2023-09-02 20:56:11,935 - FGO - INFO - Epoch  10 | Train Loss: -2.225 | Val Loss: -0.02 | Val F1: 0.91 |
2023-09-02 20:56:12,776 - FGO - INFO - Epoch  20 | Train Loss: -2.411 | Val Loss: -0.09 | Val F1: 0.96 |
2023-09-02 20:56:13,533 - FGO - INFO - Epoch  30 | Train Loss: -2.518 | Val Loss: -0.17 | Val F1: 0.97 |
2023-09-02 20:56:14,332 - FGO - INFO - Epoch  40 | Train Loss: -2.581 | Val Loss: -0.20 | Val F1: 0.97 |
2023-09-02 20:56:15,018 - FGO - INFO - Best Epoch:   7 | Train Loss: -2.148 | Val Loss: -0.20 | Val F1: 0.99 |
2023-09-02 20:56:15,018 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:15,023 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:56:15,023 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:15,060 - FGO - INFO - Train CM:
[[387   9]
 [ 12 321]]
2023-09-02 20:56:15,060 - FGO - INFO - Val CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:56:15,060 - FGO - INFO - Test CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:56:15,070 - FGO - INFO - test statistical parity: 0.046838407494145196
2023-09-02 20:56:15,071 - FGO - INFO - test equal opportunity: 0.10952380952380958
2023-09-02 20:56:15,072 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 20:56:15,072 - FGO - INFO - test macro f1: 0.9732905982905983
2023-09-02 20:56:15,072 - CV - INFO - fold time: 4.62265944480896s (0.07704432408014933m)
2023-09-02 20:56:15,072 - CV - INFO - ----- BEGINNING FOLD SET (020:4)----------------------------------------------------------
2023-09-02 20:56:15,074 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/020/4
2023-09-02 20:56:15,074 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:15,074 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:15,074 - FGO - INFO - 	done: False
2023-09-02 20:56:15,074 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:15,074 - FGO - INFO - 	h1: 64
2023-09-02 20:56:15,074 - FGO - INFO - 	h2: 32
2023-09-02 20:56:15,074 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:15,074 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:15,074 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:15,074 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:15,074 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:15,074 - FGO - INFO - 	theta: 30
2023-09-02 20:56:15,074 - FGO - INFO - 	clip: 5
2023-09-02 20:56:15,074 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:15,074 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:15,074 - FGO - INFO - Source Total: 732
2023-09-02 20:56:15,075 - FGO - INFO - Target Total: 72
2023-09-02 20:56:15,075 - FGO - INFO - Train Total: 732
2023-09-02 20:56:15,075 - FGO - INFO - Val Total:   72
2023-09-02 20:56:15,075 - FGO - INFO - Test Total:  72
2023-09-02 20:56:15,075 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:15,075 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:15,075 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:15,075 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:15,075 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:15,075 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:15,075 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:15,075 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:15,075 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:15,075 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:15,076 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:15,078 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:15,169 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:15,169 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:15,169 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:15,169 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:15,169 - FGO - INFO - N: 804
2023-09-02 20:56:15,169 - FGO - INFO - N_s: 732
2023-09-02 20:56:15,169 - FGO - INFO - N_t: 72
2023-09-02 20:56:15,173 - CV - INFO - Begin Pretrain
2023-09-02 20:56:15,173 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:15,176 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:56:15,201 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.46 | Val F1: 0.81 |
2023-09-02 20:56:15,226 - FGO - INFO - Epoch  20 | Train Loss: 0.141 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:56:15,251 - FGO - INFO - Epoch  30 | Train Loss: 0.100 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:56:15,276 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:56:15,300 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:56:15,325 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 20:56:15,350 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:56:15,374 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:56:15,399 - FGO - INFO - Epoch  90 | Train Loss: 0.064 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:56:15,424 - FGO - INFO - Epoch 100 | Train Loss: 0.064 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:56:15,424 - FGO - INFO - Best Epoch:  64 | Train Loss: 0.069 | Val Loss: 0.06 | Val F1: 0.99 
2023-09-02 20:56:15,424 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:15,425 - CV - INFO - Pretrain Complete, 64 epochs
2023-09-02 20:56:15,425 - CV - INFO - Begin OT Train
2023-09-02 20:56:15,425 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:15,530 - FGO - INFO - Epoch   0 | Train Loss: -1.989 | Val Loss: -0.16 | Val F1: 0.99 |
2023-09-02 20:56:16,456 - FGO - INFO - Epoch  10 | Train Loss: -2.391 | Val Loss: -0.16 | Val F1: 0.99 |
2023-09-02 20:56:17,214 - FGO - INFO - Epoch  20 | Train Loss: -2.495 | Val Loss: -0.17 | Val F1: 0.97 |
2023-09-02 20:56:18,068 - FGO - INFO - Epoch  30 | Train Loss: -2.589 | Val Loss: -0.19 | Val F1: 0.99 |
2023-09-02 20:56:18,887 - FGO - INFO - Epoch  40 | Train Loss: -2.628 | Val Loss: -0.20 | Val F1: 0.99 |
2023-09-02 20:56:19,672 - FGO - INFO - Best Epoch:  10 | Train Loss: -2.391 | Val Loss: -0.16 | Val F1: 0.99 |
2023-09-02 20:56:19,672 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:19,676 - CV - INFO - OT Train Complete, 10 epochs
2023-09-02 20:56:19,676 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:19,702 - FGO - INFO - Train CM:
[[387  10]
 [ 11 324]]
2023-09-02 20:56:19,702 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:56:19,703 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:56:19,707 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:56:19,709 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:56:19,710 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:56:19,710 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:56:19,710 - CV - INFO - fold time: 4.6378257274627686s (0.07729709545771281m)
2023-09-02 20:56:19,710 - CV - INFO - ----- BEGINNING FOLD SET (020:5)----------------------------------------------------------
2023-09-02 20:56:19,712 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/020/5
2023-09-02 20:56:19,712 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:19,712 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:19,712 - FGO - INFO - 	done: False
2023-09-02 20:56:19,712 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:19,712 - FGO - INFO - 	h1: 64
2023-09-02 20:56:19,712 - FGO - INFO - 	h2: 32
2023-09-02 20:56:19,712 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:19,712 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:19,712 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:19,712 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:19,712 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:19,712 - FGO - INFO - 	theta: 30
2023-09-02 20:56:19,712 - FGO - INFO - 	clip: 5
2023-09-02 20:56:19,712 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:19,712 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:19,712 - FGO - INFO - Source Total: 726
2023-09-02 20:56:19,712 - FGO - INFO - Target Total: 78
2023-09-02 20:56:19,712 - FGO - INFO - Train Total: 726
2023-09-02 20:56:19,712 - FGO - INFO - Val Total:   78
2023-09-02 20:56:19,712 - FGO - INFO - Test Total:  78
2023-09-02 20:56:19,712 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:19,712 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:19,712 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:19,712 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:19,712 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:19,713 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:19,713 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:19,713 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:19,713 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:19,713 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:19,714 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:19,715 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:19,813 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:19,813 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:19,813 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:19,813 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:19,813 - FGO - INFO - N: 804
2023-09-02 20:56:19,813 - FGO - INFO - N_s: 726
2023-09-02 20:56:19,813 - FGO - INFO - N_t: 78
2023-09-02 20:56:19,816 - CV - INFO - Begin Pretrain
2023-09-02 20:56:19,816 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:19,820 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:56:19,844 - FGO - INFO - Epoch  10 | Train Loss: 0.515 | Val Loss: 0.52 | Val F1: 0.82 |
2023-09-02 20:56:19,869 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:56:19,894 - FGO - INFO - Epoch  30 | Train Loss: 0.106 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:56:19,918 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.13 | Val F1: 0.95 |
2023-09-02 20:56:19,942 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:56:19,967 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.09 | Val F1: 0.95 |
2023-09-02 20:56:19,991 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:56:20,016 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 20:56:20,040 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:56:20,064 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:56:20,064 - FGO - INFO - Best Epoch:  55 | Train Loss: 0.077 | Val Loss: 0.09 | Val F1: 0.97 
2023-09-02 20:56:20,064 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:20,066 - CV - INFO - Pretrain Complete, 55 epochs
2023-09-02 20:56:20,066 - CV - INFO - Begin OT Train
2023-09-02 20:56:20,066 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:20,176 - FGO - WARNING - long running sinkhorn (1000), u_diff: 1.2369265789402561e-07
2023-09-02 20:56:20,264 - FGO - WARNING - long running sinkhorn (2000), u_diff: 1.2752992972764332e-07
2023-09-02 20:56:20,352 - FGO - WARNING - long running sinkhorn (3000), u_diff: 1.2307134511502227e-07
2023-09-02 20:56:20,440 - FGO - WARNING - long running sinkhorn (4000), u_diff: 1.2636132851184811e-07
2023-09-02 20:56:20,527 - FGO - WARNING - long running sinkhorn (5000), u_diff: 1.2122676196213433e-07
2023-09-02 20:56:20,615 - FGO - WARNING - long running sinkhorn (6000), u_diff: 1.1600047855608864e-07
2023-09-02 20:56:20,703 - FGO - WARNING - long running sinkhorn (7000), u_diff: 1.1826498536038343e-07
2023-09-02 20:56:20,790 - FGO - WARNING - long running sinkhorn (8000), u_diff: 1.2439582519618853e-07
2023-09-02 20:56:20,878 - FGO - WARNING - long running sinkhorn (9000), u_diff: 1.2040874253216316e-07
2023-09-02 20:56:20,966 - FGO - WARNING - long running sinkhorn (10000), u_diff: 1.2443463504041574e-07
2023-09-02 20:56:20,966 - FGO - WARNING - large sinkhorn itter (10000)
2023-09-02 20:56:21,476 - FGO - INFO - Epoch   0 | Train Loss: -1.547 | Val Loss: -0.11 | Val F1: 0.95 |
2023-09-02 20:56:22,377 - FGO - INFO - Epoch  10 | Train Loss: -2.259 | Val Loss: 0.15 | Val F1: 0.86 |
2023-09-02 20:56:23,184 - FGO - INFO - Epoch  20 | Train Loss: -2.431 | Val Loss: 0.06 | Val F1: 0.91 |
2023-09-02 20:56:23,968 - FGO - INFO - Epoch  30 | Train Loss: -2.539 | Val Loss: 0.02 | Val F1: 0.91 |
2023-09-02 20:56:24,758 - FGO - INFO - Epoch  40 | Train Loss: -2.586 | Val Loss: 0.02 | Val F1: 0.91 |
2023-09-02 20:56:25,465 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.064 | Val Loss: -0.11 | Val F1: 0.94 |
2023-09-02 20:56:25,465 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:25,468 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:56:25,468 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:25,509 - FGO - INFO - Train CM:
[[394   6]
 [ 18 308]]
2023-09-02 20:56:25,510 - FGO - INFO - Val CM:
[[34  0]
 [ 7 37]]
2023-09-02 20:56:25,510 - FGO - INFO - Test CM:
[[34  0]
 [ 7 37]]
2023-09-02 20:56:25,515 - FGO - INFO - test statistical parity: 0.09178743961352659
2023-09-02 20:56:25,516 - FGO - INFO - test equal opportunity: 0.17948717948717952
2023-09-02 20:56:25,517 - FGO - INFO - test micro f1: 0.9102564102564102
2023-09-02 20:56:25,517 - FGO - INFO - test macro f1: 0.9101234567901235
2023-09-02 20:56:25,517 - CV - INFO - fold time: 5.807123422622681s (0.09678539037704467m)
2023-09-02 20:56:25,517 - CV - INFO - ----- BEGINNING FOLD SET (020:6)----------------------------------------------------------
2023-09-02 20:56:25,519 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/020/6
2023-09-02 20:56:25,519 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:25,519 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:25,519 - FGO - INFO - 	done: False
2023-09-02 20:56:25,519 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:25,519 - FGO - INFO - 	h1: 64
2023-09-02 20:56:25,519 - FGO - INFO - 	h2: 32
2023-09-02 20:56:25,519 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:25,519 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:25,519 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:25,519 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:25,519 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:25,519 - FGO - INFO - 	theta: 30
2023-09-02 20:56:25,519 - FGO - INFO - 	clip: 5
2023-09-02 20:56:25,519 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:25,519 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:25,519 - FGO - INFO - Source Total: 717
2023-09-02 20:56:25,519 - FGO - INFO - Target Total: 87
2023-09-02 20:56:25,519 - FGO - INFO - Train Total: 717
2023-09-02 20:56:25,519 - FGO - INFO - Val Total:   87
2023-09-02 20:56:25,519 - FGO - INFO - Test Total:  87
2023-09-02 20:56:25,519 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:25,519 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:25,519 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:25,519 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:25,519 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:25,520 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:25,520 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:25,520 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:25,520 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:25,520 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:25,521 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:25,522 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:25,629 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:25,629 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:25,629 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:25,629 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:25,629 - FGO - INFO - N: 804
2023-09-02 20:56:25,629 - FGO - INFO - N_s: 717
2023-09-02 20:56:25,629 - FGO - INFO - N_t: 87
2023-09-02 20:56:25,633 - CV - INFO - Begin Pretrain
2023-09-02 20:56:25,633 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:25,636 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:56:25,661 - FGO - INFO - Epoch  10 | Train Loss: 0.496 | Val Loss: 0.48 | Val F1: 0.80 |
2023-09-02 20:56:25,685 - FGO - INFO - Epoch  20 | Train Loss: 0.161 | Val Loss: 0.13 | Val F1: 0.93 |
2023-09-02 20:56:25,710 - FGO - INFO - Epoch  30 | Train Loss: 0.108 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:56:25,734 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.09 | Val F1: 0.98 |
2023-09-02 20:56:25,759 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:56:25,783 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:56:25,807 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:56:25,832 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:56:25,856 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:56:25,880 - FGO - INFO - Epoch 100 | Train Loss: 0.065 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:56:25,880 - FGO - INFO - Best Epoch:  73 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 1.00 
2023-09-02 20:56:25,880 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:25,882 - CV - INFO - Pretrain Complete, 73 epochs
2023-09-02 20:56:25,882 - CV - INFO - Begin OT Train
2023-09-02 20:56:25,882 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:26,002 - FGO - INFO - Epoch   0 | Train Loss: -2.006 | Val Loss: -0.23 | Val F1: 1.00 |
2023-09-02 20:56:27,005 - FGO - INFO - Epoch  10 | Train Loss: -2.301 | Val Loss: -0.25 | Val F1: 0.99 |
2023-09-02 20:56:27,873 - FGO - INFO - Epoch  20 | Train Loss: -2.471 | Val Loss: -0.23 | Val F1: 0.97 |
2023-09-02 20:56:28,725 - FGO - INFO - Epoch  30 | Train Loss: -2.547 | Val Loss: -0.28 | Val F1: 0.99 |
2023-09-02 20:56:29,508 - FGO - INFO - Epoch  40 | Train Loss: -2.596 | Val Loss: -0.29 | Val F1: 0.99 |
2023-09-02 20:56:30,285 - FGO - INFO - Best Epoch:  12 | Train Loss: -2.343 | Val Loss: -0.22 | Val F1: 1.00 |
2023-09-02 20:56:30,285 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:30,289 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:56:30,289 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:30,317 - FGO - INFO - Train CM:
[[375  10]
 [ 11 321]]
2023-09-02 20:56:30,317 - FGO - INFO - Val CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:56:30,317 - FGO - INFO - Test CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:56:30,322 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 20:56:30,324 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:56:30,325 - FGO - INFO - test micro f1: 0.9885057471264368
2023-09-02 20:56:30,325 - FGO - INFO - test macro f1: 0.9883518543312357
2023-09-02 20:56:30,325 - CV - INFO - fold time: 4.807873487472534s (0.0801312247912089m)
2023-09-02 20:56:30,325 - CV - INFO - ----- BEGINNING FOLD SET (020:7)----------------------------------------------------------
2023-09-02 20:56:30,327 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/020/7
2023-09-02 20:56:30,327 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:30,327 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:30,327 - FGO - INFO - 	done: False
2023-09-02 20:56:30,327 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:30,327 - FGO - INFO - 	h1: 64
2023-09-02 20:56:30,327 - FGO - INFO - 	h2: 32
2023-09-02 20:56:30,327 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:30,327 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:30,327 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:30,327 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:30,327 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:30,327 - FGO - INFO - 	theta: 30
2023-09-02 20:56:30,327 - FGO - INFO - 	clip: 5
2023-09-02 20:56:30,327 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:30,327 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:30,327 - FGO - INFO - Source Total: 717
2023-09-02 20:56:30,327 - FGO - INFO - Target Total: 87
2023-09-02 20:56:30,327 - FGO - INFO - Train Total: 717
2023-09-02 20:56:30,327 - FGO - INFO - Val Total:   87
2023-09-02 20:56:30,327 - FGO - INFO - Test Total:  87
2023-09-02 20:56:30,327 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:30,327 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:30,327 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:30,327 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:30,327 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:30,328 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:30,328 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:30,328 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:30,328 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:30,328 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:30,329 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:30,330 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:30,436 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:30,436 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:30,436 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:30,436 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:30,436 - FGO - INFO - N: 804
2023-09-02 20:56:30,436 - FGO - INFO - N_s: 717
2023-09-02 20:56:30,436 - FGO - INFO - N_t: 87
2023-09-02 20:56:30,440 - CV - INFO - Begin Pretrain
2023-09-02 20:56:30,440 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:30,443 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:56:30,468 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.49 | Val F1: 0.86 |
2023-09-02 20:56:30,492 - FGO - INFO - Epoch  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 |
2023-09-02 20:56:30,517 - FGO - INFO - Epoch  30 | Train Loss: 0.097 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:56:30,541 - FGO - INFO - Epoch  40 | Train Loss: 0.081 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:56:30,566 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:56:30,590 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:56:30,615 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:56:30,639 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:56:30,664 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:56:30,688 - FGO - INFO - Epoch 100 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.95 |
2023-09-02 20:56:30,689 - FGO - INFO - Best Epoch:  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 
2023-09-02 20:56:30,689 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:30,690 - CV - INFO - Pretrain Complete, 20 epochs
2023-09-02 20:56:30,690 - CV - INFO - Begin OT Train
2023-09-02 20:56:30,690 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:30,823 - FGO - INFO - Epoch   0 | Train Loss: -1.942 | Val Loss: -0.08 | Val F1: 0.95 |
2023-09-02 20:56:31,782 - FGO - INFO - Epoch  10 | Train Loss: -2.393 | Val Loss: -0.14 | Val F1: 0.97 |
2023-09-02 20:56:32,583 - FGO - INFO - Epoch  20 | Train Loss: -2.548 | Val Loss: -0.16 | Val F1: 0.97 |
2023-09-02 20:56:33,390 - FGO - INFO - Epoch  30 | Train Loss: -2.614 | Val Loss: -0.19 | Val F1: 0.97 |
2023-09-02 20:56:34,168 - FGO - INFO - Epoch  40 | Train Loss: -2.642 | Val Loss: -0.18 | Val F1: 0.97 |
2023-09-02 20:56:34,913 - FGO - INFO - Best Epoch:   8 | Train Loss: -2.385 | Val Loss: -0.16 | Val F1: 0.97 |
2023-09-02 20:56:34,913 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:34,916 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:56:34,916 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:34,940 - FGO - INFO - Train CM:
[[378   9]
 [ 11 319]]
2023-09-02 20:56:34,940 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:56:34,941 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:56:34,945 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:56:34,946 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:56:34,947 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:56:34,948 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:56:34,948 - CV - INFO - fold time: 4.622617721557617s (0.07704362869262696m)
2023-09-02 20:56:34,948 - CV - INFO - ----- BEGINNING FOLD SET (020:8)----------------------------------------------------------
2023-09-02 20:56:34,949 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/020/8
2023-09-02 20:56:34,950 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:34,950 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:34,950 - FGO - INFO - 	done: False
2023-09-02 20:56:34,950 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:34,950 - FGO - INFO - 	h1: 64
2023-09-02 20:56:34,950 - FGO - INFO - 	h2: 32
2023-09-02 20:56:34,950 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:34,950 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:34,950 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:34,950 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:34,950 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:34,950 - FGO - INFO - 	theta: 30
2023-09-02 20:56:34,950 - FGO - INFO - 	clip: 5
2023-09-02 20:56:34,950 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:34,950 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:34,950 - FGO - INFO - Source Total: 734
2023-09-02 20:56:34,950 - FGO - INFO - Target Total: 70
2023-09-02 20:56:34,950 - FGO - INFO - Train Total: 734
2023-09-02 20:56:34,950 - FGO - INFO - Val Total:   70
2023-09-02 20:56:34,950 - FGO - INFO - Test Total:  70
2023-09-02 20:56:34,950 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:34,950 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:34,950 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:34,950 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:34,950 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:34,951 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:34,951 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:34,951 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:34,951 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:34,951 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:34,952 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:34,953 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:35,040 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:35,040 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:35,041 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:35,041 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:35,041 - FGO - INFO - N: 804
2023-09-02 20:56:35,041 - FGO - INFO - N_s: 734
2023-09-02 20:56:35,041 - FGO - INFO - N_t: 70
2023-09-02 20:56:35,044 - CV - INFO - Begin Pretrain
2023-09-02 20:56:35,044 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:35,048 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:56:35,073 - FGO - INFO - Epoch  10 | Train Loss: 0.450 | Val Loss: 0.48 | Val F1: 0.81 |
2023-09-02 20:56:35,098 - FGO - INFO - Epoch  20 | Train Loss: 0.149 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:56:35,123 - FGO - INFO - Epoch  30 | Train Loss: 0.104 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:56:35,147 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:56:35,172 - FGO - INFO - Epoch  50 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:56:35,197 - FGO - INFO - Epoch  60 | Train Loss: 0.067 | Val Loss: 0.11 | Val F1: 0.96 |
2023-09-02 20:56:35,222 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.96 |
2023-09-02 20:56:35,247 - FGO - INFO - Epoch  80 | Train Loss: 0.072 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:56:35,271 - FGO - INFO - Epoch  90 | Train Loss: 0.061 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:56:35,296 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:56:35,296 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.117 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:56:35,296 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:35,297 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:56:35,297 - CV - INFO - Begin OT Train
2023-09-02 20:56:35,298 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:35,409 - FGO - INFO - Epoch   0 | Train Loss: -1.861 | Val Loss: -0.03 | Val F1: 0.93 |
2023-09-02 20:56:36,433 - FGO - INFO - Epoch  10 | Train Loss: -2.310 | Val Loss: 0.07 | Val F1: 0.90 |
2023-09-02 20:56:37,238 - FGO - INFO - Epoch  20 | Train Loss: -2.448 | Val Loss: -0.00 | Val F1: 0.93 |
2023-09-02 20:56:38,001 - FGO - INFO - Epoch  30 | Train Loss: -2.561 | Val Loss: -0.04 | Val F1: 0.96 |
2023-09-02 20:56:38,765 - FGO - INFO - Epoch  40 | Train Loss: -2.615 | Val Loss: -0.07 | Val F1: 0.96 |
2023-09-02 20:56:39,521 - FGO - INFO - Best Epoch:  26 | Train Loss: -2.524 | Val Loss: -0.05 | Val F1: 0.96 |
2023-09-02 20:56:39,521 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:39,524 - CV - INFO - OT Train Complete, 26 epochs
2023-09-02 20:56:39,525 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:39,551 - FGO - INFO - Train CM:
[[391   9]
 [ 12 322]]
2023-09-02 20:56:39,552 - FGO - INFO - Val CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:56:39,552 - FGO - INFO - Test CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:56:39,557 - FGO - INFO - test statistical parity: 0.10661268556005393
2023-09-02 20:56:39,558 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:56:39,559 - FGO - INFO - test micro f1: 0.9571428571428572
2023-09-02 20:56:39,559 - FGO - INFO - test macro f1: 0.9571341090018372
2023-09-02 20:56:39,559 - CV - INFO - fold time: 4.61155104637146s (0.076859184106191m)
2023-09-02 20:56:39,559 - CV - INFO - ----- BEGINNING FOLD SET (020:9)----------------------------------------------------------
2023-09-02 20:56:39,561 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/020/9
2023-09-02 20:56:39,561 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:39,561 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:39,561 - FGO - INFO - 	done: False
2023-09-02 20:56:39,561 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:39,561 - FGO - INFO - 	h1: 64
2023-09-02 20:56:39,561 - FGO - INFO - 	h2: 32
2023-09-02 20:56:39,561 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:39,561 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:39,561 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:39,561 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:39,561 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:39,561 - FGO - INFO - 	theta: 30
2023-09-02 20:56:39,561 - FGO - INFO - 	clip: 5
2023-09-02 20:56:39,561 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:39,561 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:39,561 - FGO - INFO - Source Total: 725
2023-09-02 20:56:39,561 - FGO - INFO - Target Total: 79
2023-09-02 20:56:39,561 - FGO - INFO - Train Total: 725
2023-09-02 20:56:39,561 - FGO - INFO - Val Total:   79
2023-09-02 20:56:39,561 - FGO - INFO - Test Total:  79
2023-09-02 20:56:39,561 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:39,561 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:39,561 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:39,561 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:39,562 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:39,562 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:39,562 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:39,562 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:39,562 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:39,562 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:39,563 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:39,564 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:39,662 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:39,662 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:39,662 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:39,662 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:39,662 - FGO - INFO - N: 804
2023-09-02 20:56:39,663 - FGO - INFO - N_s: 725
2023-09-02 20:56:39,663 - FGO - INFO - N_t: 79
2023-09-02 20:56:39,666 - CV - INFO - Begin Pretrain
2023-09-02 20:56:39,666 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:39,669 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:56:39,709 - FGO - INFO - Epoch  10 | Train Loss: 0.471 | Val Loss: 0.48 | Val F1: 0.87 |
2023-09-02 20:56:39,739 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:56:39,764 - FGO - INFO - Epoch  30 | Train Loss: 0.102 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:56:39,789 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.21 | Val F1: 0.97 |
2023-09-02 20:56:39,813 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:56:39,837 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:56:39,862 - FGO - INFO - Epoch  70 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:56:39,886 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:56:39,911 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:56:39,935 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:56:39,935 - FGO - INFO - Best Epoch:  25 | Train Loss: 0.119 | Val Loss: 0.24 | Val F1: 0.97 
2023-09-02 20:56:39,935 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:39,937 - CV - INFO - Pretrain Complete, 25 epochs
2023-09-02 20:56:39,937 - CV - INFO - Begin OT Train
2023-09-02 20:56:39,937 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:40,053 - FGO - INFO - Epoch   0 | Train Loss: -1.884 | Val Loss: -0.11 | Val F1: 0.97 |
2023-09-02 20:56:40,978 - FGO - INFO - Epoch  10 | Train Loss: -2.306 | Val Loss: -0.16 | Val F1: 0.96 |
2023-09-02 20:56:41,770 - FGO - INFO - Epoch  20 | Train Loss: -2.484 | Val Loss: -0.15 | Val F1: 0.97 |
2023-09-02 20:56:42,612 - FGO - INFO - Epoch  30 | Train Loss: -2.567 | Val Loss: -0.18 | Val F1: 0.97 |
2023-09-02 20:56:43,364 - FGO - INFO - Epoch  40 | Train Loss: -2.617 | Val Loss: -0.17 | Val F1: 0.97 |
2023-09-02 20:56:44,112 - FGO - INFO - Best Epoch:   9 | Train Loss: -2.321 | Val Loss: -0.14 | Val F1: 0.97 |
2023-09-02 20:56:44,112 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:44,116 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:56:44,116 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:44,141 - FGO - INFO - Train CM:
[[377   8]
 [ 12 328]]
2023-09-02 20:56:44,141 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:56:44,141 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:56:44,146 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:56:44,147 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:56:44,148 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:56:44,148 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:56:44,148 - CV - INFO - fold time: 4.589095830917358s (0.0764849305152893m)
2023-09-02 20:56:44,148 - CV - INFO - Mean Pretrain Epochs 41.0:
2023-09-02 20:56:44,149 - CV - INFO - Mean OT Train Epochs 15.5:
2023-09-02 20:56:44,149 - CV - INFO - Mean Val Macro F1 : 0.9564841463552417
2023-09-02 20:56:44,149 - CV - INFO - Mean Eval Stat : 0.9564841463552417 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:56:44,149 - CV - INFO - set time: 47.82962918281555s (0.7971604863802592m)
2023-09-02 20:56:44,149 - CV - INFO - script time so far: 902.0997490882874s (15.034995818138123m) (0.2505832636356354h)
2023-09-02 20:56:44,149 - CV - INFO - ===== BEGINNING OPTION SET (021)==========================================================
2023-09-02 20:56:44,149 - CV - INFO - 	done: False
2023-09-02 20:56:44,149 - CV - INFO - 	learning_rate: 0.01
2023-09-02 20:56:44,149 - CV - INFO - 	h1: 64
2023-09-02 20:56:44,149 - CV - INFO - 	h2: 32
2023-09-02 20:56:44,149 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:44,149 - CV - INFO - 	dropout: 0.0
2023-09-02 20:56:44,149 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:44,149 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:44,149 - CV - INFO - 	lambda: 0.01
2023-09-02 20:56:44,149 - CV - INFO - 	theta: 50
2023-09-02 20:56:44,149 - CV - INFO - 	clip: 5
2023-09-02 20:56:44,149 - CV - INFO - ----- BEGINNING FOLD SET (021:0)----------------------------------------------------------
2023-09-02 20:56:44,151 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/021/0
2023-09-02 20:56:44,151 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:44,151 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:44,151 - FGO - INFO - 	done: False
2023-09-02 20:56:44,151 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:44,151 - FGO - INFO - 	h1: 64
2023-09-02 20:56:44,151 - FGO - INFO - 	h2: 32
2023-09-02 20:56:44,151 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:44,151 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:44,151 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:44,151 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:44,151 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:44,151 - FGO - INFO - 	theta: 50
2023-09-02 20:56:44,151 - FGO - INFO - 	clip: 5
2023-09-02 20:56:44,151 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:44,151 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:44,151 - FGO - INFO - Source Total: 708
2023-09-02 20:56:44,151 - FGO - INFO - Target Total: 96
2023-09-02 20:56:44,151 - FGO - INFO - Train Total: 708
2023-09-02 20:56:44,151 - FGO - INFO - Val Total:   96
2023-09-02 20:56:44,151 - FGO - INFO - Test Total:  96
2023-09-02 20:56:44,151 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:44,151 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:44,151 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:44,151 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:44,151 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:44,152 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:44,152 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:44,152 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:44,152 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:44,152 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:44,153 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:44,154 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:44,269 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:44,270 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:44,270 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:44,270 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:44,270 - FGO - INFO - N: 804
2023-09-02 20:56:44,270 - FGO - INFO - N_s: 708
2023-09-02 20:56:44,270 - FGO - INFO - N_t: 96
2023-09-02 20:56:44,273 - CV - INFO - Begin Pretrain
2023-09-02 20:56:44,273 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:44,277 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:56:44,305 - FGO - INFO - Epoch  10 | Train Loss: 0.421 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:56:44,333 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:56:44,361 - FGO - INFO - Epoch  30 | Train Loss: 0.103 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:56:44,388 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:56:44,425 - FGO - INFO - Epoch  50 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:56:44,450 - FGO - INFO - Epoch  60 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:56:44,474 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:56:44,498 - FGO - INFO - Epoch  80 | Train Loss: 0.058 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:56:44,532 - FGO - INFO - Epoch  90 | Train Loss: 0.058 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:56:44,565 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:56:44,566 - FGO - INFO - Best Epoch:  28 | Train Loss: 0.112 | Val Loss: 0.09 | Val F1: 0.99 
2023-09-02 20:56:44,566 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:44,567 - CV - INFO - Pretrain Complete, 28 epochs
2023-09-02 20:56:44,567 - CV - INFO - Begin OT Train
2023-09-02 20:56:44,567 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:44,662 - FGO - INFO - Epoch   0 | Train Loss: -3.211 | Val Loss: -0.31 | Val F1: 0.94 |
2023-09-02 20:56:45,677 - FGO - INFO - Epoch  10 | Train Loss: -3.887 | Val Loss: -0.38 | Val F1: 0.96 |
2023-09-02 20:56:46,530 - FGO - INFO - Epoch  20 | Train Loss: -4.209 | Val Loss: -0.43 | Val F1: 0.95 |
2023-09-02 20:56:47,358 - FGO - INFO - Epoch  30 | Train Loss: -4.325 | Val Loss: -0.50 | Val F1: 0.96 |
2023-09-02 20:56:48,146 - FGO - INFO - Epoch  40 | Train Loss: -4.400 | Val Loss: -0.55 | Val F1: 0.98 |
2023-09-02 20:56:48,888 - FGO - INFO - Best Epoch:  34 | Train Loss: -4.359 | Val Loss: -0.52 | Val F1: 0.98 |
2023-09-02 20:56:48,888 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:48,892 - CV - INFO - OT Train Complete, 34 epochs
2023-09-02 20:56:48,892 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:48,917 - FGO - INFO - Train CM:
[[372  10]
 [ 10 316]]
2023-09-02 20:56:48,917 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:56:48,918 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:56:48,923 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:56:48,924 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:56:48,925 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:56:48,926 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:56:48,926 - CV - INFO - fold time: 4.776730537414551s (0.07961217562357585m)
2023-09-02 20:56:48,926 - CV - INFO - ----- BEGINNING FOLD SET (021:1)----------------------------------------------------------
2023-09-02 20:56:48,927 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/021/1
2023-09-02 20:56:48,927 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:48,927 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:48,927 - FGO - INFO - 	done: False
2023-09-02 20:56:48,927 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:48,927 - FGO - INFO - 	h1: 64
2023-09-02 20:56:48,927 - FGO - INFO - 	h2: 32
2023-09-02 20:56:48,927 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:48,927 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:48,927 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:48,927 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:48,927 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:48,928 - FGO - INFO - 	theta: 50
2023-09-02 20:56:48,928 - FGO - INFO - 	clip: 5
2023-09-02 20:56:48,928 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:48,928 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:48,928 - FGO - INFO - Source Total: 727
2023-09-02 20:56:48,928 - FGO - INFO - Target Total: 77
2023-09-02 20:56:48,928 - FGO - INFO - Train Total: 727
2023-09-02 20:56:48,928 - FGO - INFO - Val Total:   77
2023-09-02 20:56:48,928 - FGO - INFO - Test Total:  77
2023-09-02 20:56:48,928 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:48,928 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:48,928 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:48,928 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:48,928 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:48,928 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:48,928 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:48,928 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:48,928 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:48,928 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:48,929 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:48,931 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:49,027 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:49,027 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:49,027 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:49,027 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:49,027 - FGO - INFO - N: 804
2023-09-02 20:56:49,027 - FGO - INFO - N_s: 727
2023-09-02 20:56:49,027 - FGO - INFO - N_t: 77
2023-09-02 20:56:49,030 - CV - INFO - Begin Pretrain
2023-09-02 20:56:49,030 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:49,034 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:56:49,058 - FGO - INFO - Epoch  10 | Train Loss: 0.472 | Val Loss: 0.55 | Val F1: 0.71 |
2023-09-02 20:56:49,083 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.27 | Val F1: 0.84 |
2023-09-02 20:56:49,108 - FGO - INFO - Epoch  30 | Train Loss: 0.091 | Val Loss: 0.17 | Val F1: 0.93 |
2023-09-02 20:56:49,133 - FGO - INFO - Epoch  40 | Train Loss: 0.080 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:56:49,157 - FGO - INFO - Epoch  50 | Train Loss: 0.067 | Val Loss: 0.20 | Val F1: 0.87 |
2023-09-02 20:56:49,182 - FGO - INFO - Epoch  60 | Train Loss: 0.061 | Val Loss: 0.22 | Val F1: 0.89 |
2023-09-02 20:56:49,206 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:56:49,231 - FGO - INFO - Epoch  80 | Train Loss: 0.054 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 20:56:49,256 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.22 | Val F1: 0.90 |
2023-09-02 20:56:49,280 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:56:49,280 - FGO - INFO - Best Epoch:  34 | Train Loss: 0.088 | Val Loss: 0.17 | Val F1: 0.95 
2023-09-02 20:56:49,280 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:49,282 - CV - INFO - Pretrain Complete, 34 epochs
2023-09-02 20:56:49,282 - CV - INFO - Begin OT Train
2023-09-02 20:56:49,282 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:49,396 - FGO - INFO - Epoch   0 | Train Loss: -3.025 | Val Loss: -0.13 | Val F1: 0.90 |
2023-09-02 20:56:50,207 - FGO - INFO - Epoch  10 | Train Loss: -3.884 | Val Loss: 0.01 | Val F1: 0.84 |
2023-09-02 20:56:50,972 - FGO - INFO - Epoch  20 | Train Loss: -4.145 | Val Loss: -0.11 | Val F1: 0.87 |
2023-09-02 20:56:51,756 - FGO - INFO - Epoch  30 | Train Loss: -4.330 | Val Loss: -0.16 | Val F1: 0.89 |
2023-09-02 20:56:52,513 - FGO - INFO - Epoch  40 | Train Loss: -4.429 | Val Loss: -0.19 | Val F1: 0.89 |
2023-09-02 20:56:53,206 - FGO - INFO - Best Epoch:  47 | Train Loss: -4.474 | Val Loss: -0.21 | Val F1: 0.92 |
2023-09-02 20:56:53,206 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:53,213 - CV - INFO - OT Train Complete, 47 epochs
2023-09-02 20:56:53,213 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:53,244 - FGO - INFO - Train CM:
[[379  11]
 [  8 329]]
2023-09-02 20:56:53,244 - FGO - INFO - Val CM:
[[42  2]
 [ 4 29]]
2023-09-02 20:56:53,244 - FGO - INFO - Test CM:
[[42  2]
 [ 4 29]]
2023-09-02 20:56:53,249 - FGO - INFO - test statistical parity: 0.2794871794871795
2023-09-02 20:56:53,251 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:56:53,251 - FGO - INFO - test micro f1: 0.922077922077922
2023-09-02 20:56:53,252 - FGO - INFO - test macro f1: 0.9197916666666666
2023-09-02 20:56:53,252 - CV - INFO - fold time: 4.326380968093872s (0.0721063494682312m)
2023-09-02 20:56:53,252 - CV - INFO - ----- BEGINNING FOLD SET (021:2)----------------------------------------------------------
2023-09-02 20:56:53,254 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/021/2
2023-09-02 20:56:53,254 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:53,254 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:53,254 - FGO - INFO - 	done: False
2023-09-02 20:56:53,254 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:53,254 - FGO - INFO - 	h1: 64
2023-09-02 20:56:53,254 - FGO - INFO - 	h2: 32
2023-09-02 20:56:53,254 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:53,254 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:53,254 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:53,254 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:53,254 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:53,254 - FGO - INFO - 	theta: 50
2023-09-02 20:56:53,254 - FGO - INFO - 	clip: 5
2023-09-02 20:56:53,254 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:53,254 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:53,254 - FGO - INFO - Source Total: 721
2023-09-02 20:56:53,254 - FGO - INFO - Target Total: 83
2023-09-02 20:56:53,254 - FGO - INFO - Train Total: 721
2023-09-02 20:56:53,254 - FGO - INFO - Val Total:   83
2023-09-02 20:56:53,254 - FGO - INFO - Test Total:  83
2023-09-02 20:56:53,254 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:53,254 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:53,254 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:53,254 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:53,254 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:53,255 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:53,255 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:53,255 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:53,255 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:53,255 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:53,256 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:53,257 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:53,359 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:53,359 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:53,359 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:53,359 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:53,359 - FGO - INFO - N: 804
2023-09-02 20:56:53,359 - FGO - INFO - N_s: 721
2023-09-02 20:56:53,359 - FGO - INFO - N_t: 83
2023-09-02 20:56:53,363 - CV - INFO - Begin Pretrain
2023-09-02 20:56:53,363 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:53,366 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:56:53,391 - FGO - INFO - Epoch  10 | Train Loss: 0.478 | Val Loss: 0.49 | Val F1: 0.84 |
2023-09-02 20:56:53,416 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.24 | Val F1: 0.87 |
2023-09-02 20:56:53,440 - FGO - INFO - Epoch  30 | Train Loss: 0.087 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:56:53,465 - FGO - INFO - Epoch  40 | Train Loss: 0.073 | Val Loss: 0.25 | Val F1: 0.90 |
2023-09-02 20:56:53,489 - FGO - INFO - Epoch  50 | Train Loss: 0.063 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:56:53,514 - FGO - INFO - Epoch  60 | Train Loss: 0.058 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:56:53,538 - FGO - INFO - Epoch  70 | Train Loss: 0.056 | Val Loss: 0.28 | Val F1: 0.91 |
2023-09-02 20:56:53,563 - FGO - INFO - Epoch  80 | Train Loss: 0.052 | Val Loss: 0.28 | Val F1: 0.88 |
2023-09-02 20:56:53,587 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.28 | Val F1: 0.89 |
2023-09-02 20:56:53,612 - FGO - INFO - Epoch 100 | Train Loss: 0.046 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:56:53,612 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.058 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:56:53,612 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:53,613 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:56:53,613 - CV - INFO - Begin OT Train
2023-09-02 20:56:53,613 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:53,746 - FGO - INFO - Epoch   0 | Train Loss: -2.923 | Val Loss: -0.05 | Val F1: 0.90 |
2023-09-02 20:56:54,721 - FGO - INFO - Epoch  10 | Train Loss: -3.962 | Val Loss: -0.04 | Val F1: 0.89 |
2023-09-02 20:56:55,584 - FGO - INFO - Epoch  20 | Train Loss: -4.321 | Val Loss: -0.20 | Val F1: 0.91 |
2023-09-02 20:56:56,368 - FGO - INFO - Epoch  30 | Train Loss: -4.441 | Val Loss: -0.18 | Val F1: 0.90 |
2023-09-02 20:56:57,203 - FGO - INFO - Epoch  40 | Train Loss: -4.501 | Val Loss: -0.14 | Val F1: 0.90 |
2023-09-02 20:56:57,902 - FGO - INFO - Best Epoch:  20 | Train Loss: -4.321 | Val Loss: -0.20 | Val F1: 0.91 |
2023-09-02 20:56:57,902 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:57,906 - CV - INFO - OT Train Complete, 20 epochs
2023-09-02 20:56:57,907 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:56:57,954 - FGO - INFO - Train CM:
[[378   6]
 [  8 329]]
2023-09-02 20:56:57,954 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:56:57,954 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:56:57,959 - FGO - INFO - test statistical parity: 0.02230046948356812
2023-09-02 20:56:57,960 - FGO - INFO - test equal opportunity: 0.2592592592592593
2023-09-02 20:56:57,961 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:56:57,961 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:56:57,961 - CV - INFO - fold time: 4.709378719329834s (0.0784896453221639m)
2023-09-02 20:56:57,961 - CV - INFO - ----- BEGINNING FOLD SET (021:3)----------------------------------------------------------
2023-09-02 20:56:57,963 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/021/3
2023-09-02 20:56:57,963 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:56:57,963 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:56:57,963 - FGO - INFO - 	done: False
2023-09-02 20:56:57,963 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:56:57,963 - FGO - INFO - 	h1: 64
2023-09-02 20:56:57,963 - FGO - INFO - 	h2: 32
2023-09-02 20:56:57,963 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:56:57,963 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:56:57,963 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:56:57,963 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:56:57,963 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:56:57,963 - FGO - INFO - 	theta: 50
2023-09-02 20:56:57,963 - FGO - INFO - 	clip: 5
2023-09-02 20:56:57,963 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:56:57,963 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:56:57,963 - FGO - INFO - Source Total: 729
2023-09-02 20:56:57,964 - FGO - INFO - Target Total: 75
2023-09-02 20:56:57,964 - FGO - INFO - Train Total: 729
2023-09-02 20:56:57,964 - FGO - INFO - Val Total:   75
2023-09-02 20:56:57,964 - FGO - INFO - Test Total:  75
2023-09-02 20:56:57,964 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:56:57,964 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:56:57,964 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:56:57,964 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:56:57,964 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:56:57,964 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:56:57,964 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:56:57,964 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:56:57,964 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:56:57,964 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:56:57,965 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:56:57,966 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:56:58,061 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:56:58,061 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:56:58,061 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:56:58,061 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:56:58,062 - FGO - INFO - N: 804
2023-09-02 20:56:58,062 - FGO - INFO - N_s: 729
2023-09-02 20:56:58,062 - FGO - INFO - N_t: 75
2023-09-02 20:56:58,065 - CV - INFO - Begin Pretrain
2023-09-02 20:56:58,065 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:56:58,069 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:56:58,098 - FGO - INFO - Epoch  10 | Train Loss: 0.431 | Val Loss: 0.36 | Val F1: 0.93 |
2023-09-02 20:56:58,126 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:56:58,154 - FGO - INFO - Epoch  30 | Train Loss: 0.109 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:56:58,182 - FGO - INFO - Epoch  40 | Train Loss: 0.093 | Val Loss: 0.03 | Val F1: 0.99 |
2023-09-02 20:56:58,210 - FGO - INFO - Epoch  50 | Train Loss: 0.080 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:56:58,236 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:56:58,261 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:56:58,285 - FGO - INFO - Epoch  80 | Train Loss: 0.065 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:56:58,310 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:56:58,335 - FGO - INFO - Epoch 100 | Train Loss: 0.069 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:56:58,335 - FGO - INFO - Best Epoch:  27 | Train Loss: 0.114 | Val Loss: 0.03 | Val F1: 1.00 
2023-09-02 20:56:58,335 - FGO - INFO - Setting model to best state.
2023-09-02 20:56:58,336 - CV - INFO - Pretrain Complete, 27 epochs
2023-09-02 20:56:58,336 - CV - INFO - Begin OT Train
2023-09-02 20:56:58,336 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:56:58,449 - FGO - INFO - Epoch   0 | Train Loss: -2.960 | Val Loss: -0.30 | Val F1: 0.97 |
2023-09-02 20:56:59,357 - FGO - INFO - Epoch  10 | Train Loss: -3.982 | Val Loss: -0.21 | Val F1: 0.89 |
2023-09-02 20:57:00,195 - FGO - INFO - Epoch  20 | Train Loss: -4.180 | Val Loss: -0.24 | Val F1: 0.97 |
2023-09-02 20:57:00,986 - FGO - INFO - Epoch  30 | Train Loss: -4.358 | Val Loss: -0.37 | Val F1: 0.97 |
2023-09-02 20:57:01,804 - FGO - INFO - Epoch  40 | Train Loss: -4.440 | Val Loss: -0.37 | Val F1: 0.97 |
2023-09-02 20:57:02,551 - FGO - INFO - Best Epoch:   6 | Train Loss: -3.535 | Val Loss: -0.28 | Val F1: 0.97 |
2023-09-02 20:57:02,551 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:02,555 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:57:02,555 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:02,579 - FGO - INFO - Train CM:
[[387   9]
 [ 12 321]]
2023-09-02 20:57:02,579 - FGO - INFO - Val CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:57:02,580 - FGO - INFO - Test CM:
[[38  0]
 [ 2 35]]
2023-09-02 20:57:02,584 - FGO - INFO - test statistical parity: 0.046838407494145196
2023-09-02 20:57:02,585 - FGO - INFO - test equal opportunity: 0.10952380952380958
2023-09-02 20:57:02,586 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 20:57:02,587 - FGO - INFO - test macro f1: 0.9732905982905983
2023-09-02 20:57:02,587 - CV - INFO - fold time: 4.6253392696380615s (0.07708898782730103m)
2023-09-02 20:57:02,587 - CV - INFO - ----- BEGINNING FOLD SET (021:4)----------------------------------------------------------
2023-09-02 20:57:02,588 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/021/4
2023-09-02 20:57:02,589 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:02,589 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:02,589 - FGO - INFO - 	done: False
2023-09-02 20:57:02,589 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:02,589 - FGO - INFO - 	h1: 64
2023-09-02 20:57:02,589 - FGO - INFO - 	h2: 32
2023-09-02 20:57:02,589 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:02,589 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:02,589 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:02,589 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:02,589 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:57:02,589 - FGO - INFO - 	theta: 50
2023-09-02 20:57:02,589 - FGO - INFO - 	clip: 5
2023-09-02 20:57:02,589 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:02,589 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:02,589 - FGO - INFO - Source Total: 732
2023-09-02 20:57:02,589 - FGO - INFO - Target Total: 72
2023-09-02 20:57:02,589 - FGO - INFO - Train Total: 732
2023-09-02 20:57:02,589 - FGO - INFO - Val Total:   72
2023-09-02 20:57:02,589 - FGO - INFO - Test Total:  72
2023-09-02 20:57:02,589 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:02,589 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:02,589 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:02,589 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:02,589 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:02,590 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:02,590 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:02,590 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:02,590 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:02,590 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:02,591 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:02,592 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:02,683 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:02,683 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:02,683 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:02,683 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:02,683 - FGO - INFO - N: 804
2023-09-02 20:57:02,683 - FGO - INFO - N_s: 732
2023-09-02 20:57:02,683 - FGO - INFO - N_t: 72
2023-09-02 20:57:02,687 - CV - INFO - Begin Pretrain
2023-09-02 20:57:02,687 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:02,690 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:57:02,715 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.46 | Val F1: 0.81 |
2023-09-02 20:57:02,740 - FGO - INFO - Epoch  20 | Train Loss: 0.141 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:57:02,764 - FGO - INFO - Epoch  30 | Train Loss: 0.100 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:57:02,789 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:57:02,814 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:57:02,838 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 20:57:02,863 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:57:02,887 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:57:02,912 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:57:02,937 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:57:02,937 - FGO - INFO - Best Epoch:  64 | Train Loss: 0.069 | Val Loss: 0.06 | Val F1: 0.99 
2023-09-02 20:57:02,937 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:02,938 - CV - INFO - Pretrain Complete, 64 epochs
2023-09-02 20:57:02,938 - CV - INFO - Begin OT Train
2023-09-02 20:57:02,938 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:03,066 - FGO - INFO - Epoch   0 | Train Loss: -3.370 | Val Loss: -0.30 | Val F1: 0.99 |
2023-09-02 20:57:03,925 - FGO - INFO - Epoch  10 | Train Loss: -4.186 | Val Loss: -0.30 | Val F1: 0.99 |
2023-09-02 20:57:04,710 - FGO - INFO - Epoch  20 | Train Loss: -4.394 | Val Loss: -0.36 | Val F1: 0.99 |
2023-09-02 20:57:05,560 - FGO - INFO - Epoch  30 | Train Loss: -4.475 | Val Loss: -0.39 | Val F1: 0.99 |
2023-09-02 20:57:06,343 - FGO - INFO - Epoch  40 | Train Loss: -4.515 | Val Loss: -0.39 | Val F1: 0.99 |
2023-09-02 20:57:07,083 - FGO - INFO - Best Epoch:   6 | Train Loss: -4.076 | Val Loss: -0.34 | Val F1: 0.99 |
2023-09-02 20:57:07,083 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:07,087 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:57:07,087 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:07,113 - FGO - INFO - Train CM:
[[387  10]
 [ 11 324]]
2023-09-02 20:57:07,114 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:57:07,114 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:57:07,120 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:57:07,121 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:57:07,122 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:57:07,122 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:57:07,122 - CV - INFO - fold time: 4.535533666610718s (0.0755922277768453m)
2023-09-02 20:57:07,122 - CV - INFO - ----- BEGINNING FOLD SET (021:5)----------------------------------------------------------
2023-09-02 20:57:07,124 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/021/5
2023-09-02 20:57:07,124 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:07,124 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:07,124 - FGO - INFO - 	done: False
2023-09-02 20:57:07,124 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:07,124 - FGO - INFO - 	h1: 64
2023-09-02 20:57:07,124 - FGO - INFO - 	h2: 32
2023-09-02 20:57:07,124 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:07,124 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:07,124 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:07,124 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:07,124 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:57:07,124 - FGO - INFO - 	theta: 50
2023-09-02 20:57:07,124 - FGO - INFO - 	clip: 5
2023-09-02 20:57:07,124 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:07,124 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:07,124 - FGO - INFO - Source Total: 726
2023-09-02 20:57:07,124 - FGO - INFO - Target Total: 78
2023-09-02 20:57:07,124 - FGO - INFO - Train Total: 726
2023-09-02 20:57:07,124 - FGO - INFO - Val Total:   78
2023-09-02 20:57:07,124 - FGO - INFO - Test Total:  78
2023-09-02 20:57:07,124 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:07,124 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:07,124 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:07,124 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:07,124 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:07,125 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:07,125 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:07,125 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:07,125 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:07,125 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:07,126 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:07,127 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:07,225 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:07,225 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:07,225 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:07,225 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:07,225 - FGO - INFO - N: 804
2023-09-02 20:57:07,225 - FGO - INFO - N_s: 726
2023-09-02 20:57:07,225 - FGO - INFO - N_t: 78
2023-09-02 20:57:07,229 - CV - INFO - Begin Pretrain
2023-09-02 20:57:07,229 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:07,232 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:57:07,257 - FGO - INFO - Epoch  10 | Train Loss: 0.515 | Val Loss: 0.52 | Val F1: 0.82 |
2023-09-02 20:57:07,282 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:57:07,306 - FGO - INFO - Epoch  30 | Train Loss: 0.106 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:57:07,330 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.13 | Val F1: 0.95 |
2023-09-02 20:57:07,355 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:57:07,379 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.09 | Val F1: 0.95 |
2023-09-02 20:57:07,404 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:57:07,428 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 20:57:07,453 - FGO - INFO - Epoch  90 | Train Loss: 0.064 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:57:07,477 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:57:07,477 - FGO - INFO - Best Epoch:  55 | Train Loss: 0.077 | Val Loss: 0.09 | Val F1: 0.97 
2023-09-02 20:57:07,477 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:07,478 - CV - INFO - Pretrain Complete, 55 epochs
2023-09-02 20:57:07,478 - CV - INFO - Begin OT Train
2023-09-02 20:57:07,478 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:07,589 - FGO - WARNING - long running sinkhorn (1000), u_diff: 1.2000842275483592e-07
2023-09-02 20:57:07,677 - FGO - WARNING - long running sinkhorn (2000), u_diff: 1.220751641994866e-07
2023-09-02 20:57:07,764 - FGO - WARNING - long running sinkhorn (3000), u_diff: 1.2252235137566458e-07
2023-09-02 20:57:07,853 - FGO - WARNING - long running sinkhorn (4000), u_diff: 1.285722106558751e-07
2023-09-02 20:57:07,940 - FGO - WARNING - long running sinkhorn (5000), u_diff: 1.2614884781214641e-07
2023-09-02 20:57:08,028 - FGO - WARNING - long running sinkhorn (6000), u_diff: 1.1975842539868609e-07
2023-09-02 20:57:08,115 - FGO - WARNING - long running sinkhorn (7000), u_diff: 1.301411032272881e-07
2023-09-02 20:57:08,203 - FGO - WARNING - long running sinkhorn (8000), u_diff: 1.2122733039632294e-07
2023-09-02 20:57:08,290 - FGO - WARNING - long running sinkhorn (9000), u_diff: 1.3027370471263566e-07
2023-09-02 20:57:08,378 - FGO - WARNING - long running sinkhorn (10000), u_diff: 1.240372000665957e-07
2023-09-02 20:57:08,378 - FGO - WARNING - large sinkhorn itter (10000)
2023-09-02 20:57:08,887 - FGO - INFO - Epoch   0 | Train Loss: -2.823 | Val Loss: -0.24 | Val F1: 0.95 |
2023-09-02 20:57:09,855 - FGO - INFO - Epoch  10 | Train Loss: -4.013 | Val Loss: -0.04 | Val F1: 0.81 |
2023-09-02 20:57:10,613 - FGO - INFO - Epoch  20 | Train Loss: -4.220 | Val Loss: -0.15 | Val F1: 0.91 |
2023-09-02 20:57:11,458 - FGO - INFO - Epoch  30 | Train Loss: -4.372 | Val Loss: -0.19 | Val F1: 0.91 |
2023-09-02 20:57:12,242 - FGO - INFO - Epoch  40 | Train Loss: -4.433 | Val Loss: -0.21 | Val F1: 0.92 |
2023-09-02 20:57:12,983 - FGO - INFO - Best Epoch:   6 | Train Loss: -3.736 | Val Loss: -0.27 | Val F1: 0.95 |
2023-09-02 20:57:12,983 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:12,987 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:57:12,987 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:13,012 - FGO - INFO - Train CM:
[[396   4]
 [ 25 301]]
2023-09-02 20:57:13,012 - FGO - INFO - Val CM:
[[34  0]
 [ 6 38]]
2023-09-02 20:57:13,013 - FGO - INFO - Test CM:
[[34  0]
 [ 6 38]]
2023-09-02 20:57:13,018 - FGO - INFO - test statistical parity: 0.07729468599033817
2023-09-02 20:57:13,019 - FGO - INFO - test equal opportunity: 0.15384615384615385
2023-09-02 20:57:13,020 - FGO - INFO - test micro f1: 0.9230769230769231
2023-09-02 20:57:13,020 - FGO - INFO - test macro f1: 0.9228740936058009
2023-09-02 20:57:13,020 - CV - INFO - fold time: 5.897996187210083s (0.09829993645350138m)
2023-09-02 20:57:13,020 - CV - INFO - ----- BEGINNING FOLD SET (021:6)----------------------------------------------------------
2023-09-02 20:57:13,022 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/021/6
2023-09-02 20:57:13,022 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:13,022 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:13,022 - FGO - INFO - 	done: False
2023-09-02 20:57:13,022 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:13,022 - FGO - INFO - 	h1: 64
2023-09-02 20:57:13,022 - FGO - INFO - 	h2: 32
2023-09-02 20:57:13,022 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:13,022 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:13,022 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:13,022 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:13,022 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:57:13,022 - FGO - INFO - 	theta: 50
2023-09-02 20:57:13,022 - FGO - INFO - 	clip: 5
2023-09-02 20:57:13,022 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:13,022 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:13,022 - FGO - INFO - Source Total: 717
2023-09-02 20:57:13,022 - FGO - INFO - Target Total: 87
2023-09-02 20:57:13,022 - FGO - INFO - Train Total: 717
2023-09-02 20:57:13,022 - FGO - INFO - Val Total:   87
2023-09-02 20:57:13,022 - FGO - INFO - Test Total:  87
2023-09-02 20:57:13,022 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:13,022 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:13,022 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:13,022 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:13,023 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:13,023 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:13,023 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:13,023 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:13,023 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:13,023 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:13,024 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:13,025 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:13,131 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:13,131 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:13,131 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:13,131 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:13,131 - FGO - INFO - N: 804
2023-09-02 20:57:13,131 - FGO - INFO - N_s: 717
2023-09-02 20:57:13,131 - FGO - INFO - N_t: 87
2023-09-02 20:57:13,135 - CV - INFO - Begin Pretrain
2023-09-02 20:57:13,135 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:13,138 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:57:13,167 - FGO - INFO - Epoch  10 | Train Loss: 0.496 | Val Loss: 0.48 | Val F1: 0.80 |
2023-09-02 20:57:13,195 - FGO - INFO - Epoch  20 | Train Loss: 0.161 | Val Loss: 0.13 | Val F1: 0.93 |
2023-09-02 20:57:13,222 - FGO - INFO - Epoch  30 | Train Loss: 0.108 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:57:13,248 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.09 | Val F1: 0.98 |
2023-09-02 20:57:13,272 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:57:13,296 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:57:13,321 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:57:13,345 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:57:13,369 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:57:13,394 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:57:13,394 - FGO - INFO - Best Epoch:  73 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 1.00 
2023-09-02 20:57:13,394 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:13,395 - CV - INFO - Pretrain Complete, 73 epochs
2023-09-02 20:57:13,395 - CV - INFO - Begin OT Train
2023-09-02 20:57:13,395 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:13,518 - FGO - INFO - Epoch   0 | Train Loss: -3.397 | Val Loss: -0.40 | Val F1: 1.00 |
2023-09-02 20:57:14,423 - FGO - INFO - Epoch  10 | Train Loss: -4.047 | Val Loss: -0.42 | Val F1: 0.97 |
2023-09-02 20:57:15,276 - FGO - INFO - Epoch  20 | Train Loss: -4.244 | Val Loss: -0.44 | Val F1: 0.99 |
2023-09-02 20:57:16,017 - FGO - INFO - Epoch  30 | Train Loss: -4.359 | Val Loss: -0.51 | Val F1: 0.98 |
2023-09-02 20:57:16,797 - FGO - INFO - Epoch  40 | Train Loss: -4.427 | Val Loss: -0.53 | Val F1: 0.99 |
2023-09-02 20:57:17,488 - FGO - INFO - Best Epoch:  31 | Train Loss: -4.370 | Val Loss: -0.51 | Val F1: 0.99 |
2023-09-02 20:57:17,488 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:17,492 - CV - INFO - OT Train Complete, 31 epochs
2023-09-02 20:57:17,492 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:17,521 - FGO - INFO - Train CM:
[[376   9]
 [ 12 320]]
2023-09-02 20:57:17,521 - FGO - INFO - Val CM:
[[47  2]
 [ 0 38]]
2023-09-02 20:57:17,521 - FGO - INFO - Test CM:
[[47  2]
 [ 0 38]]
2023-09-02 20:57:17,526 - FGO - INFO - test statistical parity: 0.044303797468354444
2023-09-02 20:57:17,528 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:57:17,529 - FGO - INFO - test micro f1: 0.9770114942528736
2023-09-02 20:57:17,529 - FGO - INFO - test macro f1: 0.9767628205128205
2023-09-02 20:57:17,529 - CV - INFO - fold time: 4.508722543716431s (0.07514537572860717m)
2023-09-02 20:57:17,529 - CV - INFO - ----- BEGINNING FOLD SET (021:7)----------------------------------------------------------
2023-09-02 20:57:17,531 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/021/7
2023-09-02 20:57:17,531 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:17,531 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:17,531 - FGO - INFO - 	done: False
2023-09-02 20:57:17,531 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:17,531 - FGO - INFO - 	h1: 64
2023-09-02 20:57:17,531 - FGO - INFO - 	h2: 32
2023-09-02 20:57:17,531 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:17,531 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:17,531 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:17,531 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:17,531 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:57:17,531 - FGO - INFO - 	theta: 50
2023-09-02 20:57:17,531 - FGO - INFO - 	clip: 5
2023-09-02 20:57:17,531 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:17,531 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:17,531 - FGO - INFO - Source Total: 717
2023-09-02 20:57:17,531 - FGO - INFO - Target Total: 87
2023-09-02 20:57:17,531 - FGO - INFO - Train Total: 717
2023-09-02 20:57:17,531 - FGO - INFO - Val Total:   87
2023-09-02 20:57:17,531 - FGO - INFO - Test Total:  87
2023-09-02 20:57:17,531 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:17,531 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:17,531 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:17,531 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:17,531 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:17,532 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:17,532 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:17,532 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:17,532 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:17,532 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:17,533 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:17,534 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:17,640 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:17,640 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:17,640 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:17,640 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:17,640 - FGO - INFO - N: 804
2023-09-02 20:57:17,640 - FGO - INFO - N_s: 717
2023-09-02 20:57:17,640 - FGO - INFO - N_t: 87
2023-09-02 20:57:17,644 - CV - INFO - Begin Pretrain
2023-09-02 20:57:17,644 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:17,647 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:57:17,672 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.49 | Val F1: 0.86 |
2023-09-02 20:57:17,696 - FGO - INFO - Epoch  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 |
2023-09-02 20:57:17,721 - FGO - INFO - Epoch  30 | Train Loss: 0.097 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:57:17,746 - FGO - INFO - Epoch  40 | Train Loss: 0.081 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:57:17,770 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:57:17,795 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:57:17,819 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:57:17,844 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:57:17,868 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:57:17,892 - FGO - INFO - Epoch 100 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.95 |
2023-09-02 20:57:17,893 - FGO - INFO - Best Epoch:  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 
2023-09-02 20:57:17,893 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:17,894 - CV - INFO - Pretrain Complete, 20 epochs
2023-09-02 20:57:17,894 - CV - INFO - Begin OT Train
2023-09-02 20:57:17,894 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:18,003 - FGO - INFO - Epoch   0 | Train Loss: -3.287 | Val Loss: -0.25 | Val F1: 0.95 |
2023-09-02 20:57:18,903 - FGO - INFO - Epoch  10 | Train Loss: -4.071 | Val Loss: -0.25 | Val F1: 0.88 |
2023-09-02 20:57:19,720 - FGO - INFO - Epoch  20 | Train Loss: -4.301 | Val Loss: -0.33 | Val F1: 0.93 |
2023-09-02 20:57:20,501 - FGO - INFO - Epoch  30 | Train Loss: -4.429 | Val Loss: -0.38 | Val F1: 0.95 |
2023-09-02 20:57:21,270 - FGO - INFO - Epoch  40 | Train Loss: -4.484 | Val Loss: -0.36 | Val F1: 0.95 |
2023-09-02 20:57:21,965 - FGO - INFO - Best Epoch:   7 | Train Loss: -4.020 | Val Loss: -0.32 | Val F1: 0.95 |
2023-09-02 20:57:21,966 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:21,969 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:57:21,969 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:21,994 - FGO - INFO - Train CM:
[[378   9]
 [ 13 317]]
2023-09-02 20:57:21,994 - FGO - INFO - Val CM:
[[46  1]
 [ 3 37]]
2023-09-02 20:57:21,995 - FGO - INFO - Test CM:
[[46  1]
 [ 3 37]]
2023-09-02 20:57:22,000 - FGO - INFO - test statistical parity: 0.36333333333333334
2023-09-02 20:57:22,001 - FGO - INFO - test equal opportunity: 0.09677419354838712
2023-09-02 20:57:22,002 - FGO - INFO - test micro f1: 0.9540229885057472
2023-09-02 20:57:22,002 - FGO - INFO - test macro f1: 0.9535256410256411
2023-09-02 20:57:22,002 - CV - INFO - fold time: 4.47334623336792s (0.074555770556132m)
2023-09-02 20:57:22,002 - CV - INFO - ----- BEGINNING FOLD SET (021:8)----------------------------------------------------------
2023-09-02 20:57:22,004 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/021/8
2023-09-02 20:57:22,004 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:22,004 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:22,004 - FGO - INFO - 	done: False
2023-09-02 20:57:22,004 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:22,004 - FGO - INFO - 	h1: 64
2023-09-02 20:57:22,004 - FGO - INFO - 	h2: 32
2023-09-02 20:57:22,004 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:22,004 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:22,004 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:22,004 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:22,004 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:57:22,004 - FGO - INFO - 	theta: 50
2023-09-02 20:57:22,004 - FGO - INFO - 	clip: 5
2023-09-02 20:57:22,004 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:22,004 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:22,005 - FGO - INFO - Source Total: 734
2023-09-02 20:57:22,005 - FGO - INFO - Target Total: 70
2023-09-02 20:57:22,005 - FGO - INFO - Train Total: 734
2023-09-02 20:57:22,005 - FGO - INFO - Val Total:   70
2023-09-02 20:57:22,005 - FGO - INFO - Test Total:  70
2023-09-02 20:57:22,005 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:22,005 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:22,005 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:22,005 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:22,005 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:22,005 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:22,005 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:22,005 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:22,005 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:22,005 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:22,006 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:22,007 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:22,096 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:22,096 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:22,096 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:22,096 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:22,096 - FGO - INFO - N: 804
2023-09-02 20:57:22,096 - FGO - INFO - N_s: 734
2023-09-02 20:57:22,096 - FGO - INFO - N_t: 70
2023-09-02 20:57:22,100 - CV - INFO - Begin Pretrain
2023-09-02 20:57:22,100 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:22,103 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:57:22,129 - FGO - INFO - Epoch  10 | Train Loss: 0.450 | Val Loss: 0.48 | Val F1: 0.81 |
2023-09-02 20:57:22,154 - FGO - INFO - Epoch  20 | Train Loss: 0.149 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:57:22,178 - FGO - INFO - Epoch  30 | Train Loss: 0.104 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:57:22,203 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:57:22,228 - FGO - INFO - Epoch  50 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:57:22,253 - FGO - INFO - Epoch  60 | Train Loss: 0.067 | Val Loss: 0.11 | Val F1: 0.96 |
2023-09-02 20:57:22,278 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.96 |
2023-09-02 20:57:22,302 - FGO - INFO - Epoch  80 | Train Loss: 0.072 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:57:22,327 - FGO - INFO - Epoch  90 | Train Loss: 0.061 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:57:22,352 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:57:22,352 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.117 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:57:22,352 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:22,353 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:57:22,353 - CV - INFO - Begin OT Train
2023-09-02 20:57:22,353 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:22,442 - FGO - INFO - Epoch   0 | Train Loss: -3.201 | Val Loss: -0.16 | Val F1: 0.93 |
2023-09-02 20:57:23,417 - FGO - INFO - Epoch  10 | Train Loss: -4.057 | Val Loss: -0.09 | Val F1: 0.90 |
2023-09-02 20:57:24,195 - FGO - INFO - Epoch  20 | Train Loss: -4.215 | Val Loss: -0.15 | Val F1: 0.91 |
2023-09-02 20:57:24,967 - FGO - INFO - Epoch  30 | Train Loss: -4.372 | Val Loss: -0.22 | Val F1: 0.96 |
2023-09-02 20:57:25,783 - FGO - INFO - Epoch  40 | Train Loss: -4.462 | Val Loss: -0.24 | Val F1: 0.96 |
2023-09-02 20:57:26,512 - FGO - INFO - Best Epoch:   8 | Train Loss: -3.978 | Val Loss: -0.19 | Val F1: 0.96 |
2023-09-02 20:57:26,512 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:26,515 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 20:57:26,515 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:26,540 - FGO - INFO - Train CM:
[[391   9]
 [ 11 323]]
2023-09-02 20:57:26,541 - FGO - INFO - Val CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:57:26,541 - FGO - INFO - Test CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:57:26,546 - FGO - INFO - test statistical parity: 0.10661268556005393
2023-09-02 20:57:26,547 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:57:26,548 - FGO - INFO - test micro f1: 0.9571428571428572
2023-09-02 20:57:26,549 - FGO - INFO - test macro f1: 0.9571341090018372
2023-09-02 20:57:26,549 - CV - INFO - fold time: 4.546411514282227s (0.07577352523803711m)
2023-09-02 20:57:26,549 - CV - INFO - ----- BEGINNING FOLD SET (021:9)----------------------------------------------------------
2023-09-02 20:57:26,551 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/021/9
2023-09-02 20:57:26,551 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:26,551 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:26,551 - FGO - INFO - 	done: False
2023-09-02 20:57:26,551 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:26,551 - FGO - INFO - 	h1: 64
2023-09-02 20:57:26,551 - FGO - INFO - 	h2: 32
2023-09-02 20:57:26,551 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:26,551 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:26,551 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:26,551 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:26,551 - FGO - INFO - 	lambda: 0.01
2023-09-02 20:57:26,551 - FGO - INFO - 	theta: 50
2023-09-02 20:57:26,551 - FGO - INFO - 	clip: 5
2023-09-02 20:57:26,551 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:26,551 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:26,551 - FGO - INFO - Source Total: 725
2023-09-02 20:57:26,551 - FGO - INFO - Target Total: 79
2023-09-02 20:57:26,551 - FGO - INFO - Train Total: 725
2023-09-02 20:57:26,551 - FGO - INFO - Val Total:   79
2023-09-02 20:57:26,551 - FGO - INFO - Test Total:  79
2023-09-02 20:57:26,551 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:26,551 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:26,551 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:26,551 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:26,551 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:26,552 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:26,552 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:26,552 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:26,552 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:26,552 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:26,553 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:26,554 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:26,652 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:26,652 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:26,652 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:26,652 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:26,652 - FGO - INFO - N: 804
2023-09-02 20:57:26,652 - FGO - INFO - N_s: 725
2023-09-02 20:57:26,652 - FGO - INFO - N_t: 79
2023-09-02 20:57:26,656 - CV - INFO - Begin Pretrain
2023-09-02 20:57:26,656 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:26,659 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:57:26,684 - FGO - INFO - Epoch  10 | Train Loss: 0.471 | Val Loss: 0.48 | Val F1: 0.87 |
2023-09-02 20:57:26,709 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:57:26,733 - FGO - INFO - Epoch  30 | Train Loss: 0.102 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:57:26,758 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.21 | Val F1: 0.97 |
2023-09-02 20:57:26,782 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:57:26,807 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:57:26,831 - FGO - INFO - Epoch  70 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:57:26,855 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:57:26,880 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:57:26,904 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:57:26,904 - FGO - INFO - Best Epoch:  25 | Train Loss: 0.119 | Val Loss: 0.24 | Val F1: 0.97 
2023-09-02 20:57:26,904 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:26,906 - CV - INFO - Pretrain Complete, 25 epochs
2023-09-02 20:57:26,906 - CV - INFO - Begin OT Train
2023-09-02 20:57:26,906 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:27,032 - FGO - INFO - Epoch   0 | Train Loss: -3.212 | Val Loss: -0.25 | Val F1: 0.97 |
2023-09-02 20:57:27,966 - FGO - INFO - Epoch  10 | Train Loss: -4.059 | Val Loss: -0.26 | Val F1: 0.91 |
2023-09-02 20:57:28,795 - FGO - INFO - Epoch  20 | Train Loss: -4.244 | Val Loss: -0.34 | Val F1: 0.99 |
2023-09-02 20:57:29,567 - FGO - INFO - Epoch  30 | Train Loss: -4.365 | Val Loss: -0.41 | Val F1: 0.99 |
2023-09-02 20:57:30,452 - FGO - INFO - Epoch  40 | Train Loss: -4.440 | Val Loss: -0.40 | Val F1: 0.96 |
2023-09-02 20:57:31,162 - FGO - INFO - Best Epoch:  17 | Train Loss: -4.146 | Val Loss: -0.26 | Val F1: 0.99 |
2023-09-02 20:57:31,163 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:31,166 - CV - INFO - OT Train Complete, 17 epochs
2023-09-02 20:57:31,166 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:31,192 - FGO - INFO - Train CM:
[[377   8]
 [ 12 328]]
2023-09-02 20:57:31,192 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:57:31,193 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:57:31,197 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:57:31,199 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:57:31,200 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:57:31,200 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:57:31,200 - CV - INFO - fold time: 4.65123176574707s (0.07752052942911784m)
2023-09-02 20:57:31,200 - CV - INFO - Mean Pretrain Epochs 41.0:
2023-09-02 20:57:31,200 - CV - INFO - Mean OT Train Epochs 18.2:
2023-09-02 20:57:31,200 - CV - INFO - Mean Val Macro F1 : 0.9541252256853416
2023-09-02 20:57:31,200 - CV - INFO - Mean Eval Stat : 0.9541252256853416 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:57:31,200 - CV - INFO - set time: 47.05162167549133s (0.7841936945915222m)
2023-09-02 20:57:31,200 - CV - INFO - script time so far: 949.1514139175415s (15.819190231959025m) (0.2636531705326504h)
2023-09-02 20:57:31,200 - CV - INFO - ===== BEGINNING OPTION SET (022)==========================================================
2023-09-02 20:57:31,200 - CV - INFO - 	done: False
2023-09-02 20:57:31,200 - CV - INFO - 	learning_rate: 0.01
2023-09-02 20:57:31,200 - CV - INFO - 	h1: 64
2023-09-02 20:57:31,200 - CV - INFO - 	h2: 32
2023-09-02 20:57:31,200 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:31,200 - CV - INFO - 	dropout: 0.0
2023-09-02 20:57:31,200 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:31,200 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:31,200 - CV - INFO - 	lambda: 0.03
2023-09-02 20:57:31,200 - CV - INFO - 	theta: 10
2023-09-02 20:57:31,200 - CV - INFO - 	clip: 5
2023-09-02 20:57:31,201 - CV - INFO - ----- BEGINNING FOLD SET (022:0)----------------------------------------------------------
2023-09-02 20:57:31,202 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/022/0
2023-09-02 20:57:31,202 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:31,202 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:31,202 - FGO - INFO - 	done: False
2023-09-02 20:57:31,202 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:31,202 - FGO - INFO - 	h1: 64
2023-09-02 20:57:31,202 - FGO - INFO - 	h2: 32
2023-09-02 20:57:31,202 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:31,202 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:31,202 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:31,202 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:31,202 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:57:31,202 - FGO - INFO - 	theta: 10
2023-09-02 20:57:31,202 - FGO - INFO - 	clip: 5
2023-09-02 20:57:31,202 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:31,202 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:31,203 - FGO - INFO - Source Total: 708
2023-09-02 20:57:31,203 - FGO - INFO - Target Total: 96
2023-09-02 20:57:31,203 - FGO - INFO - Train Total: 708
2023-09-02 20:57:31,203 - FGO - INFO - Val Total:   96
2023-09-02 20:57:31,203 - FGO - INFO - Test Total:  96
2023-09-02 20:57:31,203 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:31,203 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:31,203 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:31,203 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:31,203 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:31,203 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:31,203 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:31,203 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:31,203 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:31,203 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:31,204 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:31,205 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:31,321 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:31,321 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:31,321 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:31,321 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:31,321 - FGO - INFO - N: 804
2023-09-02 20:57:31,321 - FGO - INFO - N_s: 708
2023-09-02 20:57:31,321 - FGO - INFO - N_t: 96
2023-09-02 20:57:31,325 - CV - INFO - Begin Pretrain
2023-09-02 20:57:31,325 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:31,328 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:57:31,353 - FGO - INFO - Epoch  10 | Train Loss: 0.421 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:57:31,377 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:57:31,401 - FGO - INFO - Epoch  30 | Train Loss: 0.103 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:57:31,426 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:57:31,450 - FGO - INFO - Epoch  50 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:57:31,474 - FGO - INFO - Epoch  60 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:57:31,498 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:57:31,522 - FGO - INFO - Epoch  80 | Train Loss: 0.058 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:57:31,547 - FGO - INFO - Epoch  90 | Train Loss: 0.058 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:57:31,571 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:57:31,571 - FGO - INFO - Best Epoch:  28 | Train Loss: 0.112 | Val Loss: 0.09 | Val F1: 0.99 
2023-09-02 20:57:31,571 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:31,572 - CV - INFO - Pretrain Complete, 28 epochs
2023-09-02 20:57:31,572 - CV - INFO - Begin OT Train
2023-09-02 20:57:31,572 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:31,661 - FGO - INFO - Epoch   0 | Train Loss: -2.310 | Val Loss: -0.18 | Val F1: 0.94 |
2023-09-02 20:57:32,442 - FGO - INFO - Epoch  10 | Train Loss: -2.424 | Val Loss: -0.25 | Val F1: 0.97 |
2023-09-02 20:57:33,205 - FGO - INFO - Epoch  20 | Train Loss: -2.517 | Val Loss: -0.25 | Val F1: 0.95 |
2023-09-02 20:57:34,009 - FGO - INFO - Epoch  30 | Train Loss: -2.614 | Val Loss: -0.30 | Val F1: 0.98 |
2023-09-02 20:57:34,795 - FGO - INFO - Epoch  40 | Train Loss: -2.649 | Val Loss: -0.29 | Val F1: 0.98 |
2023-09-02 20:57:35,449 - FGO - INFO - Best Epoch:  28 | Train Loss: -2.600 | Val Loss: -0.30 | Val F1: 0.98 |
2023-09-02 20:57:35,449 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:35,452 - CV - INFO - OT Train Complete, 28 epochs
2023-09-02 20:57:35,452 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:35,480 - FGO - INFO - Train CM:
[[373   9]
 [ 10 316]]
2023-09-02 20:57:35,481 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:57:35,481 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:57:35,486 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:57:35,488 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:57:35,489 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:57:35,489 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:57:35,489 - CV - INFO - fold time: 4.288726329803467s (0.07147877216339112m)
2023-09-02 20:57:35,489 - CV - INFO - ----- BEGINNING FOLD SET (022:1)----------------------------------------------------------
2023-09-02 20:57:35,491 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/022/1
2023-09-02 20:57:35,491 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:35,491 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:35,491 - FGO - INFO - 	done: False
2023-09-02 20:57:35,491 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:35,491 - FGO - INFO - 	h1: 64
2023-09-02 20:57:35,491 - FGO - INFO - 	h2: 32
2023-09-02 20:57:35,491 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:35,491 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:35,491 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:35,491 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:35,491 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:57:35,491 - FGO - INFO - 	theta: 10
2023-09-02 20:57:35,491 - FGO - INFO - 	clip: 5
2023-09-02 20:57:35,491 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:35,491 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:35,491 - FGO - INFO - Source Total: 727
2023-09-02 20:57:35,491 - FGO - INFO - Target Total: 77
2023-09-02 20:57:35,491 - FGO - INFO - Train Total: 727
2023-09-02 20:57:35,491 - FGO - INFO - Val Total:   77
2023-09-02 20:57:35,491 - FGO - INFO - Test Total:  77
2023-09-02 20:57:35,491 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:35,491 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:35,491 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:35,491 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:35,491 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:35,492 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:35,492 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:35,492 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:35,492 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:35,492 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:35,493 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:35,494 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:35,590 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:35,590 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:35,590 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:35,590 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:35,590 - FGO - INFO - N: 804
2023-09-02 20:57:35,590 - FGO - INFO - N_s: 727
2023-09-02 20:57:35,590 - FGO - INFO - N_t: 77
2023-09-02 20:57:35,593 - CV - INFO - Begin Pretrain
2023-09-02 20:57:35,593 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:35,597 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:57:35,622 - FGO - INFO - Epoch  10 | Train Loss: 0.472 | Val Loss: 0.55 | Val F1: 0.71 |
2023-09-02 20:57:35,646 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.27 | Val F1: 0.84 |
2023-09-02 20:57:35,671 - FGO - INFO - Epoch  30 | Train Loss: 0.091 | Val Loss: 0.17 | Val F1: 0.93 |
2023-09-02 20:57:35,696 - FGO - INFO - Epoch  40 | Train Loss: 0.080 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:57:35,720 - FGO - INFO - Epoch  50 | Train Loss: 0.067 | Val Loss: 0.20 | Val F1: 0.87 |
2023-09-02 20:57:35,745 - FGO - INFO - Epoch  60 | Train Loss: 0.061 | Val Loss: 0.22 | Val F1: 0.89 |
2023-09-02 20:57:35,769 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:57:35,794 - FGO - INFO - Epoch  80 | Train Loss: 0.054 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 20:57:35,819 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.21 | Val F1: 0.92 |
2023-09-02 20:57:35,843 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:57:35,843 - FGO - INFO - Best Epoch:  34 | Train Loss: 0.088 | Val Loss: 0.17 | Val F1: 0.95 
2023-09-02 20:57:35,843 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:35,845 - CV - INFO - Pretrain Complete, 34 epochs
2023-09-02 20:57:35,845 - CV - INFO - Begin OT Train
2023-09-02 20:57:35,845 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:35,914 - FGO - INFO - Epoch   0 | Train Loss: -2.313 | Val Loss: -0.05 | Val F1: 0.90 |
2023-09-02 20:57:36,701 - FGO - INFO - Epoch  10 | Train Loss: -2.427 | Val Loss: 0.17 | Val F1: 0.87 |
2023-09-02 20:57:37,561 - FGO - INFO - Epoch  20 | Train Loss: -2.546 | Val Loss: -0.05 | Val F1: 0.89 |
2023-09-02 20:57:38,338 - FGO - INFO - Epoch  30 | Train Loss: -2.634 | Val Loss: -0.05 | Val F1: 0.92 |
2023-09-02 20:57:39,244 - FGO - INFO - Epoch  40 | Train Loss: -2.683 | Val Loss: -0.06 | Val F1: 0.93 |
2023-09-02 20:57:39,954 - FGO - INFO - Best Epoch:  12 | Train Loss: -2.487 | Val Loss: -0.06 | Val F1: 0.93 |
2023-09-02 20:57:39,954 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:39,957 - CV - INFO - OT Train Complete, 12 epochs
2023-09-02 20:57:39,957 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:39,982 - FGO - INFO - Train CM:
[[381   9]
 [  8 329]]
2023-09-02 20:57:39,982 - FGO - INFO - Val CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:57:39,983 - FGO - INFO - Test CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:57:39,988 - FGO - INFO - test statistical parity: 0.36282051282051286
2023-09-02 20:57:39,989 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:57:39,990 - FGO - INFO - test micro f1: 0.935064935064935
2023-09-02 20:57:39,990 - FGO - INFO - test macro f1: 0.9328449328449329
2023-09-02 20:57:39,991 - CV - INFO - fold time: 4.50124979019165s (0.07502082983652751m)
2023-09-02 20:57:39,991 - CV - INFO - ----- BEGINNING FOLD SET (022:2)----------------------------------------------------------
2023-09-02 20:57:39,992 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/022/2
2023-09-02 20:57:39,992 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:39,992 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:39,992 - FGO - INFO - 	done: False
2023-09-02 20:57:39,992 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:39,992 - FGO - INFO - 	h1: 64
2023-09-02 20:57:39,992 - FGO - INFO - 	h2: 32
2023-09-02 20:57:39,992 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:39,992 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:39,992 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:39,992 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:39,992 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:57:39,993 - FGO - INFO - 	theta: 10
2023-09-02 20:57:39,993 - FGO - INFO - 	clip: 5
2023-09-02 20:57:39,993 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:39,993 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:39,993 - FGO - INFO - Source Total: 721
2023-09-02 20:57:39,993 - FGO - INFO - Target Total: 83
2023-09-02 20:57:39,993 - FGO - INFO - Train Total: 721
2023-09-02 20:57:39,993 - FGO - INFO - Val Total:   83
2023-09-02 20:57:39,993 - FGO - INFO - Test Total:  83
2023-09-02 20:57:39,993 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:39,993 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:39,993 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:39,993 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:39,993 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:39,993 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:39,993 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:39,993 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:39,993 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:39,993 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:39,994 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:39,996 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:40,098 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:40,098 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:40,098 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:40,098 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:40,098 - FGO - INFO - N: 804
2023-09-02 20:57:40,098 - FGO - INFO - N_s: 721
2023-09-02 20:57:40,098 - FGO - INFO - N_t: 83
2023-09-02 20:57:40,102 - CV - INFO - Begin Pretrain
2023-09-02 20:57:40,102 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:40,105 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:57:40,129 - FGO - INFO - Epoch  10 | Train Loss: 0.478 | Val Loss: 0.49 | Val F1: 0.84 |
2023-09-02 20:57:40,154 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.24 | Val F1: 0.87 |
2023-09-02 20:57:40,178 - FGO - INFO - Epoch  30 | Train Loss: 0.087 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:57:40,203 - FGO - INFO - Epoch  40 | Train Loss: 0.073 | Val Loss: 0.25 | Val F1: 0.90 |
2023-09-02 20:57:40,227 - FGO - INFO - Epoch  50 | Train Loss: 0.063 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:57:40,252 - FGO - INFO - Epoch  60 | Train Loss: 0.058 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:57:40,276 - FGO - INFO - Epoch  70 | Train Loss: 0.056 | Val Loss: 0.28 | Val F1: 0.91 |
2023-09-02 20:57:40,301 - FGO - INFO - Epoch  80 | Train Loss: 0.052 | Val Loss: 0.28 | Val F1: 0.88 |
2023-09-02 20:57:40,325 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.28 | Val F1: 0.89 |
2023-09-02 20:57:40,349 - FGO - INFO - Epoch 100 | Train Loss: 0.046 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:57:40,349 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.058 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:57:40,349 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:40,351 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:57:40,351 - CV - INFO - Begin OT Train
2023-09-02 20:57:40,351 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:40,450 - FGO - INFO - Epoch   0 | Train Loss: -2.181 | Val Loss: 0.03 | Val F1: 0.90 |
2023-09-02 20:57:41,296 - FGO - INFO - Epoch  10 | Train Loss: -2.517 | Val Loss: 0.10 | Val F1: 0.90 |
2023-09-02 20:57:42,049 - FGO - INFO - Epoch  20 | Train Loss: -2.589 | Val Loss: -0.06 | Val F1: 0.90 |
2023-09-02 20:57:42,901 - FGO - INFO - Epoch  30 | Train Loss: -2.677 | Val Loss: 0.08 | Val F1: 0.91 |
2023-09-02 20:57:43,692 - FGO - INFO - Epoch  40 | Train Loss: -2.708 | Val Loss: 0.08 | Val F1: 0.90 |
2023-09-02 20:57:44,383 - FGO - INFO - Best Epoch:  14 | Train Loss: -2.550 | Val Loss: -0.00 | Val F1: 0.91 |
2023-09-02 20:57:44,383 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:44,386 - CV - INFO - OT Train Complete, 14 epochs
2023-09-02 20:57:44,387 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:44,412 - FGO - INFO - Train CM:
[[377   7]
 [  8 329]]
2023-09-02 20:57:44,412 - FGO - INFO - Val CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:57:44,413 - FGO - INFO - Test CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:57:44,418 - FGO - INFO - test statistical parity: 0.10563380281690143
2023-09-02 20:57:44,419 - FGO - INFO - test equal opportunity: 0.09259259259259256
2023-09-02 20:57:44,420 - FGO - INFO - test micro f1: 0.9156626506024096
2023-09-02 20:57:44,420 - FGO - INFO - test macro f1: 0.9124076586763153
2023-09-02 20:57:44,420 - CV - INFO - fold time: 4.429747819900513s (0.07382913033167521m)
2023-09-02 20:57:44,420 - CV - INFO - ----- BEGINNING FOLD SET (022:3)----------------------------------------------------------
2023-09-02 20:57:44,422 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/022/3
2023-09-02 20:57:44,422 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:44,422 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:44,422 - FGO - INFO - 	done: False
2023-09-02 20:57:44,422 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:44,422 - FGO - INFO - 	h1: 64
2023-09-02 20:57:44,422 - FGO - INFO - 	h2: 32
2023-09-02 20:57:44,422 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:44,422 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:44,422 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:44,422 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:44,422 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:57:44,422 - FGO - INFO - 	theta: 10
2023-09-02 20:57:44,422 - FGO - INFO - 	clip: 5
2023-09-02 20:57:44,422 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:44,422 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:44,422 - FGO - INFO - Source Total: 729
2023-09-02 20:57:44,422 - FGO - INFO - Target Total: 75
2023-09-02 20:57:44,422 - FGO - INFO - Train Total: 729
2023-09-02 20:57:44,422 - FGO - INFO - Val Total:   75
2023-09-02 20:57:44,422 - FGO - INFO - Test Total:  75
2023-09-02 20:57:44,422 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:44,422 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:44,422 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:44,422 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:44,422 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:44,423 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:44,423 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:44,423 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:44,423 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:44,423 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:44,424 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:44,425 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:44,553 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:44,553 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:44,553 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:44,553 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:44,553 - FGO - INFO - N: 804
2023-09-02 20:57:44,553 - FGO - INFO - N_s: 729
2023-09-02 20:57:44,553 - FGO - INFO - N_t: 75
2023-09-02 20:57:44,557 - CV - INFO - Begin Pretrain
2023-09-02 20:57:44,557 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:44,560 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:57:44,585 - FGO - INFO - Epoch  10 | Train Loss: 0.431 | Val Loss: 0.36 | Val F1: 0.93 |
2023-09-02 20:57:44,609 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:57:44,634 - FGO - INFO - Epoch  30 | Train Loss: 0.109 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:57:44,659 - FGO - INFO - Epoch  40 | Train Loss: 0.093 | Val Loss: 0.03 | Val F1: 0.99 |
2023-09-02 20:57:44,683 - FGO - INFO - Epoch  50 | Train Loss: 0.080 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:57:44,708 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:57:44,732 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:57:44,756 - FGO - INFO - Epoch  80 | Train Loss: 0.065 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:57:44,781 - FGO - INFO - Epoch  90 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:57:44,805 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:57:44,805 - FGO - INFO - Best Epoch:  27 | Train Loss: 0.114 | Val Loss: 0.03 | Val F1: 1.00 
2023-09-02 20:57:44,806 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:44,807 - CV - INFO - Pretrain Complete, 27 epochs
2023-09-02 20:57:44,807 - CV - INFO - Begin OT Train
2023-09-02 20:57:44,807 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:44,895 - FGO - INFO - Epoch   0 | Train Loss: -2.238 | Val Loss: -0.21 | Val F1: 0.97 |
2023-09-02 20:57:45,724 - FGO - INFO - Epoch  10 | Train Loss: -2.446 | Val Loss: -0.14 | Val F1: 0.96 |
2023-09-02 20:57:46,507 - FGO - INFO - Epoch  20 | Train Loss: -2.569 | Val Loss: -0.21 | Val F1: 0.99 |
2023-09-02 20:57:47,248 - FGO - INFO - Epoch  30 | Train Loss: -2.638 | Val Loss: -0.25 | Val F1: 0.99 |
2023-09-02 20:57:48,112 - FGO - INFO - Epoch  40 | Train Loss: -2.674 | Val Loss: -0.26 | Val F1: 0.99 |
2023-09-02 20:57:48,813 - FGO - INFO - Best Epoch:  14 | Train Loss: -2.502 | Val Loss: -0.24 | Val F1: 0.99 |
2023-09-02 20:57:48,813 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:48,816 - CV - INFO - OT Train Complete, 14 epochs
2023-09-02 20:57:48,816 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:48,841 - FGO - INFO - Train CM:
[[387   9]
 [ 12 321]]
2023-09-02 20:57:48,842 - FGO - INFO - Val CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:57:48,842 - FGO - INFO - Test CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:57:48,847 - FGO - INFO - test statistical parity: 0.024590163934426257
2023-09-02 20:57:48,848 - FGO - INFO - test equal opportunity: 0.033333333333333326
2023-09-02 20:57:48,849 - FGO - INFO - test micro f1: 0.9866666666666668
2023-09-02 20:57:48,850 - FGO - INFO - test macro f1: 0.9866571784380003
2023-09-02 20:57:48,850 - CV - INFO - fold time: 4.429314136505127s (0.07382190227508545m)
2023-09-02 20:57:48,850 - CV - INFO - ----- BEGINNING FOLD SET (022:4)----------------------------------------------------------
2023-09-02 20:57:48,851 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/022/4
2023-09-02 20:57:48,851 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:48,851 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:48,852 - FGO - INFO - 	done: False
2023-09-02 20:57:48,852 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:48,852 - FGO - INFO - 	h1: 64
2023-09-02 20:57:48,852 - FGO - INFO - 	h2: 32
2023-09-02 20:57:48,852 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:48,852 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:48,852 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:48,852 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:48,852 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:57:48,852 - FGO - INFO - 	theta: 10
2023-09-02 20:57:48,852 - FGO - INFO - 	clip: 5
2023-09-02 20:57:48,852 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:48,852 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:48,852 - FGO - INFO - Source Total: 732
2023-09-02 20:57:48,852 - FGO - INFO - Target Total: 72
2023-09-02 20:57:48,852 - FGO - INFO - Train Total: 732
2023-09-02 20:57:48,852 - FGO - INFO - Val Total:   72
2023-09-02 20:57:48,852 - FGO - INFO - Test Total:  72
2023-09-02 20:57:48,852 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:48,852 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:48,852 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:48,852 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:48,852 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:48,852 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:48,852 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:48,852 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:48,852 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:48,853 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:48,853 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:48,855 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:48,945 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:48,946 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:48,946 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:48,946 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:48,946 - FGO - INFO - N: 804
2023-09-02 20:57:48,946 - FGO - INFO - N_s: 732
2023-09-02 20:57:48,946 - FGO - INFO - N_t: 72
2023-09-02 20:57:48,949 - CV - INFO - Begin Pretrain
2023-09-02 20:57:48,949 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:48,953 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:57:48,978 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.46 | Val F1: 0.81 |
2023-09-02 20:57:49,002 - FGO - INFO - Epoch  20 | Train Loss: 0.141 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:57:49,027 - FGO - INFO - Epoch  30 | Train Loss: 0.100 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:57:49,052 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:57:49,076 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:57:49,101 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 20:57:49,126 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:57:49,150 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:57:49,175 - FGO - INFO - Epoch  90 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:57:49,200 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:57:49,200 - FGO - INFO - Best Epoch:  64 | Train Loss: 0.069 | Val Loss: 0.06 | Val F1: 0.99 
2023-09-02 20:57:49,200 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:49,201 - CV - INFO - Pretrain Complete, 64 epochs
2023-09-02 20:57:49,201 - CV - INFO - Begin OT Train
2023-09-02 20:57:49,201 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:49,293 - FGO - INFO - Epoch   0 | Train Loss: -2.426 | Val Loss: -0.19 | Val F1: 0.99 |
2023-09-02 20:57:50,154 - FGO - INFO - Epoch  10 | Train Loss: -2.498 | Val Loss: -0.21 | Val F1: 0.99 |
2023-09-02 20:57:50,901 - FGO - INFO - Epoch  20 | Train Loss: -2.558 | Val Loss: -0.21 | Val F1: 0.97 |
2023-09-02 20:57:51,711 - FGO - INFO - Epoch  30 | Train Loss: -2.631 | Val Loss: -0.21 | Val F1: 0.99 |
2023-09-02 20:57:52,504 - FGO - INFO - Epoch  40 | Train Loss: -2.669 | Val Loss: -0.19 | Val F1: 0.99 |
2023-09-02 20:57:53,199 - FGO - INFO - Best Epoch:  10 | Train Loss: -2.498 | Val Loss: -0.21 | Val F1: 0.99 |
2023-09-02 20:57:53,199 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:53,202 - CV - INFO - OT Train Complete, 10 epochs
2023-09-02 20:57:53,203 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:53,226 - FGO - INFO - Train CM:
[[387  10]
 [ 12 323]]
2023-09-02 20:57:53,226 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:57:53,227 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:57:53,231 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:57:53,232 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:57:53,233 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:57:53,234 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:57:53,234 - CV - INFO - fold time: 4.384245872497559s (0.07307076454162598m)
2023-09-02 20:57:53,234 - CV - INFO - ----- BEGINNING FOLD SET (022:5)----------------------------------------------------------
2023-09-02 20:57:53,236 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/022/5
2023-09-02 20:57:53,236 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:53,236 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:53,236 - FGO - INFO - 	done: False
2023-09-02 20:57:53,236 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:53,236 - FGO - INFO - 	h1: 64
2023-09-02 20:57:53,236 - FGO - INFO - 	h2: 32
2023-09-02 20:57:53,236 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:53,236 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:53,236 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:53,236 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:53,236 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:57:53,236 - FGO - INFO - 	theta: 10
2023-09-02 20:57:53,236 - FGO - INFO - 	clip: 5
2023-09-02 20:57:53,236 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:53,236 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:53,236 - FGO - INFO - Source Total: 726
2023-09-02 20:57:53,236 - FGO - INFO - Target Total: 78
2023-09-02 20:57:53,236 - FGO - INFO - Train Total: 726
2023-09-02 20:57:53,236 - FGO - INFO - Val Total:   78
2023-09-02 20:57:53,236 - FGO - INFO - Test Total:  78
2023-09-02 20:57:53,236 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:53,236 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:53,236 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:53,236 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:53,236 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:53,237 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:53,237 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:53,237 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:53,237 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:53,237 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:53,238 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:53,239 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:53,336 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:53,336 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:53,336 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:53,336 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:53,336 - FGO - INFO - N: 804
2023-09-02 20:57:53,336 - FGO - INFO - N_s: 726
2023-09-02 20:57:53,336 - FGO - INFO - N_t: 78
2023-09-02 20:57:53,340 - CV - INFO - Begin Pretrain
2023-09-02 20:57:53,340 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:53,343 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:57:53,372 - FGO - INFO - Epoch  10 | Train Loss: 0.515 | Val Loss: 0.52 | Val F1: 0.82 |
2023-09-02 20:57:53,400 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:57:53,427 - FGO - INFO - Epoch  30 | Train Loss: 0.106 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:57:53,455 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.13 | Val F1: 0.95 |
2023-09-02 20:57:53,493 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:57:53,519 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.09 | Val F1: 0.95 |
2023-09-02 20:57:53,557 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:57:53,584 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 20:57:53,616 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:57:53,649 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:57:53,649 - FGO - INFO - Best Epoch:  55 | Train Loss: 0.077 | Val Loss: 0.09 | Val F1: 0.97 
2023-09-02 20:57:53,649 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:53,650 - CV - INFO - Pretrain Complete, 55 epochs
2023-09-02 20:57:53,650 - CV - INFO - Begin OT Train
2023-09-02 20:57:53,650 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:53,723 - FGO - INFO - Epoch   0 | Train Loss: -2.168 | Val Loss: -0.16 | Val F1: 0.95 |
2023-09-02 20:57:54,546 - FGO - INFO - Epoch  10 | Train Loss: -2.425 | Val Loss: 0.22 | Val F1: 0.88 |
2023-09-02 20:57:55,370 - FGO - INFO - Epoch  20 | Train Loss: -2.537 | Val Loss: 0.08 | Val F1: 0.88 |
2023-09-02 20:57:56,130 - FGO - INFO - Epoch  30 | Train Loss: -2.620 | Val Loss: 0.11 | Val F1: 0.91 |
2023-09-02 20:57:56,906 - FGO - INFO - Epoch  40 | Train Loss: -2.665 | Val Loss: 0.07 | Val F1: 0.90 |
2023-09-02 20:57:57,662 - FGO - INFO - Best Epoch:   6 | Train Loss: -2.290 | Val Loss: -0.17 | Val F1: 0.95 |
2023-09-02 20:57:57,662 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:57,669 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:57:57,669 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:57:57,697 - FGO - INFO - Train CM:
[[393   7]
 [ 15 311]]
2023-09-02 20:57:57,697 - FGO - INFO - Val CM:
[[32  2]
 [ 6 38]]
2023-09-02 20:57:57,697 - FGO - INFO - Test CM:
[[32  2]
 [ 6 38]]
2023-09-02 20:57:57,703 - FGO - INFO - test statistical parity: 0.1739130434782608
2023-09-02 20:57:57,704 - FGO - INFO - test equal opportunity: 0.15384615384615385
2023-09-02 20:57:57,705 - FGO - INFO - test micro f1: 0.8974358974358975
2023-09-02 20:57:57,706 - FGO - INFO - test macro f1: 0.8968253968253967
2023-09-02 20:57:57,706 - CV - INFO - fold time: 4.471818685531616s (0.07453031142552693m)
2023-09-02 20:57:57,706 - CV - INFO - ----- BEGINNING FOLD SET (022:6)----------------------------------------------------------
2023-09-02 20:57:57,707 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/022/6
2023-09-02 20:57:57,708 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:57:57,708 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:57:57,708 - FGO - INFO - 	done: False
2023-09-02 20:57:57,708 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:57:57,708 - FGO - INFO - 	h1: 64
2023-09-02 20:57:57,708 - FGO - INFO - 	h2: 32
2023-09-02 20:57:57,708 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:57:57,708 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:57:57,708 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:57:57,708 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:57:57,708 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:57:57,708 - FGO - INFO - 	theta: 10
2023-09-02 20:57:57,708 - FGO - INFO - 	clip: 5
2023-09-02 20:57:57,708 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:57:57,708 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:57:57,708 - FGO - INFO - Source Total: 717
2023-09-02 20:57:57,708 - FGO - INFO - Target Total: 87
2023-09-02 20:57:57,708 - FGO - INFO - Train Total: 717
2023-09-02 20:57:57,708 - FGO - INFO - Val Total:   87
2023-09-02 20:57:57,708 - FGO - INFO - Test Total:  87
2023-09-02 20:57:57,708 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:57:57,708 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:57:57,708 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:57:57,708 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:57:57,708 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:57:57,709 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:57:57,709 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:57:57,709 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:57:57,709 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:57:57,709 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:57:57,710 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:57:57,711 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:57:57,817 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:57:57,817 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:57:57,817 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:57:57,817 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:57:57,817 - FGO - INFO - N: 804
2023-09-02 20:57:57,817 - FGO - INFO - N_s: 717
2023-09-02 20:57:57,817 - FGO - INFO - N_t: 87
2023-09-02 20:57:57,820 - CV - INFO - Begin Pretrain
2023-09-02 20:57:57,820 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:57:57,824 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:57:57,848 - FGO - INFO - Epoch  10 | Train Loss: 0.496 | Val Loss: 0.48 | Val F1: 0.80 |
2023-09-02 20:57:57,873 - FGO - INFO - Epoch  20 | Train Loss: 0.161 | Val Loss: 0.13 | Val F1: 0.93 |
2023-09-02 20:57:57,897 - FGO - INFO - Epoch  30 | Train Loss: 0.108 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:57:57,922 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.09 | Val F1: 0.98 |
2023-09-02 20:57:57,946 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:57:57,971 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:57:57,995 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:57:58,019 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:57:58,044 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:57:58,068 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:57:58,068 - FGO - INFO - Best Epoch:  73 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 1.00 
2023-09-02 20:57:58,068 - FGO - INFO - Setting model to best state.
2023-09-02 20:57:58,070 - CV - INFO - Pretrain Complete, 73 epochs
2023-09-02 20:57:58,070 - CV - INFO - Begin OT Train
2023-09-02 20:57:58,070 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:57:58,166 - FGO - INFO - Epoch   0 | Train Loss: -2.416 | Val Loss: -0.28 | Val F1: 1.00 |
2023-09-02 20:57:58,947 - FGO - INFO - Epoch  10 | Train Loss: -2.505 | Val Loss: -0.23 | Val F1: 0.94 |
2023-09-02 20:57:59,746 - FGO - INFO - Epoch  20 | Train Loss: -2.551 | Val Loss: -0.27 | Val F1: 0.96 |
2023-09-02 20:58:00,544 - FGO - INFO - Epoch  30 | Train Loss: -2.613 | Val Loss: -0.30 | Val F1: 0.98 |
2023-09-02 20:58:01,313 - FGO - INFO - Epoch  40 | Train Loss: -2.646 | Val Loss: -0.32 | Val F1: 0.99 |
2023-09-02 20:58:02,037 - FGO - INFO - Best Epoch:  36 | Train Loss: -2.639 | Val Loss: -0.32 | Val F1: 1.00 |
2023-09-02 20:58:02,037 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:02,040 - CV - INFO - OT Train Complete, 36 epochs
2023-09-02 20:58:02,040 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:02,065 - FGO - INFO - Train CM:
[[376   9]
 [ 11 321]]
2023-09-02 20:58:02,065 - FGO - INFO - Val CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:58:02,066 - FGO - INFO - Test CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:58:02,071 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 20:58:02,072 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:58:02,073 - FGO - INFO - test micro f1: 0.9885057471264368
2023-09-02 20:58:02,073 - FGO - INFO - test macro f1: 0.9883518543312357
2023-09-02 20:58:02,073 - CV - INFO - fold time: 4.367698907852173s (0.07279498179753621m)
2023-09-02 20:58:02,073 - CV - INFO - ----- BEGINNING FOLD SET (022:7)----------------------------------------------------------
2023-09-02 20:58:02,075 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/022/7
2023-09-02 20:58:02,075 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:02,075 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:02,075 - FGO - INFO - 	done: False
2023-09-02 20:58:02,075 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:02,075 - FGO - INFO - 	h1: 64
2023-09-02 20:58:02,075 - FGO - INFO - 	h2: 32
2023-09-02 20:58:02,075 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:02,075 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:02,075 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:02,075 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:02,075 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:02,075 - FGO - INFO - 	theta: 10
2023-09-02 20:58:02,075 - FGO - INFO - 	clip: 5
2023-09-02 20:58:02,075 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:02,075 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:02,076 - FGO - INFO - Source Total: 717
2023-09-02 20:58:02,076 - FGO - INFO - Target Total: 87
2023-09-02 20:58:02,076 - FGO - INFO - Train Total: 717
2023-09-02 20:58:02,076 - FGO - INFO - Val Total:   87
2023-09-02 20:58:02,076 - FGO - INFO - Test Total:  87
2023-09-02 20:58:02,076 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:02,076 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:02,076 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:02,076 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:02,076 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:02,076 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:02,076 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:02,076 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:02,076 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:02,076 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:02,077 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:02,078 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:02,184 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:02,184 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:02,184 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:02,184 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:02,184 - FGO - INFO - N: 804
2023-09-02 20:58:02,184 - FGO - INFO - N_s: 717
2023-09-02 20:58:02,184 - FGO - INFO - N_t: 87
2023-09-02 20:58:02,188 - CV - INFO - Begin Pretrain
2023-09-02 20:58:02,188 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:02,191 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:58:02,216 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.49 | Val F1: 0.86 |
2023-09-02 20:58:02,241 - FGO - INFO - Epoch  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 |
2023-09-02 20:58:02,265 - FGO - INFO - Epoch  30 | Train Loss: 0.097 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:58:02,290 - FGO - INFO - Epoch  40 | Train Loss: 0.081 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:58:02,314 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:58:02,343 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:58:02,368 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:58:02,393 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:58:02,417 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:58:02,441 - FGO - INFO - Epoch 100 | Train Loss: 0.074 | Val Loss: 0.20 | Val F1: 0.95 |
2023-09-02 20:58:02,441 - FGO - INFO - Best Epoch:  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 
2023-09-02 20:58:02,442 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:02,443 - CV - INFO - Pretrain Complete, 20 epochs
2023-09-02 20:58:02,443 - CV - INFO - Begin OT Train
2023-09-02 20:58:02,443 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:02,542 - FGO - INFO - Epoch   0 | Train Loss: -2.401 | Val Loss: -0.14 | Val F1: 0.95 |
2023-09-02 20:58:03,326 - FGO - INFO - Epoch  10 | Train Loss: -2.485 | Val Loss: -0.14 | Val F1: 0.93 |
2023-09-02 20:58:04,089 - FGO - INFO - Epoch  20 | Train Loss: -2.547 | Val Loss: -0.17 | Val F1: 0.95 |
2023-09-02 20:58:04,845 - FGO - INFO - Epoch  30 | Train Loss: -2.624 | Val Loss: -0.14 | Val F1: 0.95 |
2023-09-02 20:58:05,645 - FGO - INFO - Epoch  40 | Train Loss: -2.660 | Val Loss: -0.13 | Val F1: 0.97 |
2023-09-02 20:58:06,311 - FGO - INFO - Best Epoch:  35 | Train Loss: -2.646 | Val Loss: -0.14 | Val F1: 0.97 |
2023-09-02 20:58:06,311 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:06,314 - CV - INFO - OT Train Complete, 35 epochs
2023-09-02 20:58:06,314 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:06,351 - FGO - INFO - Train CM:
[[378   9]
 [ 12 318]]
2023-09-02 20:58:06,352 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:58:06,352 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:58:06,357 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:58:06,358 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:58:06,359 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:58:06,359 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:58:06,359 - CV - INFO - fold time: 4.285818338394165s (0.07143030563990276m)
2023-09-02 20:58:06,359 - CV - INFO - ----- BEGINNING FOLD SET (022:8)----------------------------------------------------------
2023-09-02 20:58:06,361 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/022/8
2023-09-02 20:58:06,361 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:06,361 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:06,361 - FGO - INFO - 	done: False
2023-09-02 20:58:06,361 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:06,361 - FGO - INFO - 	h1: 64
2023-09-02 20:58:06,361 - FGO - INFO - 	h2: 32
2023-09-02 20:58:06,361 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:06,361 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:06,361 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:06,361 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:06,361 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:06,361 - FGO - INFO - 	theta: 10
2023-09-02 20:58:06,361 - FGO - INFO - 	clip: 5
2023-09-02 20:58:06,361 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:06,361 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:06,361 - FGO - INFO - Source Total: 734
2023-09-02 20:58:06,361 - FGO - INFO - Target Total: 70
2023-09-02 20:58:06,361 - FGO - INFO - Train Total: 734
2023-09-02 20:58:06,361 - FGO - INFO - Val Total:   70
2023-09-02 20:58:06,361 - FGO - INFO - Test Total:  70
2023-09-02 20:58:06,361 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:06,361 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:06,361 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:06,361 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:06,361 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:06,362 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:06,362 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:06,362 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:06,362 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:06,362 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:06,363 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:06,364 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:06,453 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:06,453 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:06,453 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:06,453 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:06,453 - FGO - INFO - N: 804
2023-09-02 20:58:06,453 - FGO - INFO - N_s: 734
2023-09-02 20:58:06,453 - FGO - INFO - N_t: 70
2023-09-02 20:58:06,457 - CV - INFO - Begin Pretrain
2023-09-02 20:58:06,457 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:06,460 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:58:06,485 - FGO - INFO - Epoch  10 | Train Loss: 0.450 | Val Loss: 0.48 | Val F1: 0.81 |
2023-09-02 20:58:06,510 - FGO - INFO - Epoch  20 | Train Loss: 0.149 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:58:06,535 - FGO - INFO - Epoch  30 | Train Loss: 0.104 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:58:06,560 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:58:06,585 - FGO - INFO - Epoch  50 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:58:06,609 - FGO - INFO - Epoch  60 | Train Loss: 0.067 | Val Loss: 0.11 | Val F1: 0.96 |
2023-09-02 20:58:06,634 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.96 |
2023-09-02 20:58:06,659 - FGO - INFO - Epoch  80 | Train Loss: 0.072 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:58:06,683 - FGO - INFO - Epoch  90 | Train Loss: 0.061 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:58:06,708 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:58:06,708 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.117 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:58:06,708 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:06,709 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:58:06,709 - CV - INFO - Begin OT Train
2023-09-02 20:58:06,709 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:06,802 - FGO - INFO - Epoch   0 | Train Loss: -2.362 | Val Loss: -0.08 | Val F1: 0.93 |
2023-09-02 20:58:07,570 - FGO - INFO - Epoch  10 | Train Loss: -2.456 | Val Loss: 0.06 | Val F1: 0.93 |
2023-09-02 20:58:08,406 - FGO - INFO - Epoch  20 | Train Loss: -2.569 | Val Loss: 0.02 | Val F1: 0.94 |
2023-09-02 20:58:09,142 - FGO - INFO - Epoch  30 | Train Loss: -2.654 | Val Loss: 0.03 | Val F1: 0.94 |
2023-09-02 20:58:10,013 - FGO - INFO - Epoch  40 | Train Loss: -2.688 | Val Loss: 0.03 | Val F1: 0.94 |
2023-09-02 20:58:10,722 - FGO - INFO - Best Epoch:  49 | Train Loss: -2.707 | Val Loss: 0.01 | Val F1: 0.96 |
2023-09-02 20:58:10,722 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:10,724 - CV - INFO - OT Train Complete, 49 epochs
2023-09-02 20:58:10,725 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:10,752 - FGO - INFO - Train CM:
[[391   9]
 [ 12 322]]
2023-09-02 20:58:10,752 - FGO - INFO - Val CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:58:10,752 - FGO - INFO - Test CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:58:10,757 - FGO - INFO - test statistical parity: 0.10661268556005393
2023-09-02 20:58:10,759 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:58:10,760 - FGO - INFO - test micro f1: 0.9571428571428572
2023-09-02 20:58:10,760 - FGO - INFO - test macro f1: 0.9571341090018372
2023-09-02 20:58:10,760 - CV - INFO - fold time: 4.4008262157440186s (0.07334710359573364m)
2023-09-02 20:58:10,760 - CV - INFO - ----- BEGINNING FOLD SET (022:9)----------------------------------------------------------
2023-09-02 20:58:10,762 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/022/9
2023-09-02 20:58:10,762 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:10,762 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:10,762 - FGO - INFO - 	done: False
2023-09-02 20:58:10,762 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:10,762 - FGO - INFO - 	h1: 64
2023-09-02 20:58:10,762 - FGO - INFO - 	h2: 32
2023-09-02 20:58:10,762 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:10,762 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:10,762 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:10,762 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:10,762 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:10,762 - FGO - INFO - 	theta: 10
2023-09-02 20:58:10,762 - FGO - INFO - 	clip: 5
2023-09-02 20:58:10,762 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:10,763 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:10,763 - FGO - INFO - Source Total: 725
2023-09-02 20:58:10,763 - FGO - INFO - Target Total: 79
2023-09-02 20:58:10,763 - FGO - INFO - Train Total: 725
2023-09-02 20:58:10,763 - FGO - INFO - Val Total:   79
2023-09-02 20:58:10,763 - FGO - INFO - Test Total:  79
2023-09-02 20:58:10,763 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:10,763 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:10,763 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:10,763 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:10,763 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:10,763 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:10,763 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:10,763 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:10,763 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:10,763 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:10,764 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:10,765 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:10,864 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:10,864 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:10,864 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:10,864 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:10,864 - FGO - INFO - N: 804
2023-09-02 20:58:10,864 - FGO - INFO - N_s: 725
2023-09-02 20:58:10,864 - FGO - INFO - N_t: 79
2023-09-02 20:58:10,868 - CV - INFO - Begin Pretrain
2023-09-02 20:58:10,868 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:10,871 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:58:10,896 - FGO - INFO - Epoch  10 | Train Loss: 0.471 | Val Loss: 0.48 | Val F1: 0.87 |
2023-09-02 20:58:10,921 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:58:10,945 - FGO - INFO - Epoch  30 | Train Loss: 0.102 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:58:10,970 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.21 | Val F1: 0.97 |
2023-09-02 20:58:10,994 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:58:11,019 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:58:11,043 - FGO - INFO - Epoch  70 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:58:11,068 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:58:11,092 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:58:11,117 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:58:11,117 - FGO - INFO - Best Epoch:  25 | Train Loss: 0.119 | Val Loss: 0.24 | Val F1: 0.97 
2023-09-02 20:58:11,117 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:11,118 - CV - INFO - Pretrain Complete, 25 epochs
2023-09-02 20:58:11,118 - CV - INFO - Begin OT Train
2023-09-02 20:58:11,118 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:11,212 - FGO - INFO - Epoch   0 | Train Loss: -2.393 | Val Loss: -0.16 | Val F1: 0.97 |
2023-09-02 20:58:11,992 - FGO - INFO - Epoch  10 | Train Loss: -2.251 | Val Loss: 0.22 | Val F1: 0.83 |
2023-09-02 20:58:12,779 - FGO - INFO - Epoch  20 | Train Loss: -2.500 | Val Loss: -0.20 | Val F1: 0.97 |
2023-09-02 20:58:13,747 - FGO - INFO - Epoch  30 | Train Loss: -2.564 | Val Loss: -0.22 | Val F1: 0.97 |
2023-09-02 20:58:14,577 - FGO - INFO - Epoch  40 | Train Loss: -2.628 | Val Loss: -0.24 | Val F1: 0.97 |
2023-09-02 20:58:15,285 - FGO - INFO - Best Epoch:  14 | Train Loss: -2.497 | Val Loss: -0.21 | Val F1: 0.99 |
2023-09-02 20:58:15,285 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:15,288 - CV - INFO - OT Train Complete, 14 epochs
2023-09-02 20:58:15,289 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:15,314 - FGO - INFO - Train CM:
[[378   7]
 [ 13 327]]
2023-09-02 20:58:15,314 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:58:15,315 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:58:15,320 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:58:15,321 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:58:15,322 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:58:15,322 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:58:15,322 - CV - INFO - fold time: 4.562215328216553s (0.07603692213694255m)
2023-09-02 20:58:15,322 - CV - INFO - Mean Pretrain Epochs 41.0:
2023-09-02 20:58:15,322 - CV - INFO - Mean OT Train Epochs 21.8:
2023-09-02 20:58:15,322 - CV - INFO - Mean Val Macro F1 : 0.9577923703017468
2023-09-02 20:58:15,322 - CV - INFO - Mean Eval Stat : 0.9577923703017468 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:58:15,323 - CV - INFO - set time: 44.12220907211304s (0.735370151201884m)
2023-09-02 20:58:15,323 - CV - INFO - script time so far: 993.2736663818359s (16.55456110636393m) (0.2759093517727322h)
2023-09-02 20:58:15,323 - CV - INFO - ===== BEGINNING OPTION SET (023)==========================================================
2023-09-02 20:58:15,323 - CV - INFO - 	done: False
2023-09-02 20:58:15,323 - CV - INFO - 	learning_rate: 0.01
2023-09-02 20:58:15,323 - CV - INFO - 	h1: 64
2023-09-02 20:58:15,323 - CV - INFO - 	h2: 32
2023-09-02 20:58:15,323 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:15,323 - CV - INFO - 	dropout: 0.0
2023-09-02 20:58:15,323 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:15,323 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:15,323 - CV - INFO - 	lambda: 0.03
2023-09-02 20:58:15,323 - CV - INFO - 	theta: 30
2023-09-02 20:58:15,323 - CV - INFO - 	clip: 5
2023-09-02 20:58:15,323 - CV - INFO - ----- BEGINNING FOLD SET (023:0)----------------------------------------------------------
2023-09-02 20:58:15,324 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/023/0
2023-09-02 20:58:15,325 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:15,325 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:15,325 - FGO - INFO - 	done: False
2023-09-02 20:58:15,325 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:15,325 - FGO - INFO - 	h1: 64
2023-09-02 20:58:15,325 - FGO - INFO - 	h2: 32
2023-09-02 20:58:15,325 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:15,325 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:15,325 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:15,325 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:15,325 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:15,325 - FGO - INFO - 	theta: 30
2023-09-02 20:58:15,325 - FGO - INFO - 	clip: 5
2023-09-02 20:58:15,325 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:15,325 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:15,325 - FGO - INFO - Source Total: 708
2023-09-02 20:58:15,325 - FGO - INFO - Target Total: 96
2023-09-02 20:58:15,325 - FGO - INFO - Train Total: 708
2023-09-02 20:58:15,325 - FGO - INFO - Val Total:   96
2023-09-02 20:58:15,325 - FGO - INFO - Test Total:  96
2023-09-02 20:58:15,325 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:15,325 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:15,325 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:15,325 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:15,325 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:15,325 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:15,326 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:15,326 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:15,326 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:15,326 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:15,327 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:15,328 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:15,443 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:15,443 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:15,443 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:15,443 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:15,443 - FGO - INFO - N: 804
2023-09-02 20:58:15,443 - FGO - INFO - N_s: 708
2023-09-02 20:58:15,443 - FGO - INFO - N_t: 96
2023-09-02 20:58:15,446 - CV - INFO - Begin Pretrain
2023-09-02 20:58:15,446 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:15,450 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:58:15,474 - FGO - INFO - Epoch  10 | Train Loss: 0.421 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:58:15,499 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:58:15,523 - FGO - INFO - Epoch  30 | Train Loss: 0.103 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:58:15,547 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:58:15,572 - FGO - INFO - Epoch  50 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:58:15,596 - FGO - INFO - Epoch  60 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:58:15,620 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:58:15,644 - FGO - INFO - Epoch  80 | Train Loss: 0.058 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:58:15,669 - FGO - INFO - Epoch  90 | Train Loss: 0.058 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:58:15,693 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:58:15,693 - FGO - INFO - Best Epoch:  28 | Train Loss: 0.112 | Val Loss: 0.09 | Val F1: 0.99 
2023-09-02 20:58:15,693 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:15,694 - CV - INFO - Pretrain Complete, 28 epochs
2023-09-02 20:58:15,694 - CV - INFO - Begin OT Train
2023-09-02 20:58:15,694 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:15,762 - FGO - INFO - Epoch   0 | Train Loss: -7.282 | Val Loss: -0.88 | Val F1: 0.94 |
2023-09-02 20:58:16,535 - FGO - INFO - Epoch  10 | Train Loss: -7.881 | Val Loss: -1.01 | Val F1: 0.96 |
2023-09-02 20:58:17,325 - FGO - INFO - Epoch  20 | Train Loss: -8.064 | Val Loss: -1.01 | Val F1: 0.95 |
2023-09-02 20:58:18,085 - FGO - INFO - Epoch  30 | Train Loss: -8.178 | Val Loss: -1.04 | Val F1: 0.96 |
2023-09-02 20:58:18,811 - FGO - INFO - Epoch  40 | Train Loss: -8.239 | Val Loss: -1.07 | Val F1: 0.98 |
2023-09-02 20:58:19,551 - FGO - INFO - Best Epoch:  31 | Train Loss: -8.183 | Val Loss: -1.07 | Val F1: 0.98 |
2023-09-02 20:58:19,551 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:19,554 - CV - INFO - OT Train Complete, 31 epochs
2023-09-02 20:58:19,554 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:19,579 - FGO - INFO - Train CM:
[[372  10]
 [ 10 316]]
2023-09-02 20:58:19,579 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:58:19,579 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:58:19,585 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:58:19,586 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:58:19,587 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:58:19,587 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:58:19,587 - CV - INFO - fold time: 4.264647722244263s (0.07107746203740438m)
2023-09-02 20:58:19,587 - CV - INFO - ----- BEGINNING FOLD SET (023:1)----------------------------------------------------------
2023-09-02 20:58:19,589 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/023/1
2023-09-02 20:58:19,589 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:19,589 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:19,589 - FGO - INFO - 	done: False
2023-09-02 20:58:19,589 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:19,589 - FGO - INFO - 	h1: 64
2023-09-02 20:58:19,589 - FGO - INFO - 	h2: 32
2023-09-02 20:58:19,589 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:19,589 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:19,589 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:19,589 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:19,589 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:19,589 - FGO - INFO - 	theta: 30
2023-09-02 20:58:19,589 - FGO - INFO - 	clip: 5
2023-09-02 20:58:19,589 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:19,589 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:19,589 - FGO - INFO - Source Total: 727
2023-09-02 20:58:19,589 - FGO - INFO - Target Total: 77
2023-09-02 20:58:19,589 - FGO - INFO - Train Total: 727
2023-09-02 20:58:19,589 - FGO - INFO - Val Total:   77
2023-09-02 20:58:19,589 - FGO - INFO - Test Total:  77
2023-09-02 20:58:19,589 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:19,589 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:19,589 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:19,589 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:19,589 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:19,590 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:19,590 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:19,590 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:19,590 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:19,590 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:19,591 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:19,592 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:19,689 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:19,689 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:19,689 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:19,689 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:19,689 - FGO - INFO - N: 804
2023-09-02 20:58:19,689 - FGO - INFO - N_s: 727
2023-09-02 20:58:19,689 - FGO - INFO - N_t: 77
2023-09-02 20:58:19,692 - CV - INFO - Begin Pretrain
2023-09-02 20:58:19,692 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:19,696 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:58:19,721 - FGO - INFO - Epoch  10 | Train Loss: 0.472 | Val Loss: 0.55 | Val F1: 0.71 |
2023-09-02 20:58:19,746 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.27 | Val F1: 0.84 |
2023-09-02 20:58:19,770 - FGO - INFO - Epoch  30 | Train Loss: 0.091 | Val Loss: 0.17 | Val F1: 0.93 |
2023-09-02 20:58:19,795 - FGO - INFO - Epoch  40 | Train Loss: 0.080 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:58:19,820 - FGO - INFO - Epoch  50 | Train Loss: 0.067 | Val Loss: 0.20 | Val F1: 0.87 |
2023-09-02 20:58:19,844 - FGO - INFO - Epoch  60 | Train Loss: 0.061 | Val Loss: 0.22 | Val F1: 0.89 |
2023-09-02 20:58:19,869 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:58:19,893 - FGO - INFO - Epoch  80 | Train Loss: 0.054 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 20:58:19,918 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.22 | Val F1: 0.90 |
2023-09-02 20:58:19,943 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.30 | Val F1: 0.89 |
2023-09-02 20:58:19,943 - FGO - INFO - Best Epoch:  34 | Train Loss: 0.088 | Val Loss: 0.17 | Val F1: 0.95 
2023-09-02 20:58:19,943 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:19,944 - CV - INFO - Pretrain Complete, 34 epochs
2023-09-02 20:58:19,944 - CV - INFO - Begin OT Train
2023-09-02 20:58:19,944 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:20,013 - FGO - INFO - Epoch   0 | Train Loss: -7.304 | Val Loss: -0.56 | Val F1: 0.90 |
2023-09-02 20:58:20,863 - FGO - INFO - Epoch  10 | Train Loss: -7.988 | Val Loss: -0.48 | Val F1: 0.87 |
2023-09-02 20:58:21,676 - FGO - INFO - Epoch  20 | Train Loss: -8.107 | Val Loss: -0.57 | Val F1: 0.88 |
2023-09-02 20:58:22,432 - FGO - INFO - Epoch  30 | Train Loss: -8.240 | Val Loss: -0.54 | Val F1: 0.88 |
2023-09-02 20:58:23,265 - FGO - INFO - Epoch  40 | Train Loss: -8.330 | Val Loss: -0.50 | Val F1: 0.89 |
2023-09-02 20:58:23,956 - FGO - INFO - Best Epoch:  42 | Train Loss: -8.345 | Val Loss: -0.52 | Val F1: 0.91 |
2023-09-02 20:58:23,956 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:23,959 - CV - INFO - OT Train Complete, 42 epochs
2023-09-02 20:58:23,959 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:23,985 - FGO - INFO - Train CM:
[[373  17]
 [  7 330]]
2023-09-02 20:58:23,986 - FGO - INFO - Val CM:
[[41  3]
 [ 4 29]]
2023-09-02 20:58:23,986 - FGO - INFO - Test CM:
[[41  3]
 [ 4 29]]
2023-09-02 20:58:23,991 - FGO - INFO - test statistical parity: 0.29487179487179493
2023-09-02 20:58:23,992 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:58:23,993 - FGO - INFO - test micro f1: 0.9090909090909091
2023-09-02 20:58:23,993 - FGO - INFO - test macro f1: 0.9068280034572169
2023-09-02 20:58:23,993 - CV - INFO - fold time: 4.406041860580444s (0.07343403100967408m)
2023-09-02 20:58:23,993 - CV - INFO - ----- BEGINNING FOLD SET (023:2)----------------------------------------------------------
2023-09-02 20:58:23,995 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/023/2
2023-09-02 20:58:23,995 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:23,995 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:23,995 - FGO - INFO - 	done: False
2023-09-02 20:58:23,995 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:23,995 - FGO - INFO - 	h1: 64
2023-09-02 20:58:23,995 - FGO - INFO - 	h2: 32
2023-09-02 20:58:23,995 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:23,995 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:23,995 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:23,995 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:23,995 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:23,995 - FGO - INFO - 	theta: 30
2023-09-02 20:58:23,995 - FGO - INFO - 	clip: 5
2023-09-02 20:58:23,995 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:23,996 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:23,996 - FGO - INFO - Source Total: 721
2023-09-02 20:58:23,996 - FGO - INFO - Target Total: 83
2023-09-02 20:58:23,996 - FGO - INFO - Train Total: 721
2023-09-02 20:58:23,996 - FGO - INFO - Val Total:   83
2023-09-02 20:58:23,996 - FGO - INFO - Test Total:  83
2023-09-02 20:58:23,996 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:23,996 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:23,996 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:23,996 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:23,996 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:23,996 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:23,996 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:23,996 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:23,996 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:23,996 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:23,997 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:23,998 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:24,101 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:24,101 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:24,101 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:24,101 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:24,101 - FGO - INFO - N: 804
2023-09-02 20:58:24,101 - FGO - INFO - N_s: 721
2023-09-02 20:58:24,101 - FGO - INFO - N_t: 83
2023-09-02 20:58:24,105 - CV - INFO - Begin Pretrain
2023-09-02 20:58:24,105 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:24,108 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:58:24,133 - FGO - INFO - Epoch  10 | Train Loss: 0.478 | Val Loss: 0.49 | Val F1: 0.84 |
2023-09-02 20:58:24,157 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.24 | Val F1: 0.87 |
2023-09-02 20:58:24,182 - FGO - INFO - Epoch  30 | Train Loss: 0.087 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:58:24,206 - FGO - INFO - Epoch  40 | Train Loss: 0.073 | Val Loss: 0.25 | Val F1: 0.90 |
2023-09-02 20:58:24,231 - FGO - INFO - Epoch  50 | Train Loss: 0.063 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:58:24,255 - FGO - INFO - Epoch  60 | Train Loss: 0.058 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:58:24,279 - FGO - INFO - Epoch  70 | Train Loss: 0.056 | Val Loss: 0.28 | Val F1: 0.91 |
2023-09-02 20:58:24,304 - FGO - INFO - Epoch  80 | Train Loss: 0.052 | Val Loss: 0.28 | Val F1: 0.88 |
2023-09-02 20:58:24,328 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.28 | Val F1: 0.89 |
2023-09-02 20:58:24,353 - FGO - INFO - Epoch 100 | Train Loss: 0.046 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:58:24,353 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.058 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:58:24,353 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:24,354 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:58:24,354 - CV - INFO - Begin OT Train
2023-09-02 20:58:24,354 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:24,424 - FGO - INFO - Epoch   0 | Train Loss: -7.148 | Val Loss: -0.51 | Val F1: 0.90 |
2023-09-02 20:58:25,248 - FGO - INFO - Epoch  10 | Train Loss: -8.027 | Val Loss: -0.54 | Val F1: 0.89 |
2023-09-02 20:58:26,045 - FGO - INFO - Epoch  20 | Train Loss: -8.208 | Val Loss: -0.67 | Val F1: 0.90 |
2023-09-02 20:58:26,812 - FGO - INFO - Epoch  30 | Train Loss: -8.336 | Val Loss: -0.55 | Val F1: 0.91 |
2023-09-02 20:58:27,553 - FGO - INFO - Epoch  40 | Train Loss: -8.404 | Val Loss: -0.48 | Val F1: 0.90 |
2023-09-02 20:58:28,377 - FGO - INFO - Best Epoch:  26 | Train Loss: -8.296 | Val Loss: -0.59 | Val F1: 0.91 |
2023-09-02 20:58:28,377 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:28,381 - CV - INFO - OT Train Complete, 26 epochs
2023-09-02 20:58:28,381 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:28,406 - FGO - INFO - Train CM:
[[378   6]
 [  9 328]]
2023-09-02 20:58:28,406 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:58:28,406 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 20:58:28,412 - FGO - INFO - test statistical parity: 0.02230046948356812
2023-09-02 20:58:28,413 - FGO - INFO - test equal opportunity: 0.2592592592592593
2023-09-02 20:58:28,414 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 20:58:28,414 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 20:58:28,414 - CV - INFO - fold time: 4.420793056488037s (0.07367988427480061m)
2023-09-02 20:58:28,414 - CV - INFO - ----- BEGINNING FOLD SET (023:3)----------------------------------------------------------
2023-09-02 20:58:28,416 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/023/3
2023-09-02 20:58:28,416 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:28,416 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:28,416 - FGO - INFO - 	done: False
2023-09-02 20:58:28,416 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:28,416 - FGO - INFO - 	h1: 64
2023-09-02 20:58:28,416 - FGO - INFO - 	h2: 32
2023-09-02 20:58:28,416 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:28,416 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:28,416 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:28,416 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:28,416 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:28,416 - FGO - INFO - 	theta: 30
2023-09-02 20:58:28,416 - FGO - INFO - 	clip: 5
2023-09-02 20:58:28,416 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:28,416 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:28,416 - FGO - INFO - Source Total: 729
2023-09-02 20:58:28,416 - FGO - INFO - Target Total: 75
2023-09-02 20:58:28,416 - FGO - INFO - Train Total: 729
2023-09-02 20:58:28,416 - FGO - INFO - Val Total:   75
2023-09-02 20:58:28,416 - FGO - INFO - Test Total:  75
2023-09-02 20:58:28,416 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:28,416 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:28,416 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:28,416 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:28,416 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:28,417 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:28,417 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:28,417 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:28,417 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:28,417 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:28,418 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:28,419 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:28,513 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:28,513 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:28,513 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:28,513 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:28,513 - FGO - INFO - N: 804
2023-09-02 20:58:28,513 - FGO - INFO - N_s: 729
2023-09-02 20:58:28,513 - FGO - INFO - N_t: 75
2023-09-02 20:58:28,517 - CV - INFO - Begin Pretrain
2023-09-02 20:58:28,517 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:28,520 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:58:28,545 - FGO - INFO - Epoch  10 | Train Loss: 0.431 | Val Loss: 0.36 | Val F1: 0.93 |
2023-09-02 20:58:28,569 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:58:28,594 - FGO - INFO - Epoch  30 | Train Loss: 0.109 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:58:28,618 - FGO - INFO - Epoch  40 | Train Loss: 0.093 | Val Loss: 0.03 | Val F1: 0.99 |
2023-09-02 20:58:28,643 - FGO - INFO - Epoch  50 | Train Loss: 0.080 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:58:28,667 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:58:28,692 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:58:28,716 - FGO - INFO - Epoch  80 | Train Loss: 0.065 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:58:28,741 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.04 | Val F1: 0.97 |
2023-09-02 20:58:28,765 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:58:28,765 - FGO - INFO - Best Epoch:  27 | Train Loss: 0.114 | Val Loss: 0.03 | Val F1: 1.00 
2023-09-02 20:58:28,765 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:28,767 - CV - INFO - Pretrain Complete, 27 epochs
2023-09-02 20:58:28,767 - CV - INFO - Begin OT Train
2023-09-02 20:58:28,767 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:28,835 - FGO - INFO - Epoch   0 | Train Loss: -7.242 | Val Loss: -0.74 | Val F1: 0.99 |
2023-09-02 20:58:29,642 - FGO - INFO - Epoch  10 | Train Loss: -7.874 | Val Loss: -0.59 | Val F1: 0.89 |
2023-09-02 20:58:30,375 - FGO - INFO - Epoch  20 | Train Loss: -8.111 | Val Loss: -0.73 | Val F1: 0.93 |
2023-09-02 20:58:31,250 - FGO - INFO - Epoch  30 | Train Loss: -8.240 | Val Loss: -0.81 | Val F1: 0.99 |
2023-09-02 20:58:32,018 - FGO - INFO - Epoch  40 | Train Loss: -8.307 | Val Loss: -0.83 | Val F1: 0.99 |
2023-09-02 20:58:32,706 - FGO - INFO - Best Epoch:  22 | Train Loss: -8.141 | Val Loss: -0.78 | Val F1: 0.99 |
2023-09-02 20:58:32,706 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:32,713 - CV - INFO - OT Train Complete, 22 epochs
2023-09-02 20:58:32,713 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:32,741 - FGO - INFO - Train CM:
[[392   4]
 [ 22 311]]
2023-09-02 20:58:32,741 - FGO - INFO - Val CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:58:32,741 - FGO - INFO - Test CM:
[[38  0]
 [ 1 36]]
2023-09-02 20:58:32,747 - FGO - INFO - test statistical parity: 0.024590163934426257
2023-09-02 20:58:32,748 - FGO - INFO - test equal opportunity: 0.033333333333333326
2023-09-02 20:58:32,749 - FGO - INFO - test micro f1: 0.9866666666666668
2023-09-02 20:58:32,749 - FGO - INFO - test macro f1: 0.9866571784380003
2023-09-02 20:58:32,749 - CV - INFO - fold time: 4.335092306137085s (0.07225153843561809m)
2023-09-02 20:58:32,749 - CV - INFO - ----- BEGINNING FOLD SET (023:4)----------------------------------------------------------
2023-09-02 20:58:32,751 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/023/4
2023-09-02 20:58:32,751 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:32,751 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:32,751 - FGO - INFO - 	done: False
2023-09-02 20:58:32,751 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:32,751 - FGO - INFO - 	h1: 64
2023-09-02 20:58:32,751 - FGO - INFO - 	h2: 32
2023-09-02 20:58:32,751 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:32,751 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:32,751 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:32,751 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:32,751 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:32,751 - FGO - INFO - 	theta: 30
2023-09-02 20:58:32,751 - FGO - INFO - 	clip: 5
2023-09-02 20:58:32,751 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:32,751 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:32,751 - FGO - INFO - Source Total: 732
2023-09-02 20:58:32,751 - FGO - INFO - Target Total: 72
2023-09-02 20:58:32,752 - FGO - INFO - Train Total: 732
2023-09-02 20:58:32,752 - FGO - INFO - Val Total:   72
2023-09-02 20:58:32,752 - FGO - INFO - Test Total:  72
2023-09-02 20:58:32,752 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:32,752 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:32,752 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:32,752 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:32,752 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:32,752 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:32,752 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:32,752 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:32,752 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:32,752 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:32,753 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:32,754 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:32,845 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:32,845 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:32,845 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:32,845 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:32,845 - FGO - INFO - N: 804
2023-09-02 20:58:32,845 - FGO - INFO - N_s: 732
2023-09-02 20:58:32,845 - FGO - INFO - N_t: 72
2023-09-02 20:58:32,849 - CV - INFO - Begin Pretrain
2023-09-02 20:58:32,849 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:32,852 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:58:32,877 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.46 | Val F1: 0.81 |
2023-09-02 20:58:32,902 - FGO - INFO - Epoch  20 | Train Loss: 0.141 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:58:32,927 - FGO - INFO - Epoch  30 | Train Loss: 0.100 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:58:32,952 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:58:32,976 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:58:33,001 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 20:58:33,026 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:58:33,050 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:58:33,075 - FGO - INFO - Epoch  90 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:58:33,100 - FGO - INFO - Epoch 100 | Train Loss: 0.069 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:58:33,100 - FGO - INFO - Best Epoch:  64 | Train Loss: 0.069 | Val Loss: 0.06 | Val F1: 0.99 
2023-09-02 20:58:33,100 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:33,101 - CV - INFO - Pretrain Complete, 64 epochs
2023-09-02 20:58:33,101 - CV - INFO - Begin OT Train
2023-09-02 20:58:33,101 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:33,199 - FGO - INFO - Epoch   0 | Train Loss: -7.413 | Val Loss: -0.71 | Val F1: 0.99 |
2023-09-02 20:58:33,996 - FGO - INFO - Epoch  10 | Train Loss: -8.097 | Val Loss: -0.75 | Val F1: 0.99 |
2023-09-02 20:58:34,733 - FGO - INFO - Epoch  20 | Train Loss: -8.261 | Val Loss: -0.79 | Val F1: 0.99 |
2023-09-02 20:58:35,562 - FGO - INFO - Epoch  30 | Train Loss: -8.352 | Val Loss: -0.79 | Val F1: 0.99 |
2023-09-02 20:58:36,391 - FGO - INFO - Epoch  40 | Train Loss: -8.400 | Val Loss: -0.78 | Val F1: 0.99 |
2023-09-02 20:58:37,062 - FGO - INFO - Best Epoch:   9 | Train Loss: -8.092 | Val Loss: -0.75 | Val F1: 0.99 |
2023-09-02 20:58:37,062 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:37,065 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:58:37,065 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:37,090 - FGO - INFO - Train CM:
[[386  11]
 [ 11 324]]
2023-09-02 20:58:37,090 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:58:37,091 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 20:58:37,096 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 20:58:37,097 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 20:58:37,098 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 20:58:37,098 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 20:58:37,098 - CV - INFO - fold time: 4.349005699157715s (0.07248342831929525m)
2023-09-02 20:58:37,098 - CV - INFO - ----- BEGINNING FOLD SET (023:5)----------------------------------------------------------
2023-09-02 20:58:37,100 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/023/5
2023-09-02 20:58:37,100 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:37,100 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:37,100 - FGO - INFO - 	done: False
2023-09-02 20:58:37,100 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:37,100 - FGO - INFO - 	h1: 64
2023-09-02 20:58:37,100 - FGO - INFO - 	h2: 32
2023-09-02 20:58:37,100 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:37,100 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:37,100 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:37,100 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:37,100 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:37,100 - FGO - INFO - 	theta: 30
2023-09-02 20:58:37,100 - FGO - INFO - 	clip: 5
2023-09-02 20:58:37,100 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:37,100 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:37,101 - FGO - INFO - Source Total: 726
2023-09-02 20:58:37,101 - FGO - INFO - Target Total: 78
2023-09-02 20:58:37,101 - FGO - INFO - Train Total: 726
2023-09-02 20:58:37,101 - FGO - INFO - Val Total:   78
2023-09-02 20:58:37,101 - FGO - INFO - Test Total:  78
2023-09-02 20:58:37,101 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:37,101 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:37,101 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:37,101 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:37,101 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:37,101 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:37,101 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:37,101 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:37,101 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:37,101 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:37,102 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:37,103 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:37,201 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:37,201 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:37,201 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:37,201 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:37,201 - FGO - INFO - N: 804
2023-09-02 20:58:37,201 - FGO - INFO - N_s: 726
2023-09-02 20:58:37,201 - FGO - INFO - N_t: 78
2023-09-02 20:58:37,205 - CV - INFO - Begin Pretrain
2023-09-02 20:58:37,205 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:37,208 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:58:37,233 - FGO - INFO - Epoch  10 | Train Loss: 0.515 | Val Loss: 0.52 | Val F1: 0.82 |
2023-09-02 20:58:37,257 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:58:37,282 - FGO - INFO - Epoch  30 | Train Loss: 0.106 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:58:37,306 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.13 | Val F1: 0.95 |
2023-09-02 20:58:37,330 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:58:37,355 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.09 | Val F1: 0.95 |
2023-09-02 20:58:37,379 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:58:37,404 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 20:58:37,428 - FGO - INFO - Epoch  90 | Train Loss: 0.064 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:58:37,452 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:58:37,452 - FGO - INFO - Best Epoch:  55 | Train Loss: 0.077 | Val Loss: 0.09 | Val F1: 0.97 
2023-09-02 20:58:37,452 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:37,454 - CV - INFO - Pretrain Complete, 55 epochs
2023-09-02 20:58:37,454 - CV - INFO - Begin OT Train
2023-09-02 20:58:37,454 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:37,543 - FGO - INFO - Epoch   0 | Train Loss: -7.128 | Val Loss: -0.68 | Val F1: 0.95 |
2023-09-02 20:58:38,317 - FGO - INFO - Epoch  10 | Train Loss: -7.938 | Val Loss: -0.34 | Val F1: 0.81 |
2023-09-02 20:58:39,135 - FGO - INFO - Epoch  20 | Train Loss: -8.133 | Val Loss: -0.56 | Val F1: 0.91 |
2023-09-02 20:58:39,956 - FGO - INFO - Epoch  30 | Train Loss: -8.263 | Val Loss: -0.53 | Val F1: 0.91 |
2023-09-02 20:58:40,725 - FGO - INFO - Epoch  40 | Train Loss: -8.321 | Val Loss: -0.55 | Val F1: 0.91 |
2023-09-02 20:58:41,421 - FGO - INFO - Best Epoch:   6 | Train Loss: -7.673 | Val Loss: -0.69 | Val F1: 0.94 |
2023-09-02 20:58:41,421 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:41,425 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:58:41,425 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:41,451 - FGO - INFO - Train CM:
[[396   4]
 [ 25 301]]
2023-09-02 20:58:41,451 - FGO - INFO - Val CM:
[[34  0]
 [ 6 38]]
2023-09-02 20:58:41,452 - FGO - INFO - Test CM:
[[34  0]
 [ 6 38]]
2023-09-02 20:58:41,456 - FGO - INFO - test statistical parity: 0.07729468599033817
2023-09-02 20:58:41,457 - FGO - INFO - test equal opportunity: 0.15384615384615385
2023-09-02 20:58:41,458 - FGO - INFO - test micro f1: 0.9230769230769231
2023-09-02 20:58:41,459 - FGO - INFO - test macro f1: 0.9228740936058009
2023-09-02 20:58:41,459 - CV - INFO - fold time: 4.360470294952393s (0.07267450491587321m)
2023-09-02 20:58:41,459 - CV - INFO - ----- BEGINNING FOLD SET (023:6)----------------------------------------------------------
2023-09-02 20:58:41,461 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/023/6
2023-09-02 20:58:41,461 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:41,461 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:41,461 - FGO - INFO - 	done: False
2023-09-02 20:58:41,461 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:41,461 - FGO - INFO - 	h1: 64
2023-09-02 20:58:41,461 - FGO - INFO - 	h2: 32
2023-09-02 20:58:41,461 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:41,461 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:41,461 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:41,461 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:41,461 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:41,461 - FGO - INFO - 	theta: 30
2023-09-02 20:58:41,461 - FGO - INFO - 	clip: 5
2023-09-02 20:58:41,461 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:41,461 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:41,461 - FGO - INFO - Source Total: 717
2023-09-02 20:58:41,461 - FGO - INFO - Target Total: 87
2023-09-02 20:58:41,461 - FGO - INFO - Train Total: 717
2023-09-02 20:58:41,461 - FGO - INFO - Val Total:   87
2023-09-02 20:58:41,461 - FGO - INFO - Test Total:  87
2023-09-02 20:58:41,461 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:41,461 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:41,461 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:41,461 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:41,461 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:41,462 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:41,462 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:41,462 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:41,462 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:41,462 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:41,463 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:41,464 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:41,570 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:41,570 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:41,570 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:41,570 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:41,570 - FGO - INFO - N: 804
2023-09-02 20:58:41,570 - FGO - INFO - N_s: 717
2023-09-02 20:58:41,570 - FGO - INFO - N_t: 87
2023-09-02 20:58:41,574 - CV - INFO - Begin Pretrain
2023-09-02 20:58:41,574 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:41,577 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:58:41,602 - FGO - INFO - Epoch  10 | Train Loss: 0.496 | Val Loss: 0.48 | Val F1: 0.80 |
2023-09-02 20:58:41,626 - FGO - INFO - Epoch  20 | Train Loss: 0.161 | Val Loss: 0.13 | Val F1: 0.93 |
2023-09-02 20:58:41,651 - FGO - INFO - Epoch  30 | Train Loss: 0.108 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:58:41,676 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.09 | Val F1: 0.98 |
2023-09-02 20:58:41,700 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:58:41,724 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:58:41,749 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:58:41,773 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:58:41,797 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:58:41,822 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:58:41,822 - FGO - INFO - Best Epoch:  73 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 1.00 
2023-09-02 20:58:41,822 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:41,823 - CV - INFO - Pretrain Complete, 73 epochs
2023-09-02 20:58:41,823 - CV - INFO - Begin OT Train
2023-09-02 20:58:41,823 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:41,891 - FGO - INFO - Epoch   0 | Train Loss: -7.410 | Val Loss: -0.91 | Val F1: 1.00 |
2023-09-02 20:58:42,660 - FGO - INFO - Epoch  10 | Train Loss: -7.993 | Val Loss: -0.94 | Val F1: 0.95 |
2023-09-02 20:58:43,452 - FGO - INFO - Epoch  20 | Train Loss: -8.098 | Val Loss: -0.93 | Val F1: 0.93 |
2023-09-02 20:58:44,240 - FGO - INFO - Epoch  30 | Train Loss: -8.181 | Val Loss: -0.95 | Val F1: 0.97 |
2023-09-02 20:58:44,946 - FGO - INFO - Epoch  40 | Train Loss: -8.249 | Val Loss: -1.01 | Val F1: 0.97 |
2023-09-02 20:58:45,662 - FGO - INFO - Best Epoch:  46 | Train Loss: -8.278 | Val Loss: -1.02 | Val F1: 0.99 |
2023-09-02 20:58:45,662 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:45,666 - CV - INFO - OT Train Complete, 46 epochs
2023-09-02 20:58:45,666 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:45,690 - FGO - INFO - Train CM:
[[383   2]
 [ 24 308]]
2023-09-02 20:58:45,691 - FGO - INFO - Val CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:58:45,691 - FGO - INFO - Test CM:
[[48  1]
 [ 0 38]]
2023-09-02 20:58:45,696 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 20:58:45,697 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:58:45,698 - FGO - INFO - test micro f1: 0.9885057471264368
2023-09-02 20:58:45,699 - FGO - INFO - test macro f1: 0.9883518543312357
2023-09-02 20:58:45,699 - CV - INFO - fold time: 4.239704370498657s (0.07066173950831095m)
2023-09-02 20:58:45,699 - CV - INFO - ----- BEGINNING FOLD SET (023:7)----------------------------------------------------------
2023-09-02 20:58:45,700 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/023/7
2023-09-02 20:58:45,700 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:45,700 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:45,700 - FGO - INFO - 	done: False
2023-09-02 20:58:45,700 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:45,700 - FGO - INFO - 	h1: 64
2023-09-02 20:58:45,700 - FGO - INFO - 	h2: 32
2023-09-02 20:58:45,701 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:45,701 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:45,701 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:45,701 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:45,701 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:45,701 - FGO - INFO - 	theta: 30
2023-09-02 20:58:45,701 - FGO - INFO - 	clip: 5
2023-09-02 20:58:45,701 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:45,701 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:45,701 - FGO - INFO - Source Total: 717
2023-09-02 20:58:45,701 - FGO - INFO - Target Total: 87
2023-09-02 20:58:45,701 - FGO - INFO - Train Total: 717
2023-09-02 20:58:45,701 - FGO - INFO - Val Total:   87
2023-09-02 20:58:45,701 - FGO - INFO - Test Total:  87
2023-09-02 20:58:45,701 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:45,701 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:45,701 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:45,701 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:45,701 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:45,701 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:45,701 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:45,701 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:45,701 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:45,701 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:45,702 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:45,704 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:45,809 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:45,809 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:45,809 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:45,809 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:45,810 - FGO - INFO - N: 804
2023-09-02 20:58:45,810 - FGO - INFO - N_s: 717
2023-09-02 20:58:45,810 - FGO - INFO - N_t: 87
2023-09-02 20:58:45,813 - CV - INFO - Begin Pretrain
2023-09-02 20:58:45,813 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:45,816 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:58:45,841 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.49 | Val F1: 0.86 |
2023-09-02 20:58:45,866 - FGO - INFO - Epoch  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 |
2023-09-02 20:58:45,891 - FGO - INFO - Epoch  30 | Train Loss: 0.097 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:58:45,915 - FGO - INFO - Epoch  40 | Train Loss: 0.081 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:58:45,940 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:58:45,964 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:58:45,989 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:58:46,013 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:58:46,038 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:58:46,062 - FGO - INFO - Epoch 100 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.95 |
2023-09-02 20:58:46,062 - FGO - INFO - Best Epoch:  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 
2023-09-02 20:58:46,062 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:46,064 - CV - INFO - Pretrain Complete, 20 epochs
2023-09-02 20:58:46,064 - CV - INFO - Begin OT Train
2023-09-02 20:58:46,064 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:46,133 - FGO - INFO - Epoch   0 | Train Loss: -7.359 | Val Loss: -0.73 | Val F1: 0.95 |
2023-09-02 20:58:46,964 - FGO - INFO - Epoch  10 | Train Loss: -8.071 | Val Loss: -0.85 | Val F1: 0.97 |
2023-09-02 20:58:47,744 - FGO - INFO - Epoch  20 | Train Loss: -8.240 | Val Loss: -0.85 | Val F1: 0.97 |
2023-09-02 20:58:48,579 - FGO - INFO - Epoch  30 | Train Loss: -8.322 | Val Loss: -0.84 | Val F1: 0.97 |
2023-09-02 20:58:49,322 - FGO - INFO - Epoch  40 | Train Loss: -8.376 | Val Loss: -0.84 | Val F1: 0.97 |
2023-09-02 20:58:49,990 - FGO - INFO - Best Epoch:  10 | Train Loss: -8.071 | Val Loss: -0.85 | Val F1: 0.97 |
2023-09-02 20:58:49,990 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:49,993 - CV - INFO - OT Train Complete, 10 epochs
2023-09-02 20:58:49,993 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:50,019 - FGO - INFO - Train CM:
[[378   9]
 [ 12 318]]
2023-09-02 20:58:50,020 - FGO - INFO - Val CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:58:50,020 - FGO - INFO - Test CM:
[[46  1]
 [ 2 38]]
2023-09-02 20:58:50,025 - FGO - INFO - test statistical parity: 0.35
2023-09-02 20:58:50,027 - FGO - INFO - test equal opportunity: 0.06451612903225812
2023-09-02 20:58:50,028 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 20:58:50,028 - FGO - INFO - test macro f1: 0.9652231845436376
2023-09-02 20:58:50,028 - CV - INFO - fold time: 4.32951283454895s (0.07215854724248251m)
2023-09-02 20:58:50,028 - CV - INFO - ----- BEGINNING FOLD SET (023:8)----------------------------------------------------------
2023-09-02 20:58:50,030 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/023/8
2023-09-02 20:58:50,030 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:50,030 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:50,030 - FGO - INFO - 	done: False
2023-09-02 20:58:50,030 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:50,030 - FGO - INFO - 	h1: 64
2023-09-02 20:58:50,030 - FGO - INFO - 	h2: 32
2023-09-02 20:58:50,030 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:50,030 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:50,030 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:50,030 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:50,030 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:50,030 - FGO - INFO - 	theta: 30
2023-09-02 20:58:50,030 - FGO - INFO - 	clip: 5
2023-09-02 20:58:50,030 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:50,030 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:50,030 - FGO - INFO - Source Total: 734
2023-09-02 20:58:50,030 - FGO - INFO - Target Total: 70
2023-09-02 20:58:50,030 - FGO - INFO - Train Total: 734
2023-09-02 20:58:50,030 - FGO - INFO - Val Total:   70
2023-09-02 20:58:50,030 - FGO - INFO - Test Total:  70
2023-09-02 20:58:50,030 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:50,030 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:50,030 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:50,030 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:50,030 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:50,031 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:50,031 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:50,031 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:50,031 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:50,031 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:50,032 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:50,033 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:50,121 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:50,121 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:50,121 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:50,121 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:50,121 - FGO - INFO - N: 804
2023-09-02 20:58:50,121 - FGO - INFO - N_s: 734
2023-09-02 20:58:50,121 - FGO - INFO - N_t: 70
2023-09-02 20:58:50,125 - CV - INFO - Begin Pretrain
2023-09-02 20:58:50,125 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:50,128 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:58:50,165 - FGO - INFO - Epoch  10 | Train Loss: 0.450 | Val Loss: 0.48 | Val F1: 0.81 |
2023-09-02 20:58:50,191 - FGO - INFO - Epoch  20 | Train Loss: 0.149 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:58:50,217 - FGO - INFO - Epoch  30 | Train Loss: 0.104 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:58:50,242 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:58:50,267 - FGO - INFO - Epoch  50 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:58:50,291 - FGO - INFO - Epoch  60 | Train Loss: 0.067 | Val Loss: 0.11 | Val F1: 0.96 |
2023-09-02 20:58:50,316 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.96 |
2023-09-02 20:58:50,340 - FGO - INFO - Epoch  80 | Train Loss: 0.072 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:58:50,365 - FGO - INFO - Epoch  90 | Train Loss: 0.061 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:58:50,390 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:58:50,390 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.117 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:58:50,390 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:50,391 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:58:50,391 - CV - INFO - Begin OT Train
2023-09-02 20:58:50,391 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:50,461 - FGO - INFO - Epoch   0 | Train Loss: -7.356 | Val Loss: -0.55 | Val F1: 0.93 |
2023-09-02 20:58:51,341 - FGO - INFO - Epoch  10 | Train Loss: -7.968 | Val Loss: -0.42 | Val F1: 0.90 |
2023-09-02 20:58:52,174 - FGO - INFO - Epoch  20 | Train Loss: -8.174 | Val Loss: -0.54 | Val F1: 0.94 |
2023-09-02 20:58:52,946 - FGO - INFO - Epoch  30 | Train Loss: -8.299 | Val Loss: -0.57 | Val F1: 0.96 |
2023-09-02 20:58:53,715 - FGO - INFO - Epoch  40 | Train Loss: -8.358 | Val Loss: -0.56 | Val F1: 0.96 |
2023-09-02 20:58:54,450 - FGO - INFO - Best Epoch:  30 | Train Loss: -8.299 | Val Loss: -0.57 | Val F1: 0.96 |
2023-09-02 20:58:54,450 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:54,453 - CV - INFO - OT Train Complete, 30 epochs
2023-09-02 20:58:54,454 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:54,479 - FGO - INFO - Train CM:
[[391   9]
 [ 11 323]]
2023-09-02 20:58:54,479 - FGO - INFO - Val CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:58:54,480 - FGO - INFO - Test CM:
[[34  0]
 [ 3 33]]
2023-09-02 20:58:54,485 - FGO - INFO - test statistical parity: 0.10661268556005393
2023-09-02 20:58:54,486 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 20:58:54,487 - FGO - INFO - test micro f1: 0.9571428571428572
2023-09-02 20:58:54,487 - FGO - INFO - test macro f1: 0.9571341090018372
2023-09-02 20:58:54,487 - CV - INFO - fold time: 4.458992004394531s (0.07431653340657553m)
2023-09-02 20:58:54,487 - CV - INFO - ----- BEGINNING FOLD SET (023:9)----------------------------------------------------------
2023-09-02 20:58:54,489 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/023/9
2023-09-02 20:58:54,489 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:54,489 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:54,489 - FGO - INFO - 	done: False
2023-09-02 20:58:54,489 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:54,489 - FGO - INFO - 	h1: 64
2023-09-02 20:58:54,489 - FGO - INFO - 	h2: 32
2023-09-02 20:58:54,489 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:54,489 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:54,489 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:54,489 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:54,489 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:54,489 - FGO - INFO - 	theta: 30
2023-09-02 20:58:54,489 - FGO - INFO - 	clip: 5
2023-09-02 20:58:54,489 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:54,489 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:54,489 - FGO - INFO - Source Total: 725
2023-09-02 20:58:54,489 - FGO - INFO - Target Total: 79
2023-09-02 20:58:54,489 - FGO - INFO - Train Total: 725
2023-09-02 20:58:54,489 - FGO - INFO - Val Total:   79
2023-09-02 20:58:54,489 - FGO - INFO - Test Total:  79
2023-09-02 20:58:54,489 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:54,489 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:54,489 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:54,489 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:54,489 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:54,490 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:54,490 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:54,490 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:54,490 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:54,490 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:54,491 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:54,492 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:54,590 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:54,590 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:54,590 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:54,590 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:54,590 - FGO - INFO - N: 804
2023-09-02 20:58:54,590 - FGO - INFO - N_s: 725
2023-09-02 20:58:54,590 - FGO - INFO - N_t: 79
2023-09-02 20:58:54,594 - CV - INFO - Begin Pretrain
2023-09-02 20:58:54,594 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:54,597 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:58:54,622 - FGO - INFO - Epoch  10 | Train Loss: 0.471 | Val Loss: 0.48 | Val F1: 0.87 |
2023-09-02 20:58:54,647 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:58:54,672 - FGO - INFO - Epoch  30 | Train Loss: 0.102 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:58:54,696 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.21 | Val F1: 0.97 |
2023-09-02 20:58:54,720 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:58:54,745 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:58:54,769 - FGO - INFO - Epoch  70 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:58:54,794 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:58:54,818 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:58:54,843 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:58:54,843 - FGO - INFO - Best Epoch:  25 | Train Loss: 0.119 | Val Loss: 0.24 | Val F1: 0.97 
2023-09-02 20:58:54,843 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:54,844 - CV - INFO - Pretrain Complete, 25 epochs
2023-09-02 20:58:54,844 - CV - INFO - Begin OT Train
2023-09-02 20:58:54,844 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:54,945 - FGO - INFO - Epoch   0 | Train Loss: -7.380 | Val Loss: -0.70 | Val F1: 0.97 |
2023-09-02 20:58:55,729 - FGO - INFO - Epoch  10 | Train Loss: -8.003 | Val Loss: -0.77 | Val F1: 0.93 |
2023-09-02 20:58:56,467 - FGO - INFO - Epoch  20 | Train Loss: -8.179 | Val Loss: -0.82 | Val F1: 0.99 |
2023-09-02 20:58:57,264 - FGO - INFO - Epoch  30 | Train Loss: -8.294 | Val Loss: -0.87 | Val F1: 0.99 |
2023-09-02 20:58:58,013 - FGO - INFO - Epoch  40 | Train Loss: -8.351 | Val Loss: -0.85 | Val F1: 0.97 |
2023-09-02 20:58:58,733 - FGO - INFO - Best Epoch:  19 | Train Loss: -8.176 | Val Loss: -0.83 | Val F1: 0.99 |
2023-09-02 20:58:58,733 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:58,737 - CV - INFO - OT Train Complete, 19 epochs
2023-09-02 20:58:58,737 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:58:58,762 - FGO - INFO - Train CM:
[[377   8]
 [ 12 328]]
2023-09-02 20:58:58,762 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:58:58,763 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 20:58:58,768 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 20:58:58,769 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:58:58,770 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 20:58:58,770 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 20:58:58,770 - CV - INFO - fold time: 4.282983303070068s (0.0713830550511678m)
2023-09-02 20:58:58,770 - CV - INFO - Mean Pretrain Epochs 41.0:
2023-09-02 20:58:58,770 - CV - INFO - Mean OT Train Epochs 24.1:
2023-09-02 20:58:58,770 - CV - INFO - Mean Val Macro F1 : 0.956494175112778
2023-09-02 20:58:58,770 - CV - INFO - Mean Eval Stat : 0.956494175112778 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:58:58,770 - CV - INFO - set time: 43.447794675827026s (0.7241299112637838m)
2023-09-02 20:58:58,770 - CV - INFO - script time so far: 1036.721507549286s (17.278691792488097m) (0.2879781965414683h)
2023-09-02 20:58:58,770 - CV - INFO - ===== BEGINNING OPTION SET (024)==========================================================
2023-09-02 20:58:58,770 - CV - INFO - 	done: False
2023-09-02 20:58:58,770 - CV - INFO - 	learning_rate: 0.01
2023-09-02 20:58:58,770 - CV - INFO - 	h1: 64
2023-09-02 20:58:58,771 - CV - INFO - 	h2: 32
2023-09-02 20:58:58,771 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:58,771 - CV - INFO - 	dropout: 0.0
2023-09-02 20:58:58,771 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:58,771 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:58,771 - CV - INFO - 	lambda: 0.03
2023-09-02 20:58:58,771 - CV - INFO - 	theta: 50
2023-09-02 20:58:58,771 - CV - INFO - 	clip: 5
2023-09-02 20:58:58,771 - CV - INFO - ----- BEGINNING FOLD SET (024:0)----------------------------------------------------------
2023-09-02 20:58:58,772 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/024/0
2023-09-02 20:58:58,772 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:58:58,772 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:58:58,772 - FGO - INFO - 	done: False
2023-09-02 20:58:58,772 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:58:58,772 - FGO - INFO - 	h1: 64
2023-09-02 20:58:58,772 - FGO - INFO - 	h2: 32
2023-09-02 20:58:58,772 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:58:58,772 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:58:58,772 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:58:58,773 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:58:58,773 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:58:58,773 - FGO - INFO - 	theta: 50
2023-09-02 20:58:58,773 - FGO - INFO - 	clip: 5
2023-09-02 20:58:58,773 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:58:58,773 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:58:58,773 - FGO - INFO - Source Total: 708
2023-09-02 20:58:58,773 - FGO - INFO - Target Total: 96
2023-09-02 20:58:58,773 - FGO - INFO - Train Total: 708
2023-09-02 20:58:58,773 - FGO - INFO - Val Total:   96
2023-09-02 20:58:58,773 - FGO - INFO - Test Total:  96
2023-09-02 20:58:58,773 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:58:58,773 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:58:58,773 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:58:58,773 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:58:58,773 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:58:58,773 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:58:58,773 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:58:58,773 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:58:58,773 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:58:58,773 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:58:58,774 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:58:58,776 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:58:58,891 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:58:58,891 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:58:58,891 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:58:58,891 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:58:58,891 - FGO - INFO - N: 804
2023-09-02 20:58:58,891 - FGO - INFO - N_s: 708
2023-09-02 20:58:58,891 - FGO - INFO - N_t: 96
2023-09-02 20:58:58,895 - CV - INFO - Begin Pretrain
2023-09-02 20:58:58,895 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:58:58,898 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:58:58,923 - FGO - INFO - Epoch  10 | Train Loss: 0.421 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:58:58,947 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:58:58,971 - FGO - INFO - Epoch  30 | Train Loss: 0.103 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:58:58,995 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:58:59,020 - FGO - INFO - Epoch  50 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:58:59,044 - FGO - INFO - Epoch  60 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:58:59,068 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:58:59,092 - FGO - INFO - Epoch  80 | Train Loss: 0.058 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:58:59,117 - FGO - INFO - Epoch  90 | Train Loss: 0.058 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:58:59,141 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:58:59,141 - FGO - INFO - Best Epoch:  28 | Train Loss: 0.112 | Val Loss: 0.09 | Val F1: 0.99 
2023-09-02 20:58:59,141 - FGO - INFO - Setting model to best state.
2023-09-02 20:58:59,142 - CV - INFO - Pretrain Complete, 28 epochs
2023-09-02 20:58:59,142 - CV - INFO - Begin OT Train
2023-09-02 20:58:59,142 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:58:59,210 - FGO - INFO - Epoch   0 | Train Loss: -12.254 | Val Loss: -1.57 | Val F1: 0.94 |
2023-09-02 20:59:00,009 - FGO - INFO - Epoch  10 | Train Loss: -13.348 | Val Loss: -1.71 | Val F1: 0.95 |
2023-09-02 20:59:00,786 - FGO - INFO - Epoch  20 | Train Loss: -13.927 | Val Loss: -1.37 | Val F1: 0.53 |
2023-09-02 20:59:01,513 - FGO - INFO - Epoch  30 | Train Loss: -13.948 | Val Loss: -1.36 | Val F1: 0.35 |
2023-09-02 20:59:02,327 - FGO - INFO - Epoch  40 | Train Loss: -13.949 | Val Loss: -1.36 | Val F1: 0.35 |
2023-09-02 20:59:02,996 - FGO - INFO - Best Epoch:  11 | Train Loss: -13.495 | Val Loss: -1.73 | Val F1: 0.97 |
2023-09-02 20:59:02,996 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:02,998 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:59:02,999 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:03,022 - FGO - INFO - Train CM:
[[382   0]
 [326   0]]
2023-09-02 20:59:03,022 - FGO - INFO - Val CM:
[[52  0]
 [44  0]]
2023-09-02 20:59:03,023 - FGO - INFO - Test CM:
[[52  0]
 [44  0]]
2023-09-02 20:59:03,028 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:59:03,029 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:03,030 - FGO - INFO - test micro f1: 0.5416666666666666
2023-09-02 20:59:03,031 - FGO - INFO - test macro f1: 0.35135135135135137
2023-09-02 20:59:03,031 - CV - INFO - fold time: 4.260281801223755s (0.07100469668706258m)
2023-09-02 20:59:03,031 - CV - INFO - ----- BEGINNING FOLD SET (024:1)----------------------------------------------------------
2023-09-02 20:59:03,032 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/024/1
2023-09-02 20:59:03,033 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:03,033 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:03,033 - FGO - INFO - 	done: False
2023-09-02 20:59:03,033 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:03,033 - FGO - INFO - 	h1: 64
2023-09-02 20:59:03,033 - FGO - INFO - 	h2: 32
2023-09-02 20:59:03,033 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:03,033 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:03,033 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:03,033 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:03,033 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:59:03,033 - FGO - INFO - 	theta: 50
2023-09-02 20:59:03,033 - FGO - INFO - 	clip: 5
2023-09-02 20:59:03,033 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:03,033 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:03,033 - FGO - INFO - Source Total: 727
2023-09-02 20:59:03,033 - FGO - INFO - Target Total: 77
2023-09-02 20:59:03,033 - FGO - INFO - Train Total: 727
2023-09-02 20:59:03,033 - FGO - INFO - Val Total:   77
2023-09-02 20:59:03,033 - FGO - INFO - Test Total:  77
2023-09-02 20:59:03,033 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:03,033 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:03,033 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:03,033 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:03,033 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:03,034 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:03,034 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:03,034 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:03,034 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:03,034 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:03,035 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:03,036 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:03,132 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:03,132 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:03,132 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:03,132 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:03,132 - FGO - INFO - N: 804
2023-09-02 20:59:03,132 - FGO - INFO - N_s: 727
2023-09-02 20:59:03,132 - FGO - INFO - N_t: 77
2023-09-02 20:59:03,135 - CV - INFO - Begin Pretrain
2023-09-02 20:59:03,135 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:03,139 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:59:03,168 - FGO - INFO - Epoch  10 | Train Loss: 0.472 | Val Loss: 0.55 | Val F1: 0.71 |
2023-09-02 20:59:03,196 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.27 | Val F1: 0.84 |
2023-09-02 20:59:03,224 - FGO - INFO - Epoch  30 | Train Loss: 0.091 | Val Loss: 0.17 | Val F1: 0.93 |
2023-09-02 20:59:03,252 - FGO - INFO - Epoch  40 | Train Loss: 0.080 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:59:03,279 - FGO - INFO - Epoch  50 | Train Loss: 0.067 | Val Loss: 0.20 | Val F1: 0.87 |
2023-09-02 20:59:03,305 - FGO - INFO - Epoch  60 | Train Loss: 0.061 | Val Loss: 0.22 | Val F1: 0.89 |
2023-09-02 20:59:03,329 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:59:03,354 - FGO - INFO - Epoch  80 | Train Loss: 0.054 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 20:59:03,378 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.21 | Val F1: 0.92 |
2023-09-02 20:59:03,403 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:59:03,403 - FGO - INFO - Best Epoch:  34 | Train Loss: 0.088 | Val Loss: 0.17 | Val F1: 0.95 
2023-09-02 20:59:03,403 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:03,404 - CV - INFO - Pretrain Complete, 34 epochs
2023-09-02 20:59:03,404 - CV - INFO - Begin OT Train
2023-09-02 20:59:03,404 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:03,512 - FGO - INFO - Epoch   0 | Train Loss: -12.272 | Val Loss: -1.05 | Val F1: 0.90 |
2023-09-02 20:59:04,388 - FGO - INFO - Epoch  10 | Train Loss: -13.493 | Val Loss: -0.91 | Val F1: 0.83 |
2023-09-02 20:59:05,148 - FGO - INFO - Epoch  20 | Train Loss: -14.180 | Val Loss: -0.81 | Val F1: 0.61 |
2023-09-02 20:59:05,932 - FGO - INFO - Epoch  30 | Train Loss: -14.219 | Val Loss: -0.80 | Val F1: 0.36 |
2023-09-02 20:59:06,698 - FGO - INFO - Epoch  40 | Train Loss: -14.220 | Val Loss: -0.80 | Val F1: 0.36 |
2023-09-02 20:59:07,354 - FGO - INFO - Best Epoch:   7 | Train Loss: -13.233 | Val Loss: -1.06 | Val F1: 0.89 |
2023-09-02 20:59:07,354 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:07,357 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:59:07,358 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:07,385 - FGO - INFO - Train CM:
[[390   0]
 [337   0]]
2023-09-02 20:59:07,385 - FGO - INFO - Val CM:
[[44  0]
 [33  0]]
2023-09-02 20:59:07,386 - FGO - INFO - Test CM:
[[44  0]
 [33  0]]
2023-09-02 20:59:07,391 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:59:07,392 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:07,393 - FGO - INFO - test micro f1: 0.5714285714285714
2023-09-02 20:59:07,394 - FGO - INFO - test macro f1: 0.36363636363636365
2023-09-02 20:59:07,394 - CV - INFO - fold time: 4.362745046615601s (0.07271241744359334m)
2023-09-02 20:59:07,394 - CV - INFO - ----- BEGINNING FOLD SET (024:2)----------------------------------------------------------
2023-09-02 20:59:07,395 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/024/2
2023-09-02 20:59:07,395 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:07,395 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:07,396 - FGO - INFO - 	done: False
2023-09-02 20:59:07,396 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:07,396 - FGO - INFO - 	h1: 64
2023-09-02 20:59:07,396 - FGO - INFO - 	h2: 32
2023-09-02 20:59:07,396 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:07,396 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:07,396 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:07,396 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:07,396 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:59:07,396 - FGO - INFO - 	theta: 50
2023-09-02 20:59:07,396 - FGO - INFO - 	clip: 5
2023-09-02 20:59:07,396 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:07,396 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:07,396 - FGO - INFO - Source Total: 721
2023-09-02 20:59:07,396 - FGO - INFO - Target Total: 83
2023-09-02 20:59:07,396 - FGO - INFO - Train Total: 721
2023-09-02 20:59:07,396 - FGO - INFO - Val Total:   83
2023-09-02 20:59:07,396 - FGO - INFO - Test Total:  83
2023-09-02 20:59:07,396 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:07,396 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:07,396 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:07,396 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:07,396 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:07,396 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:07,396 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:07,396 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:07,396 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:07,397 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:07,397 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:07,399 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:07,501 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:07,501 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:07,501 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:07,501 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:07,501 - FGO - INFO - N: 804
2023-09-02 20:59:07,501 - FGO - INFO - N_s: 721
2023-09-02 20:59:07,501 - FGO - INFO - N_t: 83
2023-09-02 20:59:07,505 - CV - INFO - Begin Pretrain
2023-09-02 20:59:07,505 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:07,508 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:59:07,533 - FGO - INFO - Epoch  10 | Train Loss: 0.478 | Val Loss: 0.49 | Val F1: 0.84 |
2023-09-02 20:59:07,558 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.24 | Val F1: 0.87 |
2023-09-02 20:59:07,582 - FGO - INFO - Epoch  30 | Train Loss: 0.087 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:59:07,606 - FGO - INFO - Epoch  40 | Train Loss: 0.073 | Val Loss: 0.25 | Val F1: 0.90 |
2023-09-02 20:59:07,631 - FGO - INFO - Epoch  50 | Train Loss: 0.063 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:59:07,655 - FGO - INFO - Epoch  60 | Train Loss: 0.058 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:59:07,680 - FGO - INFO - Epoch  70 | Train Loss: 0.056 | Val Loss: 0.28 | Val F1: 0.91 |
2023-09-02 20:59:07,704 - FGO - INFO - Epoch  80 | Train Loss: 0.052 | Val Loss: 0.28 | Val F1: 0.88 |
2023-09-02 20:59:07,729 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.28 | Val F1: 0.89 |
2023-09-02 20:59:07,753 - FGO - INFO - Epoch 100 | Train Loss: 0.046 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:59:07,753 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.058 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:59:07,753 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:07,755 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:59:07,755 - CV - INFO - Begin OT Train
2023-09-02 20:59:07,755 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:07,854 - FGO - INFO - Epoch   0 | Train Loss: -12.116 | Val Loss: -1.05 | Val F1: 0.90 |
2023-09-02 20:59:08,672 - FGO - INFO - Epoch  10 | Train Loss: -13.616 | Val Loss: -1.11 | Val F1: 0.88 |
2023-09-02 20:59:09,463 - FGO - INFO - Epoch  20 | Train Loss: -14.179 | Val Loss: -0.93 | Val F1: 0.52 |
2023-09-02 20:59:10,185 - FGO - INFO - Epoch  30 | Train Loss: -14.206 | Val Loss: -0.92 | Val F1: 0.38 |
2023-09-02 20:59:10,938 - FGO - INFO - Epoch  40 | Train Loss: -14.206 | Val Loss: -0.92 | Val F1: 0.38 |
2023-09-02 20:59:11,568 - FGO - INFO - Best Epoch:   7 | Train Loss: -13.315 | Val Loss: -1.16 | Val F1: 0.91 |
2023-09-02 20:59:11,568 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:11,571 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 20:59:11,571 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:11,595 - FGO - INFO - Train CM:
[[384   0]
 [337   0]]
2023-09-02 20:59:11,595 - FGO - INFO - Val CM:
[[50  0]
 [33  0]]
2023-09-02 20:59:11,595 - FGO - INFO - Test CM:
[[50  0]
 [33  0]]
2023-09-02 20:59:11,601 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:59:11,602 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:11,603 - FGO - INFO - test micro f1: 0.6024096385542169
2023-09-02 20:59:11,603 - FGO - INFO - test macro f1: 0.3759398496240602
2023-09-02 20:59:11,603 - CV - INFO - fold time: 4.20979380607605s (0.0701632301012675m)
2023-09-02 20:59:11,603 - CV - INFO - ----- BEGINNING FOLD SET (024:3)----------------------------------------------------------
2023-09-02 20:59:11,605 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/024/3
2023-09-02 20:59:11,605 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:11,605 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:11,605 - FGO - INFO - 	done: False
2023-09-02 20:59:11,605 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:11,605 - FGO - INFO - 	h1: 64
2023-09-02 20:59:11,605 - FGO - INFO - 	h2: 32
2023-09-02 20:59:11,605 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:11,605 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:11,605 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:11,605 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:11,605 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:59:11,605 - FGO - INFO - 	theta: 50
2023-09-02 20:59:11,605 - FGO - INFO - 	clip: 5
2023-09-02 20:59:11,605 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:11,606 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:11,606 - FGO - INFO - Source Total: 729
2023-09-02 20:59:11,606 - FGO - INFO - Target Total: 75
2023-09-02 20:59:11,606 - FGO - INFO - Train Total: 729
2023-09-02 20:59:11,606 - FGO - INFO - Val Total:   75
2023-09-02 20:59:11,606 - FGO - INFO - Test Total:  75
2023-09-02 20:59:11,606 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:11,606 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:11,606 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:11,606 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:11,606 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:11,606 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:11,606 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:11,606 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:11,606 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:11,606 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:11,607 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:11,609 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:11,703 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:11,703 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:11,703 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:11,703 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:11,707 - FGO - INFO - N: 804
2023-09-02 20:59:11,707 - FGO - INFO - N_s: 729
2023-09-02 20:59:11,707 - FGO - INFO - N_t: 75
2023-09-02 20:59:11,711 - CV - INFO - Begin Pretrain
2023-09-02 20:59:11,711 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:11,714 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:59:11,739 - FGO - INFO - Epoch  10 | Train Loss: 0.431 | Val Loss: 0.36 | Val F1: 0.93 |
2023-09-02 20:59:11,764 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:59:11,788 - FGO - INFO - Epoch  30 | Train Loss: 0.109 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:59:11,813 - FGO - INFO - Epoch  40 | Train Loss: 0.093 | Val Loss: 0.03 | Val F1: 0.99 |
2023-09-02 20:59:11,837 - FGO - INFO - Epoch  50 | Train Loss: 0.080 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:59:11,862 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:59:11,887 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:59:11,911 - FGO - INFO - Epoch  80 | Train Loss: 0.065 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:59:11,936 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:59:11,960 - FGO - INFO - Epoch 100 | Train Loss: 0.069 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:59:11,960 - FGO - INFO - Best Epoch:  27 | Train Loss: 0.114 | Val Loss: 0.03 | Val F1: 1.00 
2023-09-02 20:59:11,960 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:11,962 - CV - INFO - Pretrain Complete, 27 epochs
2023-09-02 20:59:11,962 - CV - INFO - Begin OT Train
2023-09-02 20:59:11,962 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:12,059 - FGO - INFO - Epoch   0 | Train Loss: -12.178 | Val Loss: -1.25 | Val F1: 0.97 |
2023-09-02 20:59:12,877 - FGO - INFO - Epoch  10 | Train Loss: -13.472 | Val Loss: -1.14 | Val F1: 0.88 |
2023-09-02 20:59:13,655 - FGO - INFO - Epoch  20 | Train Loss: -13.866 | Val Loss: -1.12 | Val F1: 0.88 |
2023-09-02 20:59:14,419 - FGO - INFO - Epoch  30 | Train Loss: -14.122 | Val Loss: -0.86 | Val F1: 0.34 |
2023-09-02 20:59:15,311 - FGO - INFO - Epoch  40 | Train Loss: -14.124 | Val Loss: -0.86 | Val F1: 0.34 |
2023-09-02 20:59:15,977 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.107 | Val Loss: -1.33 | Val F1: 0.97 |
2023-09-02 20:59:15,977 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:15,980 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:59:15,980 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:16,011 - FGO - INFO - Train CM:
[[396   0]
 [333   0]]
2023-09-02 20:59:16,011 - FGO - INFO - Val CM:
[[38  0]
 [37  0]]
2023-09-02 20:59:16,012 - FGO - INFO - Test CM:
[[38  0]
 [37  0]]
2023-09-02 20:59:16,017 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:59:16,018 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:16,019 - FGO - INFO - test micro f1: 0.5066666666666667
2023-09-02 20:59:16,019 - FGO - INFO - test macro f1: 0.33628318584070793
2023-09-02 20:59:16,019 - CV - INFO - fold time: 4.415789842605591s (0.07359649737675984m)
2023-09-02 20:59:16,019 - CV - INFO - ----- BEGINNING FOLD SET (024:4)----------------------------------------------------------
2023-09-02 20:59:16,021 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/024/4
2023-09-02 20:59:16,021 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:16,021 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:16,021 - FGO - INFO - 	done: False
2023-09-02 20:59:16,021 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:16,021 - FGO - INFO - 	h1: 64
2023-09-02 20:59:16,021 - FGO - INFO - 	h2: 32
2023-09-02 20:59:16,021 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:16,021 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:16,021 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:16,021 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:16,021 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:59:16,021 - FGO - INFO - 	theta: 50
2023-09-02 20:59:16,021 - FGO - INFO - 	clip: 5
2023-09-02 20:59:16,021 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:16,021 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:16,021 - FGO - INFO - Source Total: 732
2023-09-02 20:59:16,021 - FGO - INFO - Target Total: 72
2023-09-02 20:59:16,021 - FGO - INFO - Train Total: 732
2023-09-02 20:59:16,021 - FGO - INFO - Val Total:   72
2023-09-02 20:59:16,021 - FGO - INFO - Test Total:  72
2023-09-02 20:59:16,021 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:16,021 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:16,021 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:16,021 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:16,021 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:16,022 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:16,022 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:16,022 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:16,022 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:16,022 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:16,023 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:16,024 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:16,116 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:16,116 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:16,116 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:16,116 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:16,116 - FGO - INFO - N: 804
2023-09-02 20:59:16,116 - FGO - INFO - N_s: 732
2023-09-02 20:59:16,116 - FGO - INFO - N_t: 72
2023-09-02 20:59:16,119 - CV - INFO - Begin Pretrain
2023-09-02 20:59:16,119 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:16,123 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:59:16,148 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.46 | Val F1: 0.81 |
2023-09-02 20:59:16,173 - FGO - INFO - Epoch  20 | Train Loss: 0.141 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:59:16,197 - FGO - INFO - Epoch  30 | Train Loss: 0.100 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:59:16,222 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:59:16,247 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:59:16,271 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 20:59:16,296 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:59:16,321 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:59:16,345 - FGO - INFO - Epoch  90 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:59:16,370 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:59:16,370 - FGO - INFO - Best Epoch:  64 | Train Loss: 0.069 | Val Loss: 0.06 | Val F1: 0.99 
2023-09-02 20:59:16,370 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:16,371 - CV - INFO - Pretrain Complete, 64 epochs
2023-09-02 20:59:16,371 - CV - INFO - Begin OT Train
2023-09-02 20:59:16,371 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:16,470 - FGO - INFO - Epoch   0 | Train Loss: -12.399 | Val Loss: -1.22 | Val F1: 0.99 |
2023-09-02 20:59:17,359 - FGO - INFO - Epoch  10 | Train Loss: -13.745 | Val Loss: -1.25 | Val F1: 0.94 |
2023-09-02 20:59:18,204 - FGO - INFO - Epoch  20 | Train Loss: -14.102 | Val Loss: -0.82 | Val F1: 0.34 |
2023-09-02 20:59:19,002 - FGO - INFO - Epoch  30 | Train Loss: -14.104 | Val Loss: -0.82 | Val F1: 0.34 |
2023-09-02 20:59:19,734 - FGO - INFO - Epoch  40 | Train Loss: -14.104 | Val Loss: -0.82 | Val F1: 0.34 |
2023-09-02 20:59:20,423 - FGO - INFO - Best Epoch:  11 | Train Loss: -13.767 | Val Loss: -1.23 | Val F1: 0.96 |
2023-09-02 20:59:20,423 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:20,426 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:59:20,426 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:20,453 - FGO - INFO - Train CM:
[[397   0]
 [335   0]]
2023-09-02 20:59:20,453 - FGO - INFO - Val CM:
[[37  0]
 [35  0]]
2023-09-02 20:59:20,454 - FGO - INFO - Test CM:
[[37  0]
 [35  0]]
2023-09-02 20:59:20,459 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:59:20,460 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:20,461 - FGO - INFO - test micro f1: 0.5138888888888888
2023-09-02 20:59:20,462 - FGO - INFO - test macro f1: 0.33944954128440363
2023-09-02 20:59:20,462 - CV - INFO - fold time: 4.44225549697876s (0.07403759161631267m)
2023-09-02 20:59:20,462 - CV - INFO - ----- BEGINNING FOLD SET (024:5)----------------------------------------------------------
2023-09-02 20:59:20,463 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/024/5
2023-09-02 20:59:20,464 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:20,464 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:20,464 - FGO - INFO - 	done: False
2023-09-02 20:59:20,464 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:20,464 - FGO - INFO - 	h1: 64
2023-09-02 20:59:20,464 - FGO - INFO - 	h2: 32
2023-09-02 20:59:20,464 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:20,464 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:20,464 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:20,464 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:20,464 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:59:20,464 - FGO - INFO - 	theta: 50
2023-09-02 20:59:20,464 - FGO - INFO - 	clip: 5
2023-09-02 20:59:20,464 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:20,464 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:20,464 - FGO - INFO - Source Total: 726
2023-09-02 20:59:20,464 - FGO - INFO - Target Total: 78
2023-09-02 20:59:20,464 - FGO - INFO - Train Total: 726
2023-09-02 20:59:20,464 - FGO - INFO - Val Total:   78
2023-09-02 20:59:20,464 - FGO - INFO - Test Total:  78
2023-09-02 20:59:20,464 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:20,464 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:20,464 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:20,464 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:20,464 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:20,464 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:20,465 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:20,465 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:20,465 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:20,465 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:20,466 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:20,467 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:20,566 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:20,566 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:20,566 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:20,566 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:20,566 - FGO - INFO - N: 804
2023-09-02 20:59:20,566 - FGO - INFO - N_s: 726
2023-09-02 20:59:20,566 - FGO - INFO - N_t: 78
2023-09-02 20:59:20,570 - CV - INFO - Begin Pretrain
2023-09-02 20:59:20,570 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:20,573 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 20:59:20,598 - FGO - INFO - Epoch  10 | Train Loss: 0.515 | Val Loss: 0.52 | Val F1: 0.82 |
2023-09-02 20:59:20,622 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 20:59:20,647 - FGO - INFO - Epoch  30 | Train Loss: 0.106 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 20:59:20,671 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.13 | Val F1: 0.95 |
2023-09-02 20:59:20,695 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 20:59:20,720 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.09 | Val F1: 0.95 |
2023-09-02 20:59:20,744 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:59:20,768 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 20:59:20,793 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:59:20,817 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 20:59:20,817 - FGO - INFO - Best Epoch:  55 | Train Loss: 0.077 | Val Loss: 0.09 | Val F1: 0.97 
2023-09-02 20:59:20,817 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:20,819 - CV - INFO - Pretrain Complete, 55 epochs
2023-09-02 20:59:20,819 - CV - INFO - Begin OT Train
2023-09-02 20:59:20,819 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:20,891 - FGO - INFO - Epoch   0 | Train Loss: -12.006 | Val Loss: -1.19 | Val F1: 0.95 |
2023-09-02 20:59:21,641 - FGO - INFO - Epoch  10 | Train Loss: -13.529 | Val Loss: -0.89 | Val F1: 0.74 |
2023-09-02 20:59:22,442 - FGO - INFO - Epoch  20 | Train Loss: -13.976 | Val Loss: -0.97 | Val F1: 0.54 |
2023-09-02 20:59:23,232 - FGO - INFO - Epoch  30 | Train Loss: -14.167 | Val Loss: -0.86 | Val F1: 0.30 |
2023-09-02 20:59:23,965 - FGO - INFO - Epoch  40 | Train Loss: -14.168 | Val Loss: -0.85 | Val F1: 0.30 |
2023-09-02 20:59:24,654 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.061 | Val Loss: -1.27 | Val F1: 0.94 |
2023-09-02 20:59:24,654 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:24,658 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:59:24,658 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:24,682 - FGO - INFO - Train CM:
[[400   0]
 [326   0]]
2023-09-02 20:59:24,683 - FGO - INFO - Val CM:
[[34  0]
 [44  0]]
2023-09-02 20:59:24,683 - FGO - INFO - Test CM:
[[34  0]
 [44  0]]
2023-09-02 20:59:24,688 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:59:24,689 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:24,690 - FGO - INFO - test micro f1: 0.4358974358974359
2023-09-02 20:59:24,691 - FGO - INFO - test macro f1: 0.30357142857142855
2023-09-02 20:59:24,691 - CV - INFO - fold time: 4.229135990142822s (0.0704855998357137m)
2023-09-02 20:59:24,691 - CV - INFO - ----- BEGINNING FOLD SET (024:6)----------------------------------------------------------
2023-09-02 20:59:24,692 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/024/6
2023-09-02 20:59:24,693 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:24,693 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:24,693 - FGO - INFO - 	done: False
2023-09-02 20:59:24,693 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:24,693 - FGO - INFO - 	h1: 64
2023-09-02 20:59:24,693 - FGO - INFO - 	h2: 32
2023-09-02 20:59:24,693 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:24,693 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:24,693 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:24,693 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:24,693 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:59:24,693 - FGO - INFO - 	theta: 50
2023-09-02 20:59:24,693 - FGO - INFO - 	clip: 5
2023-09-02 20:59:24,693 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:24,693 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:24,693 - FGO - INFO - Source Total: 717
2023-09-02 20:59:24,693 - FGO - INFO - Target Total: 87
2023-09-02 20:59:24,693 - FGO - INFO - Train Total: 717
2023-09-02 20:59:24,693 - FGO - INFO - Val Total:   87
2023-09-02 20:59:24,693 - FGO - INFO - Test Total:  87
2023-09-02 20:59:24,693 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:24,693 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:24,693 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:24,693 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:24,693 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:24,693 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:24,694 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:24,694 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:24,694 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:24,694 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:24,695 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:24,696 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:24,802 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:24,802 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:24,802 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:24,802 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:24,802 - FGO - INFO - N: 804
2023-09-02 20:59:24,802 - FGO - INFO - N_s: 717
2023-09-02 20:59:24,802 - FGO - INFO - N_t: 87
2023-09-02 20:59:24,806 - CV - INFO - Begin Pretrain
2023-09-02 20:59:24,806 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:24,809 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:59:24,837 - FGO - INFO - Epoch  10 | Train Loss: 0.496 | Val Loss: 0.48 | Val F1: 0.80 |
2023-09-02 20:59:24,862 - FGO - INFO - Epoch  20 | Train Loss: 0.161 | Val Loss: 0.13 | Val F1: 0.93 |
2023-09-02 20:59:24,887 - FGO - INFO - Epoch  30 | Train Loss: 0.108 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 20:59:24,911 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.09 | Val F1: 0.98 |
2023-09-02 20:59:24,935 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 20:59:24,960 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 20:59:24,984 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:59:25,009 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:59:25,033 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:59:25,057 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:59:25,057 - FGO - INFO - Best Epoch:  73 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 1.00 
2023-09-02 20:59:25,057 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:25,059 - CV - INFO - Pretrain Complete, 73 epochs
2023-09-02 20:59:25,059 - CV - INFO - Begin OT Train
2023-09-02 20:59:25,059 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:25,126 - FGO - INFO - Epoch   0 | Train Loss: -12.404 | Val Loss: -1.55 | Val F1: 1.00 |
2023-09-02 20:59:25,958 - FGO - INFO - Epoch  10 | Train Loss: -13.623 | Val Loss: -1.54 | Val F1: 0.90 |
2023-09-02 20:59:26,657 - FGO - INFO - Epoch  20 | Train Loss: -13.989 | Val Loss: -1.18 | Val F1: 0.39 |
2023-09-02 20:59:27,446 - FGO - INFO - Epoch  30 | Train Loss: -14.000 | Val Loss: -1.18 | Val F1: 0.36 |
2023-09-02 20:59:28,194 - FGO - INFO - Epoch  40 | Train Loss: -14.000 | Val Loss: -1.18 | Val F1: 0.36 |
2023-09-02 20:59:28,912 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.392 | Val Loss: -1.63 | Val F1: 1.00 |
2023-09-02 20:59:28,912 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:28,915 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:59:28,915 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:28,937 - FGO - INFO - Train CM:
[[385   0]
 [332   0]]
2023-09-02 20:59:28,938 - FGO - INFO - Val CM:
[[49  0]
 [38  0]]
2023-09-02 20:59:28,938 - FGO - INFO - Test CM:
[[49  0]
 [38  0]]
2023-09-02 20:59:28,942 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:59:28,943 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:28,944 - FGO - INFO - test micro f1: 0.5632183908045977
2023-09-02 20:59:28,945 - FGO - INFO - test macro f1: 0.3602941176470588
2023-09-02 20:59:28,945 - CV - INFO - fold time: 4.254138946533203s (0.07090231577555338m)
2023-09-02 20:59:28,945 - CV - INFO - ----- BEGINNING FOLD SET (024:7)----------------------------------------------------------
2023-09-02 20:59:28,947 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/024/7
2023-09-02 20:59:28,947 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:28,947 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:28,947 - FGO - INFO - 	done: False
2023-09-02 20:59:28,947 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:28,947 - FGO - INFO - 	h1: 64
2023-09-02 20:59:28,947 - FGO - INFO - 	h2: 32
2023-09-02 20:59:28,947 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:28,947 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:28,947 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:28,947 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:28,947 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:59:28,947 - FGO - INFO - 	theta: 50
2023-09-02 20:59:28,947 - FGO - INFO - 	clip: 5
2023-09-02 20:59:28,947 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:28,947 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:28,947 - FGO - INFO - Source Total: 717
2023-09-02 20:59:28,947 - FGO - INFO - Target Total: 87
2023-09-02 20:59:28,947 - FGO - INFO - Train Total: 717
2023-09-02 20:59:28,947 - FGO - INFO - Val Total:   87
2023-09-02 20:59:28,947 - FGO - INFO - Test Total:  87
2023-09-02 20:59:28,947 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:28,947 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:28,947 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:28,947 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:28,947 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:28,948 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:28,948 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:28,948 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:28,948 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:28,948 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:28,949 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:28,950 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:29,056 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:29,056 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:29,056 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:29,056 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:29,056 - FGO - INFO - N: 804
2023-09-02 20:59:29,056 - FGO - INFO - N_s: 717
2023-09-02 20:59:29,056 - FGO - INFO - N_t: 87
2023-09-02 20:59:29,060 - CV - INFO - Begin Pretrain
2023-09-02 20:59:29,060 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:29,063 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 20:59:29,088 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.49 | Val F1: 0.86 |
2023-09-02 20:59:29,112 - FGO - INFO - Epoch  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 |
2023-09-02 20:59:29,137 - FGO - INFO - Epoch  30 | Train Loss: 0.097 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:59:29,161 - FGO - INFO - Epoch  40 | Train Loss: 0.081 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:59:29,186 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:59:29,210 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 20:59:29,235 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:59:29,259 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 20:59:29,284 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 20:59:29,308 - FGO - INFO - Epoch 100 | Train Loss: 0.074 | Val Loss: 0.20 | Val F1: 0.95 |
2023-09-02 20:59:29,308 - FGO - INFO - Best Epoch:  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 
2023-09-02 20:59:29,308 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:29,310 - CV - INFO - Pretrain Complete, 20 epochs
2023-09-02 20:59:29,310 - CV - INFO - Begin OT Train
2023-09-02 20:59:29,310 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:29,399 - FGO - INFO - Epoch   0 | Train Loss: -12.316 | Val Loss: -1.33 | Val F1: 0.95 |
2023-09-02 20:59:30,272 - FGO - INFO - Epoch  10 | Train Loss: -13.749 | Val Loss: -1.40 | Val F1: 0.91 |
2023-09-02 20:59:31,029 - FGO - INFO - Epoch  20 | Train Loss: -14.092 | Val Loss: -1.09 | Val F1: 0.35 |
2023-09-02 20:59:31,788 - FGO - INFO - Epoch  30 | Train Loss: -14.093 | Val Loss: -1.09 | Val F1: 0.35 |
2023-09-02 20:59:32,589 - FGO - INFO - Epoch  40 | Train Loss: -14.093 | Val Loss: -1.09 | Val F1: 0.35 |
2023-09-02 20:59:33,245 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.547 | Val Loss: -1.45 | Val F1: 0.91 |
2023-09-02 20:59:33,245 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:33,248 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:59:33,249 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:33,274 - FGO - INFO - Train CM:
[[387   0]
 [330   0]]
2023-09-02 20:59:33,275 - FGO - INFO - Val CM:
[[47  0]
 [40  0]]
2023-09-02 20:59:33,275 - FGO - INFO - Test CM:
[[47  0]
 [40  0]]
2023-09-02 20:59:33,281 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:59:33,282 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:33,283 - FGO - INFO - test micro f1: 0.5402298850574713
2023-09-02 20:59:33,283 - FGO - INFO - test macro f1: 0.3507462686567164
2023-09-02 20:59:33,283 - CV - INFO - fold time: 4.338452577590942s (0.07230754295984904m)
2023-09-02 20:59:33,283 - CV - INFO - ----- BEGINNING FOLD SET (024:8)----------------------------------------------------------
2023-09-02 20:59:33,285 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/024/8
2023-09-02 20:59:33,285 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:33,285 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:33,285 - FGO - INFO - 	done: False
2023-09-02 20:59:33,285 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:33,285 - FGO - INFO - 	h1: 64
2023-09-02 20:59:33,285 - FGO - INFO - 	h2: 32
2023-09-02 20:59:33,285 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:33,285 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:33,285 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:33,285 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:33,285 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:59:33,285 - FGO - INFO - 	theta: 50
2023-09-02 20:59:33,285 - FGO - INFO - 	clip: 5
2023-09-02 20:59:33,285 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:33,285 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:33,285 - FGO - INFO - Source Total: 734
2023-09-02 20:59:33,285 - FGO - INFO - Target Total: 70
2023-09-02 20:59:33,285 - FGO - INFO - Train Total: 734
2023-09-02 20:59:33,285 - FGO - INFO - Val Total:   70
2023-09-02 20:59:33,285 - FGO - INFO - Test Total:  70
2023-09-02 20:59:33,286 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:33,286 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:33,286 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:33,286 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:33,286 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:33,286 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:33,286 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:33,286 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:33,286 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:33,286 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:33,287 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:33,288 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:33,377 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:33,377 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:33,377 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:33,377 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:33,377 - FGO - INFO - N: 804
2023-09-02 20:59:33,377 - FGO - INFO - N_s: 734
2023-09-02 20:59:33,377 - FGO - INFO - N_t: 70
2023-09-02 20:59:33,381 - CV - INFO - Begin Pretrain
2023-09-02 20:59:33,381 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:33,384 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 20:59:33,409 - FGO - INFO - Epoch  10 | Train Loss: 0.450 | Val Loss: 0.48 | Val F1: 0.81 |
2023-09-02 20:59:33,434 - FGO - INFO - Epoch  20 | Train Loss: 0.149 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 20:59:33,459 - FGO - INFO - Epoch  30 | Train Loss: 0.104 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:59:33,484 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:59:33,509 - FGO - INFO - Epoch  50 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 20:59:33,533 - FGO - INFO - Epoch  60 | Train Loss: 0.067 | Val Loss: 0.11 | Val F1: 0.96 |
2023-09-02 20:59:33,558 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.96 |
2023-09-02 20:59:33,583 - FGO - INFO - Epoch  80 | Train Loss: 0.072 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:59:33,608 - FGO - INFO - Epoch  90 | Train Loss: 0.061 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 20:59:33,632 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 20:59:33,633 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.117 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 20:59:33,633 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:33,634 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 20:59:33,634 - CV - INFO - Begin OT Train
2023-09-02 20:59:33,634 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:33,724 - FGO - INFO - Epoch   0 | Train Loss: -12.351 | Val Loss: -1.01 | Val F1: 0.93 |
2023-09-02 20:59:34,536 - FGO - INFO - Epoch  10 | Train Loss: -13.675 | Val Loss: -0.97 | Val F1: 0.86 |
2023-09-02 20:59:35,274 - FGO - INFO - Epoch  20 | Train Loss: -14.111 | Val Loss: -0.74 | Val F1: 0.47 |
2023-09-02 20:59:36,076 - FGO - INFO - Epoch  30 | Train Loss: -14.184 | Val Loss: -0.70 | Val F1: 0.33 |
2023-09-02 20:59:36,832 - FGO - INFO - Epoch  40 | Train Loss: -14.185 | Val Loss: -0.70 | Val F1: 0.33 |
2023-09-02 20:59:37,558 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.416 | Val Loss: -1.10 | Val F1: 0.96 |
2023-09-02 20:59:37,558 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:37,561 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 20:59:37,561 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:37,585 - FGO - INFO - Train CM:
[[400   0]
 [334   0]]
2023-09-02 20:59:37,585 - FGO - INFO - Val CM:
[[34  0]
 [36  0]]
2023-09-02 20:59:37,586 - FGO - INFO - Test CM:
[[34  0]
 [36  0]]
2023-09-02 20:59:37,591 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:59:37,592 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:37,593 - FGO - INFO - test micro f1: 0.4857142857142857
2023-09-02 20:59:37,594 - FGO - INFO - test macro f1: 0.3269230769230769
2023-09-02 20:59:37,594 - CV - INFO - fold time: 4.310198068618774s (0.07183663447697958m)
2023-09-02 20:59:37,594 - CV - INFO - ----- BEGINNING FOLD SET (024:9)----------------------------------------------------------
2023-09-02 20:59:37,595 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/024/9
2023-09-02 20:59:37,595 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:37,595 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:37,595 - FGO - INFO - 	done: False
2023-09-02 20:59:37,595 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:37,595 - FGO - INFO - 	h1: 64
2023-09-02 20:59:37,596 - FGO - INFO - 	h2: 32
2023-09-02 20:59:37,596 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:37,596 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:37,596 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:37,596 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:37,596 - FGO - INFO - 	lambda: 0.03
2023-09-02 20:59:37,596 - FGO - INFO - 	theta: 50
2023-09-02 20:59:37,596 - FGO - INFO - 	clip: 5
2023-09-02 20:59:37,596 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:37,596 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:37,596 - FGO - INFO - Source Total: 725
2023-09-02 20:59:37,596 - FGO - INFO - Target Total: 79
2023-09-02 20:59:37,596 - FGO - INFO - Train Total: 725
2023-09-02 20:59:37,596 - FGO - INFO - Val Total:   79
2023-09-02 20:59:37,596 - FGO - INFO - Test Total:  79
2023-09-02 20:59:37,596 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:37,596 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:37,596 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:37,596 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:37,596 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:37,596 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:37,596 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:37,596 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:37,596 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:37,596 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:37,597 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:37,599 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:37,697 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:37,698 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:37,698 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:37,698 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:37,698 - FGO - INFO - N: 804
2023-09-02 20:59:37,698 - FGO - INFO - N_s: 725
2023-09-02 20:59:37,698 - FGO - INFO - N_t: 79
2023-09-02 20:59:37,701 - CV - INFO - Begin Pretrain
2023-09-02 20:59:37,701 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:37,704 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 20:59:37,729 - FGO - INFO - Epoch  10 | Train Loss: 0.471 | Val Loss: 0.48 | Val F1: 0.87 |
2023-09-02 20:59:37,754 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:59:37,778 - FGO - INFO - Epoch  30 | Train Loss: 0.102 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:59:37,803 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.21 | Val F1: 0.97 |
2023-09-02 20:59:37,827 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 20:59:37,852 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 20:59:37,876 - FGO - INFO - Epoch  70 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:59:37,900 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:59:37,925 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 20:59:37,949 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 20:59:37,950 - FGO - INFO - Best Epoch:  25 | Train Loss: 0.119 | Val Loss: 0.24 | Val F1: 0.97 
2023-09-02 20:59:37,950 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:37,951 - CV - INFO - Pretrain Complete, 25 epochs
2023-09-02 20:59:37,951 - CV - INFO - Begin OT Train
2023-09-02 20:59:37,951 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:38,049 - FGO - INFO - Epoch   0 | Train Loss: -12.368 | Val Loss: -1.24 | Val F1: 0.97 |
2023-09-02 20:59:38,813 - FGO - INFO - Epoch  10 | Train Loss: -13.656 | Val Loss: -1.30 | Val F1: 0.93 |
2023-09-02 20:59:39,629 - FGO - INFO - Epoch  20 | Train Loss: -14.128 | Val Loss: -0.92 | Val F1: 0.42 |
2023-09-02 20:59:40,363 - FGO - INFO - Epoch  30 | Train Loss: -14.133 | Val Loss: -0.93 | Val F1: 0.38 |
2023-09-02 20:59:41,120 - FGO - INFO - Epoch  40 | Train Loss: -14.133 | Val Loss: -0.93 | Val F1: 0.38 |
2023-09-02 20:59:41,765 - FGO - INFO - Best Epoch:   9 | Train Loss: -13.665 | Val Loss: -1.34 | Val F1: 0.96 |
2023-09-02 20:59:41,765 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:41,768 - CV - INFO - OT Train Complete, 9 epochs
2023-09-02 20:59:41,768 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:41,792 - FGO - INFO - Train CM:
[[385   0]
 [340   0]]
2023-09-02 20:59:41,793 - FGO - INFO - Val CM:
[[49  0]
 [30  0]]
2023-09-02 20:59:41,793 - FGO - INFO - Test CM:
[[49  0]
 [30  0]]
2023-09-02 20:59:41,798 - FGO - INFO - test statistical parity: 0.0
2023-09-02 20:59:41,799 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:41,800 - FGO - INFO - test micro f1: 0.620253164556962
2023-09-02 20:59:41,801 - FGO - INFO - test macro f1: 0.3828125
2023-09-02 20:59:41,801 - CV - INFO - fold time: 4.207304239273071s (0.07012173732121786m)
2023-09-02 20:59:41,801 - CV - INFO - Mean Pretrain Epochs 41.0:
2023-09-02 20:59:41,801 - CV - INFO - Mean OT Train Epochs 7.5:
2023-09-02 20:59:41,801 - CV - INFO - Mean Val Macro F1 : 0.3491007683535168
2023-09-02 20:59:41,801 - CV - INFO - Mean Eval Stat : 0.3491007683535168 (harmoic mean of macro f1 and (1-eo))
2023-09-02 20:59:41,801 - CV - INFO - set time: 43.03065633773804s (0.7171776056289673m)
2023-09-02 20:59:41,801 - CV - INFO - script time so far: 1079.7522101402283s (17.995870169003805m) (0.29993116948339676h)
2023-09-02 20:59:41,801 - CV - INFO - ===== BEGINNING OPTION SET (025)==========================================================
2023-09-02 20:59:41,801 - CV - INFO - 	done: False
2023-09-02 20:59:41,801 - CV - INFO - 	learning_rate: 0.01
2023-09-02 20:59:41,801 - CV - INFO - 	h1: 64
2023-09-02 20:59:41,801 - CV - INFO - 	h2: 32
2023-09-02 20:59:41,801 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:41,801 - CV - INFO - 	dropout: 0.0
2023-09-02 20:59:41,801 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:41,801 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:41,801 - CV - INFO - 	lambda: 0.05
2023-09-02 20:59:41,801 - CV - INFO - 	theta: 10
2023-09-02 20:59:41,801 - CV - INFO - 	clip: 5
2023-09-02 20:59:41,801 - CV - INFO - ----- BEGINNING FOLD SET (025:0)----------------------------------------------------------
2023-09-02 20:59:41,803 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/025/0
2023-09-02 20:59:41,803 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:41,803 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:41,803 - FGO - INFO - 	done: False
2023-09-02 20:59:41,803 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:41,803 - FGO - INFO - 	h1: 64
2023-09-02 20:59:41,803 - FGO - INFO - 	h2: 32
2023-09-02 20:59:41,803 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:41,803 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:41,803 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:41,803 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:41,803 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:59:41,803 - FGO - INFO - 	theta: 10
2023-09-02 20:59:41,803 - FGO - INFO - 	clip: 5
2023-09-02 20:59:41,803 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:41,803 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:41,803 - FGO - INFO - Source Total: 708
2023-09-02 20:59:41,803 - FGO - INFO - Target Total: 96
2023-09-02 20:59:41,803 - FGO - INFO - Train Total: 708
2023-09-02 20:59:41,803 - FGO - INFO - Val Total:   96
2023-09-02 20:59:41,803 - FGO - INFO - Test Total:  96
2023-09-02 20:59:41,803 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:41,803 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:41,803 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:41,803 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:41,803 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:41,804 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:41,804 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:41,804 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:41,804 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:41,804 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:41,805 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:41,806 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:41,923 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:41,923 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:41,923 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:41,923 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:41,923 - FGO - INFO - N: 804
2023-09-02 20:59:41,923 - FGO - INFO - N_s: 708
2023-09-02 20:59:41,923 - FGO - INFO - N_t: 96
2023-09-02 20:59:41,926 - CV - INFO - Begin Pretrain
2023-09-02 20:59:41,926 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:41,930 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 20:59:41,954 - FGO - INFO - Epoch  10 | Train Loss: 0.421 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 20:59:41,979 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 20:59:42,003 - FGO - INFO - Epoch  30 | Train Loss: 0.103 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 20:59:42,027 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:59:42,051 - FGO - INFO - Epoch  50 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 20:59:42,076 - FGO - INFO - Epoch  60 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 20:59:42,100 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 20:59:42,124 - FGO - INFO - Epoch  80 | Train Loss: 0.058 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:59:42,148 - FGO - INFO - Epoch  90 | Train Loss: 0.058 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 20:59:42,172 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 20:59:42,173 - FGO - INFO - Best Epoch:  28 | Train Loss: 0.112 | Val Loss: 0.09 | Val F1: 0.99 
2023-09-02 20:59:42,173 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:42,174 - CV - INFO - Pretrain Complete, 28 epochs
2023-09-02 20:59:42,174 - CV - INFO - Begin OT Train
2023-09-02 20:59:42,174 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:42,269 - FGO - INFO - Epoch   0 | Train Loss: -4.229 | Val Loss: -0.45 | Val F1: 0.94 |
2023-09-02 20:59:43,034 - FGO - INFO - Epoch  10 | Train Loss: -4.237 | Val Loss: -0.49 | Val F1: 0.96 |
2023-09-02 20:59:43,807 - FGO - INFO - Epoch  20 | Train Loss: -4.391 | Val Loss: -0.54 | Val F1: 0.96 |
2023-09-02 20:59:44,615 - FGO - INFO - Epoch  30 | Train Loss: -4.484 | Val Loss: -0.56 | Val F1: 0.97 |
2023-09-02 20:59:45,346 - FGO - INFO - Epoch  40 | Train Loss: -4.527 | Val Loss: -0.52 | Val F1: 0.97 |
2023-09-02 20:59:46,109 - FGO - INFO - Best Epoch:  28 | Train Loss: -4.465 | Val Loss: -0.57 | Val F1: 0.98 |
2023-09-02 20:59:46,109 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:46,112 - CV - INFO - OT Train Complete, 28 epochs
2023-09-02 20:59:46,113 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:46,138 - FGO - INFO - Train CM:
[[373   9]
 [  9 317]]
2023-09-02 20:59:46,139 - FGO - INFO - Val CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:59:46,139 - FGO - INFO - Test CM:
[[52  0]
 [ 2 42]]
2023-09-02 20:59:46,145 - FGO - INFO - test statistical parity: 0.32727272727272727
2023-09-02 20:59:46,146 - FGO - INFO - test equal opportunity: 0.05555555555555558
2023-09-02 20:59:46,147 - FGO - INFO - test micro f1: 0.9791666666666666
2023-09-02 20:59:46,148 - FGO - INFO - test macro f1: 0.978938130759105
2023-09-02 20:59:46,148 - CV - INFO - fold time: 4.3462512493133545s (0.07243752082188924m)
2023-09-02 20:59:46,148 - CV - INFO - ----- BEGINNING FOLD SET (025:1)----------------------------------------------------------
2023-09-02 20:59:46,149 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/025/1
2023-09-02 20:59:46,149 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:46,149 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:46,149 - FGO - INFO - 	done: False
2023-09-02 20:59:46,149 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:46,149 - FGO - INFO - 	h1: 64
2023-09-02 20:59:46,149 - FGO - INFO - 	h2: 32
2023-09-02 20:59:46,149 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:46,149 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:46,149 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:46,149 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:46,149 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:59:46,149 - FGO - INFO - 	theta: 10
2023-09-02 20:59:46,149 - FGO - INFO - 	clip: 5
2023-09-02 20:59:46,149 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:46,149 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:46,150 - FGO - INFO - Source Total: 727
2023-09-02 20:59:46,150 - FGO - INFO - Target Total: 77
2023-09-02 20:59:46,150 - FGO - INFO - Train Total: 727
2023-09-02 20:59:46,150 - FGO - INFO - Val Total:   77
2023-09-02 20:59:46,150 - FGO - INFO - Test Total:  77
2023-09-02 20:59:46,150 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:46,150 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:46,150 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:46,150 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:46,150 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:46,150 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:46,150 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:46,150 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:46,150 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:46,150 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:46,151 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:46,152 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:46,248 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:46,248 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:46,248 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:46,248 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:46,248 - FGO - INFO - N: 804
2023-09-02 20:59:46,248 - FGO - INFO - N_s: 727
2023-09-02 20:59:46,248 - FGO - INFO - N_t: 77
2023-09-02 20:59:46,252 - CV - INFO - Begin Pretrain
2023-09-02 20:59:46,252 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:46,255 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 20:59:46,280 - FGO - INFO - Epoch  10 | Train Loss: 0.472 | Val Loss: 0.55 | Val F1: 0.71 |
2023-09-02 20:59:46,305 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.27 | Val F1: 0.84 |
2023-09-02 20:59:46,330 - FGO - INFO - Epoch  30 | Train Loss: 0.091 | Val Loss: 0.17 | Val F1: 0.93 |
2023-09-02 20:59:46,355 - FGO - INFO - Epoch  40 | Train Loss: 0.080 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:59:46,379 - FGO - INFO - Epoch  50 | Train Loss: 0.067 | Val Loss: 0.20 | Val F1: 0.87 |
2023-09-02 20:59:46,404 - FGO - INFO - Epoch  60 | Train Loss: 0.061 | Val Loss: 0.22 | Val F1: 0.89 |
2023-09-02 20:59:46,429 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 20:59:46,453 - FGO - INFO - Epoch  80 | Train Loss: 0.054 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 20:59:46,478 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.21 | Val F1: 0.92 |
2023-09-02 20:59:46,502 - FGO - INFO - Epoch 100 | Train Loss: 0.054 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:59:46,502 - FGO - INFO - Best Epoch:  34 | Train Loss: 0.088 | Val Loss: 0.17 | Val F1: 0.95 
2023-09-02 20:59:46,502 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:46,504 - CV - INFO - Pretrain Complete, 34 epochs
2023-09-02 20:59:46,504 - CV - INFO - Begin OT Train
2023-09-02 20:59:46,504 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:46,570 - FGO - INFO - Epoch   0 | Train Loss: -4.247 | Val Loss: -0.24 | Val F1: 0.90 |
2023-09-02 20:59:47,355 - FGO - INFO - Epoch  10 | Train Loss: -4.344 | Val Loss: -0.05 | Val F1: 0.87 |
2023-09-02 20:59:48,184 - FGO - INFO - Epoch  20 | Train Loss: -4.455 | Val Loss: -0.19 | Val F1: 0.89 |
2023-09-02 20:59:49,125 - FGO - INFO - Epoch  30 | Train Loss: -4.561 | Val Loss: -0.24 | Val F1: 0.92 |
2023-09-02 20:59:49,850 - FGO - INFO - Epoch  40 | Train Loss: -4.609 | Val Loss: -0.22 | Val F1: 0.93 |
2023-09-02 20:59:50,554 - FGO - INFO - Best Epoch:  32 | Train Loss: -4.581 | Val Loss: -0.23 | Val F1: 0.93 |
2023-09-02 20:59:50,554 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:50,558 - CV - INFO - OT Train Complete, 32 epochs
2023-09-02 20:59:50,558 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:50,582 - FGO - INFO - Train CM:
[[382   8]
 [  8 329]]
2023-09-02 20:59:50,582 - FGO - INFO - Val CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:59:50,583 - FGO - INFO - Test CM:
[[43  1]
 [ 4 29]]
2023-09-02 20:59:50,588 - FGO - INFO - test statistical parity: 0.36282051282051286
2023-09-02 20:59:50,589 - FGO - INFO - test equal opportunity: 0.4032258064516129
2023-09-02 20:59:50,590 - FGO - INFO - test micro f1: 0.935064935064935
2023-09-02 20:59:50,590 - FGO - INFO - test macro f1: 0.9328449328449329
2023-09-02 20:59:50,590 - CV - INFO - fold time: 4.442900657653809s (0.07404834429423014m)
2023-09-02 20:59:50,591 - CV - INFO - ----- BEGINNING FOLD SET (025:2)----------------------------------------------------------
2023-09-02 20:59:50,592 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/025/2
2023-09-02 20:59:50,592 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:50,592 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:50,592 - FGO - INFO - 	done: False
2023-09-02 20:59:50,592 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:50,592 - FGO - INFO - 	h1: 64
2023-09-02 20:59:50,592 - FGO - INFO - 	h2: 32
2023-09-02 20:59:50,592 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:50,592 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:50,592 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:50,592 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:50,592 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:59:50,592 - FGO - INFO - 	theta: 10
2023-09-02 20:59:50,592 - FGO - INFO - 	clip: 5
2023-09-02 20:59:50,592 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:50,593 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:50,593 - FGO - INFO - Source Total: 721
2023-09-02 20:59:50,593 - FGO - INFO - Target Total: 83
2023-09-02 20:59:50,593 - FGO - INFO - Train Total: 721
2023-09-02 20:59:50,593 - FGO - INFO - Val Total:   83
2023-09-02 20:59:50,593 - FGO - INFO - Test Total:  83
2023-09-02 20:59:50,593 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:50,593 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:50,593 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:50,593 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:50,593 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:50,593 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:50,593 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:50,593 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:50,593 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:50,593 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:50,594 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:50,595 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:50,698 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:50,698 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:50,698 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:50,698 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:50,698 - FGO - INFO - N: 804
2023-09-02 20:59:50,698 - FGO - INFO - N_s: 721
2023-09-02 20:59:50,698 - FGO - INFO - N_t: 83
2023-09-02 20:59:50,702 - CV - INFO - Begin Pretrain
2023-09-02 20:59:50,702 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:50,705 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 20:59:50,730 - FGO - INFO - Epoch  10 | Train Loss: 0.478 | Val Loss: 0.49 | Val F1: 0.84 |
2023-09-02 20:59:50,755 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.24 | Val F1: 0.87 |
2023-09-02 20:59:50,779 - FGO - INFO - Epoch  30 | Train Loss: 0.087 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 20:59:50,804 - FGO - INFO - Epoch  40 | Train Loss: 0.073 | Val Loss: 0.25 | Val F1: 0.90 |
2023-09-02 20:59:50,828 - FGO - INFO - Epoch  50 | Train Loss: 0.063 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 20:59:50,852 - FGO - INFO - Epoch  60 | Train Loss: 0.058 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 20:59:50,877 - FGO - INFO - Epoch  70 | Train Loss: 0.056 | Val Loss: 0.28 | Val F1: 0.91 |
2023-09-02 20:59:50,901 - FGO - INFO - Epoch  80 | Train Loss: 0.052 | Val Loss: 0.28 | Val F1: 0.88 |
2023-09-02 20:59:50,925 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.28 | Val F1: 0.89 |
2023-09-02 20:59:50,950 - FGO - INFO - Epoch 100 | Train Loss: 0.046 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 20:59:50,950 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.058 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 20:59:50,950 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:50,951 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 20:59:50,951 - CV - INFO - Begin OT Train
2023-09-02 20:59:50,951 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:51,044 - FGO - INFO - Epoch   0 | Train Loss: -4.196 | Val Loss: -0.18 | Val F1: 0.90 |
2023-09-02 20:59:51,874 - FGO - INFO - Epoch  10 | Train Loss: -4.426 | Val Loss: -0.05 | Val F1: 0.89 |
2023-09-02 20:59:52,701 - FGO - INFO - Epoch  20 | Train Loss: -4.491 | Val Loss: -0.24 | Val F1: 0.90 |
2023-09-02 20:59:53,496 - FGO - INFO - Epoch  30 | Train Loss: -4.592 | Val Loss: -0.06 | Val F1: 0.91 |
2023-09-02 20:59:54,295 - FGO - INFO - Epoch  40 | Train Loss: -4.631 | Val Loss: -0.07 | Val F1: 0.90 |
2023-09-02 20:59:54,984 - FGO - INFO - Best Epoch:  11 | Train Loss: -4.447 | Val Loss: -0.21 | Val F1: 0.91 |
2023-09-02 20:59:54,985 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:54,988 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 20:59:54,988 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:55,011 - FGO - INFO - Train CM:
[[377   7]
 [  8 329]]
2023-09-02 20:59:55,011 - FGO - INFO - Val CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:59:55,011 - FGO - INFO - Test CM:
[[46  4]
 [ 3 30]]
2023-09-02 20:59:55,016 - FGO - INFO - test statistical parity: 0.10563380281690143
2023-09-02 20:59:55,017 - FGO - INFO - test equal opportunity: 0.09259259259259256
2023-09-02 20:59:55,018 - FGO - INFO - test micro f1: 0.9156626506024096
2023-09-02 20:59:55,018 - FGO - INFO - test macro f1: 0.9124076586763153
2023-09-02 20:59:55,018 - CV - INFO - fold time: 4.427915811538696s (0.07379859685897827m)
2023-09-02 20:59:55,018 - CV - INFO - ----- BEGINNING FOLD SET (025:3)----------------------------------------------------------
2023-09-02 20:59:55,020 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/025/3
2023-09-02 20:59:55,020 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:55,020 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:55,020 - FGO - INFO - 	done: False
2023-09-02 20:59:55,020 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:55,020 - FGO - INFO - 	h1: 64
2023-09-02 20:59:55,020 - FGO - INFO - 	h2: 32
2023-09-02 20:59:55,020 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:55,020 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:55,020 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:55,020 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:55,020 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:59:55,020 - FGO - INFO - 	theta: 10
2023-09-02 20:59:55,020 - FGO - INFO - 	clip: 5
2023-09-02 20:59:55,020 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:55,020 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:55,020 - FGO - INFO - Source Total: 729
2023-09-02 20:59:55,020 - FGO - INFO - Target Total: 75
2023-09-02 20:59:55,020 - FGO - INFO - Train Total: 729
2023-09-02 20:59:55,020 - FGO - INFO - Val Total:   75
2023-09-02 20:59:55,020 - FGO - INFO - Test Total:  75
2023-09-02 20:59:55,021 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:55,021 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:55,021 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:55,021 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:55,021 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:55,021 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:55,021 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:55,021 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:55,021 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:55,021 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:55,022 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:55,023 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:55,117 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:55,117 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:55,117 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:55,117 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:55,117 - FGO - INFO - N: 804
2023-09-02 20:59:55,117 - FGO - INFO - N_s: 729
2023-09-02 20:59:55,117 - FGO - INFO - N_t: 75
2023-09-02 20:59:55,121 - CV - INFO - Begin Pretrain
2023-09-02 20:59:55,121 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:55,124 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 20:59:55,149 - FGO - INFO - Epoch  10 | Train Loss: 0.431 | Val Loss: 0.36 | Val F1: 0.93 |
2023-09-02 20:59:55,174 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:59:55,198 - FGO - INFO - Epoch  30 | Train Loss: 0.109 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:59:55,223 - FGO - INFO - Epoch  40 | Train Loss: 0.093 | Val Loss: 0.03 | Val F1: 0.99 |
2023-09-02 20:59:55,247 - FGO - INFO - Epoch  50 | Train Loss: 0.080 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 20:59:55,272 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:59:55,296 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:59:55,321 - FGO - INFO - Epoch  80 | Train Loss: 0.065 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 20:59:55,345 - FGO - INFO - Epoch  90 | Train Loss: 0.064 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 20:59:55,370 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 20:59:55,370 - FGO - INFO - Best Epoch:  27 | Train Loss: 0.114 | Val Loss: 0.03 | Val F1: 1.00 
2023-09-02 20:59:55,370 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:55,371 - CV - INFO - Pretrain Complete, 27 epochs
2023-09-02 20:59:55,371 - CV - INFO - Begin OT Train
2023-09-02 20:59:55,371 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:55,438 - FGO - INFO - Epoch   0 | Train Loss: -4.073 | Val Loss: -0.42 | Val F1: 0.97 |
2023-09-02 20:59:56,217 - FGO - INFO - Epoch  10 | Train Loss: -4.328 | Val Loss: -0.27 | Val F1: 0.95 |
2023-09-02 20:59:57,112 - FGO - INFO - Epoch  20 | Train Loss: -4.482 | Val Loss: -0.45 | Val F1: 0.99 |
2023-09-02 20:59:57,920 - FGO - INFO - Epoch  30 | Train Loss: -4.546 | Val Loss: -0.46 | Val F1: 0.99 |
2023-09-02 20:59:58,757 - FGO - INFO - Epoch  40 | Train Loss: -4.587 | Val Loss: -0.47 | Val F1: 0.99 |
2023-09-02 20:59:59,461 - FGO - INFO - Best Epoch:  37 | Train Loss: -4.579 | Val Loss: -0.47 | Val F1: 0.99 |
2023-09-02 20:59:59,461 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:59,464 - CV - INFO - OT Train Complete, 37 epochs
2023-09-02 20:59:59,464 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 20:59:59,490 - FGO - INFO - Train CM:
[[387   9]
 [ 11 322]]
2023-09-02 20:59:59,491 - FGO - INFO - Val CM:
[[37  1]
 [ 0 37]]
2023-09-02 20:59:59,491 - FGO - INFO - Test CM:
[[37  1]
 [ 0 37]]
2023-09-02 20:59:59,496 - FGO - INFO - test statistical parity: 0.008196721311475419
2023-09-02 20:59:59,497 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 20:59:59,498 - FGO - INFO - test micro f1: 0.9866666666666668
2023-09-02 20:59:59,498 - FGO - INFO - test macro f1: 0.9866666666666666
2023-09-02 20:59:59,498 - CV - INFO - fold time: 4.4799158573150635s (0.07466526428858439m)
2023-09-02 20:59:59,498 - CV - INFO - ----- BEGINNING FOLD SET (025:4)----------------------------------------------------------
2023-09-02 20:59:59,500 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/025/4
2023-09-02 20:59:59,500 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 20:59:59,500 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 20:59:59,500 - FGO - INFO - 	done: False
2023-09-02 20:59:59,500 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 20:59:59,500 - FGO - INFO - 	h1: 64
2023-09-02 20:59:59,500 - FGO - INFO - 	h2: 32
2023-09-02 20:59:59,500 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 20:59:59,500 - FGO - INFO - 	dropout: 0.0
2023-09-02 20:59:59,500 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 20:59:59,500 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 20:59:59,500 - FGO - INFO - 	lambda: 0.05
2023-09-02 20:59:59,500 - FGO - INFO - 	theta: 10
2023-09-02 20:59:59,500 - FGO - INFO - 	clip: 5
2023-09-02 20:59:59,500 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 20:59:59,500 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 20:59:59,500 - FGO - INFO - Source Total: 732
2023-09-02 20:59:59,500 - FGO - INFO - Target Total: 72
2023-09-02 20:59:59,500 - FGO - INFO - Train Total: 732
2023-09-02 20:59:59,500 - FGO - INFO - Val Total:   72
2023-09-02 20:59:59,500 - FGO - INFO - Test Total:  72
2023-09-02 20:59:59,500 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 20:59:59,500 - FGO - INFO - SOURCE: abide_large
2023-09-02 20:59:59,500 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 20:59:59,500 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 20:59:59,500 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 20:59:59,501 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 20:59:59,501 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 20:59:59,501 - FGO - INFO - 	P shape: (804,)
2023-09-02 20:59:59,501 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 20:59:59,501 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 20:59:59,502 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 20:59:59,503 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 20:59:59,594 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 20:59:59,594 - FGO - INFO - A shape: (804, 804)
2023-09-02 20:59:59,594 - FGO - INFO - X shape: (804, 93)
2023-09-02 20:59:59,594 - FGO - INFO - Y shape: (804, 2)
2023-09-02 20:59:59,594 - FGO - INFO - N: 804
2023-09-02 20:59:59,594 - FGO - INFO - N_s: 732
2023-09-02 20:59:59,594 - FGO - INFO - N_t: 72
2023-09-02 20:59:59,598 - CV - INFO - Begin Pretrain
2023-09-02 20:59:59,598 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 20:59:59,601 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 20:59:59,629 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.46 | Val F1: 0.81 |
2023-09-02 20:59:59,657 - FGO - INFO - Epoch  20 | Train Loss: 0.141 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:59:59,685 - FGO - INFO - Epoch  30 | Train Loss: 0.100 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:59:59,710 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 20:59:59,734 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 20:59:59,759 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 20:59:59,784 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:59:59,808 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:59:59,833 - FGO - INFO - Epoch  90 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 20:59:59,857 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 20:59:59,857 - FGO - INFO - Best Epoch:  64 | Train Loss: 0.069 | Val Loss: 0.06 | Val F1: 0.99 
2023-09-02 20:59:59,857 - FGO - INFO - Setting model to best state.
2023-09-02 20:59:59,859 - CV - INFO - Pretrain Complete, 64 epochs
2023-09-02 20:59:59,859 - CV - INFO - Begin OT Train
2023-09-02 20:59:59,859 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 20:59:59,926 - FGO - INFO - Epoch   0 | Train Loss: -4.305 | Val Loss: -0.39 | Val F1: 0.99 |
2023-09-02 21:00:00,793 - FGO - INFO - Epoch  10 | Train Loss: -4.403 | Val Loss: -0.33 | Val F1: 0.96 |
2023-09-02 21:00:01,596 - FGO - INFO - Epoch  20 | Train Loss: -4.492 | Val Loss: -0.38 | Val F1: 0.97 |
2023-09-02 21:00:02,395 - FGO - INFO - Epoch  30 | Train Loss: -4.544 | Val Loss: -0.39 | Val F1: 0.97 |
2023-09-02 21:00:03,195 - FGO - INFO - Epoch  40 | Train Loss: -4.585 | Val Loss: -0.37 | Val F1: 0.97 |
2023-09-02 21:00:03,874 - FGO - INFO - Best Epoch:   6 | Train Loss: -4.382 | Val Loss: -0.42 | Val F1: 0.99 |
2023-09-02 21:00:03,874 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:03,877 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 21:00:03,877 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:03,905 - FGO - INFO - Train CM:
[[387  10]
 [ 11 324]]
2023-09-02 21:00:03,906 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 21:00:03,906 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 21:00:03,911 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 21:00:03,912 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 21:00:03,913 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 21:00:03,914 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 21:00:03,914 - CV - INFO - fold time: 4.415498495101929s (0.07359164158503215m)
2023-09-02 21:00:03,914 - CV - INFO - ----- BEGINNING FOLD SET (025:5)----------------------------------------------------------
2023-09-02 21:00:03,916 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/025/5
2023-09-02 21:00:03,916 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:03,916 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:03,916 - FGO - INFO - 	done: False
2023-09-02 21:00:03,916 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:03,916 - FGO - INFO - 	h1: 64
2023-09-02 21:00:03,916 - FGO - INFO - 	h2: 32
2023-09-02 21:00:03,916 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:03,916 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:03,916 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:03,916 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:03,916 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:03,916 - FGO - INFO - 	theta: 10
2023-09-02 21:00:03,916 - FGO - INFO - 	clip: 5
2023-09-02 21:00:03,916 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:03,916 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:03,916 - FGO - INFO - Source Total: 726
2023-09-02 21:00:03,916 - FGO - INFO - Target Total: 78
2023-09-02 21:00:03,916 - FGO - INFO - Train Total: 726
2023-09-02 21:00:03,916 - FGO - INFO - Val Total:   78
2023-09-02 21:00:03,916 - FGO - INFO - Test Total:  78
2023-09-02 21:00:03,916 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:03,916 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:03,916 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:03,916 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:03,916 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:03,917 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:03,917 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:03,917 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:03,917 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:03,917 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:03,918 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:03,919 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:04,017 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:04,017 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:04,017 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:04,017 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:04,017 - FGO - INFO - N: 804
2023-09-02 21:00:04,017 - FGO - INFO - N_s: 726
2023-09-02 21:00:04,017 - FGO - INFO - N_t: 78
2023-09-02 21:00:04,020 - CV - INFO - Begin Pretrain
2023-09-02 21:00:04,020 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:04,024 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 21:00:04,048 - FGO - INFO - Epoch  10 | Train Loss: 0.515 | Val Loss: 0.52 | Val F1: 0.82 |
2023-09-02 21:00:04,073 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 21:00:04,097 - FGO - INFO - Epoch  30 | Train Loss: 0.106 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 21:00:04,122 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.13 | Val F1: 0.95 |
2023-09-02 21:00:04,146 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 21:00:04,171 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.09 | Val F1: 0.95 |
2023-09-02 21:00:04,195 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 21:00:04,219 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 21:00:04,244 - FGO - INFO - Epoch  90 | Train Loss: 0.064 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 21:00:04,268 - FGO - INFO - Epoch 100 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 21:00:04,268 - FGO - INFO - Best Epoch:  55 | Train Loss: 0.077 | Val Loss: 0.09 | Val F1: 0.97 
2023-09-02 21:00:04,268 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:04,269 - CV - INFO - Pretrain Complete, 55 epochs
2023-09-02 21:00:04,269 - CV - INFO - Begin OT Train
2023-09-02 21:00:04,269 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:04,367 - FGO - INFO - Epoch   0 | Train Loss: -3.953 | Val Loss: -0.37 | Val F1: 0.95 |
2023-09-02 21:00:05,192 - FGO - INFO - Epoch  10 | Train Loss: -4.287 | Val Loss: 0.21 | Val F1: 0.85 |
2023-09-02 21:00:06,018 - FGO - INFO - Epoch  20 | Train Loss: -4.451 | Val Loss: -0.07 | Val F1: 0.87 |
2023-09-02 21:00:06,798 - FGO - INFO - Epoch  30 | Train Loss: -4.526 | Val Loss: -0.03 | Val F1: 0.91 |
2023-09-02 21:00:07,596 - FGO - INFO - Epoch  40 | Train Loss: -4.572 | Val Loss: -0.09 | Val F1: 0.91 |
2023-09-02 21:00:08,229 - FGO - INFO - Best Epoch:   6 | Train Loss: -4.088 | Val Loss: -0.34 | Val F1: 0.95 |
2023-09-02 21:00:08,229 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:08,232 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 21:00:08,232 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:08,256 - FGO - INFO - Train CM:
[[392   8]
 [ 17 309]]
2023-09-02 21:00:08,256 - FGO - INFO - Val CM:
[[34  0]
 [ 7 37]]
2023-09-02 21:00:08,257 - FGO - INFO - Test CM:
[[34  0]
 [ 7 37]]
2023-09-02 21:00:08,262 - FGO - INFO - test statistical parity: 0.09178743961352659
2023-09-02 21:00:08,263 - FGO - INFO - test equal opportunity: 0.17948717948717952
2023-09-02 21:00:08,264 - FGO - INFO - test micro f1: 0.9102564102564102
2023-09-02 21:00:08,265 - FGO - INFO - test macro f1: 0.9101234567901235
2023-09-02 21:00:08,265 - CV - INFO - fold time: 4.350677728652954s (0.07251129547754924m)
2023-09-02 21:00:08,265 - CV - INFO - ----- BEGINNING FOLD SET (025:6)----------------------------------------------------------
2023-09-02 21:00:08,266 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/025/6
2023-09-02 21:00:08,266 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:08,266 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:08,266 - FGO - INFO - 	done: False
2023-09-02 21:00:08,266 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:08,266 - FGO - INFO - 	h1: 64
2023-09-02 21:00:08,266 - FGO - INFO - 	h2: 32
2023-09-02 21:00:08,266 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:08,266 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:08,267 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:08,267 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:08,267 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:08,267 - FGO - INFO - 	theta: 10
2023-09-02 21:00:08,267 - FGO - INFO - 	clip: 5
2023-09-02 21:00:08,267 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:08,267 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:08,267 - FGO - INFO - Source Total: 717
2023-09-02 21:00:08,267 - FGO - INFO - Target Total: 87
2023-09-02 21:00:08,267 - FGO - INFO - Train Total: 717
2023-09-02 21:00:08,267 - FGO - INFO - Val Total:   87
2023-09-02 21:00:08,267 - FGO - INFO - Test Total:  87
2023-09-02 21:00:08,267 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:08,267 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:08,267 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:08,267 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:08,267 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:08,267 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:08,267 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:08,267 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:08,267 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:08,267 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:08,268 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:08,270 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:08,376 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:08,376 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:08,376 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:08,376 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:08,376 - FGO - INFO - N: 804
2023-09-02 21:00:08,376 - FGO - INFO - N_s: 717
2023-09-02 21:00:08,376 - FGO - INFO - N_t: 87
2023-09-02 21:00:08,380 - CV - INFO - Begin Pretrain
2023-09-02 21:00:08,380 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:08,383 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 21:00:08,408 - FGO - INFO - Epoch  10 | Train Loss: 0.496 | Val Loss: 0.48 | Val F1: 0.80 |
2023-09-02 21:00:08,432 - FGO - INFO - Epoch  20 | Train Loss: 0.161 | Val Loss: 0.13 | Val F1: 0.93 |
2023-09-02 21:00:08,457 - FGO - INFO - Epoch  30 | Train Loss: 0.108 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 21:00:08,481 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.09 | Val F1: 0.98 |
2023-09-02 21:00:08,506 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 21:00:08,530 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 21:00:08,554 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:00:08,579 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.05 | Val F1: 1.00 |
2023-09-02 21:00:08,603 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 1.00 |
2023-09-02 21:00:08,627 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 21:00:08,627 - FGO - INFO - Best Epoch:  73 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 1.00 
2023-09-02 21:00:08,627 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:08,629 - CV - INFO - Pretrain Complete, 73 epochs
2023-09-02 21:00:08,629 - CV - INFO - Begin OT Train
2023-09-02 21:00:08,629 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:08,694 - FGO - INFO - Epoch   0 | Train Loss: -4.266 | Val Loss: -0.51 | Val F1: 1.00 |
2023-09-02 21:00:09,533 - FGO - INFO - Epoch  10 | Train Loss: -4.298 | Val Loss: -0.41 | Val F1: 0.94 |
2023-09-02 21:00:10,307 - FGO - INFO - Epoch  20 | Train Loss: -4.430 | Val Loss: -0.49 | Val F1: 0.95 |
2023-09-02 21:00:11,047 - FGO - INFO - Epoch  30 | Train Loss: -4.498 | Val Loss: -0.52 | Val F1: 0.97 |
2023-09-02 21:00:11,793 - FGO - INFO - Epoch  40 | Train Loss: -4.545 | Val Loss: -0.58 | Val F1: 1.00 |
2023-09-02 21:00:12,495 - FGO - INFO - Best Epoch:  35 | Train Loss: -4.529 | Val Loss: -0.57 | Val F1: 1.00 |
2023-09-02 21:00:12,495 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:12,498 - CV - INFO - OT Train Complete, 35 epochs
2023-09-02 21:00:12,499 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:12,524 - FGO - INFO - Train CM:
[[376   9]
 [ 12 320]]
2023-09-02 21:00:12,524 - FGO - INFO - Val CM:
[[48  1]
 [ 0 38]]
2023-09-02 21:00:12,525 - FGO - INFO - Test CM:
[[48  1]
 [ 0 38]]
2023-09-02 21:00:12,530 - FGO - INFO - test statistical parity: 0.05696202531645572
2023-09-02 21:00:12,532 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:00:12,533 - FGO - INFO - test micro f1: 0.9885057471264368
2023-09-02 21:00:12,533 - FGO - INFO - test macro f1: 0.9883518543312357
2023-09-02 21:00:12,533 - CV - INFO - fold time: 4.268427848815918s (0.07114046414693197m)
2023-09-02 21:00:12,533 - CV - INFO - ----- BEGINNING FOLD SET (025:7)----------------------------------------------------------
2023-09-02 21:00:12,535 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/025/7
2023-09-02 21:00:12,535 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:12,535 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:12,535 - FGO - INFO - 	done: False
2023-09-02 21:00:12,535 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:12,535 - FGO - INFO - 	h1: 64
2023-09-02 21:00:12,535 - FGO - INFO - 	h2: 32
2023-09-02 21:00:12,535 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:12,535 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:12,535 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:12,535 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:12,535 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:12,535 - FGO - INFO - 	theta: 10
2023-09-02 21:00:12,535 - FGO - INFO - 	clip: 5
2023-09-02 21:00:12,535 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:12,535 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:12,535 - FGO - INFO - Source Total: 717
2023-09-02 21:00:12,535 - FGO - INFO - Target Total: 87
2023-09-02 21:00:12,535 - FGO - INFO - Train Total: 717
2023-09-02 21:00:12,535 - FGO - INFO - Val Total:   87
2023-09-02 21:00:12,535 - FGO - INFO - Test Total:  87
2023-09-02 21:00:12,535 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:12,535 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:12,535 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:12,535 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:12,535 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:12,536 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:12,536 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:12,536 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:12,536 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:12,536 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:12,537 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:12,538 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:12,644 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:12,644 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:12,644 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:12,644 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:12,644 - FGO - INFO - N: 804
2023-09-02 21:00:12,644 - FGO - INFO - N_s: 717
2023-09-02 21:00:12,644 - FGO - INFO - N_t: 87
2023-09-02 21:00:12,648 - CV - INFO - Begin Pretrain
2023-09-02 21:00:12,648 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:12,651 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 21:00:12,676 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.49 | Val F1: 0.86 |
2023-09-02 21:00:12,701 - FGO - INFO - Epoch  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 |
2023-09-02 21:00:12,725 - FGO - INFO - Epoch  30 | Train Loss: 0.097 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 21:00:12,750 - FGO - INFO - Epoch  40 | Train Loss: 0.081 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 21:00:12,774 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 21:00:12,799 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 21:00:12,823 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 21:00:12,848 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 21:00:12,872 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 21:00:12,897 - FGO - INFO - Epoch 100 | Train Loss: 0.077 | Val Loss: 0.21 | Val F1: 0.95 |
2023-09-02 21:00:12,897 - FGO - INFO - Best Epoch:  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 
2023-09-02 21:00:12,897 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:12,898 - CV - INFO - Pretrain Complete, 20 epochs
2023-09-02 21:00:12,898 - CV - INFO - Begin OT Train
2023-09-02 21:00:12,898 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:12,964 - FGO - INFO - Epoch   0 | Train Loss: -4.269 | Val Loss: -0.37 | Val F1: 0.95 |
2023-09-02 21:00:13,740 - FGO - INFO - Epoch  10 | Train Loss: -4.210 | Val Loss: 0.03 | Val F1: 0.91 |
2023-09-02 21:00:14,534 - FGO - INFO - Epoch  20 | Train Loss: -4.383 | Val Loss: -0.27 | Val F1: 0.92 |
2023-09-02 21:00:15,297 - FGO - INFO - Epoch  30 | Train Loss: -4.481 | Val Loss: -0.28 | Val F1: 0.93 |
2023-09-02 21:00:16,054 - FGO - INFO - Epoch  40 | Train Loss: -4.544 | Val Loss: -0.27 | Val F1: 0.94 |
2023-09-02 21:00:16,759 - FGO - INFO - Best Epoch:  43 | Train Loss: -4.559 | Val Loss: -0.29 | Val F1: 0.95 |
2023-09-02 21:00:16,759 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:16,762 - CV - INFO - OT Train Complete, 43 epochs
2023-09-02 21:00:16,762 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:16,787 - FGO - INFO - Train CM:
[[379   8]
 [ 13 317]]
2023-09-02 21:00:16,787 - FGO - INFO - Val CM:
[[46  1]
 [ 3 37]]
2023-09-02 21:00:16,788 - FGO - INFO - Test CM:
[[46  1]
 [ 3 37]]
2023-09-02 21:00:16,793 - FGO - INFO - test statistical parity: 0.36333333333333334
2023-09-02 21:00:16,794 - FGO - INFO - test equal opportunity: 0.09677419354838712
2023-09-02 21:00:16,795 - FGO - INFO - test micro f1: 0.9540229885057472
2023-09-02 21:00:16,796 - FGO - INFO - test macro f1: 0.9535256410256411
2023-09-02 21:00:16,796 - CV - INFO - fold time: 4.262570381164551s (0.07104283968607585m)
2023-09-02 21:00:16,796 - CV - INFO - ----- BEGINNING FOLD SET (025:8)----------------------------------------------------------
2023-09-02 21:00:16,797 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/025/8
2023-09-02 21:00:16,797 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:16,797 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:16,797 - FGO - INFO - 	done: False
2023-09-02 21:00:16,797 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:16,797 - FGO - INFO - 	h1: 64
2023-09-02 21:00:16,797 - FGO - INFO - 	h2: 32
2023-09-02 21:00:16,798 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:16,798 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:16,798 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:16,798 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:16,798 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:16,798 - FGO - INFO - 	theta: 10
2023-09-02 21:00:16,798 - FGO - INFO - 	clip: 5
2023-09-02 21:00:16,798 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:16,798 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:16,798 - FGO - INFO - Source Total: 734
2023-09-02 21:00:16,798 - FGO - INFO - Target Total: 70
2023-09-02 21:00:16,798 - FGO - INFO - Train Total: 734
2023-09-02 21:00:16,798 - FGO - INFO - Val Total:   70
2023-09-02 21:00:16,798 - FGO - INFO - Test Total:  70
2023-09-02 21:00:16,798 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:16,798 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:16,798 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:16,798 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:16,798 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:16,798 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:16,798 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:16,798 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:16,798 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:16,798 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:16,799 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:16,801 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:16,889 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:16,889 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:16,889 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:16,889 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:16,889 - FGO - INFO - N: 804
2023-09-02 21:00:16,889 - FGO - INFO - N_s: 734
2023-09-02 21:00:16,889 - FGO - INFO - N_t: 70
2023-09-02 21:00:16,893 - CV - INFO - Begin Pretrain
2023-09-02 21:00:16,893 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:16,896 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 21:00:16,921 - FGO - INFO - Epoch  10 | Train Loss: 0.450 | Val Loss: 0.48 | Val F1: 0.81 |
2023-09-02 21:00:16,946 - FGO - INFO - Epoch  20 | Train Loss: 0.149 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 21:00:16,971 - FGO - INFO - Epoch  30 | Train Loss: 0.104 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 21:00:16,996 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 21:00:17,021 - FGO - INFO - Epoch  50 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 21:00:17,045 - FGO - INFO - Epoch  60 | Train Loss: 0.067 | Val Loss: 0.11 | Val F1: 0.96 |
2023-09-02 21:00:17,070 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.96 |
2023-09-02 21:00:17,095 - FGO - INFO - Epoch  80 | Train Loss: 0.072 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 21:00:17,119 - FGO - INFO - Epoch  90 | Train Loss: 0.061 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 21:00:17,144 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 21:00:17,144 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.117 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 21:00:17,144 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:17,145 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 21:00:17,145 - CV - INFO - Begin OT Train
2023-09-02 21:00:17,145 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:17,239 - FGO - INFO - Epoch   0 | Train Loss: -4.159 | Val Loss: -0.26 | Val F1: 0.93 |
2023-09-02 21:00:18,026 - FGO - INFO - Epoch  10 | Train Loss: -4.333 | Val Loss: -0.06 | Val F1: 0.93 |
2023-09-02 21:00:18,781 - FGO - INFO - Epoch  20 | Train Loss: -4.485 | Val Loss: -0.15 | Val F1: 0.94 |
2023-09-02 21:00:19,553 - FGO - INFO - Epoch  30 | Train Loss: -4.567 | Val Loss: -0.12 | Val F1: 0.93 |
2023-09-02 21:00:20,354 - FGO - INFO - Epoch  40 | Train Loss: -4.606 | Val Loss: -0.11 | Val F1: 0.94 |
2023-09-02 21:00:21,053 - FGO - INFO - Best Epoch:  37 | Train Loss: -4.599 | Val Loss: -0.12 | Val F1: 0.94 |
2023-09-02 21:00:21,053 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:21,056 - CV - INFO - OT Train Complete, 37 epochs
2023-09-02 21:00:21,056 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:21,085 - FGO - INFO - Train CM:
[[391   9]
 [ 11 323]]
2023-09-02 21:00:21,085 - FGO - INFO - Val CM:
[[33  1]
 [ 3 33]]
2023-09-02 21:00:21,085 - FGO - INFO - Test CM:
[[33  1]
 [ 3 33]]
2023-09-02 21:00:21,091 - FGO - INFO - test statistical parity: 0.1241565452091768
2023-09-02 21:00:21,092 - FGO - INFO - test equal opportunity: 0.09999999999999998
2023-09-02 21:00:21,093 - FGO - INFO - test micro f1: 0.9428571428571428
2023-09-02 21:00:21,093 - FGO - INFO - test macro f1: 0.9428571428571428
2023-09-02 21:00:21,093 - CV - INFO - fold time: 4.297726392745972s (0.07162877321243286m)
2023-09-02 21:00:21,093 - CV - INFO - ----- BEGINNING FOLD SET (025:9)----------------------------------------------------------
2023-09-02 21:00:21,095 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/025/9
2023-09-02 21:00:21,095 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:21,095 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:21,095 - FGO - INFO - 	done: False
2023-09-02 21:00:21,095 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:21,095 - FGO - INFO - 	h1: 64
2023-09-02 21:00:21,095 - FGO - INFO - 	h2: 32
2023-09-02 21:00:21,095 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:21,095 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:21,095 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:21,095 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:21,095 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:21,095 - FGO - INFO - 	theta: 10
2023-09-02 21:00:21,095 - FGO - INFO - 	clip: 5
2023-09-02 21:00:21,095 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:21,095 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:21,095 - FGO - INFO - Source Total: 725
2023-09-02 21:00:21,095 - FGO - INFO - Target Total: 79
2023-09-02 21:00:21,095 - FGO - INFO - Train Total: 725
2023-09-02 21:00:21,095 - FGO - INFO - Val Total:   79
2023-09-02 21:00:21,095 - FGO - INFO - Test Total:  79
2023-09-02 21:00:21,095 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:21,096 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:21,096 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:21,096 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:21,096 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:21,096 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:21,096 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:21,096 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:21,096 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:21,096 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:21,097 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:21,098 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:21,197 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:21,197 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:21,197 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:21,197 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:21,197 - FGO - INFO - N: 804
2023-09-02 21:00:21,197 - FGO - INFO - N_s: 725
2023-09-02 21:00:21,197 - FGO - INFO - N_t: 79
2023-09-02 21:00:21,201 - CV - INFO - Begin Pretrain
2023-09-02 21:00:21,201 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:21,204 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 21:00:21,229 - FGO - INFO - Epoch  10 | Train Loss: 0.471 | Val Loss: 0.48 | Val F1: 0.87 |
2023-09-02 21:00:21,253 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 21:00:21,278 - FGO - INFO - Epoch  30 | Train Loss: 0.102 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 21:00:21,302 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.21 | Val F1: 0.97 |
2023-09-02 21:00:21,327 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 21:00:21,351 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 21:00:21,375 - FGO - INFO - Epoch  70 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 21:00:21,400 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 21:00:21,424 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 21:00:21,449 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 21:00:21,449 - FGO - INFO - Best Epoch:  25 | Train Loss: 0.119 | Val Loss: 0.24 | Val F1: 0.97 
2023-09-02 21:00:21,449 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:21,450 - CV - INFO - Pretrain Complete, 25 epochs
2023-09-02 21:00:21,450 - CV - INFO - Begin OT Train
2023-09-02 21:00:21,450 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:21,517 - FGO - INFO - Epoch   0 | Train Loss: -4.305 | Val Loss: -0.37 | Val F1: 0.97 |
2023-09-02 21:00:22,360 - FGO - INFO - Epoch  10 | Train Loss: -4.419 | Val Loss: -0.44 | Val F1: 0.99 |
2023-09-02 21:00:23,121 - FGO - INFO - Epoch  20 | Train Loss: -4.471 | Val Loss: -0.45 | Val F1: 0.99 |
2023-09-02 21:00:23,905 - FGO - INFO - Epoch  30 | Train Loss: -4.543 | Val Loss: -0.47 | Val F1: 0.99 |
2023-09-02 21:00:24,653 - FGO - INFO - Epoch  40 | Train Loss: -4.592 | Val Loss: -0.48 | Val F1: 0.99 |
2023-09-02 21:00:25,425 - FGO - INFO - Best Epoch:  30 | Train Loss: -4.543 | Val Loss: -0.47 | Val F1: 0.99 |
2023-09-02 21:00:25,425 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:25,429 - CV - INFO - OT Train Complete, 30 epochs
2023-09-02 21:00:25,429 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:25,454 - FGO - INFO - Train CM:
[[377   8]
 [ 12 328]]
2023-09-02 21:00:25,454 - FGO - INFO - Val CM:
[[47  2]
 [ 0 30]]
2023-09-02 21:00:25,454 - FGO - INFO - Test CM:
[[47  2]
 [ 0 30]]
2023-09-02 21:00:25,459 - FGO - INFO - test statistical parity: 0.005797101449275366
2023-09-02 21:00:25,461 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:00:25,462 - FGO - INFO - test micro f1: 0.9746835443037974
2023-09-02 21:00:25,462 - FGO - INFO - test macro f1: 0.9734543010752688
2023-09-02 21:00:25,462 - CV - INFO - fold time: 4.368741750717163s (0.07281236251195272m)
2023-09-02 21:00:25,462 - CV - INFO - Mean Pretrain Epochs 41.0:
2023-09-02 21:00:25,462 - CV - INFO - Mean OT Train Epochs 26.5:
2023-09-02 21:00:25,462 - CV - INFO - Mean Val Macro F1 : 0.956525674154817
2023-09-02 21:00:25,462 - CV - INFO - Mean Eval Stat : 0.956525674154817 (harmoic mean of macro f1 and (1-eo))
2023-09-02 21:00:25,462 - CV - INFO - set time: 43.66118502616882s (0.7276864171028137m)
2023-09-02 21:00:25,462 - CV - INFO - script time so far: 1123.413442850113s (18.723557380835214m) (0.3120592896805869h)
2023-09-02 21:00:25,462 - CV - INFO - ===== BEGINNING OPTION SET (026)==========================================================
2023-09-02 21:00:25,462 - CV - INFO - 	done: False
2023-09-02 21:00:25,462 - CV - INFO - 	learning_rate: 0.01
2023-09-02 21:00:25,462 - CV - INFO - 	h1: 64
2023-09-02 21:00:25,462 - CV - INFO - 	h2: 32
2023-09-02 21:00:25,462 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:25,462 - CV - INFO - 	dropout: 0.0
2023-09-02 21:00:25,462 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:25,462 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:25,463 - CV - INFO - 	lambda: 0.05
2023-09-02 21:00:25,463 - CV - INFO - 	theta: 30
2023-09-02 21:00:25,463 - CV - INFO - 	clip: 5
2023-09-02 21:00:25,463 - CV - INFO - ----- BEGINNING FOLD SET (026:0)----------------------------------------------------------
2023-09-02 21:00:25,464 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/026/0
2023-09-02 21:00:25,464 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:25,464 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:25,464 - FGO - INFO - 	done: False
2023-09-02 21:00:25,464 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:25,464 - FGO - INFO - 	h1: 64
2023-09-02 21:00:25,464 - FGO - INFO - 	h2: 32
2023-09-02 21:00:25,464 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:25,464 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:25,464 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:25,464 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:25,464 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:25,465 - FGO - INFO - 	theta: 30
2023-09-02 21:00:25,465 - FGO - INFO - 	clip: 5
2023-09-02 21:00:25,465 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:25,465 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:25,465 - FGO - INFO - Source Total: 708
2023-09-02 21:00:25,465 - FGO - INFO - Target Total: 96
2023-09-02 21:00:25,465 - FGO - INFO - Train Total: 708
2023-09-02 21:00:25,465 - FGO - INFO - Val Total:   96
2023-09-02 21:00:25,465 - FGO - INFO - Test Total:  96
2023-09-02 21:00:25,465 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:25,465 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:25,465 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:25,465 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:25,465 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:25,465 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:25,465 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:25,465 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:25,465 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:25,465 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:25,466 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:25,468 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:25,583 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:25,583 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:25,583 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:25,583 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:25,583 - FGO - INFO - N: 804
2023-09-02 21:00:25,583 - FGO - INFO - N_s: 708
2023-09-02 21:00:25,583 - FGO - INFO - N_t: 96
2023-09-02 21:00:25,587 - CV - INFO - Begin Pretrain
2023-09-02 21:00:25,587 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:25,590 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 21:00:25,614 - FGO - INFO - Epoch  10 | Train Loss: 0.421 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 21:00:25,639 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 21:00:25,663 - FGO - INFO - Epoch  30 | Train Loss: 0.103 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 21:00:25,687 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 21:00:25,711 - FGO - INFO - Epoch  50 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 21:00:25,736 - FGO - INFO - Epoch  60 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 21:00:25,760 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 21:00:25,784 - FGO - INFO - Epoch  80 | Train Loss: 0.058 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 21:00:25,808 - FGO - INFO - Epoch  90 | Train Loss: 0.058 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 21:00:25,833 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 21:00:25,833 - FGO - INFO - Best Epoch:  28 | Train Loss: 0.112 | Val Loss: 0.09 | Val F1: 0.99 
2023-09-02 21:00:25,833 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:25,834 - CV - INFO - Pretrain Complete, 28 epochs
2023-09-02 21:00:25,834 - CV - INFO - Begin OT Train
2023-09-02 21:00:25,834 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:25,899 - FGO - INFO - Epoch   0 | Train Loss: -12.972 | Val Loss: -1.67 | Val F1: 0.94 |
2023-09-02 21:00:26,721 - FGO - INFO - Epoch  10 | Train Loss: -13.484 | Val Loss: -1.79 | Val F1: 0.96 |
2023-09-02 21:00:27,472 - FGO - INFO - Epoch  20 | Train Loss: -13.762 | Val Loss: -1.80 | Val F1: 0.93 |
2023-09-02 21:00:28,221 - FGO - INFO - Epoch  30 | Train Loss: -13.826 | Val Loss: -1.79 | Val F1: 0.95 |
2023-09-02 21:00:28,971 - FGO - INFO - Epoch  40 | Train Loss: -13.916 | Val Loss: -1.81 | Val F1: 0.95 |
2023-09-02 21:00:29,693 - FGO - INFO - Best Epoch:   8 | Train Loss: -13.556 | Val Loss: -1.79 | Val F1: 0.96 |
2023-09-02 21:00:29,693 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:29,696 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 21:00:29,697 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:29,719 - FGO - INFO - Train CM:
[[379   3]
 [ 24 302]]
2023-09-02 21:00:29,719 - FGO - INFO - Val CM:
[[52  0]
 [ 4 40]]
2023-09-02 21:00:29,720 - FGO - INFO - Test CM:
[[52  0]
 [ 4 40]]
2023-09-02 21:00:29,724 - FGO - INFO - test statistical parity: 0.2481283422459893
2023-09-02 21:00:29,725 - FGO - INFO - test equal opportunity: 0.04166666666666663
2023-09-02 21:00:29,726 - FGO - INFO - test micro f1: 0.9583333333333334
2023-09-02 21:00:29,727 - FGO - INFO - test macro f1: 0.9576719576719577
2023-09-02 21:00:29,727 - CV - INFO - fold time: 4.264265775680542s (0.07107109626134236m)
2023-09-02 21:00:29,727 - CV - INFO - ----- BEGINNING FOLD SET (026:1)----------------------------------------------------------
2023-09-02 21:00:29,728 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/026/1
2023-09-02 21:00:29,729 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:29,729 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:29,729 - FGO - INFO - 	done: False
2023-09-02 21:00:29,729 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:29,729 - FGO - INFO - 	h1: 64
2023-09-02 21:00:29,729 - FGO - INFO - 	h2: 32
2023-09-02 21:00:29,729 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:29,729 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:29,729 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:29,729 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:29,729 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:29,729 - FGO - INFO - 	theta: 30
2023-09-02 21:00:29,729 - FGO - INFO - 	clip: 5
2023-09-02 21:00:29,729 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:29,729 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:29,729 - FGO - INFO - Source Total: 727
2023-09-02 21:00:29,729 - FGO - INFO - Target Total: 77
2023-09-02 21:00:29,729 - FGO - INFO - Train Total: 727
2023-09-02 21:00:29,729 - FGO - INFO - Val Total:   77
2023-09-02 21:00:29,729 - FGO - INFO - Test Total:  77
2023-09-02 21:00:29,729 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:29,729 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:29,729 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:29,729 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:29,729 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:29,729 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:29,730 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:29,730 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:29,730 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:29,730 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:29,731 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:29,732 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:29,828 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:29,828 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:29,828 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:29,828 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:29,828 - FGO - INFO - N: 804
2023-09-02 21:00:29,828 - FGO - INFO - N_s: 727
2023-09-02 21:00:29,828 - FGO - INFO - N_t: 77
2023-09-02 21:00:29,832 - CV - INFO - Begin Pretrain
2023-09-02 21:00:29,832 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:29,835 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 21:00:29,860 - FGO - INFO - Epoch  10 | Train Loss: 0.472 | Val Loss: 0.55 | Val F1: 0.71 |
2023-09-02 21:00:29,885 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.27 | Val F1: 0.84 |
2023-09-02 21:00:29,909 - FGO - INFO - Epoch  30 | Train Loss: 0.091 | Val Loss: 0.17 | Val F1: 0.93 |
2023-09-02 21:00:29,934 - FGO - INFO - Epoch  40 | Train Loss: 0.080 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 21:00:29,959 - FGO - INFO - Epoch  50 | Train Loss: 0.067 | Val Loss: 0.20 | Val F1: 0.87 |
2023-09-02 21:00:29,983 - FGO - INFO - Epoch  60 | Train Loss: 0.061 | Val Loss: 0.22 | Val F1: 0.89 |
2023-09-02 21:00:30,008 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 21:00:30,032 - FGO - INFO - Epoch  80 | Train Loss: 0.054 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 21:00:30,057 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.21 | Val F1: 0.92 |
2023-09-02 21:00:30,081 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 21:00:30,082 - FGO - INFO - Best Epoch:  34 | Train Loss: 0.088 | Val Loss: 0.17 | Val F1: 0.95 
2023-09-02 21:00:30,082 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:30,083 - CV - INFO - Pretrain Complete, 34 epochs
2023-09-02 21:00:30,083 - CV - INFO - Begin OT Train
2023-09-02 21:00:30,083 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:30,180 - FGO - INFO - Epoch   0 | Train Loss: -13.080 | Val Loss: -1.13 | Val F1: 0.90 |
2023-09-02 21:00:30,973 - FGO - INFO - Epoch  10 | Train Loss: -13.766 | Val Loss: -1.01 | Val F1: 0.86 |
2023-09-02 21:00:31,735 - FGO - INFO - Epoch  20 | Train Loss: -13.952 | Val Loss: -1.13 | Val F1: 0.89 |
2023-09-02 21:00:32,509 - FGO - INFO - Epoch  30 | Train Loss: -14.150 | Val Loss: -0.88 | Val F1: 0.65 |
2023-09-02 21:00:33,264 - FGO - INFO - Epoch  40 | Train Loss: -14.219 | Val Loss: -0.80 | Val F1: 0.36 |
2023-09-02 21:00:33,924 - FGO - INFO - Best Epoch:   7 | Train Loss: -13.675 | Val Loss: -1.12 | Val F1: 0.89 |
2023-09-02 21:00:33,924 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:33,927 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 21:00:33,927 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:33,951 - FGO - INFO - Train CM:
[[390   0]
 [337   0]]
2023-09-02 21:00:33,952 - FGO - INFO - Val CM:
[[44  0]
 [33  0]]
2023-09-02 21:00:33,952 - FGO - INFO - Test CM:
[[44  0]
 [33  0]]
2023-09-02 21:00:33,957 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:00:33,958 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:00:33,959 - FGO - INFO - test micro f1: 0.5714285714285714
2023-09-02 21:00:33,960 - FGO - INFO - test macro f1: 0.36363636363636365
2023-09-02 21:00:33,960 - CV - INFO - fold time: 4.232884407043457s (0.07054807345072428m)
2023-09-02 21:00:33,960 - CV - INFO - ----- BEGINNING FOLD SET (026:2)----------------------------------------------------------
2023-09-02 21:00:33,961 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/026/2
2023-09-02 21:00:33,962 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:33,962 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:33,962 - FGO - INFO - 	done: False
2023-09-02 21:00:33,962 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:33,962 - FGO - INFO - 	h1: 64
2023-09-02 21:00:33,962 - FGO - INFO - 	h2: 32
2023-09-02 21:00:33,962 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:33,962 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:33,962 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:33,962 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:33,962 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:33,962 - FGO - INFO - 	theta: 30
2023-09-02 21:00:33,962 - FGO - INFO - 	clip: 5
2023-09-02 21:00:33,962 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:33,962 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:33,962 - FGO - INFO - Source Total: 721
2023-09-02 21:00:33,962 - FGO - INFO - Target Total: 83
2023-09-02 21:00:33,962 - FGO - INFO - Train Total: 721
2023-09-02 21:00:33,962 - FGO - INFO - Val Total:   83
2023-09-02 21:00:33,962 - FGO - INFO - Test Total:  83
2023-09-02 21:00:33,962 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:33,962 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:33,962 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:33,962 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:33,962 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:33,963 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:33,963 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:33,963 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:33,963 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:33,963 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:33,964 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:33,965 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:34,067 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:34,067 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:34,067 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:34,067 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:34,068 - FGO - INFO - N: 804
2023-09-02 21:00:34,068 - FGO - INFO - N_s: 721
2023-09-02 21:00:34,068 - FGO - INFO - N_t: 83
2023-09-02 21:00:34,071 - CV - INFO - Begin Pretrain
2023-09-02 21:00:34,071 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:34,074 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 21:00:34,099 - FGO - INFO - Epoch  10 | Train Loss: 0.478 | Val Loss: 0.49 | Val F1: 0.84 |
2023-09-02 21:00:34,124 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.24 | Val F1: 0.87 |
2023-09-02 21:00:34,148 - FGO - INFO - Epoch  30 | Train Loss: 0.087 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 21:00:34,173 - FGO - INFO - Epoch  40 | Train Loss: 0.073 | Val Loss: 0.25 | Val F1: 0.90 |
2023-09-02 21:00:34,197 - FGO - INFO - Epoch  50 | Train Loss: 0.063 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 21:00:34,221 - FGO - INFO - Epoch  60 | Train Loss: 0.058 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 21:00:34,246 - FGO - INFO - Epoch  70 | Train Loss: 0.056 | Val Loss: 0.28 | Val F1: 0.91 |
2023-09-02 21:00:34,270 - FGO - INFO - Epoch  80 | Train Loss: 0.052 | Val Loss: 0.28 | Val F1: 0.88 |
2023-09-02 21:00:34,295 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.28 | Val F1: 0.89 |
2023-09-02 21:00:34,319 - FGO - INFO - Epoch 100 | Train Loss: 0.046 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 21:00:34,319 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.058 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 21:00:34,319 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:34,321 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 21:00:34,321 - CV - INFO - Begin OT Train
2023-09-02 21:00:34,321 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:34,417 - FGO - INFO - Epoch   0 | Train Loss: -12.993 | Val Loss: -1.13 | Val F1: 0.90 |
2023-09-02 21:00:35,200 - FGO - INFO - Epoch  10 | Train Loss: -13.818 | Val Loss: -1.11 | Val F1: 0.88 |
2023-09-02 21:00:35,971 - FGO - INFO - Epoch  20 | Train Loss: -13.990 | Val Loss: -1.30 | Val F1: 0.89 |
2023-09-02 21:00:36,760 - FGO - INFO - Epoch  30 | Train Loss: -14.109 | Val Loss: -1.23 | Val F1: 0.91 |
2023-09-02 21:00:37,498 - FGO - INFO - Epoch  40 | Train Loss: -14.196 | Val Loss: -1.12 | Val F1: 0.90 |
2023-09-02 21:00:38,258 - FGO - INFO - Best Epoch:   7 | Train Loss: -13.679 | Val Loss: -1.15 | Val F1: 0.91 |
2023-09-02 21:00:38,258 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:38,262 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 21:00:38,262 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:38,286 - FGO - INFO - Train CM:
[[379   5]
 [ 13 324]]
2023-09-02 21:00:38,286 - FGO - INFO - Val CM:
[[46  4]
 [ 4 29]]
2023-09-02 21:00:38,287 - FGO - INFO - Test CM:
[[46  4]
 [ 4 29]]
2023-09-02 21:00:38,292 - FGO - INFO - test statistical parity: 0.02230046948356812
2023-09-02 21:00:38,293 - FGO - INFO - test equal opportunity: 0.2592592592592593
2023-09-02 21:00:38,294 - FGO - INFO - test micro f1: 0.9036144578313253
2023-09-02 21:00:38,295 - FGO - INFO - test macro f1: 0.8993939393939394
2023-09-02 21:00:38,295 - CV - INFO - fold time: 4.334977149963379s (0.07224961916605631m)
2023-09-02 21:00:38,295 - CV - INFO - ----- BEGINNING FOLD SET (026:3)----------------------------------------------------------
2023-09-02 21:00:38,296 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/026/3
2023-09-02 21:00:38,296 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:38,296 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:38,297 - FGO - INFO - 	done: False
2023-09-02 21:00:38,297 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:38,297 - FGO - INFO - 	h1: 64
2023-09-02 21:00:38,297 - FGO - INFO - 	h2: 32
2023-09-02 21:00:38,297 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:38,297 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:38,297 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:38,297 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:38,297 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:38,297 - FGO - INFO - 	theta: 30
2023-09-02 21:00:38,297 - FGO - INFO - 	clip: 5
2023-09-02 21:00:38,297 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:38,297 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:38,297 - FGO - INFO - Source Total: 729
2023-09-02 21:00:38,297 - FGO - INFO - Target Total: 75
2023-09-02 21:00:38,297 - FGO - INFO - Train Total: 729
2023-09-02 21:00:38,297 - FGO - INFO - Val Total:   75
2023-09-02 21:00:38,297 - FGO - INFO - Test Total:  75
2023-09-02 21:00:38,297 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:38,297 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:38,297 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:38,297 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:38,297 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:38,297 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:38,297 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:38,297 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:38,297 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:38,297 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:38,298 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:38,300 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:38,394 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:38,394 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:38,394 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:38,394 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:38,394 - FGO - INFO - N: 804
2023-09-02 21:00:38,394 - FGO - INFO - N_s: 729
2023-09-02 21:00:38,394 - FGO - INFO - N_t: 75
2023-09-02 21:00:38,398 - CV - INFO - Begin Pretrain
2023-09-02 21:00:38,398 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:38,401 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 21:00:38,426 - FGO - INFO - Epoch  10 | Train Loss: 0.431 | Val Loss: 0.36 | Val F1: 0.93 |
2023-09-02 21:00:38,451 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:00:38,475 - FGO - INFO - Epoch  30 | Train Loss: 0.109 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 21:00:38,500 - FGO - INFO - Epoch  40 | Train Loss: 0.093 | Val Loss: 0.03 | Val F1: 0.99 |
2023-09-02 21:00:38,525 - FGO - INFO - Epoch  50 | Train Loss: 0.080 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 21:00:38,549 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 21:00:38,574 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 21:00:38,598 - FGO - INFO - Epoch  80 | Train Loss: 0.065 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 21:00:38,623 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 21:00:38,647 - FGO - INFO - Epoch 100 | Train Loss: 0.069 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 21:00:38,647 - FGO - INFO - Best Epoch:  27 | Train Loss: 0.114 | Val Loss: 0.03 | Val F1: 1.00 
2023-09-02 21:00:38,647 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:38,649 - CV - INFO - Pretrain Complete, 27 epochs
2023-09-02 21:00:38,649 - CV - INFO - Begin OT Train
2023-09-02 21:00:38,649 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:38,728 - FGO - INFO - Epoch   0 | Train Loss: -12.818 | Val Loss: -1.33 | Val F1: 0.97 |
2023-09-02 21:00:39,510 - FGO - INFO - Epoch  10 | Train Loss: -13.589 | Val Loss: -1.16 | Val F1: 0.91 |
2023-09-02 21:00:40,275 - FGO - INFO - Epoch  20 | Train Loss: -13.925 | Val Loss: -1.34 | Val F1: 0.93 |
2023-09-02 21:00:41,039 - FGO - INFO - Epoch  30 | Train Loss: -13.999 | Val Loss: -1.39 | Val F1: 0.97 |
2023-09-02 21:00:41,842 - FGO - INFO - Epoch  40 | Train Loss: -14.075 | Val Loss: -1.39 | Val F1: 0.97 |
2023-09-02 21:00:42,542 - FGO - INFO - Best Epoch:   7 | Train Loss: -13.457 | Val Loss: -1.37 | Val F1: 0.97 |
2023-09-02 21:00:42,542 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:42,545 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 21:00:42,545 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:42,569 - FGO - INFO - Train CM:
[[393   3]
 [ 27 306]]
2023-09-02 21:00:42,570 - FGO - INFO - Val CM:
[[38  0]
 [ 2 35]]
2023-09-02 21:00:42,570 - FGO - INFO - Test CM:
[[38  0]
 [ 2 35]]
2023-09-02 21:00:42,575 - FGO - INFO - test statistical parity: 0.046838407494145196
2023-09-02 21:00:42,577 - FGO - INFO - test equal opportunity: 0.10952380952380958
2023-09-02 21:00:42,578 - FGO - INFO - test micro f1: 0.9733333333333334
2023-09-02 21:00:42,578 - FGO - INFO - test macro f1: 0.9732905982905983
2023-09-02 21:00:42,578 - CV - INFO - fold time: 4.283269643783569s (0.07138782739639282m)
2023-09-02 21:00:42,578 - CV - INFO - ----- BEGINNING FOLD SET (026:4)----------------------------------------------------------
2023-09-02 21:00:42,580 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/026/4
2023-09-02 21:00:42,580 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:42,580 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:42,580 - FGO - INFO - 	done: False
2023-09-02 21:00:42,580 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:42,580 - FGO - INFO - 	h1: 64
2023-09-02 21:00:42,580 - FGO - INFO - 	h2: 32
2023-09-02 21:00:42,580 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:42,580 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:42,580 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:42,580 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:42,580 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:42,580 - FGO - INFO - 	theta: 30
2023-09-02 21:00:42,580 - FGO - INFO - 	clip: 5
2023-09-02 21:00:42,580 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:42,580 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:42,580 - FGO - INFO - Source Total: 732
2023-09-02 21:00:42,580 - FGO - INFO - Target Total: 72
2023-09-02 21:00:42,580 - FGO - INFO - Train Total: 732
2023-09-02 21:00:42,580 - FGO - INFO - Val Total:   72
2023-09-02 21:00:42,580 - FGO - INFO - Test Total:  72
2023-09-02 21:00:42,580 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:42,580 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:42,580 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:42,580 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:42,580 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:42,581 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:42,581 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:42,581 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:42,581 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:42,581 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:42,582 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:42,583 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:42,674 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:42,674 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:42,674 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:42,674 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:42,674 - FGO - INFO - N: 804
2023-09-02 21:00:42,674 - FGO - INFO - N_s: 732
2023-09-02 21:00:42,674 - FGO - INFO - N_t: 72
2023-09-02 21:00:42,678 - CV - INFO - Begin Pretrain
2023-09-02 21:00:42,678 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:42,681 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 21:00:42,706 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.46 | Val F1: 0.81 |
2023-09-02 21:00:42,731 - FGO - INFO - Epoch  20 | Train Loss: 0.141 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 21:00:42,756 - FGO - INFO - Epoch  30 | Train Loss: 0.100 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 21:00:42,780 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 21:00:42,805 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 21:00:42,830 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 21:00:42,854 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:00:42,879 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 21:00:42,904 - FGO - INFO - Epoch  90 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 21:00:42,929 - FGO - INFO - Epoch 100 | Train Loss: 0.069 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:00:42,929 - FGO - INFO - Best Epoch:  64 | Train Loss: 0.069 | Val Loss: 0.06 | Val F1: 0.99 
2023-09-02 21:00:42,929 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:42,930 - CV - INFO - Pretrain Complete, 64 epochs
2023-09-02 21:00:42,930 - CV - INFO - Begin OT Train
2023-09-02 21:00:42,930 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:43,000 - FGO - INFO - Epoch   0 | Train Loss: -13.073 | Val Loss: -1.29 | Val F1: 0.99 |
2023-09-02 21:00:43,786 - FGO - INFO - Epoch  10 | Train Loss: -13.917 | Val Loss: -1.35 | Val F1: 0.96 |
2023-09-02 21:00:44,596 - FGO - INFO - Epoch  20 | Train Loss: -14.042 | Val Loss: -1.38 | Val F1: 0.99 |
2023-09-02 21:00:45,380 - FGO - INFO - Epoch  30 | Train Loss: -14.134 | Val Loss: -1.37 | Val F1: 0.99 |
2023-09-02 21:00:46,222 - FGO - INFO - Epoch  40 | Train Loss: -14.201 | Val Loss: -1.37 | Val F1: 0.99 |
2023-09-02 21:00:46,915 - FGO - INFO - Best Epoch:  11 | Train Loss: -13.925 | Val Loss: -1.35 | Val F1: 0.99 |
2023-09-02 21:00:46,915 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:46,918 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 21:00:46,919 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:46,946 - FGO - INFO - Train CM:
[[386  11]
 [ 11 324]]
2023-09-02 21:00:46,946 - FGO - INFO - Val CM:
[[37  0]
 [ 1 34]]
2023-09-02 21:00:46,946 - FGO - INFO - Test CM:
[[37  0]
 [ 1 34]]
2023-09-02 21:00:46,952 - FGO - INFO - test statistical parity: 0.08387096774193548
2023-09-02 21:00:46,953 - FGO - INFO - test equal opportunity: 0.19999999999999996
2023-09-02 21:00:46,954 - FGO - INFO - test micro f1: 0.9861111111111112
2023-09-02 21:00:46,954 - FGO - INFO - test macro f1: 0.986086956521739
2023-09-02 21:00:46,954 - CV - INFO - fold time: 4.37628698348999s (0.07293811639149984m)
2023-09-02 21:00:46,954 - CV - INFO - ----- BEGINNING FOLD SET (026:5)----------------------------------------------------------
2023-09-02 21:00:46,956 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/026/5
2023-09-02 21:00:46,956 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:46,956 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:46,956 - FGO - INFO - 	done: False
2023-09-02 21:00:46,956 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:46,956 - FGO - INFO - 	h1: 64
2023-09-02 21:00:46,956 - FGO - INFO - 	h2: 32
2023-09-02 21:00:46,956 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:46,956 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:46,956 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:46,956 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:46,956 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:46,956 - FGO - INFO - 	theta: 30
2023-09-02 21:00:46,956 - FGO - INFO - 	clip: 5
2023-09-02 21:00:46,956 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:46,956 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:46,956 - FGO - INFO - Source Total: 726
2023-09-02 21:00:46,956 - FGO - INFO - Target Total: 78
2023-09-02 21:00:46,956 - FGO - INFO - Train Total: 726
2023-09-02 21:00:46,956 - FGO - INFO - Val Total:   78
2023-09-02 21:00:46,956 - FGO - INFO - Test Total:  78
2023-09-02 21:00:46,956 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:46,957 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:46,957 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:46,957 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:46,957 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:46,957 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:46,957 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:46,957 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:46,957 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:46,957 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:46,958 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:46,959 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:47,057 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:47,058 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:47,058 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:47,058 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:47,058 - FGO - INFO - N: 804
2023-09-02 21:00:47,058 - FGO - INFO - N_s: 726
2023-09-02 21:00:47,058 - FGO - INFO - N_t: 78
2023-09-02 21:00:47,061 - CV - INFO - Begin Pretrain
2023-09-02 21:00:47,061 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:47,065 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 21:00:47,093 - FGO - INFO - Epoch  10 | Train Loss: 0.515 | Val Loss: 0.52 | Val F1: 0.82 |
2023-09-02 21:00:47,118 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 21:00:47,142 - FGO - INFO - Epoch  30 | Train Loss: 0.106 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 21:00:47,167 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.13 | Val F1: 0.95 |
2023-09-02 21:00:47,205 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 21:00:47,230 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.09 | Val F1: 0.95 |
2023-09-02 21:00:47,255 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 21:00:47,290 - FGO - INFO - Epoch  80 | Train Loss: 0.070 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 21:00:47,319 - FGO - INFO - Epoch  90 | Train Loss: 0.064 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 21:00:47,355 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 21:00:47,355 - FGO - INFO - Best Epoch:  55 | Train Loss: 0.077 | Val Loss: 0.09 | Val F1: 0.97 
2023-09-02 21:00:47,355 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:47,356 - CV - INFO - Pretrain Complete, 55 epochs
2023-09-02 21:00:47,356 - CV - INFO - Begin OT Train
2023-09-02 21:00:47,356 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:47,428 - FGO - INFO - Epoch   0 | Train Loss: -12.665 | Val Loss: -1.28 | Val F1: 0.95 |
2023-09-02 21:00:48,234 - FGO - INFO - Epoch  10 | Train Loss: -13.715 | Val Loss: -0.83 | Val F1: 0.82 |
2023-09-02 21:00:48,994 - FGO - INFO - Epoch  20 | Train Loss: -13.970 | Val Loss: -1.19 | Val F1: 0.86 |
2023-09-02 21:00:49,781 - FGO - INFO - Epoch  30 | Train Loss: -14.026 | Val Loss: -1.19 | Val F1: 0.91 |
2023-09-02 21:00:50,549 - FGO - INFO - Epoch  40 | Train Loss: -14.072 | Val Loss: -1.09 | Val F1: 0.91 |
2023-09-02 21:00:51,267 - FGO - INFO - Best Epoch:   6 | Train Loss: -13.383 | Val Loss: -1.19 | Val F1: 0.92 |
2023-09-02 21:00:51,267 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:51,274 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 21:00:51,275 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:51,303 - FGO - INFO - Train CM:
[[400   0]
 [326   0]]
2023-09-02 21:00:51,303 - FGO - INFO - Val CM:
[[34  0]
 [44  0]]
2023-09-02 21:00:51,304 - FGO - INFO - Test CM:
[[34  0]
 [44  0]]
2023-09-02 21:00:51,309 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:00:51,310 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:00:51,311 - FGO - INFO - test micro f1: 0.4358974358974359
2023-09-02 21:00:51,311 - FGO - INFO - test macro f1: 0.30357142857142855
2023-09-02 21:00:51,311 - CV - INFO - fold time: 4.357084274291992s (0.07261807123819987m)
2023-09-02 21:00:51,311 - CV - INFO - ----- BEGINNING FOLD SET (026:6)----------------------------------------------------------
2023-09-02 21:00:51,313 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/026/6
2023-09-02 21:00:51,313 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:51,313 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:51,313 - FGO - INFO - 	done: False
2023-09-02 21:00:51,313 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:51,313 - FGO - INFO - 	h1: 64
2023-09-02 21:00:51,313 - FGO - INFO - 	h2: 32
2023-09-02 21:00:51,313 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:51,313 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:51,313 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:51,313 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:51,313 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:51,313 - FGO - INFO - 	theta: 30
2023-09-02 21:00:51,313 - FGO - INFO - 	clip: 5
2023-09-02 21:00:51,313 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:51,313 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:51,314 - FGO - INFO - Source Total: 717
2023-09-02 21:00:51,314 - FGO - INFO - Target Total: 87
2023-09-02 21:00:51,314 - FGO - INFO - Train Total: 717
2023-09-02 21:00:51,314 - FGO - INFO - Val Total:   87
2023-09-02 21:00:51,314 - FGO - INFO - Test Total:  87
2023-09-02 21:00:51,314 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:51,314 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:51,314 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:51,314 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:51,314 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:51,314 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:51,314 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:51,314 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:51,314 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:51,314 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:51,315 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:51,316 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:51,423 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:51,424 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:51,424 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:51,424 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:51,424 - FGO - INFO - N: 804
2023-09-02 21:00:51,424 - FGO - INFO - N_s: 717
2023-09-02 21:00:51,424 - FGO - INFO - N_t: 87
2023-09-02 21:00:51,427 - CV - INFO - Begin Pretrain
2023-09-02 21:00:51,427 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:51,431 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 21:00:51,455 - FGO - INFO - Epoch  10 | Train Loss: 0.496 | Val Loss: 0.48 | Val F1: 0.80 |
2023-09-02 21:00:51,480 - FGO - INFO - Epoch  20 | Train Loss: 0.161 | Val Loss: 0.13 | Val F1: 0.93 |
2023-09-02 21:00:51,505 - FGO - INFO - Epoch  30 | Train Loss: 0.108 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 21:00:51,529 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.09 | Val F1: 0.98 |
2023-09-02 21:00:51,554 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 21:00:51,578 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 21:00:51,603 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:00:51,627 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:00:51,651 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 21:00:51,676 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 21:00:51,676 - FGO - INFO - Best Epoch:  73 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 1.00 
2023-09-02 21:00:51,676 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:51,677 - CV - INFO - Pretrain Complete, 73 epochs
2023-09-02 21:00:51,677 - CV - INFO - Begin OT Train
2023-09-02 21:00:51,677 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:51,801 - FGO - INFO - Epoch   0 | Train Loss: -13.046 | Val Loss: -1.63 | Val F1: 1.00 |
2023-09-02 21:00:52,550 - FGO - INFO - Epoch  10 | Train Loss: -13.729 | Val Loss: -1.69 | Val F1: 0.96 |
2023-09-02 21:00:53,271 - FGO - INFO - Epoch  20 | Train Loss: -13.884 | Val Loss: -1.66 | Val F1: 0.96 |
2023-09-02 21:00:54,023 - FGO - INFO - Epoch  30 | Train Loss: -13.973 | Val Loss: -1.66 | Val F1: 0.96 |
2023-09-02 21:00:54,788 - FGO - INFO - Epoch  40 | Train Loss: -14.035 | Val Loss: -1.68 | Val F1: 0.96 |
2023-09-02 21:00:55,484 - FGO - INFO - Best Epoch:  10 | Train Loss: -13.729 | Val Loss: -1.69 | Val F1: 0.96 |
2023-09-02 21:00:55,484 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:55,487 - CV - INFO - OT Train Complete, 10 epochs
2023-09-02 21:00:55,487 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:55,527 - FGO - INFO - Train CM:
[[384   1]
 [ 29 303]]
2023-09-02 21:00:55,528 - FGO - INFO - Val CM:
[[49  0]
 [ 3 35]]
2023-09-02 21:00:55,528 - FGO - INFO - Test CM:
[[49  0]
 [ 3 35]]
2023-09-02 21:00:55,532 - FGO - INFO - test statistical parity: 0.10759493670886078
2023-09-02 21:00:55,534 - FGO - INFO - test equal opportunity: 0.08823529411764708
2023-09-02 21:00:55,535 - FGO - INFO - test micro f1: 0.9655172413793104
2023-09-02 21:00:55,535 - FGO - INFO - test macro f1: 0.9646005696460056
2023-09-02 21:00:55,535 - CV - INFO - fold time: 4.2235493659973145s (0.07039248943328857m)
2023-09-02 21:00:55,535 - CV - INFO - ----- BEGINNING FOLD SET (026:7)----------------------------------------------------------
2023-09-02 21:00:55,537 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/026/7
2023-09-02 21:00:55,537 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:55,537 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:55,537 - FGO - INFO - 	done: False
2023-09-02 21:00:55,537 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:55,537 - FGO - INFO - 	h1: 64
2023-09-02 21:00:55,537 - FGO - INFO - 	h2: 32
2023-09-02 21:00:55,537 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:55,537 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:55,537 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:55,537 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:55,537 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:55,537 - FGO - INFO - 	theta: 30
2023-09-02 21:00:55,537 - FGO - INFO - 	clip: 5
2023-09-02 21:00:55,537 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:55,537 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:55,537 - FGO - INFO - Source Total: 717
2023-09-02 21:00:55,537 - FGO - INFO - Target Total: 87
2023-09-02 21:00:55,537 - FGO - INFO - Train Total: 717
2023-09-02 21:00:55,537 - FGO - INFO - Val Total:   87
2023-09-02 21:00:55,537 - FGO - INFO - Test Total:  87
2023-09-02 21:00:55,537 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:55,537 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:55,537 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:55,537 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:55,537 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:55,538 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:55,538 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:55,538 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:55,538 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:55,538 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:55,539 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:55,540 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:55,646 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:55,646 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:55,646 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:55,646 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:55,646 - FGO - INFO - N: 804
2023-09-02 21:00:55,646 - FGO - INFO - N_s: 717
2023-09-02 21:00:55,646 - FGO - INFO - N_t: 87
2023-09-02 21:00:55,650 - CV - INFO - Begin Pretrain
2023-09-02 21:00:55,650 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:55,653 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 21:00:55,678 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.49 | Val F1: 0.86 |
2023-09-02 21:00:55,703 - FGO - INFO - Epoch  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 |
2023-09-02 21:00:55,727 - FGO - INFO - Epoch  30 | Train Loss: 0.097 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 21:00:55,751 - FGO - INFO - Epoch  40 | Train Loss: 0.081 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 21:00:55,776 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 21:00:55,800 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 21:00:55,825 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 21:00:55,849 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 21:00:55,874 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 21:00:55,898 - FGO - INFO - Epoch 100 | Train Loss: 0.074 | Val Loss: 0.20 | Val F1: 0.95 |
2023-09-02 21:00:55,898 - FGO - INFO - Best Epoch:  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 
2023-09-02 21:00:55,898 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:55,900 - CV - INFO - Pretrain Complete, 20 epochs
2023-09-02 21:00:55,900 - CV - INFO - Begin OT Train
2023-09-02 21:00:55,900 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:00:55,978 - FGO - INFO - Epoch   0 | Train Loss: -13.022 | Val Loss: -1.42 | Val F1: 0.95 |
2023-09-02 21:00:56,761 - FGO - INFO - Epoch  10 | Train Loss: -13.776 | Val Loss: -1.55 | Val F1: 0.93 |
2023-09-02 21:00:57,498 - FGO - INFO - Epoch  20 | Train Loss: -13.932 | Val Loss: -1.48 | Val F1: 0.91 |
2023-09-02 21:00:58,244 - FGO - INFO - Epoch  30 | Train Loss: -14.033 | Val Loss: -1.51 | Val F1: 0.94 |
2023-09-02 21:00:59,072 - FGO - INFO - Epoch  40 | Train Loss: -14.105 | Val Loss: -1.46 | Val F1: 0.94 |
2023-09-02 21:00:59,773 - FGO - INFO - Best Epoch:  35 | Train Loss: -14.072 | Val Loss: -1.50 | Val F1: 0.95 |
2023-09-02 21:00:59,773 - FGO - INFO - Setting model to best state.
2023-09-02 21:00:59,776 - CV - INFO - OT Train Complete, 35 epochs
2023-09-02 21:00:59,776 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:00:59,813 - FGO - INFO - Train CM:
[[378   9]
 [ 15 315]]
2023-09-02 21:00:59,813 - FGO - INFO - Val CM:
[[46  1]
 [ 3 37]]
2023-09-02 21:00:59,814 - FGO - INFO - Test CM:
[[46  1]
 [ 3 37]]
2023-09-02 21:00:59,818 - FGO - INFO - test statistical parity: 0.36333333333333334
2023-09-02 21:00:59,820 - FGO - INFO - test equal opportunity: 0.09677419354838712
2023-09-02 21:00:59,820 - FGO - INFO - test micro f1: 0.9540229885057472
2023-09-02 21:00:59,821 - FGO - INFO - test macro f1: 0.9535256410256411
2023-09-02 21:00:59,821 - CV - INFO - fold time: 4.285893440246582s (0.07143155733744304m)
2023-09-02 21:00:59,821 - CV - INFO - ----- BEGINNING FOLD SET (026:8)----------------------------------------------------------
2023-09-02 21:00:59,823 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/026/8
2023-09-02 21:00:59,823 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:00:59,823 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:00:59,823 - FGO - INFO - 	done: False
2023-09-02 21:00:59,823 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:00:59,823 - FGO - INFO - 	h1: 64
2023-09-02 21:00:59,823 - FGO - INFO - 	h2: 32
2023-09-02 21:00:59,823 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:00:59,823 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:00:59,823 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:00:59,823 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:00:59,823 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:00:59,823 - FGO - INFO - 	theta: 30
2023-09-02 21:00:59,823 - FGO - INFO - 	clip: 5
2023-09-02 21:00:59,823 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:00:59,823 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:00:59,823 - FGO - INFO - Source Total: 734
2023-09-02 21:00:59,823 - FGO - INFO - Target Total: 70
2023-09-02 21:00:59,823 - FGO - INFO - Train Total: 734
2023-09-02 21:00:59,823 - FGO - INFO - Val Total:   70
2023-09-02 21:00:59,823 - FGO - INFO - Test Total:  70
2023-09-02 21:00:59,823 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:00:59,823 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:00:59,823 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:00:59,823 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:00:59,823 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:00:59,824 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:00:59,824 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:00:59,824 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:00:59,824 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:00:59,824 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:00:59,825 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:00:59,826 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:00:59,915 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:00:59,915 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:00:59,915 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:00:59,915 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:00:59,915 - FGO - INFO - N: 804
2023-09-02 21:00:59,915 - FGO - INFO - N_s: 734
2023-09-02 21:00:59,915 - FGO - INFO - N_t: 70
2023-09-02 21:00:59,918 - CV - INFO - Begin Pretrain
2023-09-02 21:00:59,918 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:00:59,922 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 21:00:59,951 - FGO - INFO - Epoch  10 | Train Loss: 0.450 | Val Loss: 0.48 | Val F1: 0.81 |
2023-09-02 21:00:59,978 - FGO - INFO - Epoch  20 | Train Loss: 0.149 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 21:01:00,003 - FGO - INFO - Epoch  30 | Train Loss: 0.104 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 21:01:00,028 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 21:01:00,066 - FGO - INFO - Epoch  50 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 21:01:00,091 - FGO - INFO - Epoch  60 | Train Loss: 0.067 | Val Loss: 0.11 | Val F1: 0.96 |
2023-09-02 21:01:00,116 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.96 |
2023-09-02 21:01:00,140 - FGO - INFO - Epoch  80 | Train Loss: 0.072 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 21:01:00,165 - FGO - INFO - Epoch  90 | Train Loss: 0.061 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 21:01:00,189 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 21:01:00,189 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.117 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 21:01:00,190 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:00,191 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 21:01:00,191 - CV - INFO - Begin OT Train
2023-09-02 21:01:00,191 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:00,260 - FGO - INFO - Epoch   0 | Train Loss: -12.964 | Val Loss: -1.08 | Val F1: 0.93 |
2023-09-02 21:01:01,047 - FGO - INFO - Epoch  10 | Train Loss: -13.700 | Val Loss: -0.95 | Val F1: 0.88 |
2023-09-02 21:01:01,743 - FGO - INFO - Epoch  20 | Train Loss: -13.979 | Val Loss: -1.08 | Val F1: 0.93 |
2023-09-02 21:01:02,536 - FGO - INFO - Epoch  30 | Train Loss: -14.058 | Val Loss: -1.15 | Val F1: 0.94 |
2023-09-02 21:01:03,342 - FGO - INFO - Epoch  40 | Train Loss: -14.125 | Val Loss: -1.15 | Val F1: 0.96 |
2023-09-02 21:01:04,018 - FGO - INFO - Best Epoch:  13 | Train Loss: -13.865 | Val Loss: -1.12 | Val F1: 0.96 |
2023-09-02 21:01:04,018 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:04,021 - CV - INFO - OT Train Complete, 13 epochs
2023-09-02 21:01:04,022 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:04,047 - FGO - INFO - Train CM:
[[398   2]
 [ 27 307]]
2023-09-02 21:01:04,047 - FGO - INFO - Val CM:
[[34  0]
 [ 4 32]]
2023-09-02 21:01:04,047 - FGO - INFO - Test CM:
[[34  0]
 [ 4 32]]
2023-09-02 21:01:04,052 - FGO - INFO - test statistical parity: 0.08906882591093113
2023-09-02 21:01:04,053 - FGO - INFO - test equal opportunity: 0.06666666666666665
2023-09-02 21:01:04,054 - FGO - INFO - test micro f1: 0.9428571428571428
2023-09-02 21:01:04,055 - FGO - INFO - test macro f1: 0.9428104575163399
2023-09-02 21:01:04,055 - CV - INFO - fold time: 4.233898878097534s (0.07056498130162557m)
2023-09-02 21:01:04,055 - CV - INFO - ----- BEGINNING FOLD SET (026:9)----------------------------------------------------------
2023-09-02 21:01:04,057 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/026/9
2023-09-02 21:01:04,057 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:04,057 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:04,057 - FGO - INFO - 	done: False
2023-09-02 21:01:04,057 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:04,057 - FGO - INFO - 	h1: 64
2023-09-02 21:01:04,057 - FGO - INFO - 	h2: 32
2023-09-02 21:01:04,057 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:04,057 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:04,057 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:04,057 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:04,057 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:04,057 - FGO - INFO - 	theta: 30
2023-09-02 21:01:04,057 - FGO - INFO - 	clip: 5
2023-09-02 21:01:04,057 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:04,057 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:04,057 - FGO - INFO - Source Total: 725
2023-09-02 21:01:04,057 - FGO - INFO - Target Total: 79
2023-09-02 21:01:04,057 - FGO - INFO - Train Total: 725
2023-09-02 21:01:04,057 - FGO - INFO - Val Total:   79
2023-09-02 21:01:04,057 - FGO - INFO - Test Total:  79
2023-09-02 21:01:04,057 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:04,057 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:04,057 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:04,057 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:04,057 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:04,058 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:04,058 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:04,058 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:04,058 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:04,058 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:04,059 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:04,060 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:04,158 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:04,158 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:04,158 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:04,159 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:04,159 - FGO - INFO - N: 804
2023-09-02 21:01:04,159 - FGO - INFO - N_s: 725
2023-09-02 21:01:04,159 - FGO - INFO - N_t: 79
2023-09-02 21:01:04,162 - CV - INFO - Begin Pretrain
2023-09-02 21:01:04,162 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:04,165 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 21:01:04,190 - FGO - INFO - Epoch  10 | Train Loss: 0.471 | Val Loss: 0.48 | Val F1: 0.87 |
2023-09-02 21:01:04,215 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 21:01:04,239 - FGO - INFO - Epoch  30 | Train Loss: 0.102 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 21:01:04,264 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.21 | Val F1: 0.97 |
2023-09-02 21:01:04,288 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 21:01:04,313 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 21:01:04,337 - FGO - INFO - Epoch  70 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 21:01:04,361 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 21:01:04,386 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 21:01:04,410 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 21:01:04,410 - FGO - INFO - Best Epoch:  25 | Train Loss: 0.119 | Val Loss: 0.24 | Val F1: 0.97 
2023-09-02 21:01:04,410 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:04,412 - CV - INFO - Pretrain Complete, 25 epochs
2023-09-02 21:01:04,412 - CV - INFO - Begin OT Train
2023-09-02 21:01:04,412 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:04,503 - FGO - INFO - Epoch   0 | Train Loss: -13.107 | Val Loss: -1.33 | Val F1: 0.97 |
2023-09-02 21:01:05,304 - FGO - INFO - Epoch  10 | Train Loss: -13.891 | Val Loss: -1.42 | Val F1: 0.94 |
2023-09-02 21:01:06,127 - FGO - INFO - Epoch  20 | Train Loss: -14.015 | Val Loss: -1.47 | Val F1: 0.99 |
2023-09-02 21:01:06,924 - FGO - INFO - Epoch  30 | Train Loss: -14.113 | Val Loss: -1.49 | Val F1: 0.99 |
2023-09-02 21:01:07,733 - FGO - INFO - Epoch  40 | Train Loss: -14.177 | Val Loss: -1.49 | Val F1: 0.99 |
2023-09-02 21:01:08,421 - FGO - INFO - Best Epoch:   8 | Train Loss: -13.845 | Val Loss: -1.44 | Val F1: 0.99 |
2023-09-02 21:01:08,421 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:08,429 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 21:01:08,429 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:08,459 - FGO - INFO - Train CM:
[[383   2]
 [ 23 317]]
2023-09-02 21:01:08,459 - FGO - INFO - Val CM:
[[49  0]
 [ 1 29]]
2023-09-02 21:01:08,459 - FGO - INFO - Test CM:
[[49  0]
 [ 1 29]]
2023-09-02 21:01:08,464 - FGO - INFO - test statistical parity: 0.03768115942028988
2023-09-02 21:01:08,466 - FGO - INFO - test equal opportunity: 0.038461538461538436
2023-09-02 21:01:08,467 - FGO - INFO - test micro f1: 0.9873417721518988
2023-09-02 21:01:08,467 - FGO - INFO - test macro f1: 0.9864749186783085
2023-09-02 21:01:08,467 - CV - INFO - fold time: 4.412228345870972s (0.07353713909784952m)
2023-09-02 21:01:08,467 - CV - INFO - Mean Pretrain Epochs 41.0:
2023-09-02 21:01:08,467 - CV - INFO - Mean OT Train Epochs 11.2:
2023-09-02 21:01:08,467 - CV - INFO - Mean Val Macro F1 : 0.8331062830952323
2023-09-02 21:01:08,467 - CV - INFO - Mean Eval Stat : 0.8331062830952323 (harmoic mean of macro f1 and (1-eo))
2023-09-02 21:01:08,467 - CV - INFO - set time: 43.004897117614746s (0.7167482852935791m)
2023-09-02 21:01:08,467 - CV - INFO - script time so far: 1166.4183809757233s (19.44030634959539m) (0.3240051058265898h)
2023-09-02 21:01:08,467 - CV - INFO - ===== BEGINNING OPTION SET (027)==========================================================
2023-09-02 21:01:08,467 - CV - INFO - 	done: False
2023-09-02 21:01:08,467 - CV - INFO - 	learning_rate: 0.01
2023-09-02 21:01:08,467 - CV - INFO - 	h1: 64
2023-09-02 21:01:08,467 - CV - INFO - 	h2: 32
2023-09-02 21:01:08,467 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:08,467 - CV - INFO - 	dropout: 0.0
2023-09-02 21:01:08,467 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:08,467 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:08,467 - CV - INFO - 	lambda: 0.05
2023-09-02 21:01:08,467 - CV - INFO - 	theta: 50
2023-09-02 21:01:08,467 - CV - INFO - 	clip: 5
2023-09-02 21:01:08,467 - CV - INFO - ----- BEGINNING FOLD SET (027:0)----------------------------------------------------------
2023-09-02 21:01:08,469 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/027/0
2023-09-02 21:01:08,469 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:08,469 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:08,469 - FGO - INFO - 	done: False
2023-09-02 21:01:08,469 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:08,469 - FGO - INFO - 	h1: 64
2023-09-02 21:01:08,469 - FGO - INFO - 	h2: 32
2023-09-02 21:01:08,469 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:08,469 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:08,469 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:08,469 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:08,469 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:08,469 - FGO - INFO - 	theta: 50
2023-09-02 21:01:08,469 - FGO - INFO - 	clip: 5
2023-09-02 21:01:08,469 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:08,469 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:08,469 - FGO - INFO - Source Total: 708
2023-09-02 21:01:08,470 - FGO - INFO - Target Total: 96
2023-09-02 21:01:08,470 - FGO - INFO - Train Total: 708
2023-09-02 21:01:08,470 - FGO - INFO - Val Total:   96
2023-09-02 21:01:08,470 - FGO - INFO - Test Total:  96
2023-09-02 21:01:08,470 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:08,470 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:08,470 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:08,470 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:08,470 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:08,470 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:08,470 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:08,470 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:08,470 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:08,470 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:08,471 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:08,473 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:08,588 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:08,589 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:08,589 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:08,589 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:08,589 - FGO - INFO - N: 804
2023-09-02 21:01:08,589 - FGO - INFO - N_s: 708
2023-09-02 21:01:08,589 - FGO - INFO - N_t: 96
2023-09-02 21:01:08,592 - CV - INFO - Begin Pretrain
2023-09-02 21:01:08,592 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:08,595 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.69 | Val F1: 0.35 |
2023-09-02 21:01:08,620 - FGO - INFO - Epoch  10 | Train Loss: 0.421 | Val Loss: 0.44 | Val F1: 0.88 |
2023-09-02 21:01:08,644 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.20 | Val F1: 0.94 |
2023-09-02 21:01:08,669 - FGO - INFO - Epoch  30 | Train Loss: 0.103 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 21:01:08,693 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 21:01:08,717 - FGO - INFO - Epoch  50 | Train Loss: 0.073 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 21:01:08,741 - FGO - INFO - Epoch  60 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 21:01:08,765 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.13 | Val F1: 0.97 |
2023-09-02 21:01:08,790 - FGO - INFO - Epoch  80 | Train Loss: 0.058 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 21:01:08,814 - FGO - INFO - Epoch  90 | Train Loss: 0.058 | Val Loss: 0.12 | Val F1: 0.97 |
2023-09-02 21:01:08,838 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 21:01:08,838 - FGO - INFO - Best Epoch:  28 | Train Loss: 0.112 | Val Loss: 0.09 | Val F1: 0.99 
2023-09-02 21:01:08,838 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:08,839 - CV - INFO - Pretrain Complete, 28 epochs
2023-09-02 21:01:08,839 - CV - INFO - Begin OT Train
2023-09-02 21:01:08,839 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:08,935 - FGO - INFO - Epoch   0 | Train Loss: -21.715 | Val Loss: -2.89 | Val F1: 0.94 |
2023-09-02 21:01:09,762 - FGO - INFO - Epoch  10 | Train Loss: -22.963 | Val Loss: -3.04 | Val F1: 0.92 |
2023-09-02 21:01:10,562 - FGO - INFO - Epoch  20 | Train Loss: -23.697 | Val Loss: -2.73 | Val F1: 0.40 |
2023-09-02 21:01:11,334 - FGO - INFO - Epoch  30 | Train Loss: -23.708 | Val Loss: -2.73 | Val F1: 0.35 |
2023-09-02 21:01:12,121 - FGO - INFO - Epoch  40 | Train Loss: -23.708 | Val Loss: -2.73 | Val F1: 0.35 |
2023-09-02 21:01:12,768 - FGO - INFO - Best Epoch:  11 | Train Loss: -23.123 | Val Loss: -3.05 | Val F1: 0.95 |
2023-09-02 21:01:12,768 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:12,771 - CV - INFO - OT Train Complete, 11 epochs
2023-09-02 21:01:12,771 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:12,795 - FGO - INFO - Train CM:
[[382   0]
 [326   0]]
2023-09-02 21:01:12,795 - FGO - INFO - Val CM:
[[52  0]
 [44  0]]
2023-09-02 21:01:12,795 - FGO - INFO - Test CM:
[[52  0]
 [44  0]]
2023-09-02 21:01:12,801 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:01:12,802 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:01:12,803 - FGO - INFO - test micro f1: 0.5416666666666666
2023-09-02 21:01:12,804 - FGO - INFO - test macro f1: 0.35135135135135137
2023-09-02 21:01:12,804 - CV - INFO - fold time: 4.336107969284058s (0.0722684661547343m)
2023-09-02 21:01:12,804 - CV - INFO - ----- BEGINNING FOLD SET (027:1)----------------------------------------------------------
2023-09-02 21:01:12,805 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/027/1
2023-09-02 21:01:12,805 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:12,805 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:12,805 - FGO - INFO - 	done: False
2023-09-02 21:01:12,805 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:12,805 - FGO - INFO - 	h1: 64
2023-09-02 21:01:12,805 - FGO - INFO - 	h2: 32
2023-09-02 21:01:12,805 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:12,805 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:12,805 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:12,805 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:12,805 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:12,805 - FGO - INFO - 	theta: 50
2023-09-02 21:01:12,805 - FGO - INFO - 	clip: 5
2023-09-02 21:01:12,806 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:12,806 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:12,806 - FGO - INFO - Source Total: 727
2023-09-02 21:01:12,806 - FGO - INFO - Target Total: 77
2023-09-02 21:01:12,806 - FGO - INFO - Train Total: 727
2023-09-02 21:01:12,806 - FGO - INFO - Val Total:   77
2023-09-02 21:01:12,806 - FGO - INFO - Test Total:  77
2023-09-02 21:01:12,806 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:12,806 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:12,806 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:12,806 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:12,806 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:12,806 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:12,806 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:12,806 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:12,806 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:12,806 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:12,807 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:12,809 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:12,905 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:12,905 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:12,905 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:12,905 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:12,905 - FGO - INFO - N: 804
2023-09-02 21:01:12,905 - FGO - INFO - N_s: 727
2023-09-02 21:01:12,905 - FGO - INFO - N_t: 77
2023-09-02 21:01:12,909 - CV - INFO - Begin Pretrain
2023-09-02 21:01:12,909 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:12,912 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 21:01:12,937 - FGO - INFO - Epoch  10 | Train Loss: 0.472 | Val Loss: 0.55 | Val F1: 0.71 |
2023-09-02 21:01:12,962 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.27 | Val F1: 0.84 |
2023-09-02 21:01:12,986 - FGO - INFO - Epoch  30 | Train Loss: 0.091 | Val Loss: 0.17 | Val F1: 0.93 |
2023-09-02 21:01:13,011 - FGO - INFO - Epoch  40 | Train Loss: 0.080 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 21:01:13,036 - FGO - INFO - Epoch  50 | Train Loss: 0.067 | Val Loss: 0.20 | Val F1: 0.87 |
2023-09-02 21:01:13,060 - FGO - INFO - Epoch  60 | Train Loss: 0.061 | Val Loss: 0.22 | Val F1: 0.89 |
2023-09-02 21:01:13,085 - FGO - INFO - Epoch  70 | Train Loss: 0.061 | Val Loss: 0.16 | Val F1: 0.92 |
2023-09-02 21:01:13,109 - FGO - INFO - Epoch  80 | Train Loss: 0.054 | Val Loss: 0.18 | Val F1: 0.90 |
2023-09-02 21:01:13,134 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.21 | Val F1: 0.92 |
2023-09-02 21:01:13,159 - FGO - INFO - Epoch 100 | Train Loss: 0.055 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 21:01:13,159 - FGO - INFO - Best Epoch:  34 | Train Loss: 0.088 | Val Loss: 0.17 | Val F1: 0.95 
2023-09-02 21:01:13,159 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:13,160 - CV - INFO - Pretrain Complete, 34 epochs
2023-09-02 21:01:13,160 - CV - INFO - Begin OT Train
2023-09-02 21:01:13,160 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:13,227 - FGO - INFO - Epoch   0 | Train Loss: -21.908 | Val Loss: -2.01 | Val F1: 0.90 |
2023-09-02 21:01:13,984 - FGO - INFO - Epoch  10 | Train Loss: -23.333 | Val Loss: -2.04 | Val F1: 0.86 |
2023-09-02 21:01:14,783 - FGO - INFO - Epoch  20 | Train Loss: -24.152 | Val Loss: -1.79 | Val F1: 0.36 |
2023-09-02 21:01:15,537 - FGO - INFO - Epoch  30 | Train Loss: -24.159 | Val Loss: -1.79 | Val F1: 0.36 |
2023-09-02 21:01:16,327 - FGO - INFO - Epoch  40 | Train Loss: -24.160 | Val Loss: -1.79 | Val F1: 0.36 |
2023-09-02 21:01:17,038 - FGO - INFO - Best Epoch:   8 | Train Loss: -23.232 | Val Loss: -2.07 | Val F1: 0.89 |
2023-09-02 21:01:17,038 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:17,042 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 21:01:17,042 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:17,078 - FGO - INFO - Train CM:
[[390   0]
 [337   0]]
2023-09-02 21:01:17,078 - FGO - INFO - Val CM:
[[44  0]
 [33  0]]
2023-09-02 21:01:17,078 - FGO - INFO - Test CM:
[[44  0]
 [33  0]]
2023-09-02 21:01:17,083 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:01:17,084 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:01:17,085 - FGO - INFO - test micro f1: 0.5714285714285714
2023-09-02 21:01:17,085 - FGO - INFO - test macro f1: 0.36363636363636365
2023-09-02 21:01:17,085 - CV - INFO - fold time: 4.2817957401275635s (0.0713632623354594m)
2023-09-02 21:01:17,085 - CV - INFO - ----- BEGINNING FOLD SET (027:2)----------------------------------------------------------
2023-09-02 21:01:17,087 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/027/2
2023-09-02 21:01:17,087 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:17,087 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:17,087 - FGO - INFO - 	done: False
2023-09-02 21:01:17,087 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:17,087 - FGO - INFO - 	h1: 64
2023-09-02 21:01:17,087 - FGO - INFO - 	h2: 32
2023-09-02 21:01:17,087 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:17,087 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:17,087 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:17,087 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:17,087 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:17,087 - FGO - INFO - 	theta: 50
2023-09-02 21:01:17,087 - FGO - INFO - 	clip: 5
2023-09-02 21:01:17,087 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:17,087 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:17,087 - FGO - INFO - Source Total: 721
2023-09-02 21:01:17,087 - FGO - INFO - Target Total: 83
2023-09-02 21:01:17,087 - FGO - INFO - Train Total: 721
2023-09-02 21:01:17,087 - FGO - INFO - Val Total:   83
2023-09-02 21:01:17,087 - FGO - INFO - Test Total:  83
2023-09-02 21:01:17,088 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:17,088 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:17,088 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:17,088 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:17,088 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:17,088 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:17,088 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:17,088 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:17,088 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:17,088 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:17,089 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:17,090 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:17,194 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:17,194 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:17,194 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:17,194 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:17,194 - FGO - INFO - N: 804
2023-09-02 21:01:17,194 - FGO - INFO - N_s: 721
2023-09-02 21:01:17,194 - FGO - INFO - N_t: 83
2023-09-02 21:01:17,197 - CV - INFO - Begin Pretrain
2023-09-02 21:01:17,197 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:17,201 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.38 |
2023-09-02 21:01:17,225 - FGO - INFO - Epoch  10 | Train Loss: 0.478 | Val Loss: 0.49 | Val F1: 0.84 |
2023-09-02 21:01:17,250 - FGO - INFO - Epoch  20 | Train Loss: 0.142 | Val Loss: 0.24 | Val F1: 0.87 |
2023-09-02 21:01:17,274 - FGO - INFO - Epoch  30 | Train Loss: 0.087 | Val Loss: 0.26 | Val F1: 0.90 |
2023-09-02 21:01:17,299 - FGO - INFO - Epoch  40 | Train Loss: 0.073 | Val Loss: 0.25 | Val F1: 0.90 |
2023-09-02 21:01:17,323 - FGO - INFO - Epoch  50 | Train Loss: 0.063 | Val Loss: 0.25 | Val F1: 0.91 |
2023-09-02 21:01:17,348 - FGO - INFO - Epoch  60 | Train Loss: 0.058 | Val Loss: 0.27 | Val F1: 0.91 |
2023-09-02 21:01:17,372 - FGO - INFO - Epoch  70 | Train Loss: 0.056 | Val Loss: 0.28 | Val F1: 0.91 |
2023-09-02 21:01:17,397 - FGO - INFO - Epoch  80 | Train Loss: 0.052 | Val Loss: 0.28 | Val F1: 0.88 |
2023-09-02 21:01:17,421 - FGO - INFO - Epoch  90 | Train Loss: 0.051 | Val Loss: 0.28 | Val F1: 0.89 |
2023-09-02 21:01:17,446 - FGO - INFO - Epoch 100 | Train Loss: 0.046 | Val Loss: 0.29 | Val F1: 0.89 |
2023-09-02 21:01:17,446 - FGO - INFO - Best Epoch:  58 | Train Loss: 0.058 | Val Loss: 0.26 | Val F1: 0.92 
2023-09-02 21:01:17,446 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:17,447 - CV - INFO - Pretrain Complete, 58 epochs
2023-09-02 21:01:17,447 - CV - INFO - Begin OT Train
2023-09-02 21:01:17,447 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:17,534 - FGO - INFO - Epoch   0 | Train Loss: -21.791 | Val Loss: -2.08 | Val F1: 0.90 |
2023-09-02 21:01:18,313 - FGO - INFO - Epoch  10 | Train Loss: -23.315 | Val Loss: -2.21 | Val F1: 0.88 |
2023-09-02 21:01:19,078 - FGO - INFO - Epoch  20 | Train Loss: -24.097 | Val Loss: -2.00 | Val F1: 0.63 |
2023-09-02 21:01:19,830 - FGO - INFO - Epoch  30 | Train Loss: -24.138 | Val Loss: -1.98 | Val F1: 0.38 |
2023-09-02 21:01:20,568 - FGO - INFO - Epoch  40 | Train Loss: -24.138 | Val Loss: -1.99 | Val F1: 0.38 |
2023-09-02 21:01:21,232 - FGO - INFO - Best Epoch:  17 | Train Loss: -23.835 | Val Loss: -2.15 | Val F1: 0.92 |
2023-09-02 21:01:21,232 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:21,235 - CV - INFO - OT Train Complete, 17 epochs
2023-09-02 21:01:21,235 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:21,259 - FGO - INFO - Train CM:
[[384   0]
 [337   0]]
2023-09-02 21:01:21,260 - FGO - INFO - Val CM:
[[50  0]
 [33  0]]
2023-09-02 21:01:21,260 - FGO - INFO - Test CM:
[[50  0]
 [33  0]]
2023-09-02 21:01:21,265 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:01:21,266 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:01:21,267 - FGO - INFO - test micro f1: 0.6024096385542169
2023-09-02 21:01:21,268 - FGO - INFO - test macro f1: 0.3759398496240602
2023-09-02 21:01:21,268 - CV - INFO - fold time: 4.182244777679443s (0.06970407962799072m)
2023-09-02 21:01:21,268 - CV - INFO - ----- BEGINNING FOLD SET (027:3)----------------------------------------------------------
2023-09-02 21:01:21,269 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/027/3
2023-09-02 21:01:21,269 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:21,269 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:21,269 - FGO - INFO - 	done: False
2023-09-02 21:01:21,269 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:21,270 - FGO - INFO - 	h1: 64
2023-09-02 21:01:21,270 - FGO - INFO - 	h2: 32
2023-09-02 21:01:21,270 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:21,270 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:21,270 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:21,270 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:21,270 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:21,270 - FGO - INFO - 	theta: 50
2023-09-02 21:01:21,270 - FGO - INFO - 	clip: 5
2023-09-02 21:01:21,270 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:21,270 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:21,270 - FGO - INFO - Source Total: 729
2023-09-02 21:01:21,270 - FGO - INFO - Target Total: 75
2023-09-02 21:01:21,270 - FGO - INFO - Train Total: 729
2023-09-02 21:01:21,270 - FGO - INFO - Val Total:   75
2023-09-02 21:01:21,270 - FGO - INFO - Test Total:  75
2023-09-02 21:01:21,270 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:21,270 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:21,270 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:21,270 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:21,270 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:21,270 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:21,270 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:21,270 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:21,270 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:21,270 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:21,271 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:21,273 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:21,367 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:21,367 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:21,367 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:21,367 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:21,367 - FGO - INFO - N: 804
2023-09-02 21:01:21,367 - FGO - INFO - N_s: 729
2023-09-02 21:01:21,367 - FGO - INFO - N_t: 75
2023-09-02 21:01:21,371 - CV - INFO - Begin Pretrain
2023-09-02 21:01:21,371 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:21,374 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.37 |
2023-09-02 21:01:21,399 - FGO - INFO - Epoch  10 | Train Loss: 0.431 | Val Loss: 0.36 | Val F1: 0.93 |
2023-09-02 21:01:21,423 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:01:21,448 - FGO - INFO - Epoch  30 | Train Loss: 0.109 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 21:01:21,473 - FGO - INFO - Epoch  40 | Train Loss: 0.093 | Val Loss: 0.03 | Val F1: 0.99 |
2023-09-02 21:01:21,497 - FGO - INFO - Epoch  50 | Train Loss: 0.080 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 21:01:21,522 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 21:01:21,546 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 21:01:21,571 - FGO - INFO - Epoch  80 | Train Loss: 0.065 | Val Loss: 0.05 | Val F1: 0.97 |
2023-09-02 21:01:21,595 - FGO - INFO - Epoch  90 | Train Loss: 0.064 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 21:01:21,619 - FGO - INFO - Epoch 100 | Train Loss: 0.068 | Val Loss: 0.07 | Val F1: 0.97 |
2023-09-02 21:01:21,619 - FGO - INFO - Best Epoch:  27 | Train Loss: 0.114 | Val Loss: 0.03 | Val F1: 1.00 
2023-09-02 21:01:21,619 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:21,621 - CV - INFO - Pretrain Complete, 27 epochs
2023-09-02 21:01:21,621 - CV - INFO - Begin OT Train
2023-09-02 21:01:21,621 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:21,700 - FGO - INFO - Epoch   0 | Train Loss: -21.546 | Val Loss: -2.24 | Val F1: 0.97 |
2023-09-02 21:01:22,510 - FGO - INFO - Epoch  10 | Train Loss: -23.170 | Val Loss: -2.18 | Val F1: 0.89 |
2023-09-02 21:01:23,321 - FGO - INFO - Epoch  20 | Train Loss: -23.898 | Val Loss: -1.95 | Val F1: 0.42 |
2023-09-02 21:01:24,116 - FGO - INFO - Epoch  30 | Train Loss: -24.000 | Val Loss: -1.89 | Val F1: 0.34 |
2023-09-02 21:01:24,890 - FGO - INFO - Epoch  40 | Train Loss: -24.001 | Val Loss: -1.89 | Val F1: 0.34 |
2023-09-02 21:01:25,609 - FGO - INFO - Best Epoch:   6 | Train Loss: -22.569 | Val Loss: -2.34 | Val F1: 0.97 |
2023-09-02 21:01:25,609 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:25,612 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 21:01:25,613 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:25,635 - FGO - INFO - Train CM:
[[396   0]
 [333   0]]
2023-09-02 21:01:25,635 - FGO - INFO - Val CM:
[[38  0]
 [37  0]]
2023-09-02 21:01:25,636 - FGO - INFO - Test CM:
[[38  0]
 [37  0]]
2023-09-02 21:01:25,640 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:01:25,641 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:01:25,642 - FGO - INFO - test micro f1: 0.5066666666666667
2023-09-02 21:01:25,643 - FGO - INFO - test macro f1: 0.33628318584070793
2023-09-02 21:01:25,643 - CV - INFO - fold time: 4.374982118606567s (0.0729163686434428m)
2023-09-02 21:01:25,643 - CV - INFO - ----- BEGINNING FOLD SET (027:4)----------------------------------------------------------
2023-09-02 21:01:25,644 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/027/4
2023-09-02 21:01:25,644 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:25,645 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:25,645 - FGO - INFO - 	done: False
2023-09-02 21:01:25,645 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:25,645 - FGO - INFO - 	h1: 64
2023-09-02 21:01:25,645 - FGO - INFO - 	h2: 32
2023-09-02 21:01:25,645 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:25,645 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:25,645 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:25,645 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:25,645 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:25,645 - FGO - INFO - 	theta: 50
2023-09-02 21:01:25,645 - FGO - INFO - 	clip: 5
2023-09-02 21:01:25,645 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:25,645 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:25,645 - FGO - INFO - Source Total: 732
2023-09-02 21:01:25,645 - FGO - INFO - Target Total: 72
2023-09-02 21:01:25,645 - FGO - INFO - Train Total: 732
2023-09-02 21:01:25,645 - FGO - INFO - Val Total:   72
2023-09-02 21:01:25,645 - FGO - INFO - Test Total:  72
2023-09-02 21:01:25,645 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:25,645 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:25,645 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:25,645 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:25,645 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:25,645 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:25,645 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:25,645 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:25,646 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:25,646 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:25,646 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:25,648 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:25,739 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:25,739 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:25,739 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:25,739 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:25,739 - FGO - INFO - N: 804
2023-09-02 21:01:25,739 - FGO - INFO - N_s: 732
2023-09-02 21:01:25,739 - FGO - INFO - N_t: 72
2023-09-02 21:01:25,743 - CV - INFO - Begin Pretrain
2023-09-02 21:01:25,743 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:25,746 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.33 |
2023-09-02 21:01:25,771 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.46 | Val F1: 0.81 |
2023-09-02 21:01:25,796 - FGO - INFO - Epoch  20 | Train Loss: 0.141 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 21:01:25,821 - FGO - INFO - Epoch  30 | Train Loss: 0.100 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 21:01:25,845 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.97 |
2023-09-02 21:01:25,870 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.97 |
2023-09-02 21:01:25,894 - FGO - INFO - Epoch  60 | Train Loss: 0.073 | Val Loss: 0.08 | Val F1: 0.97 |
2023-09-02 21:01:25,919 - FGO - INFO - Epoch  70 | Train Loss: 0.073 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:01:25,944 - FGO - INFO - Epoch  80 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 21:01:25,968 - FGO - INFO - Epoch  90 | Train Loss: 0.067 | Val Loss: 0.06 | Val F1: 0.99 |
2023-09-02 21:01:25,993 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:01:25,993 - FGO - INFO - Best Epoch:  64 | Train Loss: 0.069 | Val Loss: 0.06 | Val F1: 0.99 
2023-09-02 21:01:25,993 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:25,994 - CV - INFO - Pretrain Complete, 64 epochs
2023-09-02 21:01:25,994 - CV - INFO - Begin OT Train
2023-09-02 21:01:25,994 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:26,119 - FGO - INFO - Epoch   0 | Train Loss: -21.844 | Val Loss: -2.19 | Val F1: 0.99 |
2023-09-02 21:01:26,895 - FGO - INFO - Epoch  10 | Train Loss: -23.609 | Val Loss: -2.15 | Val F1: 0.89 |
2023-09-02 21:01:27,679 - FGO - INFO - Epoch  20 | Train Loss: -23.965 | Val Loss: -1.83 | Val F1: 0.34 |
2023-09-02 21:01:28,488 - FGO - INFO - Epoch  30 | Train Loss: -23.966 | Val Loss: -1.83 | Val F1: 0.34 |
2023-09-02 21:01:29,213 - FGO - INFO - Epoch  40 | Train Loss: -23.967 | Val Loss: -1.83 | Val F1: 0.34 |
2023-09-02 21:01:29,902 - FGO - INFO - Best Epoch:   8 | Train Loss: -23.438 | Val Loss: -2.24 | Val F1: 0.94 |
2023-09-02 21:01:29,903 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:29,905 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 21:01:29,906 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:29,931 - FGO - INFO - Train CM:
[[397   0]
 [335   0]]
2023-09-02 21:01:29,931 - FGO - INFO - Val CM:
[[37  0]
 [35  0]]
2023-09-02 21:01:29,931 - FGO - INFO - Test CM:
[[37  0]
 [35  0]]
2023-09-02 21:01:29,936 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:01:29,938 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:01:29,939 - FGO - INFO - test micro f1: 0.5138888888888888
2023-09-02 21:01:29,939 - FGO - INFO - test macro f1: 0.33944954128440363
2023-09-02 21:01:29,939 - CV - INFO - fold time: 4.296473026275635s (0.07160788377126058m)
2023-09-02 21:01:29,939 - CV - INFO - ----- BEGINNING FOLD SET (027:5)----------------------------------------------------------
2023-09-02 21:01:29,941 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/027/5
2023-09-02 21:01:29,941 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:29,941 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:29,941 - FGO - INFO - 	done: False
2023-09-02 21:01:29,941 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:29,941 - FGO - INFO - 	h1: 64
2023-09-02 21:01:29,941 - FGO - INFO - 	h2: 32
2023-09-02 21:01:29,941 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:29,941 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:29,941 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:29,941 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:29,941 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:29,941 - FGO - INFO - 	theta: 50
2023-09-02 21:01:29,941 - FGO - INFO - 	clip: 5
2023-09-02 21:01:29,941 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:29,941 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:29,941 - FGO - INFO - Source Total: 726
2023-09-02 21:01:29,941 - FGO - INFO - Target Total: 78
2023-09-02 21:01:29,941 - FGO - INFO - Train Total: 726
2023-09-02 21:01:29,941 - FGO - INFO - Val Total:   78
2023-09-02 21:01:29,941 - FGO - INFO - Test Total:  78
2023-09-02 21:01:29,941 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:29,941 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:29,941 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:29,941 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:29,941 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:29,942 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:29,942 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:29,942 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:29,942 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:29,942 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:29,943 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:29,944 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:30,042 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:30,043 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:30,043 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:30,043 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:30,043 - FGO - INFO - N: 804
2023-09-02 21:01:30,043 - FGO - INFO - N_s: 726
2023-09-02 21:01:30,043 - FGO - INFO - N_t: 78
2023-09-02 21:01:30,046 - CV - INFO - Begin Pretrain
2023-09-02 21:01:30,046 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:30,050 - FGO - INFO - Epoch   0 | Train Loss: 0.684 | Val Loss: 0.73 | Val F1: 0.32 |
2023-09-02 21:01:30,074 - FGO - INFO - Epoch  10 | Train Loss: 0.515 | Val Loss: 0.52 | Val F1: 0.82 |
2023-09-02 21:01:30,099 - FGO - INFO - Epoch  20 | Train Loss: 0.158 | Val Loss: 0.28 | Val F1: 0.92 |
2023-09-02 21:01:30,123 - FGO - INFO - Epoch  30 | Train Loss: 0.106 | Val Loss: 0.27 | Val F1: 0.92 |
2023-09-02 21:01:30,148 - FGO - INFO - Epoch  40 | Train Loss: 0.085 | Val Loss: 0.13 | Val F1: 0.95 |
2023-09-02 21:01:30,172 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.11 | Val F1: 0.95 |
2023-09-02 21:01:30,197 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.09 | Val F1: 0.95 |
2023-09-02 21:01:30,221 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 21:01:30,246 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.07 | Val F1: 0.95 |
2023-09-02 21:01:30,270 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 21:01:30,295 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.10 | Val F1: 0.95 |
2023-09-02 21:01:30,295 - FGO - INFO - Best Epoch:  55 | Train Loss: 0.077 | Val Loss: 0.09 | Val F1: 0.97 
2023-09-02 21:01:30,295 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:30,296 - CV - INFO - Pretrain Complete, 55 epochs
2023-09-02 21:01:30,296 - CV - INFO - Begin OT Train
2023-09-02 21:01:30,296 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:30,362 - FGO - INFO - Epoch   0 | Train Loss: -21.352 | Val Loss: -2.18 | Val F1: 0.95 |
2023-09-02 21:01:31,194 - FGO - INFO - Epoch  10 | Train Loss: -23.334 | Val Loss: -1.95 | Val F1: 0.79 |
2023-09-02 21:01:31,987 - FGO - INFO - Epoch  20 | Train Loss: -24.016 | Val Loss: -1.92 | Val F1: 0.38 |
2023-09-02 21:01:32,810 - FGO - INFO - Epoch  30 | Train Loss: -24.072 | Val Loss: -1.90 | Val F1: 0.30 |
2023-09-02 21:01:33,576 - FGO - INFO - Epoch  40 | Train Loss: -24.072 | Val Loss: -1.89 | Val F1: 0.30 |
2023-09-02 21:01:34,234 - FGO - INFO - Best Epoch:   6 | Train Loss: -22.766 | Val Loss: -2.21 | Val F1: 0.91 |
2023-09-02 21:01:34,234 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:34,238 - CV - INFO - OT Train Complete, 6 epochs
2023-09-02 21:01:34,238 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:34,265 - FGO - INFO - Train CM:
[[400   0]
 [326   0]]
2023-09-02 21:01:34,265 - FGO - INFO - Val CM:
[[34  0]
 [44  0]]
2023-09-02 21:01:34,266 - FGO - INFO - Test CM:
[[34  0]
 [44  0]]
2023-09-02 21:01:34,271 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:01:34,272 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:01:34,273 - FGO - INFO - test micro f1: 0.4358974358974359
2023-09-02 21:01:34,274 - FGO - INFO - test macro f1: 0.30357142857142855
2023-09-02 21:01:34,274 - CV - INFO - fold time: 4.334493637084961s (0.07224156061808268m)
2023-09-02 21:01:34,274 - CV - INFO - ----- BEGINNING FOLD SET (027:6)----------------------------------------------------------
2023-09-02 21:01:34,275 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/027/6
2023-09-02 21:01:34,275 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:34,276 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:34,276 - FGO - INFO - 	done: False
2023-09-02 21:01:34,276 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:34,276 - FGO - INFO - 	h1: 64
2023-09-02 21:01:34,276 - FGO - INFO - 	h2: 32
2023-09-02 21:01:34,276 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:34,276 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:34,276 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:34,276 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:34,276 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:34,276 - FGO - INFO - 	theta: 50
2023-09-02 21:01:34,276 - FGO - INFO - 	clip: 5
2023-09-02 21:01:34,276 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:34,276 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:34,276 - FGO - INFO - Source Total: 717
2023-09-02 21:01:34,276 - FGO - INFO - Target Total: 87
2023-09-02 21:01:34,276 - FGO - INFO - Train Total: 717
2023-09-02 21:01:34,276 - FGO - INFO - Val Total:   87
2023-09-02 21:01:34,276 - FGO - INFO - Test Total:  87
2023-09-02 21:01:34,276 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:34,276 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:34,276 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:34,276 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:34,276 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:34,276 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:34,276 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:34,276 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:34,276 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:34,277 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:34,277 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:34,279 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:34,386 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:34,386 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:34,386 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:34,386 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:34,386 - FGO - INFO - N: 804
2023-09-02 21:01:34,386 - FGO - INFO - N_s: 717
2023-09-02 21:01:34,386 - FGO - INFO - N_t: 87
2023-09-02 21:01:34,390 - CV - INFO - Begin Pretrain
2023-09-02 21:01:34,390 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:34,393 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.68 | Val F1: 0.36 |
2023-09-02 21:01:34,417 - FGO - INFO - Epoch  10 | Train Loss: 0.496 | Val Loss: 0.48 | Val F1: 0.80 |
2023-09-02 21:01:34,442 - FGO - INFO - Epoch  20 | Train Loss: 0.161 | Val Loss: 0.13 | Val F1: 0.93 |
2023-09-02 21:01:34,467 - FGO - INFO - Epoch  30 | Train Loss: 0.108 | Val Loss: 0.07 | Val F1: 0.96 |
2023-09-02 21:01:34,491 - FGO - INFO - Epoch  40 | Train Loss: 0.089 | Val Loss: 0.09 | Val F1: 0.98 |
2023-09-02 21:01:34,515 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.08 | Val F1: 0.99 |
2023-09-02 21:01:34,540 - FGO - INFO - Epoch  60 | Train Loss: 0.072 | Val Loss: 0.06 | Val F1: 0.98 |
2023-09-02 21:01:34,564 - FGO - INFO - Epoch  70 | Train Loss: 0.074 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:01:34,589 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 0.99 |
2023-09-02 21:01:34,613 - FGO - INFO - Epoch  90 | Train Loss: 0.065 | Val Loss: 0.04 | Val F1: 0.99 |
2023-09-02 21:01:34,637 - FGO - INFO - Epoch 100 | Train Loss: 0.066 | Val Loss: 0.04 | Val F1: 1.00 |
2023-09-02 21:01:34,637 - FGO - INFO - Best Epoch:  73 | Train Loss: 0.068 | Val Loss: 0.05 | Val F1: 1.00 
2023-09-02 21:01:34,637 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:34,639 - CV - INFO - Pretrain Complete, 73 epochs
2023-09-02 21:01:34,639 - CV - INFO - Begin OT Train
2023-09-02 21:01:34,639 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:34,735 - FGO - INFO - Epoch   0 | Train Loss: -21.811 | Val Loss: -2.75 | Val F1: 1.00 |
2023-09-02 21:01:35,573 - FGO - INFO - Epoch  10 | Train Loss: -23.313 | Val Loss: -2.78 | Val F1: 0.96 |
2023-09-02 21:01:36,361 - FGO - INFO - Epoch  20 | Train Loss: -23.793 | Val Loss: -2.43 | Val F1: 0.39 |
2023-09-02 21:01:37,105 - FGO - INFO - Epoch  30 | Train Loss: -23.794 | Val Loss: -2.43 | Val F1: 0.36 |
2023-09-02 21:01:37,858 - FGO - INFO - Epoch  40 | Train Loss: -23.794 | Val Loss: -2.43 | Val F1: 0.36 |
2023-09-02 21:01:38,512 - FGO - INFO - Best Epoch:  10 | Train Loss: -23.313 | Val Loss: -2.78 | Val F1: 0.96 |
2023-09-02 21:01:38,512 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:38,515 - CV - INFO - OT Train Complete, 10 epochs
2023-09-02 21:01:38,516 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:38,541 - FGO - INFO - Train CM:
[[385   0]
 [332   0]]
2023-09-02 21:01:38,541 - FGO - INFO - Val CM:
[[49  0]
 [38  0]]
2023-09-02 21:01:38,541 - FGO - INFO - Test CM:
[[49  0]
 [38  0]]
2023-09-02 21:01:38,546 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:01:38,548 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:01:38,549 - FGO - INFO - test micro f1: 0.5632183908045977
2023-09-02 21:01:38,549 - FGO - INFO - test macro f1: 0.3602941176470588
2023-09-02 21:01:38,549 - CV - INFO - fold time: 4.275402069091797s (0.07125670115152995m)
2023-09-02 21:01:38,549 - CV - INFO - ----- BEGINNING FOLD SET (027:7)----------------------------------------------------------
2023-09-02 21:01:38,551 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/027/7
2023-09-02 21:01:38,551 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:38,551 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:38,551 - FGO - INFO - 	done: False
2023-09-02 21:01:38,551 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:38,551 - FGO - INFO - 	h1: 64
2023-09-02 21:01:38,551 - FGO - INFO - 	h2: 32
2023-09-02 21:01:38,551 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:38,551 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:38,551 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:38,551 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:38,551 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:38,551 - FGO - INFO - 	theta: 50
2023-09-02 21:01:38,551 - FGO - INFO - 	clip: 5
2023-09-02 21:01:38,551 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:38,551 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:38,551 - FGO - INFO - Source Total: 717
2023-09-02 21:01:38,551 - FGO - INFO - Target Total: 87
2023-09-02 21:01:38,551 - FGO - INFO - Train Total: 717
2023-09-02 21:01:38,551 - FGO - INFO - Val Total:   87
2023-09-02 21:01:38,551 - FGO - INFO - Test Total:  87
2023-09-02 21:01:38,551 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:38,551 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:38,551 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:38,551 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:38,551 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:38,552 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:38,552 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:38,552 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:38,552 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:38,552 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:38,553 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:38,554 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:38,660 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:38,660 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:38,660 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:38,660 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:38,660 - FGO - INFO - N: 804
2023-09-02 21:01:38,660 - FGO - INFO - N_s: 717
2023-09-02 21:01:38,660 - FGO - INFO - N_t: 87
2023-09-02 21:01:38,664 - CV - INFO - Begin Pretrain
2023-09-02 21:01:38,664 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:38,667 - FGO - INFO - Epoch   0 | Train Loss: 0.689 | Val Loss: 0.68 | Val F1: 0.35 |
2023-09-02 21:01:38,692 - FGO - INFO - Epoch  10 | Train Loss: 0.469 | Val Loss: 0.49 | Val F1: 0.86 |
2023-09-02 21:01:38,717 - FGO - INFO - Epoch  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 |
2023-09-02 21:01:38,741 - FGO - INFO - Epoch  30 | Train Loss: 0.097 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 21:01:38,766 - FGO - INFO - Epoch  40 | Train Loss: 0.081 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 21:01:38,790 - FGO - INFO - Epoch  50 | Train Loss: 0.077 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 21:01:38,815 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.17 | Val F1: 0.95 |
2023-09-02 21:01:38,840 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 21:01:38,864 - FGO - INFO - Epoch  80 | Train Loss: 0.068 | Val Loss: 0.18 | Val F1: 0.95 |
2023-09-02 21:01:38,889 - FGO - INFO - Epoch  90 | Train Loss: 0.068 | Val Loss: 0.16 | Val F1: 0.95 |
2023-09-02 21:01:38,913 - FGO - INFO - Epoch 100 | Train Loss: 0.074 | Val Loss: 0.20 | Val F1: 0.95 |
2023-09-02 21:01:38,913 - FGO - INFO - Best Epoch:  20 | Train Loss: 0.145 | Val Loss: 0.11 | Val F1: 0.98 
2023-09-02 21:01:38,913 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:38,915 - CV - INFO - Pretrain Complete, 20 epochs
2023-09-02 21:01:38,915 - CV - INFO - Begin OT Train
2023-09-02 21:01:38,915 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:38,980 - FGO - INFO - Epoch   0 | Train Loss: -21.768 | Val Loss: -2.46 | Val F1: 0.95 |
2023-09-02 21:01:39,845 - FGO - INFO - Epoch  10 | Train Loss: -23.446 | Val Loss: -2.58 | Val F1: 0.95 |
2023-09-02 21:01:40,579 - FGO - INFO - Epoch  20 | Train Loss: -23.947 | Val Loss: -2.27 | Val F1: 0.35 |
2023-09-02 21:01:41,330 - FGO - INFO - Epoch  30 | Train Loss: -23.948 | Val Loss: -2.27 | Val F1: 0.35 |
2023-09-02 21:01:42,055 - FGO - INFO - Epoch  40 | Train Loss: -23.948 | Val Loss: -2.27 | Val F1: 0.35 |
2023-09-02 21:01:42,736 - FGO - INFO - Best Epoch:  10 | Train Loss: -23.446 | Val Loss: -2.58 | Val F1: 0.95 |
2023-09-02 21:01:42,736 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:42,743 - CV - INFO - OT Train Complete, 10 epochs
2023-09-02 21:01:42,743 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:42,768 - FGO - INFO - Train CM:
[[387   0]
 [330   0]]
2023-09-02 21:01:42,769 - FGO - INFO - Val CM:
[[47  0]
 [40  0]]
2023-09-02 21:01:42,769 - FGO - INFO - Test CM:
[[47  0]
 [40  0]]
2023-09-02 21:01:42,774 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:01:42,776 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:01:42,777 - FGO - INFO - test micro f1: 0.5402298850574713
2023-09-02 21:01:42,777 - FGO - INFO - test macro f1: 0.3507462686567164
2023-09-02 21:01:42,777 - CV - INFO - fold time: 4.227892637252808s (0.07046487728754679m)
2023-09-02 21:01:42,777 - CV - INFO - ----- BEGINNING FOLD SET (027:8)----------------------------------------------------------
2023-09-02 21:01:42,779 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/027/8
2023-09-02 21:01:42,779 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:42,779 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:42,779 - FGO - INFO - 	done: False
2023-09-02 21:01:42,779 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:42,779 - FGO - INFO - 	h1: 64
2023-09-02 21:01:42,779 - FGO - INFO - 	h2: 32
2023-09-02 21:01:42,779 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:42,779 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:42,779 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:42,779 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:42,779 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:42,779 - FGO - INFO - 	theta: 50
2023-09-02 21:01:42,779 - FGO - INFO - 	clip: 5
2023-09-02 21:01:42,779 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:42,779 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:42,779 - FGO - INFO - Source Total: 734
2023-09-02 21:01:42,779 - FGO - INFO - Target Total: 70
2023-09-02 21:01:42,779 - FGO - INFO - Train Total: 734
2023-09-02 21:01:42,779 - FGO - INFO - Val Total:   70
2023-09-02 21:01:42,779 - FGO - INFO - Test Total:  70
2023-09-02 21:01:42,779 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:42,779 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:42,779 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:42,779 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:42,779 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:42,780 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:42,780 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:42,780 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:42,780 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:42,780 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:42,781 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:42,782 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:42,871 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:42,871 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:42,871 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:42,871 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:42,871 - FGO - INFO - N: 804
2023-09-02 21:01:42,871 - FGO - INFO - N_s: 734
2023-09-02 21:01:42,871 - FGO - INFO - N_t: 70
2023-09-02 21:01:42,874 - CV - INFO - Begin Pretrain
2023-09-02 21:01:42,875 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:42,878 - FGO - INFO - Epoch   0 | Train Loss: 0.688 | Val Loss: 0.70 | Val F1: 0.32 |
2023-09-02 21:01:42,903 - FGO - INFO - Epoch  10 | Train Loss: 0.450 | Val Loss: 0.48 | Val F1: 0.81 |
2023-09-02 21:01:42,928 - FGO - INFO - Epoch  20 | Train Loss: 0.149 | Val Loss: 0.19 | Val F1: 0.90 |
2023-09-02 21:01:42,953 - FGO - INFO - Epoch  30 | Train Loss: 0.104 | Val Loss: 0.15 | Val F1: 0.96 |
2023-09-02 21:01:42,977 - FGO - INFO - Epoch  40 | Train Loss: 0.086 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 21:01:43,002 - FGO - INFO - Epoch  50 | Train Loss: 0.074 | Val Loss: 0.12 | Val F1: 0.96 |
2023-09-02 21:01:43,027 - FGO - INFO - Epoch  60 | Train Loss: 0.067 | Val Loss: 0.11 | Val F1: 0.96 |
2023-09-02 21:01:43,052 - FGO - INFO - Epoch  70 | Train Loss: 0.068 | Val Loss: 0.14 | Val F1: 0.96 |
2023-09-02 21:01:43,076 - FGO - INFO - Epoch  80 | Train Loss: 0.072 | Val Loss: 0.16 | Val F1: 0.94 |
2023-09-02 21:01:43,101 - FGO - INFO - Epoch  90 | Train Loss: 0.061 | Val Loss: 0.14 | Val F1: 0.94 |
2023-09-02 21:01:43,126 - FGO - INFO - Epoch 100 | Train Loss: 0.062 | Val Loss: 0.15 | Val F1: 0.94 |
2023-09-02 21:01:43,126 - FGO - INFO - Best Epoch:  26 | Train Loss: 0.117 | Val Loss: 0.14 | Val F1: 0.96 
2023-09-02 21:01:43,126 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:43,127 - CV - INFO - Pretrain Complete, 26 epochs
2023-09-02 21:01:43,127 - CV - INFO - Begin OT Train
2023-09-02 21:01:43,127 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:43,206 - FGO - INFO - Epoch   0 | Train Loss: -21.769 | Val Loss: -1.90 | Val F1: 0.93 |
2023-09-02 21:01:43,980 - FGO - INFO - Epoch  10 | Train Loss: -23.387 | Val Loss: -1.87 | Val F1: 0.84 |
2023-09-02 21:01:44,776 - FGO - INFO - Epoch  20 | Train Loss: -24.092 | Val Loss: -1.63 | Val F1: 0.36 |
2023-09-02 21:01:45,505 - FGO - INFO - Epoch  30 | Train Loss: -24.101 | Val Loss: -1.63 | Val F1: 0.33 |
2023-09-02 21:01:46,235 - FGO - INFO - Epoch  40 | Train Loss: -24.101 | Val Loss: -1.63 | Val F1: 0.33 |
2023-09-02 21:01:46,955 - FGO - INFO - Best Epoch:   7 | Train Loss: -23.220 | Val Loss: -2.04 | Val F1: 0.96 |
2023-09-02 21:01:46,956 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:46,959 - CV - INFO - OT Train Complete, 7 epochs
2023-09-02 21:01:46,959 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:46,983 - FGO - INFO - Train CM:
[[400   0]
 [334   0]]
2023-09-02 21:01:46,983 - FGO - INFO - Val CM:
[[34  0]
 [36  0]]
2023-09-02 21:01:46,984 - FGO - INFO - Test CM:
[[34  0]
 [36  0]]
2023-09-02 21:01:46,989 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:01:46,990 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:01:46,991 - FGO - INFO - test micro f1: 0.4857142857142857
2023-09-02 21:01:46,992 - FGO - INFO - test macro f1: 0.3269230769230769
2023-09-02 21:01:46,992 - CV - INFO - fold time: 4.2145676612854s (0.07024279435475668m)
2023-09-02 21:01:46,992 - CV - INFO - ----- BEGINNING FOLD SET (027:9)----------------------------------------------------------
2023-09-02 21:01:46,993 - CV - INFO - Saving details to directory: 
log/cv/None/abide_large/027/9
2023-09-02 21:01:46,993 - FGO - INFO - ===== SETUP LOGGING ======================================================================
2023-09-02 21:01:46,993 - FGO - INFO - THIS_FILE: Wrapper.py
2023-09-02 21:01:46,993 - FGO - INFO - 	done: False
2023-09-02 21:01:46,994 - FGO - INFO - 	learning_rate: 0.01
2023-09-02 21:01:46,994 - FGO - INFO - 	h1: 64
2023-09-02 21:01:46,994 - FGO - INFO - 	h2: 32
2023-09-02 21:01:46,994 - FGO - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:46,994 - FGO - INFO - 	dropout: 0.0
2023-09-02 21:01:46,994 - FGO - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:46,994 - FGO - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:46,994 - FGO - INFO - 	lambda: 0.05
2023-09-02 21:01:46,994 - FGO - INFO - 	theta: 50
2023-09-02 21:01:46,994 - FGO - INFO - 	clip: 5
2023-09-02 21:01:46,994 - FGO - INFO - ===== SETUP LOGGING COMPLETE =============================================================
2023-09-02 21:01:46,994 - FGO - INFO - ===== Configuring Masks ==================================================================
2023-09-02 21:01:46,994 - FGO - INFO - Source Total: 725
2023-09-02 21:01:46,994 - FGO - INFO - Target Total: 79
2023-09-02 21:01:46,994 - FGO - INFO - Train Total: 725
2023-09-02 21:01:46,994 - FGO - INFO - Val Total:   79
2023-09-02 21:01:46,994 - FGO - INFO - Test Total:  79
2023-09-02 21:01:46,994 - FGO - INFO - ===== Preparing to load data =============================================================
2023-09-02 21:01:46,994 - FGO - INFO - SOURCE: abide_large
2023-09-02 21:01:46,994 - FGO - INFO - ===== Retrieving SOURCE Data =============================================================
2023-09-02 21:01:46,994 - FGO - INFO - *************** In load_graph_data ***************
2023-09-02 21:01:46,994 - FGO - INFO - 	FILEPATH: ./data/abide_large.mat
2023-09-02 21:01:46,994 - FGO - INFO - 	X shape: (804, 93)
2023-09-02 21:01:46,994 - FGO - INFO - 	A shape: (804, 804)
2023-09-02 21:01:46,994 - FGO - INFO - 	P shape: (804,)
2023-09-02 21:01:46,994 - FGO - INFO - 	Y shape: (804, 2)
2023-09-02 21:01:46,994 - FGO - INFO - 	Y sum: 804 (number of postive labels)
2023-09-02 21:01:46,995 - FGO - INFO - ===== Preparing data =====================================================================
2023-09-02 21:01:46,997 - FGO - INFO - ===== Disconnecting Source and Target ====================================================
2023-09-02 21:01:47,096 - FGO - INFO - ===== Finalize Data ======================================================================
2023-09-02 21:01:47,096 - FGO - INFO - A shape: (804, 804)
2023-09-02 21:01:47,096 - FGO - INFO - X shape: (804, 93)
2023-09-02 21:01:47,096 - FGO - INFO - Y shape: (804, 2)
2023-09-02 21:01:47,096 - FGO - INFO - N: 804
2023-09-02 21:01:47,096 - FGO - INFO - N_s: 725
2023-09-02 21:01:47,096 - FGO - INFO - N_t: 79
2023-09-02 21:01:47,100 - CV - INFO - Begin Pretrain
2023-09-02 21:01:47,100 - FGO - INFO - ===== Pretrain GCN Model =================================================================
2023-09-02 21:01:47,103 - FGO - INFO - Epoch   0 | Train Loss: 0.690 | Val Loss: 0.67 | Val F1: 0.38 |
2023-09-02 21:01:47,132 - FGO - INFO - Epoch  10 | Train Loss: 0.471 | Val Loss: 0.48 | Val F1: 0.87 |
2023-09-02 21:01:47,160 - FGO - INFO - Epoch  20 | Train Loss: 0.138 | Val Loss: 0.18 | Val F1: 0.96 |
2023-09-02 21:01:47,184 - FGO - INFO - Epoch  30 | Train Loss: 0.102 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 21:01:47,209 - FGO - INFO - Epoch  40 | Train Loss: 0.092 | Val Loss: 0.21 | Val F1: 0.97 |
2023-09-02 21:01:47,233 - FGO - INFO - Epoch  50 | Train Loss: 0.078 | Val Loss: 0.19 | Val F1: 0.97 |
2023-09-02 21:01:47,264 - FGO - INFO - Epoch  60 | Train Loss: 0.071 | Val Loss: 0.18 | Val F1: 0.97 |
2023-09-02 21:01:47,293 - FGO - INFO - Epoch  70 | Train Loss: 0.066 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 21:01:47,321 - FGO - INFO - Epoch  80 | Train Loss: 0.069 | Val Loss: 0.15 | Val F1: 0.97 |
2023-09-02 21:01:47,352 - FGO - INFO - Epoch  90 | Train Loss: 0.063 | Val Loss: 0.10 | Val F1: 0.97 |
2023-09-02 21:01:47,384 - FGO - INFO - Epoch 100 | Train Loss: 0.070 | Val Loss: 0.06 | Val F1: 0.97 |
2023-09-02 21:01:47,384 - FGO - INFO - Best Epoch:  25 | Train Loss: 0.119 | Val Loss: 0.24 | Val F1: 0.97 
2023-09-02 21:01:47,384 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:47,385 - CV - INFO - Pretrain Complete, 25 epochs
2023-09-02 21:01:47,386 - CV - INFO - Begin OT Train
2023-09-02 21:01:47,386 - FGO - INFO - ===== Train Fair OT GCN Model ============================================================
2023-09-02 21:01:47,479 - FGO - INFO - Epoch   0 | Train Loss: -21.909 | Val Loss: -2.28 | Val F1: 0.97 |
2023-09-02 21:01:48,252 - FGO - INFO - Epoch  10 | Train Loss: -23.656 | Val Loss: -2.32 | Val F1: 0.92 |
2023-09-02 21:01:49,055 - FGO - INFO - Epoch  20 | Train Loss: -24.015 | Val Loss: -1.99 | Val F1: 0.38 |
2023-09-02 21:01:49,825 - FGO - INFO - Epoch  30 | Train Loss: -24.015 | Val Loss: -2.00 | Val F1: 0.38 |
2023-09-02 21:01:50,617 - FGO - INFO - Epoch  40 | Train Loss: -24.014 | Val Loss: -2.00 | Val F1: 0.38 |
2023-09-02 21:01:51,274 - FGO - INFO - Best Epoch:   8 | Train Loss: -23.481 | Val Loss: -2.37 | Val F1: 0.93 |
2023-09-02 21:01:51,275 - FGO - INFO - Setting model to best state.
2023-09-02 21:01:51,277 - CV - INFO - OT Train Complete, 8 epochs
2023-09-02 21:01:51,278 - FGO - INFO - ===== Test Fair OT GCN Model =============================================================
2023-09-02 21:01:51,302 - FGO - INFO - Train CM:
[[385   0]
 [340   0]]
2023-09-02 21:01:51,302 - FGO - INFO - Val CM:
[[49  0]
 [30  0]]
2023-09-02 21:01:51,302 - FGO - INFO - Test CM:
[[49  0]
 [30  0]]
2023-09-02 21:01:51,307 - FGO - INFO - test statistical parity: 0.0
2023-09-02 21:01:51,309 - FGO - INFO - test equal opportunity: 0.0
2023-09-02 21:01:51,310 - FGO - INFO - test micro f1: 0.620253164556962
2023-09-02 21:01:51,310 - FGO - INFO - test macro f1: 0.3828125
2023-09-02 21:01:51,310 - CV - INFO - fold time: 4.318472862243652s (0.07197454770406088m)
2023-09-02 21:01:51,310 - CV - INFO - Mean Pretrain Epochs 41.0:
2023-09-02 21:01:51,310 - CV - INFO - Mean OT Train Epochs 9.1:
2023-09-02 21:01:51,310 - CV - INFO - Mean Val Macro F1 : 0.3491007683535168
2023-09-02 21:01:51,310 - CV - INFO - Mean Eval Stat : 0.3491007683535168 (harmoic mean of macro f1 and (1-eo))
2023-09-02 21:01:51,310 - CV - INFO - set time: 42.84298753738403s (0.7140497922897339m)
2023-09-02 21:01:51,310 - CV - INFO - script time so far: 1209.2614130973816s (20.15435688495636m) (0.335905948082606h)
2023-09-02 21:01:51,310 - CV - INFO - ===== CROSS FOLD COMPLETE ================================================================
2023-09-02 21:01:51,310 - CV - INFO - Best Eval Stat: 0.9589087702629799
2023-09-02 21:01:51,310 - CV - INFO - Best Set: 
2023-09-02 21:01:51,310 - CV - INFO - 	done: False
2023-09-02 21:01:51,310 - CV - INFO - 	learning_rate: 0.005
2023-09-02 21:01:51,310 - CV - INFO - 	h1: 64
2023-09-02 21:01:51,310 - CV - INFO - 	h2: 32
2023-09-02 21:01:51,310 - CV - INFO - 	weight_decay: 0.0005
2023-09-02 21:01:51,310 - CV - INFO - 	dropout: 0.0
2023-09-02 21:01:51,310 - CV - INFO - 	max_pretrain_epochs: 100
2023-09-02 21:01:51,310 - CV - INFO - 	max_ot_epochs: 50
2023-09-02 21:01:51,310 - CV - INFO - 	lambda: 0.01
2023-09-02 21:01:51,311 - CV - INFO - 	theta: 10
2023-09-02 21:01:51,311 - CV - INFO - 	clip: 5
2023-09-02 21:01:51,311 - CV - INFO - 	mean_pe: 45.5
2023-09-02 21:01:51,311 - CV - INFO - 	mean_ot: 17.4
2023-09-02 21:01:51,311 - CV - INFO - 	mean_val_f1: 0.9589087702629799
2023-09-02 21:01:51,311 - CV - INFO - 	mean_hmean: 0.9589087702629799
2023-09-02 21:01:51,311 - CV - INFO - total script time: 1209.261641740799s (20.154360695679983m) (0.3359060115946664h)
